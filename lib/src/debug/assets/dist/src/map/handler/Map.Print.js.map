{"version":3,"file":"Map.Print.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/map/handler/Map.Print.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Map.Print is handling the print action\n */\n\n/* global _ */\n\nL.Map.mergeOptions({\n\tprintHandler: true\n});\n\nL.Map.Print = L.Handler.extend({\n\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t},\n\n\taddHooks: function () {\n\t\tthis._map.on('filedownloadready', this._onFileReady, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('filedownloadready', this._onFileReady, this);\n\t},\n\n\t_onFileReady: function (e) {\n\t\t// we need to load the pdf document and pass it to the iframe as an\n\t\t// object URL, because else we might have cross origin security problems\n\t\tvar xmlHttp = new XMLHttpRequest();\n\t\txmlHttp.onreadystatechange = L.bind(function () {\n\t\t\tif (xmlHttp.readyState === 4 && xmlHttp.status === 200) {\n\t\t\t\tthis._onInitPrint(xmlHttp);\n\t\t\t}\n\t\t}, this);\n\t\txmlHttp.open('GET', e.url, true);\n\t\txmlHttp.responseType = 'blob';\n\t\txmlHttp.send();\n\t},\n\n\t_onInitPrint: function (e) {\n\t\tvar blob = new Blob([e.response], {type: 'application/pdf'});\n\t\tvar url = URL.createObjectURL(blob);\n\t\tthis._printIframe = L.DomUtil.create('iframe', '', document.body);\n\t\tthis._printIframe.title = _('Print dialog');\n\t\tthis._printIframe.onload = L.bind(this._onIframeLoaded, this);\n\t\tL.DomUtil.setStyle(this._printIframe, 'visibility', 'hidden');\n\t\tL.DomUtil.setStyle(this._printIframe, 'position', 'fixed');\n\t\tL.DomUtil.setStyle(this._printIframe, 'right', '0');\n\t\tL.DomUtil.setStyle(this._printIframe, 'bottom', '0');\n\t\tthis._printIframe.src = url;\n\t},\n\n\t_onIframeLoaded: function () {\n\t\tthis._printIframe.contentWindow.focus(); // Required for IE\n\t\tthis._printIframe.contentWindow.print();\n\t\t// couldn't find another way to remove it\n\t\tsetTimeout(L.bind(this._closePrintIframe, this, this._printIframe), 300 * 1000);\n\t},\n\n\t_closePrintIframe: function (printIframe) {\n\t\tL.DomUtil.remove(printIframe);\n\t\tthis._map.focus();\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'printHandler', L.Map.Print);\n"]}