{"version":3,"file":"Map.Drag.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/map/handler/Map.Drag.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.\n */\n\nL.Map.mergeOptions({\n\tdragging: true\n});\n\nL.Map.Drag = L.Handler.extend({\n\taddHooks: function () {\n\t\tif (!this._draggable) {\n\t\t\tvar map = this._map;\n\n\t\t\tthis._draggable = new L.Draggable(map._mapPane, map._container);\n\t\t\tthis._draggable._map = map;\n\n\t\t\tthis._draggable.on({\n\t\t\t\tdown: this._onDown,\n\t\t\t\tdragstart: this._onDragStart,\n\t\t\t\tpredrag: this._onPreDrag,\n\t\t\t\tdrag: this._onDrag,\n\t\t\t\tdragend: this._onDragEnd\n\t\t\t}, this);\n\t\t}\n\t\tthis._draggable.enable();\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._draggable.disable();\n\t},\n\n\tmoved: function () {\n\t\treturn this._draggable && this._draggable._moved;\n\t},\n\n\t_onDown: function () {\n\t\tthis._map.stop();\n\t},\n\n\t_onDragStart: function () {\n\t\tthis._dragEdgeOffset = new L.Point(0, 0);\n\n\t\tvar map = this._map;\n\n\t\tmap\n\t\t    .fire('movestart')\n\t\t    .fire('dragstart');\n\t},\n\n\t_onDrag: function (e) {\n\t\tif (window.IgnorePanning)\n\t\t\treturn;\n\n\t\tthis._map\n\t\t    .fire('move', e)\n\t\t    .fire('drag', e);\n\t},\n\n\t_onPreDrag: function () {\n\t\tvar org = this._map.getPixelOrigin();\n\t\tvar pos = this._map._getMapPanePos();\n\t\tvar size = this._map.getLayerMaxBounds().getSize().subtract(this._map.getSize());\n\n\t\tthis._draggable._newPos = this._draggable._newPos.add(this._dragEdgeOffset);\n\n\t\tif (this._draggable._newPos.x !== pos.x) {\n\t\t\tlet clampedX = Math.max(\n\t\t\t\tMath.min(org.x, this._draggable._newPos.x),\n\t\t\t\torg.x - Math.max(size.x, 0)\n\t\t\t);\n\t\t\tthis._dragEdgeOffset.x += clampedX - this._draggable._newPos.x;\n\t\t\tthis._draggable._newPos.x = clampedX;\n\t\t}\n\n\t\tif (this._draggable._newPos.y !== pos.y) {\n\t\t\tlet clampedY = Math.max(\n\t\t\t\tMath.min(org.y, this._draggable._newPos.y),\n\t\t\t\torg.y - Math.max(size.y, 0)\n\t\t\t);\n\t\t\tthis._dragEdgeOffset.y += clampedY - this._draggable._newPos.y;\n\t\t\tthis._draggable._newPos.y = clampedY;\n\t\t}\n\t},\n\n\t_onDragEnd: function (e) {\n\t\tvar map = this._map;\n\n\t\tmap.fire('dragend', e);\n\t\tmap.fire('moveend');\n\t}\n});\n"]}