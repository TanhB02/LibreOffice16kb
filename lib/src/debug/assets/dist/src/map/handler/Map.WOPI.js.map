{"version":3,"file":"Map.WOPI.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/map/handler/Map.WOPI.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * L.WOPI contains WOPI related logic\n */\n\n/* global _ app _UNO JSDialog errorMessages URLPopUpSection */\nL.Map.WOPI = L.Handler.extend({\n\t// If the CheckFileInfo call fails on server side, we won't have any PostMessageOrigin.\n\t// So use '*' because we still needs to send 'close' message to the parent frame which\n\t// wouldn't be possible otherwise.\n\tPostMessageOrigin: window.postmessageOriginExt || '*',\n\tBaseFileName: '',\n\tBreadcrumbDocName: '',\n\tDocumentLoadedTime: false,\n\tHidePrintOption: false,\n\tHideSaveOption: false,\n\tHideExportOption: false,\n\tHideRepairOption: false,\n\tHideChangeTrackingControls: false,\n\tDisablePrint: false,\n\tDisableExport: false,\n\tDisableCopy: false,\n\tDisableInactiveMessages: false,\n\tDownloadAsPostMessage: false,\n\tUserCanNotWriteRelative: true,\n\tEnableInsertRemoteImage: false,\n\tEnableInsertRemoteFile: false, /* Separate, because requires explicit integration support */\n\tDisableInsertLocalImage: false,\n\tEnableInsertRemoteLink: false,\n\tEnableRemoteAIContent: false,\n\tEnableShare: false,\n\tHideUserList: null,\n\tCallPythonScriptSource: null,\n\tSupportsRename: false,\n\tUserCanRename: false,\n\tUserCanWrite: false,\n\tDisablePresentation: false,\n\n\t_appLoadedConditions: {\n\t\tdocloaded: false,\n\t\tupdatepermission: false,\n\t\tviewinfo: false /* Whether view information has already arrived */\n\t},\n\n\t_appLoaded: false,\n\t_insertImageMenuSetupDone: false,\n\n\tinitialize: function(map) {\n\t\tthis._map = map;\n\t},\n\n\taddHooks: function() {\n\t\tthis._map.on('postMessage', this._postMessage, this);\n\n\t\t// init messages\n\t\tthis._map.on('docloaded', this._postLoaded, this);\n\t\tapp.events.on('updatepermission', this._postLoaded.bind(this));\n\t\t// This indicates that 'viewinfo' message has already arrived\n\t\tthis._map.on('viewinfo', this._postLoaded, this);\n\n\t\tthis._map.on('wopiprops', this._setWopiProps, this);\n\t\tL.DomEvent.on(window, 'message', this._postMessageListener, this);\n\n\t\tthis._map.on('updateviewslist', function() { this._postViewsMessage('Views_List'); }, this);\n\n\t\tif (!window.ThisIsAMobileApp) {\n\t\t\t// override the window.open to issue a postMessage, so that\n\t\t\t// it is possible to handle the hyperlink in the integration\n\t\t\tvar that = this;\n\t\t\twindow.open = function (open) {\n\t\t\t\treturn function (url, name, features) {\n\t\t\t\t\tconst eSignature = that._map.eSignature;\n\t\t\t\t\tconst eSignInProgress = eSignature && eSignature.signInProgress;\n\t\t\t\t\tif (eSignInProgress) {\n\t\t\t\t\t\treturn open.call(window, url, name, features);\n\t\t\t\t\t}\n\n\t\t\t\t\tthat._map.fire('postMessage', {\n\t\t\t\t\t\tmsgId: 'UI_Hyperlink',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tUrl: url,\n\t\t\t\t\t\t\tName: name,\n\t\t\t\t\t\t\tFeatures: features\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!that._map._disableDefaultAction['UI_Hyperlink'])\n\t\t\t\t\t\treturn open.call(window, url, name, features);\n\t\t\t\t\telse\n\t\t\t\t\t\treturn null;\n\t\t\t\t};\n\t\t\t}(window.open);\n\t\t}\n\t},\n\n\tremoveHooks: function() {\n\t\tthis._map.off('postMessage', this._postMessage, this);\n\n\t\t// init messages\n\t\tthis._map.off('docloaded', this._postLoaded, this);\n\t\tthis._map.off('viewinfo', this._postLoaded, this);\n\n\t\tthis._map.off('wopiprops', this._setWopiProps, this);\n\t\tL.DomEvent.off(window, 'message', this._postMessageListener, this);\n\n\t\tthis._map.off('updateviewslist');\n\t},\n\n\t// Return whether there is the capability to rename, not the permission.\n\t// Since we fall back on Save As for rename isn't supported.\n\t_supportsRename: function() {\n\t\treturn !!this.SupportsRename || !this.UserCanNotWriteRelative;\n\t},\n\n\t_setWopiProps: function(wopiInfo) {\n\t\tvar overridenFileInfo = window.checkFileInfoOverride;\n\t\t// Store postmessageorigin property, if it exists\n\t\tif (wopiInfo['PostMessageOrigin']) {\n\t\t\tthis.PostMessageOrigin = wopiInfo['PostMessageOrigin'];\n\t\t}\n\n\t\tthis.BaseFileName = wopiInfo['BaseFileName'];\n\t\tthis.BreadcrumbDocName = wopiInfo['BreadcrumbDocName'];\n\t\tif (this.BreadcrumbDocName === undefined)\n\t\t\tthis.BreadcrumbDocName = this.BaseFileName;\n\t\tthis.HidePrintOption = !!wopiInfo['HidePrintOption'];\n\t\tthis.HideSaveOption = !!wopiInfo['HideSaveOption'];\n\t\tthis.HideExportOption = !!wopiInfo['HideExportOption'];\n\t\tthis.HideRepairOption = !!wopiInfo['HideRepairOption'];\n\t\tthis.HideChangeTrackingControls = !!wopiInfo['HideChangeTrackingControls'];\n\t\tthis.DisablePrint = !!wopiInfo['DisablePrint'];\n\t\tthis.DisableExport = !!wopiInfo['DisableExport'];\n\t\tthis.DisableCopy = !!wopiInfo['DisableCopy'];\n\t\tthis.DisableInactiveMessages = !!wopiInfo['DisableInactiveMessages'];\n\t\tthis.DownloadAsPostMessage = Object.prototype.hasOwnProperty.call(overridenFileInfo, 'DownloadAsPostMessage') ?\n\t\t\toverridenFileInfo.DownloadAsPostMessage : !!wopiInfo['DownloadAsPostMessage'];\n\t\tthis.UserCanNotWriteRelative = !!wopiInfo['UserCanNotWriteRelative'];\n\t\tthis.EnableInsertRemoteImage = !!wopiInfo['EnableInsertRemoteImage'];\n\t\tthis.EnableInsertRemoteFile = !!wopiInfo['EnableInsertRemoteFile'];\n\t\tthis.DisableInsertLocalImage = !!wopiInfo['DisableInsertLocalImage'];\n\t\tthis.EnableRemoteLinkPicker = !!wopiInfo['EnableRemoteLinkPicker'];\n\t\tthis.EnableRemoteAIContent = !!wopiInfo['EnableRemoteAIContent'];\n\t\tthis.SupportsRename = !!wopiInfo['SupportsRename'];\n\t\tthis.UserCanRename = !!wopiInfo['UserCanRename'];\n\t\tthis.EnableShare = !!wopiInfo['EnableShare'];\n\t\tthis.UserCanWrite = !!wopiInfo['UserCanWrite'];\n\t\tthis.DisablePresentation = wopiInfo['DisablePresentation'];\n\n\t\tif (this.UserCanWrite && !app.isReadOnly()) // There are 2 places that set the file permissions, WOPI and URI. Don't change permission if URI doesn't allow.\n\t\t\tapp.setPermission('edit');\n\n\t\tthis.IsOwner = !!wopiInfo['IsOwner'];\n\n\t\tif (wopiInfo['HideUserList'])\n\t\t\tthis.HideUserList = wopiInfo['HideUserList'].split(',');\n\n\t\tthis._map.fire('postMessage', {\n\t\t\tmsgId: 'App_LoadingStatus',\n\t\t\targs: {\n\t\t\t\tStatus: 'Frame_Ready',\n\t\t\t\tFeatures: {\n\t\t\t\t\tVersionStates: true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif ('TemplateSaveAs' in wopiInfo) {\n\t\t\tthis._map.showBusy(_('Creating new file from template...'), false);\n\t\t\tthis._map.saveAs(wopiInfo['TemplateSaveAs']);\n\t\t}\n\n\t\tthis.setupImageInsertionMenu();\n\t},\n\n\tsetupImageInsertionMenu: function() {\n\t\tif (this._insertImageMenuSetupDone) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar menuEntriesImage = JSDialog.MenuDefinitions.get('InsertImageMenu');\n\t\tvar menuEntriesMultimedia = JSDialog.MenuDefinitions.get('InsertMultimediaMenu');\n\n\t\tif (this.DisableInsertLocalImage) {\n\t\t\tmenuEntriesImage = [];\n\t\t\tmenuEntriesMultimedia = [];\n\t\t}\n\n\t\tif (this.EnableInsertRemoteImage) {\n\t\t\tmenuEntriesImage.push({action: 'remotegraphic', text: _UNO('.uno:InsertGraphic', '', true)});\n\t\t}\n\n\t\tif (this.EnableInsertRemoteFile) {\n\t\t\t/* Separate, because needs explicit integration support */\n\t\t\tmenuEntriesMultimedia.push({action: 'remotemultimedia', text: _UNO('.uno:InsertAVMedia', '', true)});\n\t\t}\n\n\t\tthis._insertImageMenuSetupDone = true;\n\t},\n\n\tresetAppLoaded: function() {\n\t\tthis._appLoaded = false;\n\t\tfor (var key in this._appLoadedConditions) {\n\t\t\tthis._appLoadedConditions[key] = false;\n\t\t}\n\t},\n\n\t_postLoaded: function(e) {\n\t\tif (this._appLoaded) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.type === 'docloaded') {\n\t\t\t// doc unloaded\n\t\t\tif (!e.status)\n\t\t\t{\n\t\t\t\tthis._appLoadedConditions[e.type] = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.DocumentLoadedTime = Date.now();\n\t\t}\n\t\tthis._appLoadedConditions[e.type] = true;\n\t\tfor (var key in this._appLoadedConditions) {\n\t\t\tif (!this._appLoadedConditions[key])\n\t\t\t\treturn;\n\t\t}\n\n\t\tthis._appLoaded = true;\n\t\tthis._map.fire('postMessage', {msgId: 'App_LoadingStatus', args: {Status: 'Document_Loaded', DocumentLoadedTime: this.DocumentLoadedTime}});\n\t},\n\n\t// Naturally we set a CSP to catch badness, but check here as well.\n\t// Checking whether a message came from our iframe's parents is\n\t// un-necessarily difficult.\n\t_allowMessageOrigin: function(e) {\n\t\t// e.origin === 'null' when sandboxed\n\t\tif (e.origin === 'null')\n\t\t\treturn false;\n\n\t\t// cache - to avoid regexps.\n\t\tif (this._cachedGoodOrigin && this._cachedGoodOrigin === e.origin)\n\t\t\treturn true;\n\n\t\ttry {\n\t\t\tif (e.origin === window.parent.origin)\n\t\t\t\treturn true;\n\t\t} catch (secErr) { // security error de-referencing window.parent.origin.\n\t\t}\n\n\t\t// sent from the server\n\t\tvar i;\n\t\tif (!this._allowedOrigins && window.frameAncestors)\n\t\t{\n\t\t\tvar ancestors = window.frameAncestors.trim().split(' ');\n\t\t\tthis._allowedOrigins = ancestors;\n\t\t\t// convert to JS regexps from localhost:* to https*://localhost:.*\n\t\t\tfor (i = 0; i < ancestors.length; i++) {\n\t\t\t\tthis._allowedOrigins[i] = '(http|https)://' + ancestors[i].replace(/:\\*/, ':?.*');\n\t\t\t}\n\t\t}\n\n\t\tif (this._allowedOrigins)\n\t\t{\n\t\t\tfor (i = 0; i < this._allowedOrigins.length; i++) {\n\t\t\t\tif (e.origin.match(this._allowedOrigins[i]))\n\t\t\t\t{\n\t\t\t\t\tthis._cachedGoodOrigin = e.origin;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// chrome only\n\t\tif (window.location.ancestorOrigins &&\n\t\t    window.location.ancestorOrigins.contains(e.origin))\n\t\t{\n\t\t\tthis._cachedGoodOrigin = e.origin;\n\t\t\treturn true;\n\t\t}\n\n\t\tconst eSignature = this._map.eSignature;\n\t\tif (eSignature && eSignature.url === e.origin) {\n\t\t\t// The sender is our esign popup: accept it.\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_postMessageListener: function(e) {\n\t\tif (!this._allowMessageOrigin(e)) {\n\t\t\twindow.app.console.error('PostMessage not allowed due to incorrect origin.');\n\t\t\treturn;\n\t\t}\n\n\t\tvar msg;\n\n\t\tif (('data' in e) && Object.hasOwnProperty.call(e.data, 'MessageId')) {\n\t\t\t// when e.data already contains the right props, but isn't JSON (a blob is passed for ex)\n\t\t\tmsg = e.data;\n\t\t} else if (typeof e.data === 'object') {\n\t\t\t// E.g. the esign popup sends us an object, no need to JSON-parse it.\n\t\t\tmsg = e.data;\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tmsg = JSON.parse(e.data);\n\t\t\t} catch (e) {\n\t\t\t\twindow.app.console.error(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// allow closing documents before they are completely loaded\n\t\tif (msg.MessageId === 'Close_Session') {\n\t\t\tapp.socket.sendMessage('closedocument');\n\t\t\treturn;\n\t\t}\n\n\t\t// Exception: UI modification can be done before WOPIPostmessageReady was fulfilled\n\t\tif (msg.MessageId === 'Show_Button' || msg.MessageId === 'Hide_Button' || msg.MessageId === 'Remove_Button') {\n\t\t\tif (!msg.Values) {\n\t\t\t\twindow.app.console.error('Property \"Values\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!msg.Values.id) {\n\t\t\t\twindow.app.console.error('Property \"Values.id\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar show = msg.MessageId === 'Show_Button';\n\t\t\tthis._map.uiManager.showButton(msg.Values.id, show);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_Command' || msg.MessageId === 'Hide_Command') {\n\t\t\tif (!msg.Values) {\n\t\t\t\twindow.app.console.error('Property \"Values\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!msg.Values.id) {\n\t\t\t\twindow.app.console.error('Property \"Values.id\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar show = msg.MessageId === 'Show_Command';\n\t\t\tthis._map.uiManager.showCommand(msg.Values.id, show);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Remove_Statusbar_Element') {\n\t\t\tif (!msg.Values) {\n\t\t\t\twindow.app.console.error('Property \"Values\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!msg.Values.id) {\n\t\t\t\twindow.app.console.error('Property \"Values.id\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// TODO: remove\n\t\t\twindow.app.map.statusBar.showItem(msg.Values.id, false);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_Menubar') {\n\t\t\tthis._map.uiManager.showMenubar();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hide_Menubar') {\n\t\t\tthis._map.uiManager.hideMenubar();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_Ruler') {\n\t\t\tthis._map.uiManager.showRuler();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hide_Ruler') {\n\t\t\tthis._map.uiManager.hideRuler();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_StatusBar') {\n\t\t\tthis._map.uiManager.showStatusBar();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hide_StatusBar') {\n\t\t\tthis._map.uiManager.hideStatusBar(false);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Collapse_Notebookbar') {\n\t\t\tthis._map.uiManager.collapseNotebookbar();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Extend_Notebookbar') {\n\t\t\tthis._map.uiManager.extendNotebookbar();\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_NotebookTab' || msg.MessageId === 'Hide_NotebookTab') {\n\t\t\tif (!msg.Values) {\n\t\t\t\twindow.app.console.error('Property \"Values\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!msg.Values.id) {\n\t\t\t\twindow.app.console.error('Property \"Values.id\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet show = msg.MessageId === 'Show_NotebookTab';\n\t\t\tthis._map.uiManager.showNotebookTab(msg.Values.id, show);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_Sidebar') {\n\t\t\t/* id is optional */\n                        if (msg.Values) {\n\t\t\t\tswitch (msg.Values.id) {\n\t\t\t\tcase 'Navigator':\n\t\t\t\tcase 'ModifyPage':\n\t\t\t\tcase 'SlideChangeWindow':\n\t\t\t\tcase 'CustomAnimation':\n\t\t\t\tcase 'MasterSlidesPanel':\n\t\t\t\t\tthis._map.sendUnoCommand(`.uno:${msg.Values.id}`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._map.sendUnoCommand('.uno:SidebarDeck.PropertyDeck');\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hide_Sidebar') {\n\t\t\tthis._map.sendUnoCommand('.uno:SidebarHide');\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Show_Menu_Item' || msg.MessageId === 'Hide_Menu_Item') {\n\t\t\tif (!msg.Values) {\n\t\t\t\twindow.app.console.error('Property \"Values\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!msg.Values.id) {\n\t\t\t\twindow.app.console.error('Property \"Values.id\" not set');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._map.menubar || !this._map.menubar.hasItem(msg.Values.id)) {\n\t\t\t\twindow.app.console.error('Menu item with id \"' + msg.Values.id + '\" not found.');\n\t\t\t\tif (this._map.uiManager.getCurrentMode() === 'notebookbar') {\n\t\t\t\t\twindow.app.console.error('No menu items in notebookbar');\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (msg.MessageId === 'Show_Menu_Item') {\n\t\t\t\tif (!this._map.menubar.showItem(msg.Values.id)) {\n\t\t\t\t\twindow.app.console.error('Menu entry with id \"' + msg.Values.id + '\" not found.');\n\t\t\t\t}\n\t\t\t} else if (!this._map.menubar.hideItem(msg.Values.id)) {\n\t\t\t\twindow.app.console.error('Menu entry with id \"' + msg.Values.id + '\" not found.');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Insert_Button' &&\n\t\t\tmsg.Values && msg.Values.id) {\n\t\t\tthis._map.uiManager.insertButton(msg.Values);\n\t\t\treturn;\n\t\t} else if (msg.MessageId === 'Send_UNO_Command' && msg.Values && msg.Values.Command) {\n\t\t\tthis._map.sendUnoCommand(msg.Values.Command, msg.Values.Args || '');\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hint_OnscreenKeyboard') {\n\t\t\twindow.keyboard.hintOnscreenKeyboard(true);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Hint_NoOnscreenKeyboard') {\n\t\t\twindow.keyboard.hintOnscreenKeyboard(false);\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Disable_Default_UIAction') {\n\t\t\t// Disable the default handler and action for a UI command.\n\t\t\t// When set to true, the given UI command will issue a postmessage\n\t\t\t// only. For example, UI_Save will be issued for invoking the save\n\t\t\t// command (from the menu, toolbar, or keyboard shortcut) and no\n\t\t\t// action will take place if 'UI_Save' is disabled via\n\t\t\t// the Disable_Default_UIAction command.\n\t\t\tif (msg.Values && msg.Values.action && msg.Values.disable !== undefined) {\n\t\t\t\tthis._map._disableDefaultAction[msg.Values.action] = msg.Values.disable;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\telse if (msg.MessageId === 'Error_Messages') {\n\t\t\tif (msg.Values && msg.Values.list) {\n\t\t\t\tmsg.Values.list.forEach(function (item) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(errorMessages.storage, item.type)) {\n\t\t\t\t\t\terrorMessages.storage[item.type] = item.msg;\n\t\t\t\t\t} else if (Object.prototype.hasOwnProperty.call(errorMessages.uploadfile, item.type)) {\n\t\t\t\t\t\terrorMessages.uploadfile[item.type] = item.msg;\n\t\t\t\t\t} else if (Object.prototype.hasOwnProperty.call(errorMessages, item.type)) {\n\t\t\t\t\t\terrorMessages[item.type] = item.msg;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// All following actions must be done after initialization is completed.\n\t\tif (!window.WOPIPostmessageReady) {\n\t\t\twindow.app.console.error('PostMessage ignored: not ready.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (msg.MessageId === 'Host_PostmessageReady') {\n\t\t\t// We already have a listener for this in cool.html, so ignore it here\n\t\t\treturn;\n\t\t}\n\n\t\tif (msg.MessageId === 'Grab_Focus') {\n\t\t\tapp.idleHandler._activate();\n\t\t\treturn;\n\t\t}\n\n\t\t// allow closing documents before they are completely loaded\n\t\tif (msg.MessageId === 'Close_Session') {\n\t\t\tapp.socket.sendMessage('closedocument');\n\t\t\treturn;\n\t\t}\n\n\t\t// when user goes idle we have 'this._appLoaded == false'\n\t\tif (msg.MessageId === 'Get_User_State') {\n\t\t\tvar isIdle = app.idleHandler.isDimActive();\n\t\t\tthis._postMessage({msgId: 'Get_User_State_Resp', args: {\n\t\t\t\tState: (isIdle ? 'idle' : 'active'),\n\t\t\t\tElapsed: app.idleHandler.getElapsedFromActivity()\n\t\t\t}});\n\t\t}\n\n\t\t// For all other messages, warn if trying to interact before we are completely loaded\n\t\tif (!this._appLoaded) {\n\t\t\twindow.app.console.error('Collabora Online not loaded yet. Listen for App_LoadingStatus (Document_Loaded) event before using PostMessage API. Ignoring post message \\'' + msg.MessageId + '\\'.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (msg.MessageId === 'Set_Settings') {\n\t\t\tif (msg.Values) {\n\t\t\t\tvar alwaysActive = msg.Values.AlwaysActive;\n\t\t\t\tthis._map.options.alwaysActive = !!alwaysActive;\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Get_Views') {\n\t\t\tthis._postViewsMessage('Get_Views_Resp');\n\t\t}\n\t\telse if (msg.MessageId === 'Reset_Access_Token') {\n\t\t\tapp.socket.sendMessage('resetaccesstoken ' + msg.Values.token);\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Save') {\n\t\t\tvar dontTerminateEdit = msg.Values && msg.Values['DontTerminateEdit'];\n\t\t\tvar dontSaveIfUnmodified = msg.Values && msg.Values['DontSaveIfUnmodified'];\n\t\t\tvar extendedData = msg.Values && msg.Values['ExtendedData'];\n\t\t\textendedData = encodeURIComponent(extendedData);\n\t\t\tthis._notifySave = msg.Values && msg.Values['Notify'];\n\n\t\t\tthis._map.save(dontTerminateEdit, dontSaveIfUnmodified, extendedData);\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Close') {\n\t\t\tthis._map.remove();\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Fullscreen') {\n\t\t\tapp.util.toggleFullScreen();\n\t\t}\n\t\telse if (msg.MessageId === 'Action_FullscreenPresentation' && this._map.getDocType() === 'presentation') {\n\t\t\tif (msg.Values) {\n\t\t\t\tvar slideNumber;\n\t\t\t\tif (typeof msg.Values.StartSlideNumber != 'undefined') {\n\t\t\t\t\tslideNumber = msg.Values.StartSlideNumber;\n\t\t\t\t} else if (msg.Values.CurrentSlide) {\n\t\t\t\t\tslideNumber = this._map.getCurrentPartNumber();\n\t\t\t\t}\n\t\t\t\tthis._map.fire('fullscreen',\n\t\t\t\t\t       {\n\t\t\t\t\t\t       startSlideNumber: slideNumber\n\t\t\t\t\t       });\n\t\t\t} else {\n\t\t\t\tthis._map.fire('fullscreen');\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Print') {\n\t\t\tthis._map.print();\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Export') {\n\t\t\tif (msg.Values) {\n\t\t\t\tthis._notifySave = msg.Values['Notify'];\n\t\t\t\tvar format = msg.Values.Format;\n\t\t\t\tvar fileName = this._map['wopi'].BaseFileName;\n\t\t\t\tfileName = fileName.substr(0, fileName.lastIndexOf('.'));\n\t\t\t\tfileName = fileName === '' ? 'document' : fileName;\n\t\t\t\tthis._map.downloadAs(fileName + '.' + format, format);\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId == 'Action_InsertGraphic') {\n\t\t\tif (msg.Values) {\n\t\t\t\tthis._map.insertURL(msg.Values.url, \"graphicurl\");\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId == 'Action_InsertMultimedia') {\n\t\t\tif (msg.Values) {\n\t\t\t\tthis._map.insertURL(msg.Values.url, \"multimediaurl\");\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId == 'Action_InsertLink') {\n\t\t\tif (msg.Values) {\n\t\t\t\tvar link = this._map.makeURLFromStr(msg.Values.url);\n\t\t\t\tvar text = this._map.getTextForLink();\n\n\t\t\t\ttext = text ? text.trim() : link;\n\n\t\t\t\tvar command = {\n\t\t\t\t\t'Hyperlink.Text': {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tvalue: text\n\t\t\t\t\t},\n\t\t\t\t\t'Hyperlink.URL': {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tvalue: link\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis._map.sendUnoCommand('.uno:SetHyperlink', command);\n\t\t\t\tthis._map.focus();\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId == 'Action_GetLinkPreview_Resp') {\n\t\t\tvar preview = document.querySelector('#hyperlink-pop-up-preview');\n\t\t\tif (preview) {\n\t\t\t\t// check if this is a preview for currently displayed link\n\t\t\t\tif (preview.nextSibling && preview.nextSibling.innerText !== msg.Values.url)\n\t\t\t\t\treturn;\n\n\t\t\t\tpreview.innerText = '';\n\t\t\t\tif (msg.Values.image && msg.Values.image.indexOf('data:') === 0) {\n\t\t\t\t\tvar image = L.DomUtil.create('img', '', preview);\n\t\t\t\t\timage.src = msg.Values.image;\n\t\t\t\t\timage.alt = msg.Values.title;\n\t\t\t\t\timage.onload = function() {\n\t\t\t\t\t\tURLPopUpSection.resetPosition();\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tL.DomUtil.addClass(preview, 'no-preview');\n\t\t\t\t}\n\t\t\t\tif (msg.Values.title) {\n\t\t\t\t\tvar title = L.DomUtil.create('p', '', preview);\n\t\t\t\t\ttitle.innerText = msg.Values.title;\n\t\t\t\t\tURLPopUpSection.resetPosition();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_InsertFile') {\n\t\t\tif (msg.Values && (msg.Values.File instanceof Blob)) {\n\t\t\t\tthis._map.fire('insertfile', {file: msg.Values.File});\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId == 'Action_Paste') {\n\t\t\tif (msg.Values && msg.Values.Mimetype && msg.Values.Data) {\n\t\t\t\tvar blob = new Blob(['paste mimetype=' + msg.Values.Mimetype + '\\n', msg.Values.Data]);\n\t\t\t\tapp.socket.sendMessage(blob);\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_ShowBusy') {\n\t\t\tif (msg.Values && msg.Values.Label) {\n\t\t\t\tthis._map.fire('showbusy', {label: msg.Values.Label});\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_HideBusy') {\n\t\t\tthis._map.fire('hidebusy');\n\t\t}\n\t\telse if (msg.MessageId === 'Get_Export_Formats') {\n\t\t\tvar exportFormatsResp = [];\n\t\t\tfor (var index in app.file.exportFormats) {\n\t\t\t\texportFormatsResp.push({\n\t\t\t\t\tLabel: app.file.exportFormats[index].label,\n\t\t\t\t\tFormat: app.file.exportFormats[index].format\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._postMessage({msgId: 'Get_Export_Formats_Resp', args: exportFormatsResp});\n\t\t}\n\t\telse if (msg.MessageId === 'Action_SaveAs') {\n\t\t\tif (msg.Values) {\n\t\t\t\tif (msg.Values.Filename !== null && msg.Values.Filename !== undefined) {\n\t\t\t\t\tthis._notifySave = msg.Values['Notify'];\n\t\t\t\t\tvar nameParts = msg.Values.Filename.split('.');\n\t\t\t\t\tvar format = undefined;\n\t\t\t\t\tif (nameParts.length > 1)\n\t\t\t\t\t\tformat = nameParts.pop();\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._map.uiManager.showInfoModal('error', _('Error'), _('File name should contain an extension.'), '', _('OK'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isExport = format === 'pdf' || format === 'epub';\n\t\t\t\t\tif (isExport) {\n\t\t\t\t\t\tthis._map.exportAs(msg.Values.Filename);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._map.showBusy(_('Creating copy...'), false);\n\t\t\t\t\t\tthis._map.saveAs(msg.Values.Filename, format);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_FollowUser') {\n\t\t\tif (msg.Values) {\n\t\t\t\tthis._map._setFollowing(msg.Values.Follow, msg.Values.ViewId);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._map._setFollowing(true, null);\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Host_VersionRestore') {\n\t\t\tif (msg.Values.Status === 'Pre_Restore') {\n\t\t\t\tapp.socket.sendMessage('versionrestore prerestore');\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'CallPythonScript' &&\n\t\t\t Object.prototype.hasOwnProperty.call(msg, 'ScriptFile') &&\n\t\t\t Object.prototype.hasOwnProperty.call(msg, 'Function')) {\n\t\t\tthis._map.CallPythonScriptSource = e.source;\n\t\t\tthis._map.sendUnoCommand('vnd.sun.star.script:' + msg.ScriptFile + '$' + msg.Function + '?language=Python&location=share', msg.Values);\n\t\t}\n\t\telse if (msg.MessageId === 'Action_RemoveView') {\n\t\t\tif (msg.Values && msg.Values.ViewId !== null && msg.Values.ViewId !== undefined) {\n\t\t\t\tapp.socket.sendMessage('removesession ' + msg.Values.ViewId);\n\t\t\t}\n\t\t}\n\t\telse if (msg.MessageId === 'Action_ChangeUIMode') {\n\t\t\tthis._map.uiManager.onChangeUIMode({mode: msg.Values.Mode, force: true});\n\t\t}\n\t\telse if (msg.MessageId === 'Action_Mention') {\n\t\t\tvar list = msg.Values.list;\n\t\t\tthis._map.mention.openMentionPopup(list);\n\t\t}\n\t\telse if (msg.sender === 'EIDEASY_SINGLE_METHOD_SIGNATURE') {\n\t\t\t// This is produced by the esign popup.\n\t\t\tconst eSignature = this._map.eSignature;\n\t\t\tif (eSignature) {\n\t\t\t\teSignature.handleSigned(msg);\n\t\t\t}\n\t\t}\n\t},\n\n\t_postMessage: function(e) {\n\t\tif (!this.enabled) { return; }\n\t\tvar msgId = e.msgId;\n\t\tvar values = e.args || {};\n\t\tif (!!this.PostMessageOrigin && window.parent !== window.self) {\n\t\t\t// Filter out unwanted save request response\n\t\t\tif (msgId === 'Action_Save_Resp') {\n\t\t\t\tif (!this._notifySave)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._notifySave = false;\n\t\t\t}\n\n\t\t\tvar msg = {\n\t\t\t\t'MessageId': msgId,\n\t\t\t\t'SendTime': Date.now(),\n\t\t\t\t'Values': values\n\t\t\t};\n\t\t\twindow.parent.postMessage(JSON.stringify(msg), this.PostMessageOrigin);\n\t\t}\n\t},\n\n\t_postViewsMessage: function(messageId) {\n\t\tvar getMembersRespVal = [];\n\t\tfor (var viewInfoIdx in this._map._viewInfo) {\n\t\t\tgetMembersRespVal.push({\n\t\t\t\tViewId: viewInfoIdx,\n\t\t\t\tUserName: this._map._viewInfo[viewInfoIdx].username,\n\t\t\t\tUserId: this._map._viewInfo[viewInfoIdx].userid,\n\t\t\t\tUserExtraInfo: this._map._viewInfo[viewInfoIdx].userextrainfo,\n\t\t\t\tColor: this._map._viewInfo[viewInfoIdx].color,\n\t\t\t\tReadOnly: this._map._viewInfo[viewInfoIdx].readonly,\n\t\t\t\tIsCurrentView: this._map._docLayer._viewId === parseInt(viewInfoIdx, 10)\n\t\t\t});\n\t\t}\n\n\t\tthis._postMessage({msgId: messageId, args: getMembersRespVal});\n\t}\n});\n\n// This handler would only get 'enabled' by map if map.options.wopi = true\nL.Map.addInitHook('addHandler', 'wopi', L.Map.WOPI);\n"]}