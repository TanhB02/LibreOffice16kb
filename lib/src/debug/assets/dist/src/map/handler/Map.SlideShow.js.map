{"version":3,"file":"Map.SlideShow.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/map/handler/Map.SlideShow.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * L.Map.SlideShow is handling the slideShow action\n */\n\n/* global _ sanitizeUrl app */\nL.Map.mergeOptions({\n\tslideShow: true\n});\n\nL.Map.SlideShow = L.Handler.extend({\n\n\t_slideURL: '', // store the URL for svg\n\t_presentInWindow: false,\n\t_cypressSVGPresentationTest: false,\n\t_slideShowWindowProxy: null,\n\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t\twindow.app.console.log('L.Map.SlideShow: Cypress in window: ' + ('Cypress' in window));\n\t\tthis._cypressSVGPresentationTest =\n\t\t\tL.Browser.cypressTest && 'Cypress' in window\n\t\t\t&& window.Cypress.spec.name === 'impress/fullscreen_presentation_spec.js';\n\t},\n\n\taddHooks: function () {\n\t\tthis._map.on('fullscreen', this._onFullScreen, this);\n\t\tthis._map.on('presentinwindow', this._onPresentWindow, this);\n\t\tthis._map.on('slidedownloadready', this._onSlideDownloadReady, this);\n\t},\n\n\tremoveHooks: function () {\n\t\tthis._map.off('fullscreen', this._onFullScreen, this);\n\t\tthis._map.off('presentinwindow', this._onPresentWindow, this);\n\t\tthis._map.off('slidedownloadready', this._onSlideDownloadReady, this);\n\t},\n\n\t_onFullScreen: function (e) {\n\t\tif (this._checkPresentationDisabled()) {\n\t\t\tthis._notifyPresentationDisabled();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._checkAlreadyPresenting()) {\n\t\t\tthis._notifyAlreadyPresenting();\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.impress.areAllSlidesHidden()) {\n\t\t\tthis._map.uiManager.showInfoModal('allslidehidden-modal', _('Empty Slide Show'),\n\t\t\t\t\t'All slides are hidden!', '', _('OK'), function () { }, false, 'allslidehidden-modal-response');\n\t\t\treturn;\n\t\t}\n\n\t\tlet doPresentation = function(that, e) {\n\t\t\tthat._presentInWindow = false;\n\n\t\t\tthat._startSlideNumber = 0; // Default: start from page 0\n\t\t\tif (typeof e.startSlideNumber !== 'undefined') {\n\t\t\t\tthat._startSlideNumber = e.startSlideNumber;\n\t\t\t}\n\t\t\tthat.fullscreen = !that._cypressSVGPresentationTest;\n\t\t\tthat._map.downloadAs('slideshow.svg', 'svg', null, 'slideshow');\n\n\t\t\tL.DomEvent.on(document, 'fullscreenchange', that._onFullScreenChange, that);\n\t\t};\n\n\t\tlet fallback = function(that, e) {\n\t\t\t// fallback to \"open in new tab\"\n\t\t\tif (that._slideShow) {\n\t\t\t\tL.DomUtil.remove(that._slideShow);\n\t\t\t\tthat._slideShow = null;\n\t\t\t}\n\n\t\t\tdoPresentation(that, e);\n\t\t};\n\n\t\tif (!(this._cypressSVGPresentationTest || this._map['wopi'].DownloadAsPostMessage)) {\n\t\t\tthis._slideShow = L.DomUtil.create('iframe', 'leaflet-slideshow', this._map._container);\n\t\t\tif (this._slideShow.requestFullscreen) {\n\n\t\t\t\tlet that = this;\n\t\t\t\tthis._slideShow.requestFullscreen()\n\t\t\t\t\t.then(function () { doPresentation(that, e); })\n\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\tfallback(that, e);\n\t\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfallback(this, e);\n\t},\n\n\t_onPresentWindow: function (e) {\n\t\tif (this._checkPresentationDisabled()) {\n\t\t\tthis._notifyPresentationDisabled();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._checkAlreadyPresenting()) {\n\t\t\tthis._notifyAlreadyPresenting();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._presentInWindow = true;\n\t\tthis._startSlideNumber = 0;\n\t\tif (e.startSlideNumber !== undefined) {\n\t\t\tthis._startSlideNumber = e.startSlideNumber;\n\t\t}\n\n\t\tthis._map.downloadAs('slideshow.svg', 'svg', null, 'slideshow');\n\t},\n\n\t_onFullScreenChange: function () {\n\t\tif (this._map['wopi'].DownloadAsPostMessage) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fullscreen = document.fullscreenElement;\n\t\tif (!this.fullscreen) {\n\t\t\tthis._stopFullScreen();\n\t\t}\n\t},\n\n\t_stopFullScreen: function () {\n\t\tL.DomUtil.remove(this._slideShow);\n\t\tthis._slideShow = null;\n\t\t// #7102 on exit from fullscreen we don't get a 'focus' event\n\t\t// in Chrome so a later second attempt at launching a presentation\n\t\t// fails\n\t\tthis._map.focus();\n\t},\n\n\t_onSlideDownloadReady: function (e) {\n\t\tif ('processCoolUrl' in window) {\n\t\t\te.url = window.processCoolUrl({ url: e.url, type: 'slideshow' });\n\t\t}\n\n\t\tconst embedURL = new URL(e.url);\n\t\tembedURL.searchParams.append('attachment', 0);\n\n\t\tthis._slideURL = embedURL.toString();\n\t\twindow.app.console.debug('slide file url : ', this._slideURL);\n\n\t\tthis._startPlaying();\n\t},\n\n\t_startPlaying: function() {\n\t\t// Windowed Presentation\n\t\tif (this._presentInWindow) {\n\n\t\t\tthis._slideShowWindowProxy = window.open('', '_blank', 'popup');\n\n\t\t\tif (!this._slideShowWindowProxy) {\n\t\t\t\tthis._map.uiManager.showInfoModal('popup-blocked-modal',\n\t\t\t\t\t_('Windowed Presentation Blocked'),\n\t\t\t\t\t_('Presentation was blocked. Please allow pop-ups in your browser. This lets slide shows to be displayed in separated windows, allowing for easy screen sharing.'), '',\n\t\t\t\t\t_('OK'), null, false);\n\t\t\t}\n\n\t\t\tvar popupTitle = _('Windowed Presentation: ') + this._map['wopi'].BaseFileName;\n\t\t\tthis._slideShowWindowProxy.document.title = popupTitle;\n\n\t\t\tthis._slideShowWindowProxy.document.body.style.margin = '0';\n\t\t\tthis._slideShowWindowProxy.document.body.style.padding = '0';\n\t\t\tthis._slideShowWindowProxy.document.body.style.height = '100%';\n\t\t\tthis._slideShowWindowProxy.document.body.style.overflow = 'hidden'; // Prevent scrollbars.\n\n\t\t\tconst iFrame = this._slideShowWindowProxy.document.createElement('iframe');\n\t\t\tiFrame.src = sanitizeUrl(this._slideURL);\n\t\t\tiFrame.style.width = '100%';\n\t\t\tiFrame.style.height = '100%';\n\t\t\tiFrame.style.border = 'none';\n\t\t\tthis._slideShowWindowProxy.document.body.appendChild(iFrame);\n\t\t\tthis._slideShow = iFrame;\n\n\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\tthis._processSlideshowLinks();\n\t\t\t}\n\t\t\tthis._processSlideshowVideoForSafari();\n\n\t\t\tthis._slideShowWindowProxy.document.close();\n\t\t\tthis._slideShowWindowProxy.focus();\n\n\t\t\tthis._slideShowWindowProxy.onload = this._handleSlideWindowLoaded.bind(this);\n\n\t\t\t// this event listener catches keypresses if the user somehow manages to unfocus the iframe\n\t\t\tthis._slideShowWindowProxy.addEventListener('keydown', this._onSlideWindowKeyPress.bind(this));\n\n\t\t\tvar slideShowWindow = this._slideShowWindowProxy;\n\t\t\tthis._map.uiManager.showSnackbar(_('Presenting in window'),\n\t\t\t\t_('Close Presentation'),\n\t\t\t\tfunction() {slideShowWindow.close();},\n\t\t\t\t-1, false, true);\n\n\t\t\tthis._windowCloseInterval = setInterval(function() {\n\t\t\t\tif (slideShowWindow.closed) {\n\t\t\t\t\tclearInterval(this._windowCloseInterval);\n\t\t\t\t\tthis._map.uiManager.closeSnackbar();\n\t\t\t\t\tthis._slideShowWindowProxy = null;\n\t\t\t\t\tthis._slideShow = null;\n\t\t\t\t}\n\t\t\t}.bind(this), 500);\n\t\t\treturn;\n\t\t}\n\n\t\tif ('processCoolUrl' in window) {\n\t\t\tthis._processSlideshowLinks();\n\t\t}\n\t\tthis._processSlideshowVideoForSafari();\n\n\t\t// Cypress Presentation\n\t\tif (this._cypressSVGPresentationTest || !this._slideShow) {\n\t\t\twindow.open(this._slideURL, '_self');\n\t\t\treturn;\n\t\t}\n\t\t// Fullscreen Presentation\n\n\t\tthis._map.uiManager.showSnackbar(_('Presenting in fullscreen'),\n\t\t\t_('End Presentation'),\n\t\t\tfunction() {this._stopFullScreen();},\n\t\t\tnull, false, true);\n\n\t\tvar separator = (this._slideURL.indexOf('?') === -1) ? '?' : '&';\n\t\tthis._slideShow.src = this._slideURL + separator + 'StartSlideNumber=' + this._startSlideNumber;\n\t\tthis._slideShow.contentWindow.focus();\n\t},\n\n\t_handleSlideWindowLoaded: function() {\n\t\tconst iframe = this._slideShowWindowProxy.document.querySelector('iframe');\n\n\t\tif (iframe) {\n\t\t\tiframe.contentWindow.focus();\n\t\t\tiframe.contentWindow.addEventListener('keydown', this._onSlideWindowKeyPress.bind(this));\n\t\t}\n\t},\n\n\t_processSlideshowLinks: function() {\n\t\tthis._slideShow.addEventListener('load', (function onLoadSlideshow() {\n\t\t\tvar linkElements = [].slice.call(this._slideShow.contentDocument.querySelectorAll('a'))\n\t\t\t\t.filter(function(el) {\n\t\t\t\t\treturn el.getAttribute('href') || el.getAttribute('xlink:href');\n\t\t\t\t})\n\t\t\t\t.map(function(el) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tel: el,\n\t\t\t\t\t\tlink: el.getAttribute('href') || el.getAttribute('xlink:href'),\n\t\t\t\t\t\tparent: el.parentNode\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\tvar setAttributeNs = function(el, link) {\n\t\t\t\tlink = window.processCoolUrl({ url: link, type: 'slide' });\n\n\t\t\t\tel.setAttributeNS('http://www.w3.org/1999/xlink', 'href', link);\n\t\t\t\tel.setAttribute('target', '_blank');\n\t\t\t};\n\n\t\t\tlinkElements.forEach(function(item) {\n\t\t\t\tsetAttributeNs(item.el, item.link);\n\n\t\t\t\tvar parentLink = item.parent.getAttribute('xlink:href');\n\n\t\t\t\tif (parentLink) {\n\t\t\t\t\tsetAttributeNs(item.parent, parentLink);\n\t\t\t\t}\n\n\t\t\t\titem.parent.parentNode.insertBefore(item.parent.cloneNode(true), item.parent.nextSibling);\n\t\t\t\titem.parent.parentNode.removeChild(item.parent);\n\t\t\t});\n\t\t}).bind(this));\n\t},\n\n\t_checkAlreadyPresenting: function() {\n\t\tif (this._slideShowWindowProxy && !this._slideShowWindowProxy.closed)\n\t\t\treturn true;\n\t\tif (this._slideShow)\n\t\t\treturn true;\n\t\treturn false;\n\t},\n\n\t_notifyAlreadyPresenting: function() {\n\t\tthis._map.uiManager.showInfoModal('already-presenting-modal',\n\t\t\t_('Already presenting'),\n\t\t\t_('You are already presenting this document'), '',\n\t\t\t_('OK'), null, false);\n\t},\n\n\t_checkPresentationDisabled: function() {\n\t\treturn this._map['wopi'].DisablePresentation;\n\t},\n\n\t_notifyPresentationDisabled: function() {\n\t\tthis._map.uiManager.showInfoModal('presentation-disabled-modal',\n\t\t\t_('Presentation disabled'),\n\t\t\t_('Presentation mode has been disabled for this document'), '',\n\t\t\t_('OK'), null, false);\n\t},\n\n\t_onSlideWindowKeyPress: function(e) {\n\t\tif (e.code === 'Escape') {\n\t\t\tthis._slideShowWindowProxy.opener.focus();\n\t\t\tthis._slideShowWindowProxy.close();\n\t\t\tthis._map.uiManager.closeSnackbar();\n\t\t}\n\t},\n\n\t_processSlideshowVideoForSafari: function() {\n\t\t// There is an issue where Safari without LBSE renders the video in the wrong place, so we\n\t\t// must move it back into frame\n\t\t// GH#7399 fixed the same issue, but not in presentation mode\n\t\tif (!L.Browser.safari) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._slideShow) {\n\t\t\tconsole.error('In Safari without fixing slideshow videos, this may cause videos to be offset');\n\t\t\treturn;\n\t\t}\n\n\t\tthis._slideShow.addEventListener('load', (function onLoadSlideshow() {\n\t\t\tvar videos = this._slideShow.contentDocument.querySelectorAll('video');\n\n\t\t\tvar fixSVGPos = function(video) {\n\t\t\t\tvar videoContainer = video.parentNode;\n\t\t\t\tvar foreignObject = videoContainer.parentNode;\n\t\t\t\tvar svg = foreignObject.closest('svg');\n\n\t\t\t\treturn function() {\n\t\t\t\t\tvar widthRatio = svg.width.baseVal.value / svg.viewBox.baseVal.width;\n\t\t\t\t\tvar heightRatio = svg.height.baseVal.value / svg.viewBox.baseVal.height;\n\t\t\t\t\tvar minRatio = Math.min(widthRatio, heightRatio);\n\n\t\t\t\t\tvar leftRightBorders = svg.width.baseVal.value - minRatio * svg.viewBox.baseVal.width;\n\t\t\t\t\tvar topBottomBorders = svg.height.baseVal.value - minRatio * svg.viewBox.baseVal.height;\n\n\t\t\t\t\t// revert the scaling positioning to center (back to top-left) by subtracting at 1/2 of width\n\t\t\t\t\tvar offsetX = -foreignObject.width.baseVal.value / 2.0;\n\t\t\t\t\tvar offsetY = -foreignObject.height.baseVal.value / 2.0;\n\n\t\t\t\t\t// revert the object position\n\t\t\t\t\toffsetX = offsetX - foreignObject.x.baseVal.value + (leftRightBorders / 4.0);\n\t\t\t\t\toffsetY = offsetY - foreignObject.y.baseVal.value + (topBottomBorders / 4.0);\n\n\t\t\t\t\t// reapply the scaling positioning to center by adding 1/2 of the non-scaled width\n\t\t\t\t\toffsetX = offsetX + (foreignObject.width.baseVal.value * widthRatio / 2.0);\n\t\t\t\t\toffsetY = offsetY + (foreignObject.height.baseVal.value * heightRatio / 2.0);\n\n\t\t\t\t\t// reapply the object positioning\n\t\t\t\t\toffsetX = offsetX + foreignObject.x.baseVal.value * widthRatio;\n\t\t\t\t\toffsetY = offsetY + foreignObject.y.baseVal.value * heightRatio;\n\n\t\t\t\t\tvar scaleString = 'scale(' + minRatio + ')';\n\t\t\t\t\tvar translateString = 'translate(' + offsetX + 'px, ' + offsetY + 'px)';\n\n\t\t\t\t\tvideoContainer.style.transform = translateString + ' ' + scaleString;\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tfor (var i = 0; i < videos.length; i++) {\n\t\t\t\tvar fixThisVideoPos = fixSVGPos(videos[i]);\n\n\t\t\t\tfixThisVideoPos();\n\t\t\t\tvar observer = new MutationObserver(fixThisVideoPos);\n\n\t\t\t\tobserver.observe(this._slideShow, {\n\t\t\t\t\tattributes: true\n\t\t\t\t});\n\n\t\t\t\tthis._slideShow.contentDocument.defaultView.addEventListener('resize', fixThisVideoPos);\n\t\t\t}\n\t\t}).bind(this));\n\t}\n});\n\nL.Map.addInitHook('addHandler', 'slideShow', L.Map.SlideShow);\n"]}