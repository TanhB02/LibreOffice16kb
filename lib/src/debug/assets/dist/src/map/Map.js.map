{"version":3,"file":"Map.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/map/Map.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8; fill-column: 100 -*- */\n/*\n * L.Map is the central class of the API - it is used to create a map.\n */\n\n/* global app _ Cursor JSDialog TileManager */\n\nL.Map = L.Evented.extend({\n\n\tstatics: {\n\t\tTHIS : undefined\n\t},\n\n\toptions: {\n\t\tcrs: L.CRS,\n\t\tcenter: [0, 0],\n\t\tdocParams: {},\n\t\t// Default zoom level in which the document will be loaded.\n\t\tzoom: 10,\n\t\t// These zoom values are on a logarithmic scale. Each step away from the default 10\n\t\t// (meaning 1 = 100%) is a multiplication by or division with pow(2,1/4). pow(2,1/4)\n\t\t// is approximately 1.2. Thus 4 corresponds to six steps of division by pow(2,1/4) =\n\t\t// 35%. 18 corresponds to 8 steps of multiplication by pow(2,1/4) = 400%. The\n\t\t// percentages available are then rounded to the nearest five percent.\n\t\tminZoom: 1,\n\t\tmaxZoom: 18,\n\t\tmaxBounds: L.latLngBounds([0, 0], [-100, 100]),\n\t\tfadeAnimation: false, // Not useful for typing.\n\t\tmarkerZoomAnimation: true,\n\t\t// defaultZoom:\n\t\t// The zoom level at which the tile size in twips equals the default size (3840 x 3840).\n\t\t// Unless you know what you are doing, this should not be modified.\n\t\tdefaultZoom: 10,\n\t\t// 15 = 1440 twips-per-inch / 96 dpi.\n\t\t// Chosen to match previous hardcoded value of 3840 for\n\t\t// the current tile pixel size of 256.\n\t\t// Default tile width in twips (how much of the document is covered horizontally in a\n\t\t// 256x256 pixels tile). Unless you know what you are doing, this should not be modified;\n\t\t// this means twips value for 256 pixels at 96dpi.\n\t\ttileWidthTwips: window.tileSize * 15,\n\t\t// tileHeightTwips :\n\t\t// Default tile height in twips (how much of the document is covered vertically in a\n\t\t// 256x256 pixels tile).Unless you know what you are doing, this should not be modified;\n\t\t// this means twips value for 256 pixels at 96dpi.\n\t\ttileHeightTwips: window.tileSize * 15,\n\t\turlPrefix: 'cool',\n\t\twopiSrc: '',\n\t\tcursorURL: app.LOUtil.getURL('cursors'),\n\t\t// cursorURL\n\t\t// The path (local to the server) where custom cursor files are stored.\n\t},\n\n\t// Control.UIManager instance, set in main.js\n\tuiManager: null,\n\n\t// Control.LokDialog instance, is set in Control.UIManager.ts\n\tdialog: null,\n\n\t// Control.JSDialog instance, is set in Control.UIManager.ts\n\tjsdialog: null,\n\n\tcontext: {context: ''},\n\n\tinitialize: function (id, options) { // (HTMLElement or String, Object)\n\t\tL.Evented.prototype.initialize.call(this);\n\t\toptions = L.setOptions(this, options);\n\n\t\tif (this.options.documentContainer) {\n\t\t\t// have it as DOM object\n\t\t\tthis.options.documentContainer = L.DomUtil.get(this.options.documentContainer);\n\t\t}\n\n\t\tthis._clip = L.clipboard(this);\n\t\tthis._initContainer(id);\n\t\tthis._initLayout();\n\n\t\t// Start with readonly toolbars on desktop\n\t\tif (window.mode.isDesktop()) {\n\t\t\tL.DomUtil.addClass(L.DomUtil.get('toolbar-wrapper'), 'readonly');\n\t\t}\n\n\t\tthis._initEvents();\n\t\tthis._cacheSVG = [];\n\n\t\tif (options.maxBounds) {\n\t\t\tthis.setMaxBounds(options.maxBounds);\n\t\t}\n\n\t\tif (options.zoom !== undefined) {\n\t\t\tthis._zoom = this._limitZoom(options.zoom);\n\t\t}\n\n\t\tif (options.center && options.zoom !== undefined) {\n\t\t\tthis.setView(L.latLng(options.center), options.zoom, true /* reset */);\n\t\t}\n\n\t\tCursor.imagePath = options.cursorURL;\n\n\t\t/* private members */\n\t\tthis._handlers = [];\n\t\tthis._layers = {};\n\t\tthis._zoomBoundLayers = {};\n\t\tthis._sizeChanged = true;\n\t\tthis._bDisableKeyboard = false;\n\t\tthis._fatal = false;\n\t\tthis._enabled = true;\n\t\tthis._debugAlwaysActive = false; // disables the dimming / document inactivity when true\n\t\tthis._disableDefaultAction = {}; // The events for which the default handler is disabled and only issues postMessage.\n\t\tthis.showSidebar = false;\n\t\tthis._previewQueue = [];\n\t\tthis._previewRequestsOnFly = 0;\n\t\tthis._timeToEmptyQueue = new Date();\n\t\tthis._partsDirection = 1; // For pre-fetching the slides in the direction of travel.\n\t\tthis._lockAccessibilityOn = false;\n\t\t// Focusing:\n\t\t//\n\t\t// Cursor is visible or hidden (e.g. for graphic selection).\n\t\tapp.setCursorVisibility(true);\n\t\t// The ID of the window with focus. 0 for the document.\n\t\tthis._winId = 0;\n\t\t// The object of the dialog, if any (must have .focus callable).\n\t\tthis._activeDialog = null;\n\t\t// True only when searching within the doc, as we need to use winId==0.\n\t\tthis._isSearching = false;\n\n\t\tthis.callInitHooks();\n\n\t\tthis.addHandler('keyboard', L.Map.Keyboard);\n\t\tthis.addHandler('dragging', L.Map.Drag);\n\t\tthis.dragging.disable(); // FIXME: before unification, this was only called when on a touch device or in a mobile cypress test\n\t\t// It would be better to split dragging.disable into a touch version and a mouse version but this looks like it will require a major rework of its own...\n\t\tthis.addHandler('mouse', L.Map.Mouse);\n\t\tthis.addHandler('scrollHandler', L.Map.Scroll);\n\t\tthis.addHandler('doubleClickZoom', L.Map.DoubleClickZoom);\n\t\tthis.addHandler('touchGesture', L.Map.TouchGesture);\n\t\tthis.dragging._draggable._manualDrag = window.touch.isTouchEvent;\n\n\t\tif (this.options.imagePath) {\n\t\t\tL.Icon.Default.imagePath = this.options.imagePath;\n\t\t}\n\t\tthis._addLayers(this.options.layers);\n\t\tapp.socket = new app.definitions.Socket(this);\n\n\t\tthis._progressBar = L.progressOverlay(new L.point(150, 25));\n\n\t\tthis._debug = new app.DebugManager(this);\n\t\tthis.on('docloaded', function() {\n\t\t\tif (this.options.debug && !this._debug.debugOn) {\n\t\t\t\tthis._debug.toggle();\n\t\t\t}\n\t\t});\n\n\t\tthis.on('modificationindicatorinitialized', function() {\n\t\t\tthis._modIndicatorInitialized = true;\n\t\t});\n\n\t\t// When all these conditions are met, fire statusindicator:initializationcomplete\n\t\tthis.initConditions = {\n\t\t\t'doclayerinit': false,\n\t\t\t'statusindicatorfinish': false,\n\t\t\t'StyleApply': false,\n\t\t\t'CharFontName': false,\n\t\t\t'updatepermission': false\n\t\t};\n\t\tthis.initComplete = false;\n\n\t\tapp.events.on('updatepermission', function(e) {\n\t\t\tif (!this.initComplete) {\n\t\t\t\tthis._fireInitComplete('updatepermission');\n\t\t\t}\n\n\t\t\tif (e.detail.perm === 'readonly') {\n\t\t\t\tL.DomUtil.addClass(this._container.parentElement, 'readonly');\n\t\t\t\tif (window.mode.isDesktop() || window.mode.isTablet()) {\n\t\t\t\t\tL.DomUtil.addClass(L.DomUtil.get('toolbar-wrapper'), 'readonly');\n\t\t\t\t}\n\t\t\t\tL.DomUtil.addClass(L.DomUtil.get('main-menu'), 'readonly');\n\t\t\t\tL.DomUtil.addClass(L.DomUtil.get('presentation-controls-wrapper'), 'readonly');\n\t\t\t} else {\n\t\t\t\tL.DomUtil.removeClass(this._container.parentElement, 'readonly');\n\t\t\t\tif (window.mode.isDesktop() || window.mode.isTablet()) {\n\t\t\t\t\tL.DomUtil.removeClass(L.DomUtil.get('toolbar-wrapper'), 'readonly');\n\t\t\t\t}\n\t\t\t\tL.DomUtil.removeClass(L.DomUtil.get('main-menu'), 'readonly');\n\t\t\t\tL.DomUtil.removeClass(L.DomUtil.get('presentation-controls-wrapper'), 'readonly');\n\t\t\t}\n\t\t}.bind(this));\n\n\t\tthis.on('doclayerinit', function() {\n\t\t\tif (!this.initComplete) {\n\t\t\t\tthis._fireInitComplete('doclayerinit');\n\t\t\t}\n\n\t\t\tif (window.mode.isMobile())\n\t\t\t{\n\t\t\t\tdocument.getElementById('document-container').classList.add('mobile');\n\t\t\t\tthis._size = new L.Point(0,0);\n\t\t\t\tthis.showCalcInputBar();\n\t\t\t}\n\t\t});\n\t\tthis.on('updatetoolbarcommandvalues', function(e) {\n\t\t\tif (this.initComplete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (e.commandName === '.uno:StyleApply') {\n\t\t\t\tthis._fireInitComplete('StyleApply');\n\t\t\t}\n\t\t\telse if (e.commandName === '.uno:CharFontName') {\n\t\t\t\tthis._fireInitComplete('CharFontName');\n\t\t\t}\n\t\t});\n\t\tif (window.ThisIsTheAndroidApp) {\n\t\t\tthis.on('readonlymode', function() {\n\t\t\t\tthis.setPermission('edit');\n\t\t\t});\n\t\t}\n\n\t\tthis.showBusy(_('Initializing...'), false);\n\t\tthis.on('statusindicator', this._onUpdateProgress, this);\n\n\t\tthis.on('editorgotfocus', this._onEditorGotFocus, this);\n\n\t\t// Fired to signal that the input focus is being changed.\n\t\tthis.on('changefocuswidget', this._onChangeFocusWidget, this);\n\n\t\tthis.on('searchstart', this._onSearchStart, this);\n\n\t\t// View info (user names and view ids)\n\t\tthis._viewInfo = {};\n\t\tthis._viewInfoByUserName = {};\n\n\t\t// View color map\n\t\tthis._viewColors = {};\n\n\t\t// This becomes true if document was ever modified by the user\n\t\tthis._everModified = false;\n\n\t\t// This is the new file name, if the document is renamed, which is used on uno:Save's result.\n\t\tthis._renameFilename = '';\n\n\t\t// Document is completely loaded or not\n\t\tthis._docLoaded = false;\n\n\t\t// Unlike _docLoaded, this is flagged only once,\n\t\t// after we receive status for the first time.\n\t\tthis._docLoadedOnce = false;\n\n\t\t//Last modified time of document saved state\n\t\tthis._lastModDateValue = '';\n\n\t\tthis.on('commandstatechanged', function(e) {\n\t\t\tif (e.commandName === '.uno:ModifiedStatus') {\n\t\t\t\tthis._everModified = this._everModified || (e.state === 'true');\n\n\t\t\t\t// Fire an event to let the client know whether the document needs saving or not.\n\t\t\t\tthis.fire('postMessage', {msgId: 'Doc_ModifiedStatus', args: { Modified: e.state === 'true' }});\n\n\t\t\t\tif (this._everModified) {\n\t\t\t\t\tthis.fire('updatemodificationindicator', { status: e.state === 'true' ? 'MODIFIED' : 'SAVED' });\n\t\t\t\t}\n\t\t\t}\n\t\t}, this);\n\n\t\tthis.on('commandvalues', function(e) {\n\t\t\tif (e.commandName === '.uno:LanguageStatus' && app.util.isArray(e.commandValues)) {\n\t\t\t\tapp.languages = [];\n\t\t\t\te.commandValues.forEach(function(language) {\n\t\t\t\t\tvar split = language.split(';');\n\t\t\t\t\tlanguage = split[0];\n\t\t\t\t\tvar code = '';\n\t\t\t\t\tif (split.length > 1)\n\t\t\t\t\t\tcode = split[1];\n\t\t\t\t\tapp.languages.push({translated: _(language), neutral: language, iso: code});\n\t\t\t\t});\n\t\t\t\tapp.languages.sort(function(a, b) {\n\t\t\t\t\treturn a.translated < b.translated ? -1 : a.translated > b.translated ? 1 : 0;\n\t\t\t\t});\n\t\t\t\tthis.fire('languagesupdated');\n\t\t\t}\n\t\t});\n\n\t\tthis.on('docloaded', function(e) {\n\t\t\tthis._docLoaded = e.status;\n\t\t\tif (this._docLoaded) {\n\t\t\t\tapp.idleHandler.notifyActive();\n\t\t\t\tapp.dispatcher = new app.definitions['dispatcher']();\n\t\t\t\tif (!document.hasFocus()) {\n\t\t\t\t\tthis.fire('editorgotfocus');\n\t\t\t\t\tthis.focus();\n\t\t\t\t}\n\t\t\t\tapp.idleHandler._activate();\n\t\t\t\tif (window.ThisIsTheAndroidApp) {\n\t\t\t\t\twindow.postMobileMessage('hideProgressbar');\n\t\t\t\t}\n\t\t\t} else if (this._docLayer && app.sectionContainer) {\n\t\t\t\t// remove the comments and changes\n\t\t\t\tvar commentSection = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\t\tif (commentSection)\n\t\t\t\t\tcommentSection.clearList();\n\t\t\t}\n\n\t\t\tif (!window.mode.isMobile())\n\t\t\t\tthis.initializeModificationIndicator();\n\n\t\t\t// Show sidebar.\n\t\t\tif (this._docLayer && !this._docLoadedOnce) {\n\t\t\t\t// Let the first page finish loading then load the sidebar.\n\t\t\t\tsetTimeout(this.uiManager.initializeSidebar.bind(this.uiManager), 200);\n\t\t\t}\n\n\t\t\t// We have loaded.\n\t\t\tif (!this._docLoadedOnce) {\n\t\t\t\tthis._docLoadedOnce = this._docLoaded;\n\t\t\t}\n\t\t}, this);\n\n\t\tthis.fire('postMessage', {\n\t\t\tmsgId: 'App_LoadingStatus',\n\t\t\targs: {\n\t\t\t\tStatus: 'Initialized',\n\t\t\t}\n\t\t});\n\t},\n\n\t// A11y\n\n\tinitTextInput: function(docType) {\n\t\tvar hasAccessibilitySupport =\n\t\t\twindow.enableAccessibility && window.prefs.getBoolean('accessibilityState');\n\t\thasAccessibilitySupport = hasAccessibilitySupport &&\n\t\t\t(docType === 'text' || docType === 'presentation'|| docType === 'spreadsheet');\n\n\t\tthis.setupCoreAccessibility(hasAccessibilitySupport);\n\t\tthis.createTextInput(hasAccessibilitySupport);\n\t},\n\n\tcreateTextInput: function(enableA11y) {\n\t\tthis._textInput = enableA11y ? L.a11yTextInput() : L.textInput();\n\t\tthis.addLayer(this._textInput);\n\t},\n\n\tsetupCoreAccessibility: function(enableA11y) {\n\t\tapp.socket.sendMessage('a11ystate ' + enableA11y);\n\t},\n\n\tsetAccessibilityState: function(enable) {\n\t\tif (window.prefs.getBoolean('accessibilityState') === enable)\n\t\t\treturn;\n\n\t\twindow.prefs.set('accessibilityState', enable);\n\t\tthis.setupCoreAccessibility(enable);\n\t\tthis.removeLayer(this._textInput);\n\t\tthis.createTextInput(enable);\n\t\tthis.fire('a11ystatechanged');\n\n\t\tif (enable)\n\t\t\tthis._textInput._requestFocusedParagraph();\n\t\tthis._textInput.showCursor();\n\t},\n\n\tlockAccessibilityOn: function() {\n\t\tthis.setAccessibilityState(true);\n\t\tthis._lockAccessibilityOn = true;\n\t\tthis.fire('a11ystatechanged');\n\t},\n\n\t// end of A11y\n\n\tloadDocument: function(socket) {\n\t\tapp.socket.connect(socket);\n\t\tif (this._clip)\n\t\t\tthis._clip.clearSelection();\n\t},\n\n\tsendInitUNOCommands: function() {\n\t\t// TODO: remove duplicated init code\n\t\tapp.socket.sendMessage('commandvalues command=.uno:LanguageStatus');\n\t\tif (this._docLayer._docType === 'spreadsheet') {\n\t\t\tif (this._docLayer.options.sheetGeometryDataEnabled)\n\t\t\t\tthis._docLayer.requestSheetGeometryData();\n\t\t\tthis._docLayer.refreshViewData();\n\t\t\tTileManager.update();\n\t\t}\n\t\t// For calc parsing this will need SheetGeometry, so send after\n\t\t// requesting that\n\t\tapp.socket.sendMessage('commandvalues command=.uno:ViewAnnotations');\n\t\tthis._docLayer._getToolbarCommandsValues();\n\t},\n\n\t// public methods that modify map state\n\n\tgetViewId: function (username) {\n\t\tfor (var idx in this._viewInfo) {\n\t\t\tif (this._viewInfo[idx].username === username) {\n\t\t\t\treturn this._viewInfo[idx].id;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\taddView: function(viewInfo) {\n\t\tthis._viewInfo[viewInfo.id] = viewInfo;\n\t\tif (viewInfo.userextrainfo !== undefined && viewInfo.userextrainfo.avatar !== undefined) {\n\t\t\tthis._viewInfoByUserName[viewInfo.username] = viewInfo;\n\t\t}\n\t\tthis.fire('postMessage', {msgId: 'View_Added', args: {Deprecated: true, ViewId: viewInfo.id, UserId: viewInfo.userid, UserName: viewInfo.username, UserExtraInfo: viewInfo.userextrainfo, Color: app.LOUtil.rgbToHex(viewInfo.color), ReadOnly: viewInfo.readonly}});\n\n\t\t// Fire last, otherwise not all events are handled correctly.\n\t\tthis.fire('addview', {viewId: viewInfo.id, username: viewInfo.username, extraInfo: viewInfo.userextrainfo, readonly: this.isViewReadOnly(viewInfo.id)});\n\n\t\tthis.updateAvatars();\n\t},\n\n\tremoveView: function(viewid) {\n\t\tvar username = this._viewInfo[viewid].username;\n\t\tdelete this._viewInfoByUserName[this._viewInfo[viewid].username];\n\t\tdelete this._viewInfo[viewid];\n\t\tthis.fire('postMessage', {msgId: 'View_Removed', args: {Deprecated: true, ViewId: viewid}});\n\n\t\t// Fire last, otherwise not all events are handled correctly.\n\t\tthis.fire('removeview', {viewId: viewid, username: username});\n\t},\n\n\tpanBy: function (offset) {\n\t\toffset = L.point(offset).round();\n\n\t\tif (!offset.x && !offset.y)\n\t\t\treturn this;\n\n\t\t//If we pan too far then chrome gets issues with tiles\n\t\t// and makes them disappear or appear in the wrong place (slightly offset) #2602\n\t\tif (!this.getSize().contains(offset)) {\n\t\t\tthis._resetView(this.unproject(this.project(this.getCenter()).add(offset)), this.getZoom());\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.fire('movestart');\n\t\tL.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));\n\t\tthis.fire('move').fire('moveend');\n\n\t\treturn this;\n\t},\n\n\tsetView: function (center, zoom, reset) {\n\t\tzoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);\n\t\tcenter = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);\n\n\t\tif (this._loaded && !reset && zoom === this._zoom) {\n\t\t\t// difference between the new and current centers in pixels\n\t\t\tvar offset = this._getCenterOffset(center)._floor();\n\t\t\tthis.panBy(offset);\n\t\t\treturn this;\n\t\t}\n\t\telse {\n\t\t\tthis._resetView(center, zoom);\n\n\t\t\treturn this;\n\t\t}\n\t},\n\n\tupdateAvatars: function() {\n\t\tif (this._docLayer && this._docLayer._annotations && this._docLayer._annotations._items) {\n\t\t\tfor (var idxAnno in this._docLayer._annotations._items) {\n\t\t\t\tvar annotation = this._docLayer._annotations._items[idxAnno];\n\t\t\t\tvar username = annotation._data.author;\n\t\t\t\tif (this._viewInfoByUserName[username])\n\t\t\t\t\tannotation._data.avatar = this._viewInfoByUserName[username].userextrainfo.avatar;\n\t\t\t\tannotation._updateContent();\n\t\t\t}\n\t\t}\n\t},\n\n\tinitializeModificationIndicator: function() {\n\t\tthis.fire('initmodificationindicator', this._lastmodtime);\n\t\tthis.updateModificationIndicator(this._lastmodtime);\n\t},\n\n\tupdateModificationIndicator: function(newModificationTime) {\n\t\tvar timeout;\n\n\t\tif (typeof newModificationTime === 'string') {\n\t\t\tthis._lastmodtime = newModificationTime;\n\t\t}\n\n\t\tclearTimeout(this._modTimeout);\n\n\t\tif (this._modIndicatorInitialized && this._lastmodtime) {\n\t\t\tvar dateTime = new Date(this._lastmodtime.replace(/,.*/, 'Z'));\n\t\t\tvar dateValue;\n\n\t\t\tvar elapsed = Date.now() - dateTime;\n\t\t\tvar rtf1 = new Intl.RelativeTimeFormat(String.locale, { style: 'narrow' });\n\t\t\tif (('minSavedMessageTimeoutSecs' in window) && (elapsed < (window.minSavedMessageTimeoutSecs * 1000))) {\n\t\t\t\ttimeout = window.minSavedMessageTimeoutSecs * 1000;\n\t\t\t\tdateValue = '';\n\t\t\t} else if (elapsed < 60000) {\n\t\t\t\tdateValue = _('Last saved:') + ' ' + rtf1.format(-Math.round(elapsed / 1000), 'second');\n\t\t\t\ttimeout = 6000;\n\t\t\t} else if (elapsed < 3600000) {\n\t\t\t\tdateValue = _('Last saved:') + ' ' + rtf1.format(-Math.round(elapsed / 60000), 'minute');\n\t\t\t\ttimeout = 60000;\n\t\t\t} else if (elapsed < 3600000 * 24) {\n\t\t\t\tdateValue = _('Last saved:') + ' ' + rtf1.format(-Math.round(elapsed / 3600000), 'hour');\n\t\t\t\ttimeout = 60000;\n\t\t\t} else {\n\t\t\t\tdateValue = _('Last saved:') + ' ' + dateTime.toLocaleDateString(String.locale,\n\t\t\t\t\t{ year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });\n\t\t\t\ttimeout = 60000;\n\t\t\t}\n\n\t\t\tthis.fire('updatemodificationindicator', {lastSaved: dateValue});\n\n\t\t\tif (timeout) {\n\t\t\t\tthis._modTimeout = setTimeout(L.bind(this.updateModificationIndicator, this, -1), timeout);\n\t\t\t}\n\t\t}\n\t\tif (this.lastModIndicator !== null && this.lastModIndicator !== undefined)\n\t\t\tthis.lastModIndicator.innerHTML = dateValue;\n\t\tthis.setLastModDateValue(dateValue);\n\t\tthis._modTimeout = setTimeout(L.bind(this.updateModificationIndicator, this, -1), timeout);\n\t},\n\n\tsetLastModDateValue: function(dateValue) {\n\t\tthis._lastModDateValue = dateValue;\n\t},\n\n\tgetLastModDateValue: function() {\n\t\treturn this._lastModDateValue;\n\t},\n\n\tshowBusy: function(label, bar) {\n\t\tif (window.ThisIsTheAndroidApp)\n\t\t\treturn;\n\n\t\t// If document is already loaded, ask the toolbar widget to show busy\n\t\t// status on the bottom statusbar\n\t\tif (this._docLayer) {\n\t\t\tthis.fire('showbusy', {label: label});\n\t\t\treturn;\n\t\t}\n\t\tthis._progressBar.delayedStart(this, label, bar);\n\t},\n\n\thideBusy: function () {\n\t\tif (window.ThisIsTheAndroidApp)\n\t\t\treturn;\n\n\t\tthis.fire('hidebusy');\n\t\tthis._progressBar.end(this);\n\t},\n\n\tzoomToFactor: function (zoom) {\n\t\treturn Math.pow(1.2, (zoom - this.options.zoom));\n\t},\n\n\tgetDesktopCalcZoomCenter: function() {\n\t\tconst docLayer = this._docLayer;\n\n\t\tif (app.calc.cellCursorRectangle) {\n\t\t\tconst twipsTopLeft = [app.calc.cellCursorRectangle.x1, app.calc.cellCursorRectangle.y1];\n\t\t\tconst cursorInBounds = app.file.viewedRectangle.containsPoint(twipsTopLeft);\n\n\t\t\tif (cursorInBounds) {\n\t\t\t\treturn new L.Point(...twipsTopLeft);\n\t\t\t}\n\t\t}\n\n\t\tif (docLayer._cellSelectionArea) {\n\t\t\tconst twipsCenter = docLayer._cellSelectionArea.center;\n\t\t\tconst selectionInBounds = app.file.viewedRectangle.containsPoint(twipsCenter);\n\n\t\t\tif (selectionInBounds) {\n\t\t\t\treturn new L.Point(...twipsCenter);\n\t\t\t}\n\t\t}\n\n\t\tconst viewBounds = this.getPixelBoundsCore();\n\t\treturn docLayer._corePixelsToTwips(viewBounds.getCenter());\n\t},\n\n\tsetDesktopCalcViewOnZoom: function (zoom, animate) {\n\t\tzoom = this._limitZoom(zoom);\n\n\t\tif (zoom === this.getZoom()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst docLayer = this._docLayer;\n\t\tif (!docLayer.options.sheetGeometryDataEnabled || !docLayer.sheetGeometry)\n\t\t\treturn false;\n\n\t\tconst typing = app.file.textCursor.visible;\n\n\t\tconst tsManager = docLayer._painter;\n\n\t\tconst ctx = tsManager._paintContext();\n\t\tconst splitPos = ctx.splitPos;\n\t\tconst viewBounds = ctx.viewBounds;\n\t\tconst freePaneBounds = new L.Bounds(viewBounds.min.add(splitPos), viewBounds.max);\n\n\t\tconst zoomCenter = docLayer._twipsToCorePixels(this.getDesktopCalcZoomCenter());\n\n\t\ttsManager._offset = new L.Point(0, 0);\n\t\tconst docPos = docLayer._painter._getZoomDocPos(\n\t\t\tzoomCenter,\n\t\t\tzoomCenter,\n\t\t\tfreePaneBounds,\n\t\t\t{ freezeX: false, freezeY: false },\n\t\t\tsplitPos,\n\t\t\tthis.getZoomScale(zoom),\n\t\t\ttrue\n\t\t);\n\n\t\tconst newCenterLatLng = this.unproject(docPos.center.divideBy(app.dpiScale), zoom);\n\n\t\tthis._ignoreCursorUpdate = true;\n\n\t\tconst mapUpdater = (animationCalculatedNewCenter) => {\n\t\t\tif (animationCalculatedNewCenter) {\n\t\t\t\tthis._resetView(L.latLng(animationCalculatedNewCenter), zoom);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._resetView(L.latLng(newCenterLatLng), zoom);\n\t\t};\n\t\tconst runAtFinish = () => {\n\t\t\tthis._ignoreCursorUpdate = false;\n\t\t\tif (typing) {\n\t\t\t\tdocLayer.activateCursor();\n\t\t\t}\n\t\t};\n\n\t\tif (animate) {\n\t\t\tthis._docLayer.runZoomAnimation(\n\t\t\t\tzoom,\n\t\t\t\tthis.unproject(zoomCenter.divideBy(app.dpiScale), this.getZoom()),\n\t\t\t\tmapUpdater,\n\t\t\t\trunAtFinish);\n\t\t\treturn;\n\t\t}\n\n\t\tmapUpdater(newCenterLatLng);\n\t\trunAtFinish();\n\t},\n\n\tignoreCursorUpdate: function () {\n\t\treturn this._ignoreCursorUpdate;\n\t},\n\n\tenableTextInput: function () {\n\t\tthis._setTextInputState(true /* enable? */);\n\t},\n\n\tdisableTextInput: function () {\n\t\tthis._setTextInputState(false /* enable? */);\n\t},\n\n\t_setTextInputState: function (enable) {\n\t\tvar docLayer = this._docLayer;\n\t\tif (!docLayer)\n\t\t\treturn;\n\t\tthis._ignoreCursorUpdate = !enable;\n\n\t\tif (!app.file.textCursor.visible)\n\t\t\treturn;\n\n\t\tif (!enable) {\n\t\t\tthis._textInput.disable();\n\t\t} else {\n\t\t\tthis._textInput.enable();\n\t\t\tdocLayer._updateCursorPos();\n\t\t}\n\t},\n\n\tsetZoom: function (zoom, options, animate) {\n\n\t\t// do not animate zoom when in a cypress test.\n\t\tif (animate && L.Browser.cypressTest)\n\t\t\tanimate = false;\n\n\t\tif (this._docLayer instanceof L.CanvasTileLayer) {\n\t\t\tif (!zoom)\n\t\t\t\tzoom = this._clientZoom || this.options.zoom;\n\t\t\telse\n\t\t\t\tthis._clientZoom = zoom;\n\t\t}\n\n\t\tif (!this._loaded) {\n\t\t\tthis._zoom = this._limitZoom(zoom);\n\t\t\treturn this;\n\t\t}\n\n\t\tvar curCenter = this.getCenter();\n\t\tif (this._docLayer && this._docLayer._docType === 'spreadsheet') {\n\t\t\t// for spreadsheets, when the document is smaller than the viewing area\n\t\t\t// we want it to be glued to the row/column headers instead of being centered\n\t\t\tthis._docLayer._checkSpreadSheetBounds(zoom);\n\t\t\tif (window.mode.isDesktop()) {\n\t\t\t\treturn this.setDesktopCalcViewOnZoom(zoom, animate);\n\t\t\t}\n\t\t}\n\n\t\tthis._docLayer.setZoomChanged(true);\n\t\tvar thisObj = this;\n\t\tvar cssBounds = this.getPixelBounds();\n\t\tvar mapUpdater;\n\t\tvar runAtFinish;\n\t\tif (this._docLayer && app.file.textCursor.visible && app.file.viewedRectangle.containsPoint(app.file.textCursor.rectangle.center)) {\n\t\t\t// Calculate new center after zoom. The intent is that the caret\n\t\t\t// position stays the same.\n\t\t\tvar zoomScale = 1.0 / this.getZoomScale(zoom, this._zoom);\n\t\t\tvar caretPos = this._docLayer._twipsToLatLng({ x: app.file.textCursor.rectangle.center[0], y: app.file.textCursor.rectangle.center[1] });\n\t\t\tvar newCenter = new L.LatLng(curCenter.lat + (caretPos.lat - curCenter.lat) * (1.0 - zoomScale),\n\t\t\t\t\t\t     curCenter.lng + (caretPos.lng - curCenter.lng) * (1.0 - zoomScale));\n\n\t\t\tmapUpdater = function() {\n\t\t\t\tthisObj.setView(newCenter, zoom);\n\t\t\t};\n\t\t\trunAtFinish = function() {\n\t\t\t\tthisObj._docLayer.setZoomChanged(false);\n\t\t\t};\n\n\t\t\tif (animate) {\n\t\t\t\tthis._docLayer.runZoomAnimation(zoom,\n\t\t\t\t\t// pinchCenter\n\t\t\t\t\tnew L.LatLng(\n\t\t\t\t\t\t// Use the current y-center if there is a top margin.\n\t\t\t\t\t\tcssBounds.min.y < 0 ? curCenter.lat : caretPos.lat,\n\t\t\t\t\t\t// Use the current x-center if there is a left margin.\n\t\t\t\t\t\tcssBounds.min.x < 0 ? curCenter.lng : caretPos.lng),\n\t\t\t\t\tmapUpdater,\n\t\t\t\t\trunAtFinish);\n\t\t\t} else {\n\t\t\t\tmapUpdater();\n\t\t\t\trunAtFinish();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tmapUpdater = function() {\n\t\t\tthisObj.setView(curCenter, zoom);\n\t\t};\n\n\t\trunAtFinish = function() {\n\t\t\tthisObj._docLayer.setZoomChanged(false);\n\t\t};\n\n\t\tif (animate) {\n\t\t\tthis._docLayer.runZoomAnimation(zoom,\n\t\t\t\t// pinchCenter\n\t\t\t\tcurCenter,\n\t\t\t\tmapUpdater,\n\t\t\t\trunAtFinish);\n\t\t} else {\n\t\t\tmapUpdater();\n\t\t\trunAtFinish();\n\t\t}\n\t},\n\n\tzoomIn: function (delta, options, animate) {\n\t\treturn this.setZoom(this._zoom + (delta || 1), options, animate);\n\t},\n\n\tzoomOut: function (delta, options, animate) {\n\t\treturn this.setZoom(this._zoom - (delta || 1), options, animate);\n\t},\n\n\tsetZoomAround: function (latlng, zoom) {\n\t\tvar scale = this.getZoomScale(zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPointIgnoreSplits(latlng),\n\n\t\t    centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),\n\t\t    newCenter = this.containerPointToLatLngIgnoreSplits(viewHalf.add(centerOffset));\n\n\t\treturn this.setView(newCenter, zoom);\n\t},\n\n\tpanTo: function (center) { // (LatLng)\n\t\treturn this.setView(center, this._zoom);\n\t},\n\n\tsetMaxBounds: function (bounds) {\n\t\tbounds = L.latLngBounds(bounds);\n\n\t\tthis.options.maxBounds = bounds;\n\n\t\tif (this._loaded) {\n\t\t\tthis.panInsideBounds(this.options.maxBounds);\n\t\t}\n\t},\n\n\tsetDocBounds: function (bounds) {\n\t\tbounds = L.latLngBounds(bounds);\n\t\tthis.options.docBounds = bounds;\n\t},\n\n\thasDocBounds: function () {\n\t\treturn this.options.docBounds;\n\t},\n\n\tgetCorePxDocBounds: function () {\n\t\tif (!this.options.docBounds)\n\t\t\treturn new L.Bounds(0, 0);\n\n\t\tvar topleft = this.project(this.options.docBounds.getNorthWest());\n\t\tvar bottomRight = this.project(this.options.docBounds.getSouthEast());\n\t\treturn new L.Bounds(this._docLayer._cssPixelsToCore(topleft),\n\t\t\tthis._docLayer._cssPixelsToCore(bottomRight));\n\t},\n\n\tpanInsideBounds: function (bounds) {\n\t\tvar center = this.getCenter(),\n\t\t    newCenter = this._limitCenter(center, this._zoom, bounds);\n\n\t\tif (center.equals(newCenter)) { return this; }\n\t\tif (this.distance(center, newCenter) < 0.0000001) { return this; }\n\n\t\treturn this.panTo(newCenter);\n\t},\n\n\t// If map size has already been updated, invalidateSize needs the oldSize to work properly\n\t// (e.g. if getSize() has already been called whith _sizeChanged === true)\n\tinvalidateSize: function (debounceMoveend, oldSize) {\n\t\tif (!this._loaded) { return this; }\n\n\t\tif (!oldSize)\n\t\t\toldSize = this.getSize();\n\n\t\tthis._sizeChanged = true;\n\n\t\tvar newSize = this.getSize(),\n\t\t    oldCenter = oldSize.divideBy(2).round(),\n\t\t    newCenter = newSize.divideBy(2).round(),\n\t\t    offset = oldCenter.subtract(newCenter);\n\n\t\tif (!offset.x && !offset.y) { return this; }\n\n\t\tthis.fire('move');\n\n\t\tif (debounceMoveend) {\n\t\t\tclearTimeout(this._sizeTimer);\n\t\t\tthis._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);\n\t\t} else {\n\t\t\tthis.fire('moveend');\n\t\t}\n\n\t\treturn this.fire('resize', {\n\t\t\toldSize: oldSize,\n\t\t\tnewSize: newSize\n\t\t});\n\t},\n\n\tstop: function () {\n\t\tapp.util.cancelAnimFrame(this._flyToFrame);\n\t\tif (this._panAnim) {\n\t\t\tthis._panAnim.stop();\n\t\t}\n\t\treturn this;\n\t},\n\n\t// TODO handler.addTo\n\taddHandler: function (name, HandlerClass) {\n\t\tif (!HandlerClass) { return this; }\n\n\t\tvar handler = this[name] = new HandlerClass(this);\n\n\t\tthis._handlers.push(handler);\n\n\t\tif (this.options[name]) {\n\t\t\thandler.enable();\n\t\t}\n\n\t\t// Check for the special proof-of-concept case where no WOPI is involved but we\n\t\t// still run COOL in an iframe of its own and thus need to receive the\n\t\t// postMessage things.\n\t\tif (name === 'wopi' && this.options['notWopiButIframe']) {\n\t\t\thandler.addHooks();\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\n\t\tthis._initEvents(true);\n\n\t\ttry {\n\t\t\t// throws error in IE6-8\n\t\t\tdelete this._container._leaflet;\n\t\t} catch (e) {\n\t\t\tthis._container._leaflet = undefined;\n\t\t}\n\n\t\tL.DomUtil.remove(this._mapPane);\n\n\t\tif (this._clearControlPos) {\n\t\t\tthis._clearControlPos();\n\t\t}\n\n\t\tthis._clearHandlers();\n\n\t\tif (this._loaded) {\n\t\t\tthis.fire('unload');\n\t\t}\n\n\t\tif (this._docLayer) {\n\t\t\tthis.removeLayer(this._docLayer);\n\t\t}\n\t\tapp.socket.close();\n\t\treturn this;\n\t},\n\n\tcreatePane: function (name, container) {\n\t\tvar className = 'leaflet-pane' + (name ? ' leaflet-' + name.replace('Pane', '') + '-pane' : ''),\n\t\t    pane = L.DomUtil.create('div', className, container || this._mapPane);\n\n\t\tif (name) {\n\t\t\tthis._panes[name] = pane;\n\t\t}\n\t\treturn pane;\n\t},\n\n\n\t// public methods for getting map state\n\n\thasInfoForView: function(viewid)  {\n\t\treturn (viewid in this._viewInfo);\n\t},\n\n\tgetViewName: function(viewid) {\n\t\tif (this._viewInfo[viewid] !== undefined)\n\t\t\treturn this._viewInfo[viewid].username;\n\t\telse return null;\n\t},\n\n\tgetViewColor: function(viewid) {\n\t\treturn this._viewInfo[viewid].color;\n\t},\n\n\tisViewReadOnly: function(viewid) {\n\t\treturn this._viewInfo[viewid].readonly !== '0';\n\t},\n\n\tgetCenter: function () { // (Boolean) -> LatLng\n\t\tthis._checkIfLoaded();\n\t\treturn this.layerPointToLatLng(this._getCenterLayerPoint());\n\t},\n\n\tgetZoom: function () {\n\t\treturn this._zoom;\n\t},\n\n\tgetBounds: function () {\n\t\tvar bounds = this.getPixelBounds(),\n\t\t    sw = this.unproject(bounds.getBottomLeft()),\n\t\t    ne = this.unproject(bounds.getTopRight());\n\n\t\treturn new L.LatLngBounds(sw, ne);\n\t},\n\n\tgetMinZoom: function () {\n\t\treturn this.options.minZoom === undefined ? this._layersMinZoom || 0 : this.options.minZoom;\n\t},\n\n\tgetMaxZoom: function () {\n\t\treturn this.options.maxZoom === undefined ?\n\t\t\t(this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :\n\t\t\tthis.options.maxZoom;\n\t},\n\n\tgetLayerMaxBounds: function () {\n\t\treturn L.bounds(this.latLngToLayerPoint(this.options.maxBounds.getNorthWest()),\n\t\t\tthis.latLngToLayerPoint(this.options.maxBounds.getSouthEast()));\n\t},\n\n\tgetLayerDocBounds: function () {\n\t\treturn L.bounds(this.latLngToLayerPoint(this.options.docBounds.getNorthWest()),\n\t\t\tthis.latLngToLayerPoint(this.options.docBounds.getSouthEast()));\n\t},\n\n\tgetSize: function () {\n\t\tif (!this._size || this._sizeChanged) {\n\t\t\tthis._size = new L.Point(\n\t\t\t\tthis._container.clientWidth,\n\t\t\t\tthis._container.clientHeight);\n\n\t\t\tthis._sizeChanged = false;\n\t\t}\n\n\t\treturn this._size.clone();\n\t},\n\n\tgetPixelBounds: function (center, zoom) {\n\t\tvar topLeftPoint = this._getTopLeftPoint(center, zoom);\n\t\treturn new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));\n\t},\n\n\tgetPixelBoundsCore: function (center, zoom) {\n\t\tvar bounds = this.getPixelBounds(center, zoom);\n\t\tbounds.min = bounds.min.multiplyBy(app.dpiScale);\n\t\tbounds.max = bounds.max.multiplyBy(app.dpiScale);\n\t\treturn bounds;\n\t},\n\n\tgetPixelOrigin: function () {\n\t\tthis._checkIfLoaded();\n\t\treturn this._pixelOrigin;\n\t},\n\n\tgetPane: function (pane) {\n\t\treturn typeof pane === 'string' ? this._panes[pane] : pane;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\t// We have one global winId that controls what window (dialog, sidebar, or\n\t// the main document) has the actual focus.  0 means the document.\n\tsetWinId: function (id) {\n\t\t// window.app.console.log('winId set to: ' + id);\n\t\tif (typeof id === 'string')\n\t\t\tid = parseInt(id);\n\t\tthis._winId = id;\n\t},\n\n\t// Getter for the winId, see setWinId() for more.\n\tgetWinId: function () {\n\t\tif (this.formulabar && this.formulabar.hasFocus())\n\t\t\treturn 0;\n\t\treturn this._winId;\n\t},\n\n\t// Returns true iff the document has input focus,\n\t// as opposed to a dialog, sidebar, formula bar, etc.\n\teditorHasFocus: function () {\n\t\treturn this.getWinId() === 0 && !this.calcInputBarHasFocus();\n\t},\n\n\t// Returns true iff the formula-bar has the focus.\n\tcalcInputBarHasFocus: function () {\n\t\treturn this.formulabar && this.formulabar.hasFocus();\n\t},\n\n\t// TODO replace with universal implementation after refactoring projections\n\n\tgetZoomScale: function (toZoom, fromZoom) {\n\t\tvar crs = this.options.crs;\n\t\tfromZoom = fromZoom === undefined ? this.getZoom() : fromZoom;\n\t\treturn crs.scale(toZoom) / crs.scale(fromZoom);\n\t},\n\n\tgetScaleZoom: function (scale, fromZoom) {\n\t\tfromZoom = fromZoom === undefined ? this.getZoom() : fromZoom;\n\t\treturn fromZoom + (Math.log(scale) / Math.log(1.2));\n\t},\n\n\n\t// conversion methods\n\n\tproject: function (latlng, zoom) { // (LatLng[, Number]) -> Point\n\t\tzoom = zoom === undefined ? this.getZoom() : zoom;\n\t\tvar projectedPoint = this.options.crs.latLngToPoint(L.latLng(latlng), zoom);\n\t\treturn new L.Point(app.util.round(projectedPoint.x, 1e-6), app.util.round(projectedPoint.y, 1e-6));\n\t},\n\n\tunproject: function (point, zoom) { // (Point[, Number]) -> LatLng\n\t\tzoom = zoom === undefined ? this.getZoom() : zoom;\n\t\treturn this.options.crs.pointToLatLng(L.point(point), zoom);\n\t},\n\n\t// rescaling\n\n\trescale: function(point, oldZoom, newZoom) {\n\t\toldZoom = oldZoom === undefined ? this.getZoom() : oldZoom;\n\t\tnewZoom = newZoom === undefined ? this.getZoom() : newZoom;\n\n\t\treturn this.options.crs.rescale(point, oldZoom, newZoom);\n\t},\n\n\tlayerPointToLatLng: function (point) { // (Point)\n\t\tvar projectedPoint = L.point(point).add(this.getPixelOrigin());\n\t\treturn this.unproject(projectedPoint);\n\t},\n\n\tlatLngToLayerPoint: function (latlng) { // (LatLng)\n\t\tvar projectedPoint = this.project(L.latLng(latlng))._round();\n\t\treturn projectedPoint._subtract(this.getPixelOrigin());\n\t},\n\n\tdistance: function (latlng1, latlng2) {\n\t\treturn this.options.crs.distance(L.latLng(latlng1), L.latLng(latlng2));\n\t},\n\n\tcontainerPointToLayerPoint: function (point) { // (Point)\n\t\tvar splitPanesContext = this.getSplitPanesContext();\n\t\tif (!splitPanesContext) {\n\t\t\treturn this.containerPointToLayerPointIgnoreSplits(point);\n\t\t}\n\t\tvar splitPos = splitPanesContext.getSplitPos();\n\t\tvar pixelOrigin = this.getPixelOrigin();\n\t\tvar mapPanePos = this._getMapPanePos();\n\t\tvar result = L.point(point).clone();\n\t\tvar pointX = point.x;\n\t\tif (this._docLayer.isCalcRTL()) {\n\t\t\tpointX = this._container.clientWidth - pointX;\n\t\t\tresult.x = pointX;\n\t\t}\n\n\t\tif (pointX <= splitPos.x) {\n\t\t\tresult.x -= pixelOrigin.x;\n\t\t}\n\t\telse {\n\t\t\tresult.x -= mapPanePos.x;\n\t\t}\n\n\t\tif (point.y <= splitPos.y) {\n\t\t\tresult.y -= pixelOrigin.y;\n\t\t}\n\t\telse {\n\t\t\tresult.y -= mapPanePos.y;\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tcontainerPointToLayerPointIgnoreSplits: function (point) { // (Point)\n\t\treturn L.point(point).subtract(this._getMapPanePos());\n\t},\n\n\tlayerPointToContainerPoint: function (point) { // (Point)\n\t\tvar splitPanesContext = this.getSplitPanesContext();\n\t\tif (!splitPanesContext) {\n\t\t\treturn this.layerPointToContainerPointIgnoreSplits(point);\n\t\t}\n\n\t\tvar splitPos = splitPanesContext.getSplitPos();\n\t\tvar pixelOrigin = this.getPixelOrigin();\n\t\tvar mapPanePos = this._getMapPanePos();\n\t\tvar result = L.point(point).add(pixelOrigin);\n\n\t\tif (result.x > splitPos.x) {\n\t\t\tresult.x -= (pixelOrigin.x - mapPanePos.x);\n\t\t}\n\n\t\tif (result.y > splitPos.y) {\n\t\t\tresult.y -= (pixelOrigin.y - mapPanePos.y);\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tlayerPointToContainerPointIgnoreSplits: function (point) { // (Point)\n\t\treturn L.point(point).add(this._getMapPanePos());\n\t},\n\n\tcontainerPointToLatLngIgnoreSplits: function (point) {\n\t\tvar layerPoint = this.containerPointToLayerPointIgnoreSplits(L.point(point));\n\t\treturn this.layerPointToLatLng(layerPoint);\n\t},\n\n\tlatLngToContainerPointIgnoreSplits: function (latlng) {\n\t\treturn this.layerPointToContainerPointIgnoreSplits(this.latLngToLayerPoint(L.latLng(latlng)));\n\t},\n\n\tlatLngToContainerPoint: function (latlng) {\n\t\treturn this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));\n\t},\n\n\tmouseEventToContainerPoint: function (e) { // (MouseEvent)\n\t\treturn L.DomEvent.getMousePosition(e, this._container);\n\t},\n\n\tmouseEventToLayerPoint: function (e) { // (MouseEvent)\n\t\treturn this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));\n\t},\n\n\tmouseEventToLatLng: function (e) { // (MouseEvent)\n\t\treturn this.layerPointToLatLng(this.mouseEventToLayerPoint(e));\n\t},\n\n\t// Give the focus to the text input.\n\t// @acceptInput (only on \"mobile\" (= mobile phone) or on iOS and Android in general) true if we want to\n\t// accept key input, and show the virtual keyboard.\n\tfocus: function (acceptInput) {\n\t\tif (this._textInput)\n\t\t\tthis._textInput.focus(acceptInput);\n\t},\n\n\t// just set the keyboard state for mobile\n\t// we don't want to change the focus, we know that keyboard is closed\n\t// and we are just setting the state here\n\tsetAcceptInput: function (acceptInput) {\n\t\tthis._textInput._setAcceptInput(acceptInput);\n\t},\n\n\t// Lose focus to stop accepting keyboard input.\n\t// On mobile, it will hide the virtual keyboard.\n\tblur: function () {\n\t\tthis._textInput.blur();\n\t},\n\n\thasFocus: function () {\n\t\treturn this._textInput && document.activeElement === this._textInput.activeElement();\n\t},\n\n\t// Returns true iff the textarea is enabled and we focused on it.\n\t// On mobile, this signifies that the keyboard should be visible.\n\tcanAcceptKeyboardInput: function() {\n\t\treturn this._textInput.canAcceptKeyboardInput();\n\t},\n\n\tisSearching: function() {\n\t\treturn this._isSearching;\n\t},\n\n\t_fireInitComplete: function (condition) {\n\t\tif (this.initComplete) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.initConditions[condition] = true;\n\t\tfor (var key in this.initConditions) {\n\t\t\tif (!this.initConditions[key]) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis.fire('statusindicator', {statusType: 'initializationcomplete'});\n\t\tthis.initComplete = true;\n\n\t\tL.DomUtil.addClass(this._container, 'initialized');\n\t},\n\n\t_initContainer: function (id) {\n\t\tvar container = this._container = L.DomUtil.get(id);\n\t\tL.DomUtil.removeClass(this._container, 'initialized');\n\n\t\tif (!container) {\n\t\t\tthrow new Error('Map container not found.');\n\t\t} else if (container._leaflet) {\n\t\t\tthrow new Error('Map container is already initialized.');\n\t\t}\n\n\t\tthis._fileDownloader = L.DomUtil.create('iframe', '', container);\n\t\tL.DomUtil.setStyle(this._fileDownloader, 'display', 'none');\n\n\t\tL.DomEvent.on(this._fileDownloader.contentWindow, 'contextmenu', L.DomEvent.preventDefault);\n\t\tL.DomEvent.addListener(container, 'scroll', this._onScroll, this);\n\t\tcontainer._leaflet = true;\n\t},\n\n\t_onScroll: function() {\n\t\tthis._container.scrollTop = 0;\n\t\tthis._container.scrollLeft = 0;\n\t},\n\n\t_initLayout: function () {\n\t\tvar container = this._container;\n\n\t\tthis._fadeAnimated = this.options.fadeAnimation && L.Browser.any3d;\n\n\t\tL.DomUtil.addClass(container, 'leaflet-container' +\n\t\t\t(window.touch.hasAnyTouchscreen() ? ' leaflet-touch' : '') +\n\t\t\t(L.Browser.retina ? ' leaflet-retina' : '') +\n\t\t\t(L.Browser.safari ? ' leaflet-safari' : '') +\n\t\t\t(this._fadeAnimated ? ' leaflet-fade-anim' : ''));\n\n\t\tvar position = L.DomUtil.getStyle(container, 'position');\n\n\t\tif (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {\n\t\t\tcontainer.style.position = 'absolute';\n\t\t}\n\n\t\tthis._initPanes();\n\n\t\tif (this._initControlPos) {\n\t\t\tthis._initControlPos();\n\t\t}\n\t},\n\n\t_initPanes: function () {\n\t\tvar panes = this._panes = {};\n\t\tthis._paneRenderers = {};\n\n\t\tthis._mapPane = this.createPane('mapPane', this._container);\n\n\t\tthis.createPane('shadowPane');\n\t\tthis.createPane('overlayPane');\n\t\tthis.createPane('markerPane');\n\t\tthis.createPane('formfieldPane');\n\n\t\tif (!this.options.markerZoomAnimation) {\n\t\t\tL.DomUtil.addClass(panes.markerPane, 'leaflet-zoom-hide');\n\t\t\tL.DomUtil.addClass(panes.shadowPane, 'leaflet-zoom-hide');\n\t\t}\n\t},\n\n\n\t// private methods that modify map state\n\n\t_resetView: function (center, zoom, preserveMapOffset, afterZoomAnim) {\n\n\t\tvar zoomChanged = (this._zoom !== zoom);\n\n\t\tif (!afterZoomAnim) {\n\t\t\tthis.fire('movestart');\n\n\t\t\tif (zoomChanged) {\n\t\t\t\tthis.fire('zoomstart');\n\t\t\t}\n\t\t}\n\n\t\tthis._zoom = zoom;\n\n\t\tif (!preserveMapOffset) {\n\t\t\tL.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\n\t\t}\n\n\t\tthis._pixelOrigin = this._getNewPixelOrigin(center);\n\n\t\tvar loading = !this._loaded;\n\t\tthis._loaded = true;\n\n\t\tthis.fire('viewreset', {hard: !preserveMapOffset});\n\n\t\tif (loading) {\n\t\t\tthis.fire('load');\n\t\t}\n\n\t\tthis.fire('move');\n\n\t\tif (zoomChanged || afterZoomAnim) {\n\t\t\tthis.fire('zoomend');\n\t\t\tthis.fire('zoomlevelschange');\n\t\t}\n\n\t\t// don't allow to turn off the following when moving to other sheet\n\t\tvar backupFollowed = app.getFollowedViewId();\n\n\t\tthis.fire('moveend', {hard: !preserveMapOffset});\n\n\t\tapp.setFollowingUser(backupFollowed);\n\t},\n\n\t_getZoomSpan: function () {\n\t\treturn this.getMaxZoom() - this.getMinZoom();\n\t},\n\n\t_checkIfLoaded: function () {\n\t\tif (!this._loaded) {\n\t\t\tthrow new Error('Set map center and zoom first.');\n\t\t}\n\t},\n\n\t// DOM event handling\n\t_mainEvents: function (onOff) {\n\t\tL.DomEvent[onOff](this._container, 'click dblclick mousedown mouseup ' +\n\t\t\t'mouseover mouseout mousemove dragover drop ' +\n\t\t\t'trplclick qdrplclick', window.touch.mouseOnly(this._handleDOMEvent), this);\n\t},\n\n\t_initEvents: function (remove) {\n\t\tif (!L.DomEvent) { return; }\n\n\t\tthis._targets = {};\n\n\t\tthis._mouseOut = false;\n\n\t\tvar onOff = remove ? 'off' : 'on';\n\n\t\tthis._mainEvents(onOff);\n\n\t\tL.DomEvent[onOff](window, 'blur', this._onLostFocus, this);\n\t\tL.DomEvent[onOff](window, 'focus', this._onGotFocus, this);\n\t},\n\n\n\tshowCalcInputBar: function() {\n\t\tif (this.formulabar)\n\t\t\tthis.formulabar.showFormulabar();\n\t},\n\n\t// Change the focus to a dialog or editor.\n\t// @dialog is the instance of the dialog class.\n\t// @winId is the ID of the dialog/sidebar, or 0 for the editor.\n\t// @acceptInput iff defined, map.focus is called and passed to it.\n\t_changeFocusWidget: function (dialog, winId, acceptInput) {\n\t\tif (!this._loaded) { return; }\n\n\t\tthis.setWinId(winId);\n\t\tthis._activeDialog = dialog;\n\t\tthis._isSearching = false;\n\n\t\tif (this.editorHasFocus()) {\n\t\t\t// The document has the focus.\n\t\t\tvar doclayer = this._docLayer;\n\t\t\tif (doclayer)\n\t\t\t\tdoclayer._updateCursorAndOverlay();\n\t\t} else if (acceptInput !== undefined) {\n\t\t\t// A dialog has the focus.\n\t\t\tthis.focus(acceptInput);\n\t\t\tthis._textInput.hideCursor(); // The cursor is in the dialog.\n\t\t}\n\t},\n\n\t// Our browser tab lost focus.\n\t_onLostFocus: function () {\n\t\twindow.prefs.sendPendingBrowserSettingsUpdate();\n\t\t// don't deactivate view while Drag and Drop in Pivot table dialog\n\t\tif (!JSDialog.isDnDActive())\n\t\t\tapp.idleHandler._deactivate();\n\t},\n\n\t// The editor got focus (probably a dialog closed or user clicked to edit).\n\t_onEditorGotFocus: function() {\n\t\tthis._changeFocusWidget(null, 0);\n\t\tif (this.formulabar)\n\t\t\tthis.onFormulaBarBlur();\n\t},\n\n\t// Our browser tab got focus.\n\t_onGotFocus: function () {\n\t\tif (this.editorHasFocus()) {\n\t\t\tthis.fire('editorgotfocus');\n\t\t}\n\t\telse if (this._activeDialog) {\n\t\t\tthis._activeDialog.focus(this.getWinId());\n\t\t}\n\n\t\tapp.idleHandler._activate();\n\n\t\tif (app.definitions.CommentSection.needFocus)\n\t\t{\n\t\t\tapp.definitions.CommentSection.needFocus.focus();\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).select(app.needFocus)\n\t\t\tapp.definitions.CommentSection.needFocus = null;\n\t\t}\n\t},\n\n\t// Event to change the focus to dialog or editor.\n\t_onChangeFocusWidget: function (e) {\n\t\tif (e.winId === 0) {\n\t\t\tthis._onEditorGotFocus();\n\t\t} else {\n\t\t\tthis._changeFocusWidget(e.dialog, e.winId, e.acceptInput);\n\t\t}\n\t},\n\n\t_onSearchStart: function () {\n\t\tthis._isSearching = true;\n\t},\n\n\t_onUpdateProgress: function (e) {\n\n\t\t// Minimal UX disruption for background save\n\t\tif (e.background)\n\t\t{\n\t\t\tswitch (e.statusType)\n\t\t\t{\n\t\t\tcase 'start':\n\t\t\t\tthis.uiManager.documentNameInput.showProgressBar();\n\t\t\t\tif (this.saveState)\n\t\t\t\t\tthis.saveState.showSavingStatus();\n\t\t\t\tbreak;\n\t\t\tcase 'setvalue':\n\t\t\t\tthis.uiManager.documentNameInput.setProgressBarValue(e.value);\n\t\t\t\tbreak;\n\t\t\tcase 'finish':\n\t\t\t\tthis.uiManager.documentNameInput.hideProgressBar();\n\t\t\t\tif (this.saveState)\n\t\t\t\t\tthis.saveState.showSavedStatus();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tswitch (e.statusType)\n\t\t\t{\n\t\t\tcase 'start':\n\t\t\t\t// e.text translated by Core\n\t\t\t\tthis.showBusy(e.text ? e.text : _('Please wait!'));\n\t\t\t\tif (e.forceid)\n\t\t\t\t\tthis._progressBar.forceid = e.forceid;\n\t\t\t\tbreak;\n\t\t\tcase 'setvalue':\n\t\t\t\tthis._progressBar.setBar(true);\n\t\t\t\tthis._progressBar.setValue(e.value);\n\t\t\t\tbreak;\n\t\t\tcase 'finish':\n\t\t\tcase 'coolloaded':\n\t\t\tcase 'reconnected':\n\t\t\t\tif(this._progressBar.forceid !== e.forceid)\n\t\t\t\t\treturn;\n\t\t\t\tthis.hideBusy();\n\t\t\t\tthis._progressBar.forceid = undefined;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\t_isMouseEnteringLeaving: function (e) {\n\t\tvar target = e.target || e.srcElement,\n\t\t    related = e.relatedTarget;\n\n\t\tif (!target) { return false; }\n\n\t\treturn ((target.id === 'map' || target.classList.contains('leaflet-layer'))\n\t\t\t&& !(related && (L.DomUtil.hasClass(related, 'leaflet-tile')\n\t\t\t\t|| L.DomUtil.hasClass(related, 'leaflet-cursor'))));\n\t},\n\n\t_handleDOMEvent: function (e) {\n\t\tapp.idleHandler.notifyActive();\n\n\t\tif (!this._docLayer || !this._loaded || !this._enabled || L.DomEvent._skipped(e)) { return; }\n\n\t\t// find the layer the event is propagating from\n\t\tvar target = this._targets[app.util.stamp(e.target || e.srcElement)],\n\t\t    //type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\t\t    type = e.type;\n\n\t\t// For touch devices, to pop-up the keyboard, it is required to call\n\t\t// .focus() method on hidden input within actual 'click' event here\n\t\t// Calling from some other place with no real 'click' event doesn't work.\n\n\t\tif (type === 'click' || type === 'dblclick') {\n\t\t\tif (this.isEditMode()) {\n\t\t\t\tthis.fire('editorgotfocus');\n\t\t\t\tthis.focus();\n\t\t\t}\n\n\t\t\t// unselect if anything is selected already\n\t\t\tif (app.sectionContainer.doesSectionExist(L.CSections.CommentList.name)) {\n\t\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).unselect();\n\t\t\t}\n\t\t}\n\n\t\t// we need to keep track if we have entered/left the map\n\t\tthis._mouseEnteringLeaving = false;\n\t\t// mouse leaving the map ?\n\t\tif (!target && !this._mouseOut && type === 'mouseout') {\n\t\t\tthis._mouseEnteringLeaving = this._isMouseEnteringLeaving(e);\n\t\t\tthis._mouseOut = this._mouseEnteringLeaving; // event type == mouseout\n\t\t}\n\t\t// mouse entering the map ?\n\t\tif (!target && this._mouseOut && type === 'mouseover') {\n\t\t\tthis._mouseEnteringLeaving = this._isMouseEnteringLeaving(e);\n\t\t\tthis._mouseOut = !this._mouseEnteringLeaving; // event type == mouseover\n\t\t}\n\n\t\t// special case for map mouseover/mouseout events so that they're actually mouseenter/mouseleave\n\t\tif (!target && !this._mouseEnteringLeaving && (type === 'mouseover' || type === 'mouseout') &&\n\t\t\t\t!L.DomEvent._checkMouse(this._container, e)) { return; }\n\n\t\t// prevents outline when clicking on keyboard-focusable element\n\t\tif (type === 'mousedown') {\n\t\t\tL.DomUtil.preventOutline(e.target || e.srcElement);\n\t\t\t// Prevents image dragging on Mozilla when map's dragging\n\t\t\t// option is set to false\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t// workaround for drawing shapes, without this shapes cannot be shrunken\n\t\tif (target !== undefined && target._path !== undefined && type === 'mousemove') {\n\t\t\ttarget = undefined;\n\t\t}\n\t\tthis._fireDOMEvent(target || this, e, type);\n\t},\n\n\t_fireDOMEvent: function (target, e, type) {\n\t\tif (this.uiManager.isUIBlocked())\n\t\t\treturn;\n\n\t\tif (!target.listens(type, true) && (type !== 'click' || !target.listens('preclick', true))) { return; }\n\n\t\tif (type === 'contextmenu') {\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t}\n\n\t\t// prevents firing click after you just dragged an object\n\t\tif (e.type === 'click' && !e._simulated && this._draggableMoved(target)) { return; }\n\n\t\tvar data = {\n\t\t\toriginalEvent: e\n\t\t};\n\t\tif (e.type !== 'keypress' && e.type !== 'keyup' && e.type !== 'keydown' &&\n\t\t\te.type !== 'copy' && e.type !== 'cut' && e.type !== 'paste' &&\n\t\t    e.type !== 'compositionstart' && e.type !== 'compositionupdate' && e.type !== 'compositionend' && e.type !== 'textInput') {\n\t\t\tdata.containerPoint = target instanceof L.Marker ?\n\t\t\t\tthis.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n\t\t\tdata.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n\t\t\tdata.latlng = this.layerPointToLatLng(data.layerPoint);\n\t\t}\n\t\tif (type === 'click') {\n\t\t\ttarget.fire('preclick', data, true);\n\t\t}\n\t\ttarget.fire(type, data, true);\n\t},\n\n\t_draggableMoved: function (obj) {\n\t\tobj = obj.options.draggable ? obj : this;\n\t\treturn obj.dragging && obj.dragging.moved();\n\t},\n\n\t_clearHandlers: function () {\n\t\tfor (var i = 0, len = this._handlers.length; i < len; i++) {\n\t\t\tthis._handlers[i].disable();\n\t\t}\n\t},\n\n\twhenReady: function (callback, context) {\n\t\tif (this._loaded) {\n\t\t\tcallback.call(context || this, {target: this});\n\t\t} else {\n\t\t\tthis.on('load', callback, context);\n\t\t}\n\t\treturn this;\n\t},\n\n\n\t// private methods for getting map state\n\n\t_getMapPanePos: function () {\n\t\treturn L.DomUtil.getPosition(this._mapPane) || new L.Point(0, 0);\n\t},\n\n\t_getTopLeftPoint: function (center, zoom) {\n\t\tvar pixelOrigin = center && zoom !== undefined ?\n\t\t\tthis._getNewPixelOrigin(center, zoom) :\n\t\t\tthis.getPixelOrigin();\n\n\t\treturn pixelOrigin.subtract(this._getMapPanePos());\n\t},\n\n\t_getNewPixelOrigin: function (center, zoom) {\n\t\tvar viewHalf = this.getSize()._divideBy(2);\n\t\treturn this.project(center, zoom)._subtract(viewHalf)._add(this._getMapPanePos())._floor();\n\t},\n\n\t// layer point of the current center\n\t_getCenterLayerPoint: function () {\n\t\treturn this.containerPointToLayerPointIgnoreSplits(this.getSize()._divideBy(2));\n\t},\n\n\t// offset of the specified place to the current center in pixels\n\t_getCenterOffset: function (latlng) {\n\t\treturn this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());\n\t},\n\n\t// adjust center for view to get inside bounds\n\t_limitCenter: function (center, zoom, bounds) {\n\n\t\tif (!bounds) { return center; }\n\n\t\tvar centerPoint = this.project(center, zoom),\n\t\t    viewHalf = this.getSize().divideBy(2),\n\t\t    viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),\n\t\t    offset = this._getBoundsOffset(viewBounds, bounds, zoom);\n\n\t\treturn this.unproject(centerPoint.add(offset), zoom);\n\t},\n\n\t// returns offset needed for pxBounds to get inside maxBounds at a specified zoom\n\t_getBoundsOffset: function (pxBounds, maxBounds, zoom) {\n\t\tvar nwOffset = this.project(maxBounds.getNorthWest(), zoom).subtract(pxBounds.min),\n\t\t    seOffset = this.project(maxBounds.getSouthEast(), zoom).subtract(pxBounds.max),\n\n\t\t    dx = this._rebound(nwOffset.x, -seOffset.x),\n\t\t    dy = this._rebound(nwOffset.y, -seOffset.y);\n\n\t\treturn new L.Point(dx, dy);\n\t},\n\n\t_rebound: function (left, right) {\n\t\treturn left + right > 0 ?\n\t\t\tMath.round(left - right) / 2 :\n\t\t\tMath.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));\n\t\t// TODO: do we really need ceil and floor ?\n\t\t// for spreadsheets it can cause one pixel alignment offset btw grid and row/column header\n\t\t// and a one pixel horizontal auto-scrolling issue;\n\t\t// both issues have been fixed by rounding the projection: see Map.project above;\n\t\t// anyway in case of similar problems, this code needs to be checked\n\t},\n\n\t_limitZoom: function (zoom) {\n\t\tvar min = this.getMinZoom(),\n\t\t    max = this.getMaxZoom();\n\n\t\treturn Math.max(min, Math.min(max, zoom));\n\t},\n\n\t_goToViewId: function(id) {\n\t\tif (id === -1)\n\t\t\treturn;\n\n\t\tif (this.getDocType() === 'spreadsheet') {\n\t\t\tthis._docLayer.goToCellViewCursor(id);\n\t\t} else if (this.getDocType() === 'text' || this.getDocType() === 'presentation') {\n\t\t\tthis._docLayer.goToViewCursor(id);\n\t\t}\n\t},\n\n\t/// instantJump = false allows to set the following but waits for a cursor from core to scroll\n\t_setFollowing: function(followingState, viewId, instantJump) {\n\t\tvar userDefined = viewId !== null && viewId !== undefined;\n\t\tvar followDefined = followingState !== null && followingState !== undefined;\n\n\t\tvar followEditor = true;\n\t\tvar followUser = false;\n\n\t\tif (userDefined && viewId !== -1) {\n\t\t\tfollowUser = true;\n\t\t\tfollowEditor = false;\n\t\t}\n\n\t\tif (followDefined && followingState === false) {\n\t\t\tfollowEditor = false;\n\t\t\tfollowUser = false;\n\t\t}\n\n\t\tif (followUser) {\n\t\t\tif (instantJump) this._goToViewId(viewId);\n\t\t\tapp.setFollowingUser(viewId);\n\t\t}\n\t\telse if (followEditor) {\n\t\t\tvar editorId = this._docLayer._editorId;\n\t\t\tif (editorId !== -1 && editorId !== this._docLayer.viewId) {\n\t\t\t\tif (instantJump) this._goToViewId(editorId);\n\t\t\t\tapp.setFollowingEditor(editorId);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.fire('deselectuser', {viewId: app.getFollowedViewId()});\n\t\t\tapp.setFollowingOff();\n\t\t}\n\n\t\t// Notify about changes\n\t\tthis.fire('postMessage', {msgId: 'FollowUser_Changed',\n\t\t\targs: {FollowedViewId: app.getFollowedViewId(),\n\t\t\t\tIsFollowUser: followUser,\n\t\t\t\tIsFollowEditor: followEditor}});\n\t},\n\n\tgetSplitPanesContext: function () {\n\t\tvar docLayer = this._docLayer;\n\t\tif (docLayer) {\n\t\t\treturn docLayer.getSplitPanesContext();\n\t\t}\n\n\t\treturn undefined;\n\t},\n\n\t_setPaneOpacity: function(paneClassString, opacity) {\n\t\tvar panes = document.getElementsByClassName(paneClassString);\n\t\tif (panes.length)\n\t\t\tpanes[0].style.opacity = opacity;\n\t},\n\n\tsetOverlaysOpacity: function(opacity) {\n\t\tthis._setPaneOpacity('leaflet-pane leaflet-overlay-pane', opacity);\n\t},\n\n\tsetMarkersOpacity: function(opacity) {\n\t\tthis._setPaneOpacity('leaflet-pane leaflet-marker-pane', opacity);\n\t},\n\n\tgetTileSectionMgr: function() {\n\t\tif (this._docLayer)\n\t\t\treturn this._docLayer._painter;\n\t\treturn undefined;\n\t},\n\n\tgetCursorOverlayContainer: function() {\n\t\tif (this._docLayer)\n\t\t\treturn this._docLayer._cursorOverlayDiv;\n\t\treturn undefined;\n\t}\n});\n\nL.map = function (id, options) {\n\treturn new L.Map(id, options);\n};\n"]}