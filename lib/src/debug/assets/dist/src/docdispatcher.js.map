{"version":3,"file":"docdispatcher.js","sourceRoot":"","sources":["../../../../../../../../../TanhX/online/browser/src/docdispatcher.ts"],"names":[],"mappings":"AAAA,oBAAoB;AACpB,gCAAgC;AAEhC;;;;;;;;GAQG;AAEH,kBAAkB;AAElB;;;EAGE;AAEF;IA2sBC,4DAA4D;IAC5D,oBAAY,OAA2B;QAA3B,wBAAA,EAAA,mBAA2B;QA3sB/B,eAAU,GAAQ,EAAE,CAAC;QA4sB5B,OAAO,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC;QAEzD,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAEzB,IAAI,OAAO,KAAK,MAAM,EAAE;YACvB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,iBAAiB,EAAE,CAAC;SACzB;aAAM,IAAI,OAAO,KAAK,aAAa,EAAE;YACrC,IAAI,CAAC,eAAe,EAAE,CAAC;SACvB;aAAM,IAAI,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;YACzD,IAAI,CAAC,yBAAyB,EAAE,CAAC;SACjC;QAED,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE;YAAE,IAAI,CAAC,iBAAiB,EAAE,CAAC;IACtD,CAAC;IAztBO,uCAAkB,GAA1B;QAAA,iBAuTC;QAtTA,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG;YACzB,gCAAgC;YAChC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE,EAAE;gBAC9B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE;oBAC3B,KAAK,EAAE,SAAS;oBAChB,IAAI,EAAE,EAAE,MAAM,EAAE,SAAS,EAAE;iBAC3B,CAAC,CAAC;gBACH,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,qBAAqB,CAAC,SAAS,CAAC,EAAE;oBAC9C,GAAG,CAAC,GAAG,CAAC,IAAI,CACX,KAAK,CAAC,iDAAiD,EACvD,KAAK,CAAC,2CAA2C,CACjD,CAAC;iBACF;aACD;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,IAAK,MAAc,CAAC,gBAAgB,EAAE;gBACrC,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;aAChC;iBAAM;gBACN,IACC,GAAG,CAAC,GAAG;oBACP,GAAG,CAAC,GAAG,CAAC,UAAU;oBAClB,CAAC,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC,EACnE;oBACD,KAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC,yCAAyC;iBACzE;gBAED,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE;oBAC3B,KAAK,EAAE,OAAO;oBACd,IAAI,EAAE,EAAE,YAAY,EAAE,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,UAAU,EAAE,IAAI,EAAE;iBAC/D,CAAC,CAAC;gBACH,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE;oBAC3B,KAAK,EAAE,UAAU;oBACjB,IAAI,EAAE,EAAE,YAAY,EAAE,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE;iBAC7C,CAAC,CAAC;aACH;YACD,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,qBAAqB,CAAC,UAAU,CAAC;gBAAE,GAAG,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;QAClE,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,IAAI,GAAG,CAAC,GAAG,CAAC,QAAQ;gBAAE,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;QACvD,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG;YAC1B,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,iGAAiG;YACjG,0EAA0E;YAC1E,IAAM,OAAO,GAAG;gBACf,gBAAgB,EAAE;oBACjB,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,IAAI;iBACX;gBACD,oBAAoB,EAAE;oBACrB,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,IAAI;iBACX;aACD,CAAC;YACF,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YAC9C,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QAC9B,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG;YAC3B,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,2CAA2C,CAAC,CAAC;QACrE,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC,CAAC;QACvD,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,oBAAoB,EAAE,CAAC,CAAC;QAC9D,CAAC,CAAC;QACF,oBAAoB;QACpB,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,GAAG,CAAC,GAAG,CAAC,mBAAmB,EAAE,CAAC;QAC/B,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,IAAI,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,aAAa;gBACxC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,sBAAsB,CAAC,CAAC;;gBAC3C,GAAG,CAAC,GAAG,CAAC,mBAAmB,EAAE,CAAC;QACpC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,GAAG,CAAC,GAAG,CAAC,mBAAmB,EAAE,CAAC;QAC/B,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG;YAC5B,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC;QACrB,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,IAAI,GAAG,CAAC,uBAAuB,EAAE,EAAE;gBAClC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,qBAAqB,CAAC,SAAS,CAAC,EAAE;oBAC9C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;iBAC3B;aACD;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,KAAK,EAAE,CAAC;QAC3C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE;gBAC3B,KAAK,EAAE,eAAe;gBACtB,IAAI,EAAE;oBACL,QAAQ,EAAE,yBAAyB;oBACnC,cAAc,EAAE;wBACf,YAAY;wBACZ,WAAW;wBACX,YAAY;wBACZ,WAAW;wBACX,iBAAiB;wBACjB,YAAY;wBACZ,kBAAkB;wBAClB,gBAAgB;wBAChB,iBAAiB;wBACjB,WAAW;wBACX,YAAY;wBACZ,WAAW;wBACX,YAAY;wBACZ,WAAW;wBACX,aAAa;qBACb;iBACD;aACD,CAAC,CAAC;QACJ,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG;YACnC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,mBAAmB,CAAC,CAAC;QAC7C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,oBAAoB,EAAE,CAAC;QAC1C,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,EAAE,CAAC;QACpC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;QAClC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;QACjC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG;YACnC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,EAAE,CAAC;QACpC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;QAChC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC/B,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,yBAAyB,CAAC,GAAG;YAC5C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC,CAAC;QACzD,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,yBAAyB,CAAC,GAAG;YAC5C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC,CAAC;QACzD,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,GAAG;YACtC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QACnD,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,KAAK,EAAE,CAAC;QACxC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,qBAAqB,CAAC;YACxE;gBACC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC;YAC5D,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;QACzC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,GAAG;YACvC,IAAM,aAAa,GAAG,QAAQ,CAAC,sBAAsB,CACpD,4BAA4B,CAC5B,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACjB,IAAI,cAAiC,CAAC;YACtC,IAAI,aAAa,EAAE;gBAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACvD,IAAI,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;wBAC7D,cAAc,GAAG,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAsB,CAAC;wBAChE,MAAM;qBACN;iBACD;aACD;YACD,IAAI,CAAC,cAAc;gBAClB,cAAc,GAAG,QAAQ,CAAC,cAAc,CACvC,gBAAgB,CACK,CAAC;YAExB,cAAc,CAAC,KAAK,EAAE,CAAC;QACxB,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG;YAC3B,IAAI,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,EAAE,KAAK,aAAa,EAAE;gBACpE,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,kDAAkD;aACxE;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;QACzB,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,GAAG;YAC3B,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAC9C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG;YAC5B,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAC/C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACnD,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC;QACpC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,aAAa,CAAC,UAAU,EAAE,CAAC;QAChC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,GAAG,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QACxB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,CAAC,CAAC,eAAe,CAAC,CAAC,IAAI,EAAE,CAAC;YAC1B,CAAC,CAAC,gBAAgB,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YACxC,CAAC,CAAC,iBAAiB,CAAC,CAAC,IAAI,EAAE,CAAC;YAC5B,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,KAAK,EAAE,CAAC;QACvC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,CAAC,CAAC,iBAAiB,CAAC,CAAC,IAAI,EAAE,CAAC;YAC5B,IAAI,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE;gBAAE,CAAC,CAAC,eAAe,CAAC,CAAC,IAAI,EAAE,CAAC;YACpD,wEAAwE;YACxE,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE;gBAChD,CAAC,CAAC,qBAAqB,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;QAClD,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG;YACzB,IAAI,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,KAAK,MAAM;gBAAE,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;;gBAC/D,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC9B,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG;YACzB,IAAI,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,KAAK,MAAM;gBAAE,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;;gBAC/D,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC9B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,oCAAoC,CAAC,CAAC;QAC9D,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;QACzB,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YAC/D,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,aAAa,EAAE,CAAC;QACnC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAC3D,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,oBAAoB,EAAE,CAAC;QAC1C,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,GAAG,CAAC,GAAG,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;QAClC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,IAAI,GAAG,CAAC,GAAG,CAAC,oBAAoB,EAAE;gBACjC,OAAO;aACP;YACD,IAAI,sBAAsB,GACzB,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,oBAAoB,CAAC,CAAC;YAC/C,GAAG,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC,sBAAsB,CAAC,CAAC;QACxD,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,IAAI,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,wBAAwB,EAAE,EAAE;gBACjD,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;aACnE;iBAAM;gBACN,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;aACvE;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;QACjC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,eAAe,EAAE,CAAC;QACrC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,qBAAqB,CAAC,GAAG;YACxC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,mBAAmB,EAAE,CAAC;QACzC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,IAAM,YAAY,GAAG,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;YAC3D,YAAY,CAAC,QAAQ,CAAC;gBACrB,GAAG,EAAE,CAAC,YAAY,CAAC,YAAY;gBAC/B,QAAQ,EAAE,QAAQ;aAClB,CAAC,CAAC,CAAC,yCAAyC;QAC9C,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,GAAG;YACtC,IAAM,YAAY,GAAG,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;YAC3D,YAAY,CAAC,QAAQ,CAAC;gBACrB,GAAG,EAAE,YAAY,CAAC,YAAY;gBAC9B,QAAQ,EAAE,QAAQ;aAClB,CAAC,CAAC,CAAC,yCAAyC;QAC9C,CAAC,CAAC;IACH,CAAC;IAEO,sCAAiB,GAAzB;QACC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,kBAAkB,EAAE;gBAC1C,YAAY,EAAE;oBACb,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,KAAK;iBACZ;aACD,CAAC,CAAC;QACJ,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,wBAAwB,EAAE;gBAChD,YAAY,EAAE;oBACb,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,KAAK;iBACZ;aACD,CAAC,CAAC;QACJ,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,mBAAmB,EAAE;gBAC3C,YAAY,EAAE;oBACb,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,KAAK;iBACZ;aACD,CAAC,CAAC;QACJ,CAAC,CAAC;IACH,CAAC;IAEO,oCAAe,GAAvB;QACC,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;gBAC3B,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;gBAChB,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,iBAAiB,CAClC,OAAO,EACP,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,EAC/B,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,CAC/D,CAAC;aACF;iBAAM;gBACN,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,oBAAoB,CAAC,CAAC;aAC7C;YAED,GAAG,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;YAC3B,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC;YACzB,GAAG,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC;QAC9B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YACtC,GAAG,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;YAC3B,GAAG,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC;YACzB,GAAG,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC;QAC9B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,mBAAmB,CAAC,CAAC;YAC5C,GAAG,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC;YAC5B,GAAG,CAAC,GAAG,CAAC,eAAe,EAAE,CAAC;YAC1B,GAAG,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC;QAC9B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG;YACnC,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,mBAAmB,EAAE;gBAC1D,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,kBAAkB,EAAE,CAAC;gBACvC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;gBACjE,GAAG,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC;aAC7B;iBAAM;gBACN,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC;aAC9C;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,GAAG;YACvC,IAAM,YAAY,GAAG,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,aAAa,GAAG,CAAC,CAAC;YACzD,IAAM,OAAO,GAAG;gBACf,gBAAgB,EAAE;oBACjB,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,KAAK;iBACZ;gBACD,WAAW,EAAE;oBACZ,IAAI,EAAE,SAAS;oBACf,KAAK,EAAE,KAAK;iBACZ;gBACD,UAAU,EAAE;oBACX,IAAI,EAAE,QAAQ;oBACd,KAAK,EAAE,YAAY,GAAG,GAAG,GAAG,YAAY;iBACxC;aACD,CAAC;YACF,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YAC9C,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QAC9B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG;YACnC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC;QAC/C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,qBAAqB,CAAC,GAAG;YACxC,QAAQ,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,KAAK,EAAE,CAAC;QACxD,CAAC,CAAC;QAEF,iBAAiB;QACjB,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,IAAI,IAAI,GAAG,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC;YAC7D,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACzB,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC;QACvC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,GAAG;YAChC,CAAC,CAAC,yBAAyB,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,0DAA0D;YAC1D,CAAC,CAAC,yBAAyB,CAAC,CAAC,UAAU,CACtC,CAAC,CAAC,yBAAyB,CAAC,CAAC,UAAU,EAAE,GAAG,EAAE,CAC9C,CAAC;QACH,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,CAAC,CAAC,yBAAyB,CAAC,CAAC,UAAU,CACtC,CAAC,CAAC,yBAAyB,CAAC,CAAC,UAAU,EAAE,GAAG,EAAE,CAC9C,CAAC;QACH,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,yFAAyF;YACzF,sEAAsE;YACtE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC,UAAU,GAAG,MAAM,CAAC;QAC7D,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,GAAG;YACvC,IAAI,QAAQ,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC;YACrD,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YAE7C,IAAI,QAAQ;gBAAE,gBAAgB,CAAC,oBAAoB,EAAE,CAAC;;gBACjD,gBAAgB,CAAC,oBAAoB,EAAE,CAAC;YAE7C,GAAG,CAAC,gBAAgB,CAAC,aAAa,EAAE,CAAC;QACtC,CAAC,CAAC;IACH,CAAC;IAEO,8CAAyB,GAAjC;QACC,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC,UAAU,CAChD,yBAAyB,CACzB,GAAG;YACH,IAAK,MAAc,CAAC,sBAAsB;gBAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;;gBACrE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACjC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,2BAA2B,CAAC,GAAG,IAAI,CAAC,UAAU,CAC7D,2BAA2B,CAC3B,GAAG;YACH,IAAK,MAAc,CAAC,sBAAsB;gBACzC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE;oBAC7B,gBAAgB,EAAE,GAAG,CAAC,GAAG,CAAC,oBAAoB,EAAE;iBAChD,CAAC,CAAC;;gBAEH,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,EAAE;oBAC1B,gBAAgB,EAAE,GAAG,CAAC,GAAG,CAAC,oBAAoB,EAAE;iBAChD,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC;YACxE;gBACC,IAAK,MAAc,CAAC,sBAAsB;oBACzC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;;oBAC/B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACtC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,IAAK,MAAc,CAAC,sBAAsB;gBACzC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QACtC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,GAAG;YACvC,GAAG,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC7B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,IAAI,GAAW,CAAC;YAChB,IAAI,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,KAAK,cAAc,EAAE;gBAC5C,GAAG,GAAG,CAAC,CAAC,6CAA6C,CAAC,CAAC;aACvD;iBAAM;gBACN,aAAa;gBACb,GAAG,GAAG,CAAC,CAAC,4CAA4C,CAAC,CAAC;aACtD;YACD,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,aAAa,CAC9B,mBAAmB,EACnB,CAAC,CAAC,QAAQ,CAAC,EACX,GAAG,EACH,EAAE,EACF,CAAC,CAAC,IAAI,CAAC,EACP;gBACC,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC;YACtB,CAAC,EACD,IAAI,EACJ,4BAA4B,CAC5B,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QAC3D,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QAC3D,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,aAAa,KAAK,IAAI,EAAE;gBAC3C,IAAM,YAAY,GAAG,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;gBAClD,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;aACnE;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,aAAa,KAAK,IAAI,EAAE;gBAC3C,IAAM,YAAY,GAAG,CAAC,CAAC;gBACvB,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;aACnE;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC;QACrB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC;QACrB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;QACzB,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC;QACtB,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG;YAC7B,GAAG,CAAC,GAAG,CAAC,cAAc,CACpB,MAAc,CAAC,aAAa,CAAC;gBAC7B,WAAW,EAAE,eAAe;gBAC5B,aAAa,EAAE,sBAAsB;gBACrC,QAAQ,EAAE,gBAAgB;aAC1B,CAAC,CACF,CAAC;QACH,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG;YAC/B,GAAG,CAAC,GAAG,CAAC,cAAc,CACpB,MAAc,CAAC,aAAa,CAAC;gBAC7B,WAAW,EAAE,iBAAiB;gBAC9B,aAAa,EAAE,kBAAkB;gBACjC,QAAQ,EAAE,4BAA4B;aACtC,CAAC,CACF,CAAC;QACH,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,cAAc,CACpB,MAAc,CAAC,aAAa,CAAC;gBAC7B,WAAW,EAAE,gBAAgB;gBAC7B,aAAa,EAAE,uBAAuB;gBACtC,QAAQ,EAAE,iBAAiB;aAC3B,CAAC,CACF,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,GAAG;YACrC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,KAAK,EAAE,CAAC;QAC3C,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,IAAI,GAAG,CAAC,OAAO,CAAC,SAAS;gBACxB,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC;;gBAC9C,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC;QAC/C,CAAC,CAAC;IACH,CAAC;IAEO,sCAAiB,GAAzB;QACC,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,GAAG;YAC1C,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC;QACjC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,GAAG;YACtC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;QAClC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,2BAA2B,CAAC,GAAG;YAC9C,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,kBAAkB,EAAE,CAAC;QACrC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC;QACnC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,sBAAsB,EAAE,CAAC;QACzC,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG;YACjC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;QAClC,CAAC,CAAC;IACH,CAAC;IAEO,sCAAiB,GAAzB;QACC,IAAI,CAAC,UAAU,CAAC,8BAA8B,CAAC,GAAG;YACjD,IAAM,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;YAC5C,IAAI,GAAG,GAAG,KAAK,CAAC,YAAY,CAAC,8BAA8B,CAAC,CAAC;YAC7D,GAAG,GAAG,GAAG,KAAK,MAAM,IAAI,GAAG,KAAK,IAAI,CAAC;YACrC,GAAG,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC,GAAG,CAAC,CAAC;QACpC,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,GAAG;YACpC,IAAM,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;YAC5C,IAAI,GAAG,GAAG,KAAK,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAC;YAChD,GAAG,GAAG,GAAG,KAAK,MAAM,IAAI,GAAG,KAAK,IAAI,CAAC;YACrC,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC;QAC5B,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,8BAA8B,CAAC,GAAG;YACjD,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,8BAA8B,CAAC,CAAC;YACvD,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,4CAA4C,CAAC,CAAC;QACtE,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,8BAA8B,CAAC,GAAG;YACjD,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,8BAA8B,CAAC,CAAC;YACvD,IAAM,cAAc,GAAG,GAAG,CAAC,gBAAgB,CAAC,kBAAkB,CAC7D,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAC5B,CAAC;YACF,cAAc,CAAC,8BAA8B,EAAE,CAAC;QACjD,CAAC,CAAC;IACH,CAAC;IAEO,sCAAiB,GAAzB;QACC,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,GAAG;YACnC,IAAM,aAAa,GAAG,MAAa,CAAC;YACpC,IAAI,aAAa,CAAC,aAAa,EAAE;gBAChC,aAAa,CAAC,aAAa,GAAG,KAAK,CAAC;gBACpC,GAAG,CAAC,gBAAgB;qBAClB,kBAAkB,CAAC,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;qBAChD,kBAAkB,EAAE,CAAC;gBACvB,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;gBAClC,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;aACzD;iBAAM;gBACN,IAAI,aAAa,CAAC,qBAAqB;oBACtC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,yBAAyB,CAAC,CAAC;qBAC/C,IAAI,aAAa,CAAC,YAAY;oBAClC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;gBAC1C,aAAa,CAAC,aAAa,GAAG,IAAI,CAAC;gBACnC,IAAI,QAAQ,GAAG,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,yBAAyB,EAAE,CAAC;gBAC7D,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;gBACjD,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;aACxD;QACF,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,GAAG;YAClC,IAAM,aAAa,GAAG,MAAa,CAAC;YACpC,IAAI,aAAa,CAAC,YAAY,EAAE;gBAC/B,aAAa,CAAC,YAAY,GAAG,KAAK,CAAC;gBACnC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC;gBAC3C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;gBAClC,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;aACxD;iBAAM;gBACN,IAAI,aAAa,CAAC,qBAAqB;oBACtC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,yBAAyB,CAAC,CAAC;qBAC/C,IAAI,aAAa,CAAC,aAAa;oBACnC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;gBAC3C,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;gBAClC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC;gBAC3C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;gBAClC,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;aACvD;QACF,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,yBAAyB,CAAC,GAAG;YAC5C,IAAM,aAAa,GAAG,MAAa,CAAC;YACpC,IAAI,aAAa,CAAC,qBAAqB,EAAE;gBACxC,aAAa,CAAC,qBAAqB,GAAG,KAAK,CAAC;gBAC5C,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;gBAClC,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;aAClE;iBAAM;gBACN,IAAI,aAAa,CAAC,YAAY;oBAC7B,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;qBACrC,IAAI,aAAa,CAAC,aAAa;oBACnC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;gBAC3C,aAAa,CAAC,qBAAqB,GAAG,IAAI,CAAC;gBAC3C,IAAM,QAAQ,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,2BAA2B,EAAE,CAAC;gBAC/D,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;gBACjD,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,yBAAyB,EAAE,IAAI,CAAC,CAAC;aACjE;QACF,CAAC,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE;gBAC5B,IAAI,EAAG,MAAc,CAAC,kBAAkB,CAAC,YAAY,CAAC;aACtD,CAAC,CAAC;QACJ,CAAC,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG;YAC9B,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE;gBAC5B,IAAI,EAAG,MAAc,CAAC,kBAAkB,CAAC,iBAAiB,CAAC;aAC3D,CAAC,CAAC;QACJ,CAAC,CAAC;QACF,wCAAwC;QACxC,8DAA8D;QAC9D,0CAA0C;QAC1C,IAAI;QACJ,mEAAmE;QACnE,0CAA0C;QAC1C,IAAI;QACJ,yEAAyE;QACzE,0CAA0C;QAC1C,IAAI;IACL,CAAC;IAqBM,6BAAQ,GAAf,UAAgB,MAAc;QAC7B,kEAAkE;QAClE,+DAA+D;QAC/D,IACC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,EAAE;YAChC,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC,EACvD;YACD,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;YACjC,OAAO,CAAC,KAAK,CAAC,mBAAmB,GAAG,MAAM,GAAG,yBAAyB,CAAC,CAAC;YACxE,OAAO;SACP;QAED,IAAI,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;YACpC,IAAM,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAClD,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC3B,OAAO;SACP;aAAM,IAAI,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;YAC/C,IAAM,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACtD,IAAI,QAAQ,GAAG,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;YAC5C,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;YACzD,QAAQ,GAAG,QAAQ,KAAK,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ,CAAC;YACnD,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,GAAG,GAAG,GAAG,MAAM,EAAE,MAAM,CAAC,CAAC;YACpD,OAAO;SACP;QAED,IAAI,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;YACtC,IAAM,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YACpD,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC3B,OAAO;SACP;QAED,IACC,MAAM,KAAK,WAAW;YACtB,MAAM,KAAK,UAAU;YACrB,MAAM,KAAK,YAAY;YACvB,MAAM,KAAK,mBAAmB,EAC7B;YACD,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;YAC1C,OAAO;SACP;QAED,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,SAAS,EAAE;YAC1C,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC;YAC1B,OAAO;SACP;QAED,OAAO,CAAC,KAAK,CAAC,qBAAqB,GAAG,MAAM,GAAG,GAAG,CAAC,CAAC;IACrD,CAAC;IACF,iBAAC;AAAD,CAAC,AA9wBD,IA8wBC;AAED,GAAG,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,UAAU,CAAC","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/* global app _ */\n\n/*\n\tapp.dispatcher.dispatch() will be used to call some actions so we can share the code\n\tThis is mostly used by keyboard shortcuts etc, which need a base (for simplicity) to call actions.\n*/\n\nclass Dispatcher {\n\tprivate actionsMap: any = {};\n\n\tprivate addGeneralCommands() {\n\t\tthis.actionsMap['save'] = function () {\n\t\t\t// Save only when not read-only.\n\t\t\tif (!app.map.isReadOnlyMode()) {\n\t\t\t\tapp.map.fire('postMessage', {\n\t\t\t\t\tmsgId: 'UI_Save',\n\t\t\t\t\targs: { source: 'toolbar' },\n\t\t\t\t});\n\t\t\t\tif (!app.map._disableDefaultAction['UI_Save']) {\n\t\t\t\t\tapp.map.save(\n\t\t\t\t\t\tfalse /* An explicit save should terminate cell edit */,\n\t\t\t\t\t\tfalse /* An explicit save should save it again */,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['closeapp'] = () => {\n\t\t\tif ((window as any).ThisIsAMobileApp) {\n\t\t\t\twindow.postMobileMessage('BYE');\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tapp.map &&\n\t\t\t\t\tapp.map.formulabar &&\n\t\t\t\t\t(app.map.formulabar.hasFocus() || app.map.formulabar.isInEditMode())\n\t\t\t\t) {\n\t\t\t\t\tthis.dispatch('acceptformula'); // save data from the edited cell on exit\n\t\t\t\t}\n\n\t\t\t\tapp.map.fire('postMessage', {\n\t\t\t\t\tmsgId: 'close',\n\t\t\t\t\targs: { EverModified: app.map._everModified, Deprecated: true },\n\t\t\t\t});\n\t\t\t\tapp.map.fire('postMessage', {\n\t\t\t\t\tmsgId: 'UI_Close',\n\t\t\t\t\targs: { EverModified: app.map._everModified },\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (!app.map._disableDefaultAction['UI_Close']) app.map.remove();\n\t\t};\n\n\t\tthis.actionsMap['userlist'] = () => {\n\t\t\tif (app.map.userList) app.map.userList.openDropdown();\n\t\t};\n\n\t\tthis.actionsMap['print'] = function () {\n\t\t\tapp.map.print();\n\t\t};\n\t\tthis.actionsMap['print-notespages'] = function () {\n\t\t\t// To Export only notes with slides both should be true (ExportNotesPages, ExportOnlyNotesPages).\n\t\t\t// As ExportOnlyNotesPages is kind of child condition to ExportNotesPages.\n\t\t\tconst options = {\n\t\t\t\tExportNotesPages: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: true,\n\t\t\t\t},\n\t\t\t\tExportOnlyNotesPages: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: true,\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst optionsString = JSON.stringify(options);\n\t\t\tapp.map.print(optionsString);\n\t\t};\n\t\tthis.actionsMap['repair'] = function () {\n\t\t\tapp.socket.sendMessage('commandvalues command=.uno:DocumentRepair');\n\t\t};\n\n\t\tthis.actionsMap['remotelink'] = function () {\n\t\t\tapp.map.fire('postMessage', { msgId: 'UI_PickLink' });\n\t\t};\n\t\tthis.actionsMap['remoteaicontent'] = function () {\n\t\t\tapp.map.fire('postMessage', { msgId: 'UI_InsertAIContent' });\n\t\t};\n\t\t// TODO: deduplicate\n\t\tthis.actionsMap['hyperlinkdialog'] = function () {\n\t\t\tapp.map.showHyperlinkDialog();\n\t\t};\n\t\tthis.actionsMap['inserthyperlink'] = () => {\n\t\t\tif (app.map.getDocType() == 'spreadsheet')\n\t\t\t\tapp.map.sendUnoCommand('.uno:HyperlinkDialog');\n\t\t\telse app.map.showHyperlinkDialog();\n\t\t};\n\t\tthis.actionsMap['rev-history'] = function () {\n\t\t\tapp.map.openRevisionHistory();\n\t\t};\n\t\tthis.actionsMap['shareas'] = function () {\n\t\t\tapp.map.openShare();\n\t\t};\n\n\t\tthis.actionsMap['savecomments'] = function () {\n\t\t\tif (app.isCommentEditingAllowed()) {\n\t\t\t\tapp.map.fire('postMessage', { msgId: 'UI_Save' });\n\t\t\t\tif (!app.map._disableDefaultAction['UI_Save']) {\n\t\t\t\t\tapp.map.save(false, false);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['insertmultimedia'] = function () {\n\t\t\tL.DomUtil.get('insertmultimedia').click();\n\t\t};\n\t\tthis.actionsMap['remotemultimedia'] = function () {\n\t\t\tapp.map.fire('postMessage', {\n\t\t\t\tmsgId: 'UI_InsertFile',\n\t\t\t\targs: {\n\t\t\t\t\tcallback: 'Action_InsertMultimedia',\n\t\t\t\t\tmimeTypeFilter: [\n\t\t\t\t\t\t'video/MP2T',\n\t\t\t\t\t\t'video/mp4',\n\t\t\t\t\t\t'video/mpeg',\n\t\t\t\t\t\t'video/ogg',\n\t\t\t\t\t\t'video/quicktime',\n\t\t\t\t\t\t'video/webm',\n\t\t\t\t\t\t'video/x-matroska',\n\t\t\t\t\t\t'video/x-ms-wmv',\n\t\t\t\t\t\t'video/x-msvideo',\n\t\t\t\t\t\t'audio/aac',\n\t\t\t\t\t\t'audio/flac',\n\t\t\t\t\t\t'audio/mp4',\n\t\t\t\t\t\t'audio/mpeg',\n\t\t\t\t\t\t'audio/ogg',\n\t\t\t\t\t\t'audio/x-wav',\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\n\t\tthis.actionsMap['charmapcontrol'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:InsertSymbol');\n\t\t};\n\t\tthis.actionsMap['closetablet'] = function () {\n\t\t\tapp.map.uiManager.enterReadonlyOrClose();\n\t\t};\n\n\t\tthis.actionsMap['toggledarktheme'] = function () {\n\t\t\tapp.map.uiManager.toggleDarkMode();\n\t\t};\n\t\tthis.actionsMap['invertbackground'] = function () {\n\t\t\tapp.map.uiManager.toggleInvert();\n\t\t};\n\t\tthis.actionsMap['home-search'] = function () {\n\t\t\tapp.map.uiManager.focusSearch();\n\t\t};\n\t\tthis.actionsMap['renamedocument'] = function () {\n\t\t\tapp.map.uiManager.renameDocument();\n\t\t};\n\t\tthis.actionsMap['togglewasm'] = function () {\n\t\t\tapp.map.uiManager.toggleWasm();\n\t\t};\n\n\t\tthis.actionsMap['languagemenu'] = function () {\n\t\t\tapp.map.fire('morelanguages');\n\t\t};\n\t\tthis.actionsMap['morelanguages-selection'] = function () {\n\t\t\tapp.map.fire('morelanguages', { applyto: 'selection' });\n\t\t};\n\t\tthis.actionsMap['morelanguages-paragraph'] = function () {\n\t\t\tapp.map.fire('morelanguages', { applyto: 'paragraph' });\n\t\t};\n\t\tthis.actionsMap['morelanguages-all'] = function () {\n\t\t\tapp.map.fire('morelanguages', { applyto: 'all' });\n\t\t};\n\t\tthis.actionsMap['localgraphic'] = function () {\n\t\t\tL.DomUtil.get('insertgraphic').click();\n\t\t};\n\t\tthis.actionsMap['remotegraphic'] = this.actionsMap['insertremotegraphic'] =\n\t\t\tfunction () {\n\t\t\t\tapp.map.fire('postMessage', { msgId: 'UI_InsertGraphic' });\n\t\t\t};\n\n\t\tthis.actionsMap['showhelp'] = function () {\n\t\t\tapp.map.showHelp('online-help-content');\n\t\t};\n\n\t\tthis.actionsMap['focustonotebookbar'] = function () {\n\t\t\tconst tabsContainer = document.getElementsByClassName(\n\t\t\t\t'notebookbar-tabs-container',\n\t\t\t)[0].children[0];\n\t\t\tlet elementToFocus: HTMLButtonElement;\n\t\t\tif (tabsContainer) {\n\t\t\t\tfor (let i = 0; i < tabsContainer.children.length; i++) {\n\t\t\t\t\tif (tabsContainer.children[i].classList.contains('selected')) {\n\t\t\t\t\t\telementToFocus = tabsContainer.children[i] as HTMLButtonElement;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!elementToFocus)\n\t\t\t\telementToFocus = document.getElementById(\n\t\t\t\t\t'Home-tab-label',\n\t\t\t\t) as HTMLButtonElement;\n\n\t\t\telementToFocus.focus();\n\t\t};\n\n\t\tthis.actionsMap['saveas'] = function () {\n\t\t\tif (app.map && app.map.uiManager.getCurrentMode() === 'notebookbar') {\n\t\t\t\tapp.map.openSaveAs(); // Opens save as dialog if integrator supports it.\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['insertcomment'] = function () {\n\t\t\tapp.map.insertComment();\n\t\t};\n\n\t\tthis.actionsMap['zoomin'] = () => {\n\t\t\tapp.map.zoomIn(1, null, true /* animate? */);\n\t\t};\n\t\tthis.actionsMap['zoomout'] = () => {\n\t\t\tapp.map.zoomOut(1, null, true /* animate? */);\n\t\t};\n\t\tthis.actionsMap['zoomreset'] = () => {\n\t\t\tapp.map.setZoom(app.map.options.zoom, null, true);\n\t\t};\n\n\t\tthis.actionsMap['searchprev'] = () => {\n\t\t\tapp.searchService.searchPrevious();\n\t\t};\n\t\tthis.actionsMap['searchnext'] = () => {\n\t\t\tapp.searchService.searchNext();\n\t\t};\n\t\tthis.actionsMap['cancelsearch'] = () => {\n\t\t\tapp.map.cancelSearch();\n\t\t};\n\t\tthis.actionsMap['showsearchbar'] = () => {\n\t\t\t$('#toolbar-down').hide();\n\t\t\t$('#showsearchbar').removeClass('over');\n\t\t\t$('#toolbar-search').show();\n\t\t\tL.DomUtil.get('search-input').focus();\n\t\t};\n\t\tthis.actionsMap['hidesearchbar'] = () => {\n\t\t\t$('#toolbar-search').hide();\n\t\t\tif (app.map.isEditMode()) $('#toolbar-down').show();\n\t\t\t/** show edit button if only we are able to edit but in readonly mode */\n\t\t\tif (!app.isReadOnly() && app.map.isReadOnlyMode())\n\t\t\t\t$('#mobile-edit-button').css('display', 'flex');\n\t\t};\n\n\t\tthis.actionsMap['prev'] = () => {\n\t\t\tif (app.map._docLayer._docType === 'text') app.map.goToPage('prev');\n\t\t\telse app.map.setPart('prev');\n\t\t};\n\t\tthis.actionsMap['next'] = () => {\n\t\t\tif (app.map._docLayer._docType === 'text') app.map.goToPage('next');\n\t\t\telse app.map.setPart('next');\n\t\t};\n\n\t\tthis.actionsMap['inserttextbox'] = () => {\n\t\t\tapp.map.sendUnoCommand('.uno:Text?CreateDirectly:bool=true');\n\t\t};\n\t\tthis.actionsMap['insertannotation'] = () => {\n\t\t\tapp.map.insertComment();\n\t\t};\n\n\t\tthis.actionsMap['fold'] = this.actionsMap['hamburger-tablet'] = () => {\n\t\t\tapp.map.uiManager.toggleMenubar();\n\t\t};\n\n\t\tthis.actionsMap['close'] = this.actionsMap['closemobile'] = () => {\n\t\t\tapp.map.uiManager.enterReadonlyOrClose();\n\t\t};\n\n\t\tthis.actionsMap['serveraudit'] = () => {\n\t\t\tapp.map.serverAuditDialog.open();\n\t\t};\n\n\t\tthis.actionsMap['togglea11ystate'] = () => {\n\t\t\tif (app.map._lockAccessibilityOn) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar prevAccessibilityState =\n\t\t\t\twindow.prefs.getBoolean('accessibilityState');\n\t\t\tapp.map.setAccessibilityState(!prevAccessibilityState);\n\t\t};\n\n\t\tthis.actionsMap['toggleuimode'] = () => {\n\t\t\tif (app.map.uiManager.shouldUseNotebookbarMode()) {\n\t\t\t\tapp.map.uiManager.onChangeUIMode({ mode: 'classic', force: true });\n\t\t\t} else {\n\t\t\t\tapp.map.uiManager.onChangeUIMode({ mode: 'notebookbar', force: true });\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['showruler'] = () => {\n\t\t\tapp.map.uiManager.toggleRuler();\n\t\t};\n\n\t\tthis.actionsMap['showstatusbar'] = () => {\n\t\t\tapp.map.uiManager.toggleStatusBar();\n\t\t};\n\n\t\tthis.actionsMap['collapsenotebookbar'] = () => {\n\t\t\tapp.map.uiManager.collapseNotebookbar();\n\t\t};\n\n\t\tthis.actionsMap['scrollpreviewup'] = () => {\n\t\t\tconst stylePreview = document.getElementById('stylesview');\n\t\t\tstylePreview.scrollBy({\n\t\t\t\ttop: -stylePreview.offsetHeight,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t}); // Scroll up based on stylepreview height\n\t\t};\n\n\t\tthis.actionsMap['scrollpreviewdown'] = () => {\n\t\t\tconst stylePreview = document.getElementById('stylesview');\n\t\t\tstylePreview.scrollBy({\n\t\t\t\ttop: stylePreview.offsetHeight,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t}); // Scroll up based on stylepreview height\n\t\t};\n\t}\n\n\tprivate addExportCommands() {\n\t\tthis.actionsMap['exportpdf'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:ExportToPDF', {\n\t\t\t\tSynchronMode: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: false,\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\n\t\tthis.actionsMap['exportdirectpdf'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:ExportDirectToPDF', {\n\t\t\t\tSynchronMode: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: false,\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\n\t\tthis.actionsMap['exportepub'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:ExportToEPUB', {\n\t\t\t\tSynchronMode: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: false,\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\t}\n\n\tprivate addCalcCommands() {\n\t\tthis.actionsMap['acceptformula'] = function () {\n\t\t\tif (window.mode.isMobile()) {\n\t\t\t\tapp.map.focus();\n\t\t\t\tapp.map._docLayer.postKeyboardEvent(\n\t\t\t\t\t'input',\n\t\t\t\t\tapp.map.keyboard.keyCodes.enter,\n\t\t\t\t\tapp.map.keyboard._toUNOKeyCode(app.map.keyboard.keyCodes.enter),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tapp.map.sendUnoCommand('.uno:AcceptFormula');\n\t\t\t}\n\n\t\t\tapp.map.onFormulaBarBlur();\n\t\t\tapp.map.formulabarBlur();\n\t\t\tapp.map.formulabarSetDirty();\n\t\t};\n\n\t\tthis.actionsMap['cancelformula'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:Cancel');\n\t\t\tapp.map.onFormulaBarBlur();\n\t\t\tapp.map.formulabarBlur();\n\t\t\tapp.map.formulabarSetDirty();\n\t\t};\n\n\t\tthis.actionsMap['startformula'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:StartFormula');\n\t\t\tapp.map.onFormulaBarFocus();\n\t\t\tapp.map.formulabarFocus();\n\t\t\tapp.map.formulabarSetDirty();\n\t\t};\n\n\t\tthis.actionsMap['functiondialog'] = function () {\n\t\t\tif (window.mode.isMobile() && app.map._functionWizardData) {\n\t\t\t\tapp.map._docLayer._closeMobileWizard();\n\t\t\t\tapp.map._docLayer._openMobileWizard(app.map._functionWizardData);\n\t\t\t\tapp.map.formulabarSetDirty();\n\t\t\t} else {\n\t\t\t\tapp.map.sendUnoCommand('.uno:FunctionDialog');\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['print-active-sheet'] = function () {\n\t\t\tconst currentSheet = app.map._docLayer._selectedPart + 1;\n\t\t\tconst options = {\n\t\t\t\tExportFormFields: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: false,\n\t\t\t\t},\n\t\t\t\tExportNotes: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tvalue: false,\n\t\t\t\t},\n\t\t\t\tSheetRange: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tvalue: currentSheet + '-' + currentSheet,\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst optionsString = JSON.stringify(options);\n\t\t\tapp.map.print(optionsString);\n\t\t};\n\n\t\tthis.actionsMap['print-all-sheets'] = function () {\n\t\t\tapp.map.print();\n\t\t};\n\t\tthis.actionsMap['togglerelative'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:ToggleRelative');\n\t\t};\n\t\tthis.actionsMap['focusonaddressinput'] = function () {\n\t\t\tdocument.getElementById('#addressInput input').focus();\n\t\t};\n\n\t\t// sheets toolbar\n\t\tthis.actionsMap['insertsheet'] = function () {\n\t\t\tvar nPos = $('#spreadsheet-tab-scroll')[0].childElementCount;\n\t\t\tapp.map.insertPage(nPos);\n\t\t\tapp.map.insertPage.scrollToEnd = true;\n\t\t};\n\t\tthis.actionsMap['firstrecord'] = function () {\n\t\t\t$('#spreadsheet-tab-scroll').scrollLeft(0);\n\t\t};\n\t\tthis.actionsMap['nextrecord'] = function () {\n\t\t\t// TODO: We should get visible tab's width instead of 60px\n\t\t\t$('#spreadsheet-tab-scroll').scrollLeft(\n\t\t\t\t$('#spreadsheet-tab-scroll').scrollLeft() + 60,\n\t\t\t);\n\t\t};\n\t\tthis.actionsMap['prevrecord'] = function () {\n\t\t\t$('#spreadsheet-tab-scroll').scrollLeft(\n\t\t\t\t$('#spreadsheet-tab-scroll').scrollLeft() - 30,\n\t\t\t);\n\t\t};\n\t\tthis.actionsMap['lastrecord'] = function () {\n\t\t\t// Set a very high value, so that scroll is set to the maximum possible value internally.\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollLeft\n\t\t\tL.DomUtil.get('spreadsheet-tab-scroll').scrollLeft = 100000;\n\t\t};\n\t\tthis.actionsMap['columnrowhighlight'] = function () {\n\t\t\tvar newState = !app.map.uiManager.getHighlightMode();\n\t\t\tapp.map.uiManager.setHighlightMode(newState);\n\n\t\t\tif (newState) FocusCellSection.showFocusCellSection();\n\t\t\telse FocusCellSection.hideFocusCellSection();\n\n\t\t\tapp.sectionContainer.requestReDraw();\n\t\t};\n\t}\n\n\tprivate addImpressAndDrawCommands() {\n\t\tthis.actionsMap['presentation'] = this.actionsMap[\n\t\t\t'fullscreen-presentation'\n\t\t] = () => {\n\t\t\tif ((window as any).canvasSlideshowEnabled) app.map.fire('newfullscreen');\n\t\t\telse app.map.fire('fullscreen');\n\t\t};\n\n\t\tthis.actionsMap['presentation-currentslide'] = this.actionsMap[\n\t\t\t'presentation-currentslide'\n\t\t] = () => {\n\t\t\tif ((window as any).canvasSlideshowEnabled)\n\t\t\t\tapp.map.fire('newfullscreen', {\n\t\t\t\t\tstartSlideNumber: app.map.getCurrentPartNumber(),\n\t\t\t\t});\n\t\t\telse\n\t\t\t\tapp.map.fire('fullscreen', {\n\t\t\t\t\tstartSlideNumber: app.map.getCurrentPartNumber(),\n\t\t\t\t});\n\t\t};\n\n\t\tthis.actionsMap['presentinwindow'] = this.actionsMap['present-in-window'] =\n\t\t\t() => {\n\t\t\t\tif ((window as any).canvasSlideshowEnabled)\n\t\t\t\t\tapp.map.fire('newpresentinwindow');\n\t\t\t\telse app.map.fire('presentinwindow');\n\t\t\t};\n\n\t\tthis.actionsMap['presenterconsole'] = () => {\n\t\t\tif ((window as any).canvasSlideshowEnabled)\n\t\t\t\tapp.map.fire('newpresentinconsole');\n\t\t};\n\n\t\tthis.actionsMap['fullscreen-drawing'] = () => {\n\t\t\tapp.util.toggleFullScreen();\n\t\t};\n\n\t\tthis.actionsMap['deletepage'] = function () {\n\t\t\tlet msg: string;\n\t\t\tif (app.map.getDocType() === 'presentation') {\n\t\t\t\tmsg = _('Are you sure you want to delete this slide?');\n\t\t\t} else {\n\t\t\t\t/* drawing */\n\t\t\t\tmsg = _('Are you sure you want to delete this page?');\n\t\t\t}\n\t\t\tapp.map.uiManager.showInfoModal(\n\t\t\t\t'deleteslide-modal',\n\t\t\t\t_('Delete'),\n\t\t\t\tmsg,\n\t\t\t\t'',\n\t\t\t\t_('OK'),\n\t\t\t\tfunction () {\n\t\t\t\t\tapp.map.deletePage();\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t\t'deleteslide-modal-response',\n\t\t\t);\n\t\t};\n\n\t\tthis.actionsMap['previouspart'] = function () {\n\t\t\tapp.map._docLayer._preview._scrollViewByDirection('prev');\n\t\t};\n\n\t\tthis.actionsMap['nextpart'] = function () {\n\t\t\tapp.map._docLayer._preview._scrollViewByDirection('next');\n\t\t};\n\n\t\tthis.actionsMap['lastpart'] = function () {\n\t\t\tif (app && app.file.fileBasedView === true) {\n\t\t\t\tconst partToSelect = app.map._docLayer._parts - 1;\n\t\t\t\tapp.map._docLayer._preview._scrollViewToPartPosition(partToSelect);\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['firstpart'] = function () {\n\t\t\tif (app && app.file.fileBasedView === true) {\n\t\t\t\tconst partToSelect = 0;\n\t\t\t\tapp.map._docLayer._preview._scrollViewToPartPosition(partToSelect);\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['hideslide'] = function () {\n\t\t\tapp.map.hideSlide();\n\t\t};\n\t\tthis.actionsMap['showslide'] = function () {\n\t\t\tapp.map.showSlide();\n\t\t};\n\t\tthis.actionsMap['duplicatepage'] = function () {\n\t\t\tapp.map.duplicatePage();\n\t\t};\n\t\tthis.actionsMap['insertpage'] = function () {\n\t\t\tapp.map.insertPage();\n\t\t};\n\n\t\tthis.actionsMap['leftpara'] = function () {\n\t\t\tapp.map.sendUnoCommand(\n\t\t\t\t(window as any).getUNOCommand({\n\t\t\t\t\ttextCommand: '.uno:LeftPara',\n\t\t\t\t\tobjectCommand: '.uno:ObjectAlignLeft',\n\t\t\t\t\tunosheet: '.uno:AlignLeft',\n\t\t\t\t}),\n\t\t\t);\n\t\t};\n\t\tthis.actionsMap['centerpara'] = function () {\n\t\t\tapp.map.sendUnoCommand(\n\t\t\t\t(window as any).getUNOCommand({\n\t\t\t\t\ttextCommand: '.uno:CenterPara',\n\t\t\t\t\tobjectCommand: '.uno:AlignCenter',\n\t\t\t\t\tunosheet: '.uno:AlignHorizontalCenter',\n\t\t\t\t}),\n\t\t\t);\n\t\t};\n\t\tthis.actionsMap['rightpara'] = function () {\n\t\t\tapp.map.sendUnoCommand(\n\t\t\t\t(window as any).getUNOCommand({\n\t\t\t\t\ttextCommand: '.uno:RightPara',\n\t\t\t\t\tobjectCommand: '.uno:ObjectAlignRight',\n\t\t\t\t\tunosheet: '.uno:AlignRight',\n\t\t\t\t}),\n\t\t\t);\n\t\t};\n\n\t\tthis.actionsMap['selectbackground'] = function () {\n\t\t\tL.DomUtil.get('selectbackground').click();\n\t\t};\n\n\t\tthis.actionsMap['notesmode'] = function () {\n\t\t\tif (app.impress.notesMode)\n\t\t\t\tapp.map.sendUnoCommand('.uno:NormalMultiPaneGUI');\n\t\t\telse app.map.sendUnoCommand('.uno:NotesMode');\n\t\t};\n\t}\n\n\tprivate addZoteroCommands() {\n\t\tthis.actionsMap['zoteroaddeditcitation'] = function () {\n\t\t\tapp.map.zotero.handleItemList();\n\t\t};\n\t\tthis.actionsMap['zoterosetdocprefs'] = function () {\n\t\t\tapp.map.zotero.handleStyleList();\n\t\t};\n\t\tthis.actionsMap['zoteroaddeditbibliography'] = function () {\n\t\t\tapp.map.zotero.insertBibliography();\n\t\t};\n\t\tthis.actionsMap['zoteroaddnote'] = function () {\n\t\t\tapp.map.zotero.handleInsertNote();\n\t\t};\n\t\tthis.actionsMap['zoterorefresh'] = function () {\n\t\t\tapp.map.zotero.refreshCitationsAndBib();\n\t\t};\n\t\tthis.actionsMap['zoterounlink'] = function () {\n\t\t\tapp.map.zotero.unlinkCitations();\n\t\t};\n\t}\n\n\tprivate addWriterCommands() {\n\t\tthis.actionsMap['.uno:ShowResolvedAnnotations'] = function () {\n\t\t\tconst items = app.map['stateChangeHandler'];\n\t\t\tlet val = items.getItemValue('.uno:ShowResolvedAnnotations');\n\t\t\tval = val === 'true' || val === true;\n\t\t\tapp.map.showResolvedComments(!val);\n\t\t};\n\n\t\tthis.actionsMap['showannotations'] = function () {\n\t\t\tconst items = app.map['stateChangeHandler'];\n\t\t\tlet val = items.getItemValue('showannotations');\n\t\t\tval = val === 'true' || val === true;\n\t\t\tapp.map.showComments(!val);\n\t\t};\n\n\t\tthis.actionsMap['.uno:AcceptAllTrackedChanges'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:AcceptAllTrackedChanges');\n\t\t\tapp.socket.sendMessage('commandvalues command=.uno:ViewAnnotations');\n\t\t};\n\n\t\tthis.actionsMap['.uno:RejectAllTrackedChanges'] = function () {\n\t\t\tapp.map.sendUnoCommand('.uno:RejectAllTrackedChanges');\n\t\t\tconst commentSection = app.sectionContainer.getSectionWithName(\n\t\t\t\tL.CSections.CommentList.name,\n\t\t\t);\n\t\t\tcommentSection.rejectAllTrackedCommentChanges();\n\t\t};\n\t}\n\n\tprivate addMobileCommands() {\n\t\tthis.actionsMap['comment_wizard'] = function () {\n\t\t\tconst configuration = window as any;\n\t\t\tif (configuration.commentWizard) {\n\t\t\t\tconfiguration.commentWizard = false;\n\t\t\t\tapp.sectionContainer\n\t\t\t\t\t.getSectionWithName(L.CSections.CommentList.name)\n\t\t\t\t\t.removeHighlighters();\n\t\t\t\tapp.map.fire('closemobilewizard');\n\t\t\t\tapp.map.mobileTopBar.selectItem('comment_wizard', false);\n\t\t\t} else {\n\t\t\t\tif (configuration.insertionMobileWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('insertion_mobile_wizard');\n\t\t\t\telse if (configuration.mobileWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('mobile_wizard');\n\t\t\t\tconfiguration.commentWizard = true;\n\t\t\t\tvar menuData = app.map._docLayer.getCommentWizardStructure();\n\t\t\t\tapp.map.fire('mobilewizard', { data: menuData });\n\t\t\t\tapp.map.mobileTopBar.selectItem('comment_wizard', true);\n\t\t\t}\n\t\t};\n\t\tthis.actionsMap['mobile_wizard'] = () => {\n\t\t\tconst configuration = window as any;\n\t\t\tif (configuration.mobileWizard) {\n\t\t\t\tconfiguration.mobileWizard = false;\n\t\t\t\tapp.map.sendUnoCommand('.uno:SidebarHide');\n\t\t\t\tapp.map.fire('closemobilewizard');\n\t\t\t\tapp.map.mobileTopBar.selectItem('mobile_wizard', false);\n\t\t\t} else {\n\t\t\t\tif (configuration.insertionMobileWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('insertion_mobile_wizard');\n\t\t\t\telse if (configuration.commentWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('comment_wizard');\n\t\t\t\tconfiguration.mobileWizard = true;\n\t\t\t\tapp.map.sendUnoCommand('.uno:SidebarShow');\n\t\t\t\tapp.map.fire('showwizardsidebar');\n\t\t\t\tapp.map.mobileTopBar.selectItem('mobile_wizard', true);\n\t\t\t}\n\t\t};\n\t\tthis.actionsMap['insertion_mobile_wizard'] = () => {\n\t\t\tconst configuration = window as any;\n\t\t\tif (configuration.insertionMobileWizard) {\n\t\t\t\tconfiguration.insertionMobileWizard = false;\n\t\t\t\tapp.map.fire('closemobilewizard');\n\t\t\t\tapp.map.mobileTopBar.selectItem('insertion_mobile_wizard', false);\n\t\t\t} else {\n\t\t\t\tif (configuration.mobileWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('mobile_wizard');\n\t\t\t\telse if (configuration.commentWizard)\n\t\t\t\t\tapp.dispatcher.dispatch('comment_wizard');\n\t\t\t\tconfiguration.insertionMobileWizard = true;\n\t\t\t\tconst menuData = app.map.menubar.generateInsertMenuStructure();\n\t\t\t\tapp.map.fire('mobilewizard', { data: menuData });\n\t\t\t\tapp.map.mobileTopBar.selectItem('insertion_mobile_wizard', true);\n\t\t\t}\n\t\t};\n\n\t\tthis.actionsMap['fontcolor'] = () => {\n\t\t\tapp.map.fire('mobilewizard', {\n\t\t\t\tdata: (window as any).getColorPickerData('Font Color'),\n\t\t\t});\n\t\t};\n\t\tthis.actionsMap['backcolor'] = () => {\n\t\t\tapp.map.fire('mobilewizard', {\n\t\t\t\tdata: (window as any).getColorPickerData('Highlight Color'),\n\t\t\t});\n\t\t};\n\t\t// TODO: leftover from mobile bottom bar\n\t\t// if (id === 'fontcolor' && typeof e.color !== 'undefined') {\n\t\t// \tonColorPick(id, e.color, e.themeData);\n\t\t// }\n\t\t// else if (id === 'backcolor' && typeof e.color !== 'undefined') {\n\t\t// \tonColorPick(id, e.color, e.themeData);\n\t\t// }\n\t\t// else if (id === 'backgroundcolor' && typeof e.color !== 'undefined') {\n\t\t// \tonColorPick(id, e.color, e.themeData);\n\t\t// }\n\t}\n\n\t/// optional docType specifies which commands should we load\n\tconstructor(docType: string = undefined) {\n\t\tdocType = docType ? docType : app.map._docLayer._docType;\n\n\t\tthis.addGeneralCommands();\n\t\tthis.addExportCommands();\n\n\t\tif (docType === 'text') {\n\t\t\tthis.addWriterCommands();\n\t\t\tthis.addZoteroCommands();\n\t\t} else if (docType === 'spreadsheet') {\n\t\t\tthis.addCalcCommands();\n\t\t} else if (['presentation', 'drawing'].includes(docType)) {\n\t\t\tthis.addImpressAndDrawCommands();\n\t\t}\n\n\t\tif (window.mode.isMobile()) this.addMobileCommands();\n\t}\n\n\tpublic dispatch(action: string) {\n\t\t// Don't allow to execute new actions while any dialog is visible.\n\t\t// It prevents launching multiple instances of the same dialog.\n\t\tif (\n\t\t\tapp.map.dialog.hasOpenedDialog() ||\n\t\t\t(app.map.jsdialog && app.map.jsdialog.hasDialogOpened())\n\t\t) {\n\t\t\tapp.map.dialog.blinkOpenDialog();\n\t\t\tconsole.debug('Cannot dispatch: ' + action + ' when dialog is opened.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.indexOf('saveas-') === 0) {\n\t\t\tconst format = action.substring('saveas-'.length);\n\t\t\tapp.map.openSaveAs(format);\n\t\t\treturn;\n\t\t} else if (action.indexOf('downloadas-') === 0) {\n\t\t\tconst format = action.substring('downloadas-'.length);\n\t\t\tlet fileName = app.map['wopi'].BaseFileName;\n\t\t\tfileName = fileName.substr(0, fileName.lastIndexOf('.'));\n\t\t\tfileName = fileName === '' ? 'document' : fileName;\n\t\t\tapp.map.downloadAs(fileName + '.' + format, format);\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.indexOf('exportas-') === 0) {\n\t\t\tconst format = action.substring('exportas-'.length);\n\t\t\tapp.map.openSaveAs(format);\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\taction === '.uno:Copy' ||\n\t\t\taction === '.uno:Cut' ||\n\t\t\taction === '.uno:Paste' ||\n\t\t\taction === '.uno:PasteSpecial'\n\t\t) {\n\t\t\tapp.map._clip.filterExecCopyPaste(action);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.actionsMap[action] !== undefined) {\n\t\t\tthis.actionsMap[action]();\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.error('unknown dispatch: \"' + action + '\"');\n\t}\n}\n\napp.definitions['dispatcher'] = Dispatcher;\n"]}