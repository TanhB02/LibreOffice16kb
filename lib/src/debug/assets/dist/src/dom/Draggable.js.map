{"version":3,"file":"Draggable.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/dom/Draggable.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/* global app */\n/*\n * L.Draggable allows you to add dragging capabilities to any element. Supports mobile devices too.\n */\n\nL.Draggable = L.Evented.extend({\n\n\tstatics: {\n\t\tSTART: ['touchstart', 'mousedown'],\n\t\tEND: {\n\t\t\tmousedown: 'mouseup',\n\t\t\ttouchstart: 'touchend',\n\t\t\tpointerdown: 'touchend',\n\t\t\tMSPointerDown: 'touchend'\n\t\t},\n\t\tMOVE: {\n\t\t\tmousedown: 'mousemove',\n\t\t\ttouchstart: 'touchmove',\n\t\t\tpointerdown: 'touchmove',\n\t\t\tMSPointerDown: 'touchmove'\n\t\t}\n\t},\n\n\t_manualDrag: function() {\n\t\treturn false;\n\t},\n\n\tnoManualDrag: window.memo.decorator(function(f) {\n\t\treturn function(e) {\n\t\t\tif (!this._manualDrag(e)) {\n\t\t\t\treturn f.apply(this, arguments);\n\t\t\t}\n\t\t};\n\t}),\n\n\tinitialize: function (element, dragStartTarget, preventOutline) {\n\n\t\tL.Evented.prototype.initialize.call(this);\n\n\t\tthis._element = element;\n\t\tthis._dragStartTarget = dragStartTarget || element;\n\t\tthis._preventOutline = preventOutline;\n\t\tthis._freezeX = false;\n\t\tthis._freezeY = false;\n\t},\n\n\tfreezeX: function (boolChoice) {\n\t\tthis._freezeX = boolChoice;\n\t},\n\n\tfreezeY: function (boolChoice) {\n\t\tthis._freezeY = boolChoice;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tL.DomEvent.on(this._dragStartTarget, L.Draggable.START.join(' '), this.noManualDrag(this._onDown), this);\n\n\t\tthis._enabled = true;\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tL.DomEvent.off(this._dragStartTarget, L.Draggable.START.join(' '), this.noManualDrag(this._onDown), this);\n\n\t\tthis._enabled = false;\n\t\tthis._moved = false;\n\t},\n\n\t_onDown: function (e) {\n\t\tthis._moved = false;\n\n\t\tif (e.shiftKey || ((e.which !== 1) && (e.button !== 0) && !e.touches)) { return; }\n\n\t\t// enable propagation of the mousedown event from map pane to parent elements in view mode\n\t\t// see bug bccu1446\n\t\tif (!L.DomUtil.hasClass(this._element, 'leaflet-map-pane')) {\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t}\n\n\t\tif (this._preventOutline) {\n\t\t\tL.DomUtil.preventOutline(this._element);\n\t\t}\n\n\t\tL.DomUtil.disableImageDrag();\n\t\tL.DomUtil.disableTextSelection();\n\n\t\tif (this._moving) { return; }\n\n\t\tthis.fire('down');\n\n\t\tvar first = e.touches ? e.touches[0] : e;\n\n\t\tthis._startPoint = new L.Point(first.clientX, first.clientY);\n\t\tthis._startPos = this._newPos = L.DomUtil.getPosition(this._element);\n\t\tvar startBoundingRect = this._element.getBoundingClientRect();\n\t\t// Store offset between mouse selection position, and top left\n\t\t// We don't use this internally, but it is needed for external\n\t\t// manipulation of the cursor position, e.g. when adjusting\n\t\t// for scrolling during cursor dragging.\n\t\tthis.startOffset = this._startPoint.subtract(new L.Point(startBoundingRect.left, startBoundingRect.top));\n\n\t\tL.DomEvent\n\t\t .on(document, L.Draggable.MOVE[e.type], this.noManualDrag(this._onMove), this)\n\t\t .on(document, L.Draggable.END[e.type], this.noManualDrag(this._onUp), this);\n\t},\n\n\t_onMove: function (e) {\n\t\tif (!this._startPoint) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.touches && e.touches.length > 1) {\n\t\t\tthis._moved = true;\n\t\t\treturn;\n\t\t}\n\n\t\tvar first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\n\t\t    newPoint = new L.Point(first.clientX, first.clientY),\n\t\t    offset = newPoint.subtract(this._startPoint);\n\n\t\tif (this._map) {\n\t\t\tif (this._map._docLayer.isCalcRTL()) {\n\t\t\t\toffset.x = -offset.x;\n\t\t\t}\n\n\t\t\t// needed in order to avoid a jump when the document is dragged and the mouse pointer move\n\t\t\t// from over the map into the html document element area which is not covered by tiles\n\t\t\t// (resize-detector iframe)\n\t\t\tif (e.currentTarget && e.currentTarget.frameElement\n\t\t\t\t&& L.DomUtil.hasClass(e.currentTarget.frameElement, 'resize-detector')) {\n\t\t\t\tvar rect = this._map._container.getBoundingClientRect(),\n\t\t\t\t    correction = new L.Point(rect.left, rect.top);\n\t\t\t\toffset = offset.add(correction);\n\t\t\t}\n\t\t\tif (this._map.getDocSize().x < this._map.getSize().x) {\n\t\t\t\t// don't pan horizontally when the document fits in the viewing\n\t\t\t\t// area horizontally (docWidth < viewAreaWidth)\n\t\t\t\toffset.x = 0;\n\t\t\t}\n\t\t\tif (this._map.getDocSize().y < this._map.getSize().y) {\n\t\t\t\t// don't pan vertically when the document fits in the viewing\n\t\t\t\t// area horizontally (docHeight < viewAreaHeight)\n\t\t\t\toffset.y = 0;\n\t\t\t}\n\t\t}\n\t\tif (!offset.x && !offset.y) { return; }\n\t\tif (window.touch.isTouchEvent(e) && Math.abs(offset.x) + Math.abs(offset.y) < 3 && !e.autoscroll) { return; }\n\n\t\tL.DomEvent.preventDefault(e);\n\n\t\tif (!this._moved) {\n\t\t\tthis.fire('dragstart', {originalEvent: e});\n\n\t\t\tthis._moved = true;\n\t\t\tthis._startPos = L.DomUtil.getPosition(this._element).subtract(offset);\n\n\t\t\tL.DomUtil.addClass(document.body, 'leaflet-dragging');\n\n\t\t\tthis._lastTarget = e.target || e.srcElement;\n\t\t\tL.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');\n\t\t}\n\n\t\tthis._newPos = this._startPos.add(offset);\n\n\t\tif (this._freezeY)\n\t\t\tthis._newPos.y = this._startPos.y;\n\t\tif (this._freezeX)\n\t\t\tthis._newPos.x = this._startPos.x;\n\n\t\tthis._moving = true;\n\n\t\tapp.util.cancelAnimFrame(this._animRequest);\n\t\tthis._lastEvent = e;\n\n\t\tthis._animRequest = app.util.requestAnimFrame(this._updatePosition, this);\n\t},\n\n\t_updatePosition: function () {\n\t\tvar e = {originalEvent: this._lastEvent};\n\t\tthis.fire('predrag', e);\n\t\tL.DomUtil.setPosition(this._element, this._newPos);\n\t\tthis.fire('drag', e);\n\t},\n\n\t_onUp: function (e) {\n\t\tL.DomUtil.removeClass(document.body, 'leaflet-dragging');\n\n\t\tif (this._lastTarget) {\n\t\t\tL.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');\n\t\t\tthis._lastTarget = null;\n\t\t}\n\n\t\tfor (var i in L.Draggable.MOVE) {\n\t\t\tL.DomEvent\n\t\t\t .off(document, L.Draggable.MOVE[i], this.noManualDrag(this._onMove), this)\n\t\t\t .off(document, L.Draggable.END[i], this.noManualDrag(this._onUp), this);\n\t\t}\n\n\t\tL.DomUtil.enableImageDrag();\n\t\tL.DomUtil.enableTextSelection();\n\n\t\tif (this._moved && this._moving) {\n\t\t\t// ensure drag is not fired after dragend\n\t\t\tapp.util.cancelAnimFrame(this._animRequest);\n\n\t\t\tthis.fire('dragend', {\n\t\t\t\toriginalEvent: e,\n\t\t\t\tdistance: this._newPos.distanceTo(this._startPos)\n\t\t\t});\n\t\t} else {\n\t\t\tthis.fire('up', {originalEvent: e});\n\t\t}\n\n\t\tthis._moving = false;\n\t\tthis._startPoint = undefined;\n\t}\n});\n"]}