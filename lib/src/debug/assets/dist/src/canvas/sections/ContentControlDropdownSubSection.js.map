{"version":3,"file":"ContentControlDropdownSubSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/ContentControlDropdownSubSection.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nclass ContentControlDropdownSubSection extends HTMLObjectSection {\n\tconstructor(\n\t\tsectionName: string,\n\t\tdocumentPosition: cool.SimplePoint,\n\t\tvisible: boolean = true,\n\t\tdropdownMarkerWidth: number,\n\t\tdropdownMarkerHeight: number,\n\t) {\n\t\tsuper(\n\t\t\tsectionName,\n\t\t\tdropdownMarkerWidth,\n\t\t\tdropdownMarkerHeight,\n\t\t\tdocumentPosition,\n\t\t\t'writer-drop-down-marker',\n\t\t\tvisible,\n\t\t);\n\t}\n\n\tprivate callback(\n\t\tobjectType: any,\n\t\teventType: any,\n\t\tobject: any,\n\t\tdata: any,\n\t\tbuilder: any,\n\t): void {\n\t\tvar fireEvent: string = 'jsdialog';\n\t\tif ((<any>window).mode.isMobile()) {\n\t\t\tfireEvent = 'mobilewizard';\n\t\t}\n\t\tvar closeDropdownJson = {\n\t\t\tjsontype: 'dialog',\n\t\t\ttype: 'modalpopup',\n\t\t\taction: 'close',\n\t\t\tid: builder.windowId,\n\t\t};\n\n\t\tif (eventType === 'close') {\n\t\t\tapp.map.fire(fireEvent, { data: closeDropdownJson, callback: undefined });\n\t\t} else if (eventType === 'select') {\n\t\t\tapp.socket.sendMessage(\n\t\t\t\t'contentcontrolevent type=drop-down selected=' + data,\n\t\t\t);\n\t\t\tapp.map.fire(fireEvent, { data: closeDropdownJson, callback: undefined });\n\t\t}\n\t}\n\n\tprivate showDatePicker(): void {\n\t\tif ($('#datepicker').is(':visible')) {\n\t\t\t$('#datepicker').hide();\n\t\t} else {\n\t\t\tvar datePicker = document.getElementById('datepicker');\n\t\t\tdatePicker.style.left = String(this.myTopLeft[0] / app.dpiScale) + 'px';\n\t\t\tdatePicker.style.top =\n\t\t\t\tString((this.myTopLeft[1] + this.size[1]) / app.dpiScale) + 'px';\n\t\t\t$('#datepicker').show();\n\t\t}\n\t}\n\n\tprivate getDropdownJson(): any {\n\t\tif (!this.sectionProperties.json.items) return;\n\n\t\tconst json: any = {\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: 'container-dropdown',\n\t\t\t\t\ttype: 'container',\n\t\t\t\t\ttext: '',\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'contentControlList',\n\t\t\t\t\t\t\ttype: 'treelistbox',\n\t\t\t\t\t\t\ttext: '',\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\tsingleclickactivate: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvertical: true,\n\t\t\t\t},\n\t\t\t],\n\t\t\tjsontype: 'dialog',\n\t\t\ttype: 'modalpopup',\n\t\t\tcancellable: true,\n\t\t\tpopupParent: '_POPOVER_',\n\t\t\tclickToClose: '_POPOVER_',\n\t\t\tid: 'contentControlModalpopup',\n\t\t\tisPopupPartialScreen: true,\n\t\t};\n\n\t\tconst entries = [];\n\t\tconst items = this.sectionProperties.json.items;\n\n\t\t//add entries\n\t\tfor (var i in items) {\n\t\t\tvar entry = {\n\t\t\t\ttext: items[i],\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: items[i],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\trow: i.toString(),\n\t\t\t};\n\t\t\tentries.push(entry);\n\t\t}\n\t\tjson.children[0].children[0].entries = entries;\n\n\t\t//add position\n\t\tjson.posx =\n\t\t\t(this.myTopLeft[0] - this.sectionProperties.parent.size[0]) /\n\t\t\tapp.dpiScale;\n\t\tjson.posy = (this.myTopLeft[1] + this.size[1]) / app.dpiScale;\n\n\t\treturn json;\n\t}\n\n\tonMouseEnter(point: Array<number>, e: MouseEvent): void {\n\t\tapp.map.dontHandleMouse = true;\n\t}\n\n\tonMouseLeave(point: Array<number>, e: MouseEvent): void {\n\t\tapp.map.dontHandleMouse = false;\n\t}\n\n\tpublic containsPoint(point: number[]) {\n\t\tif (\n\t\t\tthis.position[0] <= point[0] &&\n\t\t\tthis.position[0] + this.size[0] >= point[0]\n\t\t) {\n\t\t\tif (\n\t\t\t\tthis.position[1] <= point[1] &&\n\t\t\t\tthis.position[1] + this.size[1] >= point[1]\n\t\t\t)\n\t\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonClick(point: number[], e: MouseEvent): void {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tthis.stopPropagating();\n\n\t\tif (this.sectionProperties.datePicker) {\n\t\t\tthis.showDatePicker();\n\t\t} else if (this.sectionProperties.json.items) {\n\t\t\tvar fireEvent: string = 'jsdialog';\n\t\t\tif ((<any>window).mode.isMobile()) {\n\t\t\t\tfireEvent = 'mobilewizard';\n\t\t\t}\n\t\t\tapp.map.fire(fireEvent, {\n\t\t\t\tdata: this.getDropdownJson(),\n\t\t\t\tcallback: this.callback,\n\t\t\t});\n\t\t}\n\t}\n}\n\napp.definitions.contentControlDropdownSubSection =\n\tContentControlDropdownSubSection;\n"]}