{"version":3,"file":"CellSelectionHandleSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/CellSelectionHandleSection.ts"],"names":[],"mappings":"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","sourcesContent":["/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nclass CellSelectionHandle extends app.definitions.canvasSectionObject {\n\tshowSection: boolean = false;\n\tprocessingOrder: number = L.CSections.DefaultForDocumentObjects.processingOrder;\n\tdrawingOrder: number = L.CSections.DefaultForDocumentObjects.drawingOrder;\n\tzIndex: number = L.CSections.DefaultForDocumentObjects.zIndex;\n\tdocumentObject: boolean = true;\n\n\tconstructor (name: string) {\n        super();\n\n\t\tthis.sectionProperties.circleRadius = 10 * app.dpiScale;\n\t\tthis.size = [this.sectionProperties.circleRadius * 2, this.sectionProperties.circleRadius * 2];\n\n\t\tthis.name = name; // There will be multiple instances of this class. For the viewer's cursor, name will be owncellcursor. Others will have viewId-cellcursor.\n\t}\n\n\tprivate onDragEnd(point: number[]) {\n\t\tapp.map.focus();\n\t\tapp.map.fire('scrollvelocity', {vx: 0, vy: 0});\n\n\t\tconst newPoint = new cool.SimplePoint(0, 0);\n\t\tnewPoint.pX = this.position[0] + point[0];\n\t\tnewPoint.pY = this.position[1] + point[1];\n\n\t\tthis.sharedOnDragAndEnd(newPoint);\n\t\tapp.map._docLayer._onUpdateCellResizeMarkers();\n\t\tapp.map.scrollingIsHandled = false;\n\t}\n\n\tprivate sharedOnDragAndEnd(point: cool.SimplePoint) {\n\t\tconst type = this.name === 'cell_selection_handle_start' ? 'start' : 'end';\n\t\tapp.map._docLayer._postSelectTextEvent(type, point.x, point.y);\n\t}\n\n\tprivate onDrag(point: number[]) {\n\t\tconst newPoint = new cool.SimplePoint(0, 0);\n\t\tnewPoint.pX = this.position[0] + point[0];\n\t\tnewPoint.pY = this.position[1] + point[1];\n\n\t\tapp.map.fire('handleautoscroll', { pos: { x: newPoint.cX, y: newPoint.cY }, map: app.map });\n\n\t\tthis.sharedOnDragAndEnd(newPoint);\n\t}\n\n\tpublic onDraw() {\n\t\tthis.context.strokeStyle = (<any>window).prefs.getBoolean('darkTheme') ? 'white' : 'black';\n\t\tthis.context.lineWidth = 2;\n\n\t\tthis.context.beginPath();\n\t\tthis.context.arc(this.sectionProperties.circleRadius, this.sectionProperties.circleRadius, this.sectionProperties.circleRadius, 0, 2 * Math.PI);\n\t\tthis.context.stroke();\n\t}\n\n\tonMouseMove(point: number[], dragDistance: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\tapp.map.scrollingIsHandled = true;\n\t\t\tthis.stopPropagating();\n\t\t\tthis.onDrag(point);\n\t\t}\n\t}\n\n\tonMouseDown(point: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tthis.stopPropagating();\n\t}\n\n\tonMouseUp(point: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\tthis.stopPropagating();\n\t\t\tthis.onDragEnd(point);\n\t\t}\n\t}\n}\n\napp.definitions.cellSelectionHandle = CellSelectionHandle;\n"]}