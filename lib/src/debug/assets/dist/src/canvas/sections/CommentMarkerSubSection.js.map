{"version":3,"file":"CommentMarkerSubSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/CommentMarkerSubSection.ts"],"names":[],"mappings":"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","sourcesContent":["/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n\tThis class is for Impress's and Draw's comment markers.\n\tThis is a sub section, needs to know about the parent section.\n*/\n\nclass CommentMarkerSubSection extends HTMLObjectSection {\n\tconstructor(\n\t\tsectionName: string,\n\t\tobjectWidth: number,\n\t\tobjectHeight: number,\n\t\tdocumentPosition: cool.SimplePoint,\n\t\textraClass: string = '',\n\t\tshowSection: boolean = false,\n\t\tparentSection: any, // Parent section.\n\t\tdata: any, // Parent section's data.\n\t) {\n\t\tsuper(\n\t\t\tsectionName,\n\t\t\tobjectWidth,\n\t\t\tobjectHeight,\n\t\t\tdocumentPosition,\n\t\t\textraClass,\n\t\t\tshowSection,\n\t\t);\n\t\tthis.sectionProperties.parentSection = parentSection;\n\t\tthis.sectionProperties.data = data;\n\t\tthis.sectionProperties.dragStartPosition = null;\n\t}\n\n\tprivate sendAnnotationPositionChange(newPosition: number[]): void {\n\t\tif (app.file.fileBasedView) {\n\t\t\tapp.map.setPart(this.sectionProperties.docLayer._selectedPart, false);\n\t\t\tnewPosition[1] -= this.sectionProperties.data.yAddition;\n\t\t}\n\n\t\tconst comment = {\n\t\t\tId: {\n\t\t\t\ttype: 'string',\n\t\t\t\tvalue: this.sectionProperties.data.id,\n\t\t\t},\n\t\t\tPositionX: {\n\t\t\t\ttype: 'int32',\n\t\t\t\tvalue: newPosition[0],\n\t\t\t},\n\t\t\tPositionY: {\n\t\t\t\ttype: 'int32',\n\t\t\t\tvalue: newPosition[1],\n\t\t\t},\n\t\t};\n\t\tapp.map.sendUnoCommand('.uno:EditAnnotation', comment);\n\n\t\tif (app.file.fileBasedView) app.setPart(0, false);\n\t}\n\n\tonMouseMove(\n\t\tpoint: Array<number>,\n\t\tdragDistance: Array<number>,\n\t\te: MouseEvent,\n\t): void {\n\t\tif (this.sectionProperties.parentSection === null) return;\n\n\t\tif (app.sectionContainer.isDraggingSomething()) {\n\t\t\t(<any>window).IgnorePanning = true;\n\n\t\t\tif (this.sectionProperties.parent === null) return;\n\n\t\t\tif (this.sectionProperties.dragStartPosition === null)\n\t\t\t\tthis.sectionProperties.dragStartPosition = this.position.slice();\n\n\t\t\tthis.setPosition(\n\t\t\t\tthis.sectionProperties.dragStartPosition[0] + dragDistance[0],\n\t\t\t\tthis.sectionProperties.dragStartPosition[1] + dragDistance[1],\n\t\t\t);\n\t\t}\n\t}\n\n\tonDragEnd(): void {\n\t\t(<any>window).IgnorePanning = undefined;\n\n\t\tthis.sectionProperties.dragStartPosition = null;\n\n\t\tconst twips = [\n\t\t\tthis.position[0] * app.pixelsToTwips,\n\t\t\tthis.position[1] * app.pixelsToTwips,\n\t\t];\n\n\t\tthis.sendAnnotationPositionChange(twips);\n\t}\n\n\tonClick(point: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tthis.stopPropagating();\n\t\tthis.sectionProperties.parentSection.sectionProperties.commentListSection.selectById(\n\t\t\tthis.sectionProperties.data.id,\n\t\t);\n\t}\n\n\tonMouseDown(point: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tthis.stopPropagating();\n\t}\n\n\tonMouseUp(point: number[], e: MouseEvent): void {\n\t\te.stopPropagation();\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\tthis.stopPropagating();\n\t\t\tthis.onDragEnd();\n\t\t}\n\t}\n}\n\napp.definitions.commentMarkerSubSection = CommentMarkerSubSection;\n"]}