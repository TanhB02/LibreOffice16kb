{"version":3,"file":"HTMLObjectSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/HTMLObjectSection.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\nclass HTMLObjectSection extends CanvasSectionObject {\n\tname: string = \"will-be-set-at-initialization\"; // There may be multiple instances of this class.\n\tprocessingOrder: number = L.CSections.HTMLObject.processingOrder;\n\tdrawingOrder: number = L.CSections.HTMLObject.drawingOrder;\n\tzIndex: number = L.CSections.HTMLObject.zIndex;\n\tdocumentObject: boolean = true;\n\n\tconstructor (sectionName: string, objectWidth: number, objectHeight: number, documentPosition: cool.SimplePoint, extraClass: string = \"\", showSection: boolean = true) {\n        super();\n\n\t\tthis.name = sectionName;\n\t\tthis.size = [objectWidth * app.dpiScale, objectHeight * app.dpiScale];\n\t\tthis.position = [documentPosition.pX, documentPosition.pY];\n\t\tthis.sectionProperties.objectWidth = objectWidth;\n\t\tthis.sectionProperties.objectHeight = objectHeight;\n\t\tthis.sectionProperties.objectDiv = document.createElement('div');\n\t\tthis.sectionProperties.objectDiv.className = 'html-object-section';\n\n\t\tif (objectWidth === null) this.sectionProperties.objectDiv.style.width = 'auto';\n\t\telse this.sectionProperties.objectDiv.style.width = objectWidth + 'px';\n\n\t\tif (objectHeight === null) this.sectionProperties.objectDiv.style.height = 'auto';\n\t\telse this.sectionProperties.objectDiv.style.height = objectHeight + 'px';\n\n\t\tif (extraClass)\n\t\t\tthis.sectionProperties.objectDiv.classList.add(extraClass);\n\n\t\t// canvas-container and canvas overlap entirely. We can append the html object to canvas-container.\n\t\tdocument.getElementById('canvas-container').appendChild(this.sectionProperties.objectDiv);\n\n\t\tif (!showSection) {\n\t\t\tthis.sectionProperties.objectDiv.style.display = 'none';\n\t\t\tthis.showSection = false;\n\t\t}\n\t}\n\n\tonInitialize(): void {\n\t\tthis.setPosition(this.position[0], this.position[1]);\n\t\tthis.adjustHTMLObjectPosition();\n\t}\n\n\tpublic onSectionShowStatusChange(): void {\n\t\tif (this.showSection)\n\t\t\tthis.sectionProperties.objectDiv.style.display = '';\n\t\telse\n\t\t\tthis.sectionProperties.objectDiv.style.display = 'none';\n\t}\n\n\tadjustHTMLObjectPosition() {\n\t\tlet leftAddition = 0;\n\t\tlet topAddition = 0;\n\n\t\tif (this.sectionProperties.objectDiv.parentNode.id === 'map') {\n\t\t\tconst clientRectMap = document.getElementById('map').getBoundingClientRect();\n\t\t\tconst clientRectCanvas = document.getElementById('canvas-container').getBoundingClientRect();\n\n\t\t\tleftAddition = clientRectMap.width - clientRectCanvas.width;\n\t\t\ttopAddition = clientRectMap.height - clientRectCanvas.height;\n\t\t}\n\n\t\tconst left = Math.round((this.myTopLeft[0] + leftAddition) / app.dpiScale) + 'px';\n\t\tconst top = Math.round((this.myTopLeft[1] + topAddition) / app.dpiScale) + 'px';\n\n\t\tif (this.sectionProperties.objectDiv.style.left !== left)\n\t\t\tthis.sectionProperties.objectDiv.style.left = left;\n\n\t\tif (this.sectionProperties.objectDiv.style.top !== top)\n\t\t\tthis.sectionProperties.objectDiv.style.top = top;\n\t}\n\n\tonDraw(frameCount?: number, elapsedTime?: number): void {\n\t\tthis.adjustHTMLObjectPosition();\n\t}\n\n\tpublic getHTMLObject() {\n\t\treturn this.sectionProperties.objectDiv;\n\t}\n\n\tpublic onNewDocumentTopLeft(): void {\n\t\tthis.adjustHTMLObjectPosition();\n\n\t\tif (this.isVisible && this.isSectionShown()) {\n\t\t\tif (this.sectionProperties.objectDiv.style.display !== '')\n\t\t\t\tthis.sectionProperties.objectDiv.style.display = '';\n\t\t}\n\t\telse\n\t\t\tthis.sectionProperties.objectDiv.style.display = 'none';\n\t}\n\n\tpublic getPosition(): cool.SimplePoint {\n\t\tconst twips = [Math.round(this.position[0] * app.pixelsToTwips), Math.round(this.position[1] * app.pixelsToTwips)];\n\t\treturn new cool.SimplePoint(twips[0], twips[1]);\n\t}\n\n\tpublic onRemove(): void {\n\t\tthis.sectionProperties.objectDiv.remove();\n\t}\n}\n\napp.definitions.htmlObjectSection = HTMLObjectSection;\n"]}