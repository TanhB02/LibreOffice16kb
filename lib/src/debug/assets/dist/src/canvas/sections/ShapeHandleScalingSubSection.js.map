{"version":3,"file":"ShapeHandleScalingSubSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/ShapeHandleScalingSubSection.ts"],"names":[],"mappings":"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","sourcesContent":["/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n/*\n\tThis class is for the sub sections (handles) of ShapeHandlesSection.\n\tShape is rendered on the core side. Only the handles are drawn here and modification commands are sent to the core side.\n*/\n\nclass ShapeHandleScalingSubSection extends CanvasSectionObject {\n\tprocessingOrder: number = L.CSections.DefaultForDocumentObjects.processingOrder;\n\tdrawingOrder: number = L.CSections.DefaultForDocumentObjects.drawingOrder + 1; // Handle events before the parent section.\n\tzIndex: number = L.CSections.DefaultForDocumentObjects.zIndex;\n\tdocumentObject: boolean = true;\n\n\tconstructor(parentHandlerSection: ShapeHandlesSection, sectionName: string, size: number[], documentPosition: cool.SimplePoint, ownInfo: any, cropModeEnabled: boolean) {\n\t\tsuper();\n\n\t\tthis.size = size;\n\t\tthis.sectionProperties.position = documentPosition.clone();\n\t\tthis.name = sectionName;\n\n\t\tthis.sectionProperties.parentHandlerSection = parentHandlerSection;\n\t\tthis.sectionProperties.ownInfo = ownInfo;\n\t\tthis.sectionProperties.mousePointerType = null;\n\t\tthis.sectionProperties.previousCursorStyle = null;\n\n\t\tthis.sectionProperties.initialAngle = null; // Initial angle of the point (handle) to the center in radians.\n\t\tthis.sectionProperties.distanceToCenter = null; // Distance to center.\n\t\tthis.sectionProperties.mapPane = (<HTMLElement>(document.querySelectorAll('.leaflet-map-pane')[0]));\n\t\tthis.sectionProperties.cropModeEnabled = cropModeEnabled;\n\t\tthis.sectionProperties.cropCursor = 'url(' + app.LOUtil.getURL(\"images/cursors/crop.png\") + ') 8 8, auto';\n\n\t\tthis.setMousePointerType();\n\n\t\tapp.events.on('TextCursorVisibility', this.onTextCursorVisibility.bind(this));\n\t}\n\n\tonInitialize(): void {\n\t\tthis.setPosition(this.sectionProperties.position.pX, this.sectionProperties.position.pY);\n\t}\n\n\tonTextCursorVisibility(event: any): void {\n\t\tif (event.detail.visible) {\n\t\t\tthis.setShowSection(false);\n\t\t\tthis.interactable = false;\n\t\t}\n\t\telse {\n\t\t\tthis.setShowSection(true);\n\t\t\tthis.interactable = true;\n\t\t}\n\t}\n\n\tonDraw(frameCount?: number, elapsedTime?: number): void {\n\t\tthis.context.fillStyle = 'wheat';\n\t\tthis.context.strokeStyle = 'black';\n\t\tthis.context.beginPath();\n\t\tif (this.sectionProperties.cropModeEnabled)\n\t\t\tthis.drawCropHandles();\n\t\telse\n\t\t\tthis.context.arc(this.size[0] * 0.5, this.size[1] * 0.5, this.size[0] * 0.5, 0, Math.PI * 2);\n\t\tthis.context.closePath();\n\t\tthis.context.fill();\n\t\tthis.context.stroke();\n\t}\n\n\tdrawCropCornerHandle() {\n\t\tconst markerWidth = this.size[0];\n\t\tconst halfMarkerWidth = markerWidth * 0.5;\n\t\tconst shapeAngle = this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.angleRadian;\n\t\tlet x = halfMarkerWidth, y = halfMarkerWidth;\n\t\tthis.context.translate(x, y);\n\t\tthis.context.rotate(shapeAngle * -1);\n\t\tthis.context.translate(-x, -y);\n\t\tthis.context.moveTo(x, y);\n\t\tx += markerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\ty += halfMarkerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= halfMarkerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\ty += halfMarkerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= halfMarkerWidth;\n\t\tthis.context.lineTo(x, y);\n\t}\n\n\tdrawCropSideHandle() {\n\t\tconst markerWidth = this.size[0];\n\t\tconst halfMarkerWidth = markerWidth * 0.5;\n\t\tconst shapeAngle = this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.angleRadian;\n\t\tlet x = halfMarkerWidth, y = halfMarkerWidth;\n\t\tthis.context.translate(x, y);\n\t\tthis.context.rotate(shapeAngle * -1);\n\t\tthis.context.translate(-x, -y);\n\t\tthis.context.moveTo(x, y);\n\t\tx += markerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\ty += halfMarkerWidth;\n\t\tthis.context.lineTo(x, y);\n\t\tx -= markerWidth;\n\t\tthis.context.lineTo(x, y);\n\t}\n\n\tdrawCropHandles() {\n\t\tconst markerWidth = this.size[0];\n\t\tthis.context.save();\n\t\tswitch (this.sectionProperties.ownInfo.kind) {\n\t\t\tcase '1':\n\t\t\t\tthis.drawCropCornerHandle();\n\t\t\t\tbreak;\n\t\t\tcase '2':\n\t\t\t\tthis.drawCropSideHandle();\n\t\t\t\tbreak;\n\t\t\tcase '3':\n\t\t\t\tthis.context.rotate(Math.PI / 2);\n\t\t\t\tthis.context.translate(0, -markerWidth);\n\t\t\t\tthis.drawCropCornerHandle();\n\t\t\t\tbreak;\n\t\t\tcase '4':\n\t\t\t\tthis.context.rotate(-Math.PI / 2);\n\t\t\t\tthis.context.translate(-markerWidth, 0);\n\t\t\t\tthis.drawCropSideHandle();\n\t\t\t\tbreak;\n\t\t\tcase '5':\n\t\t\t\tthis.context.rotate(Math.PI / 2);\n\t\t\t\tthis.context.translate(0, -markerWidth);\n\t\t\t\tthis.drawCropSideHandle();\n\t\t\t\tbreak;\n\t\t\tcase '6':\n\t\t\t\tthis.context.rotate(-Math.PI / 2);\n\t\t\t\tthis.context.translate(-markerWidth, 0);\n\t\t\t\tthis.drawCropCornerHandle();\n\t\t\t\tbreak;\n\t\t\tcase '7':\n\t\t\t\tthis.context.rotate(Math.PI);\n\t\t\t\tthis.context.translate(-markerWidth, -markerWidth);\n\t\t\t\tthis.drawCropSideHandle();\n\t\t\t\tbreak;\n\t\t\tcase '8':\n\t\t\t\tthis.context.rotate(Math.PI);\n\t\t\t\tthis.context.translate(-markerWidth, -markerWidth);\n\t\t\t\tthis.drawCropCornerHandle();\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.context.restore();\n\t}\n\n\tsetMousePointerType() {\n\t\tif (this.sectionProperties.ownInfo.kind === '1')\n\t\t\tthis.sectionProperties.mousePointerType = 'nwse-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '2')\n\t\t\tthis.sectionProperties.mousePointerType = 'ns-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '3')\n\t\t\tthis.sectionProperties.mousePointerType = 'nesw-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '4')\n\t\t\tthis.sectionProperties.mousePointerType = 'ew-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '5')\n\t\t\tthis.sectionProperties.mousePointerType = 'ew-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '6')\n\t\t\tthis.sectionProperties.mousePointerType = 'nesw-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '7')\n\t\t\tthis.sectionProperties.mousePointerType = 'ns-resize';\n\t\telse if (this.sectionProperties.ownInfo.kind === '8')\n\t\t\tthis.sectionProperties.mousePointerType = 'nwse-resize';\n\t}\n\n\tonMouseEnter(point: number[], e: MouseEvent) {\n\t\tapp.map.dontHandleMouse = true;\n\t\te.stopPropagation();\n\t\tthis.stopPropagating();\n\t\tthis.sectionProperties.previousCursorStyle = this.sectionProperties.mapPane.style.cursor;\n\t\tif (this.sectionProperties.cropModeEnabled)\n\t\t\tthis.sectionProperties.mapPane.style.cursor = this.sectionProperties.cropCursor;\n\t\telse\n\t\t\tthis.sectionProperties.mapPane.style.cursor = this.sectionProperties.mousePointerType;\n\t\tthis.containerObject.requestReDraw();\n\t}\n\n\tonMouseLeave(point: number[], e: MouseEvent) {\n\t\tapp.map.dontHandleMouse = false;\n\t\te.stopPropagation();\n\t\tthis.stopPropagating();\n\t\tthis.sectionProperties.mapPane.style.cursor = this.sectionProperties.previousCursorStyle;\n\t\tthis.containerObject.requestReDraw();\n\t}\n\n\tprivate overrideHandle(kind: string): [string, number, number] {\n\t\tconst handle = {\n\t\t\tid: this.sectionProperties.ownInfo.id,\n\t\t\tx: this.position[0],\n\t\t\ty: this.position[1],\n\t\t};\n\t\tconst subSections = this.sectionProperties.parentHandlerSection.sectionProperties.subSections;\n\n\t\tif (kind === '5') {\n\t\t\thandle.id = '7';\n\t\t\thandle.y = subSections['7'].position[1];\n\t\t} else if (kind === '4') {\n\t\t\thandle.id = '5';\n\t\t\thandle.y = subSections['5'].position[1];\n\t\t} else if (kind === '2') {\n\t\t\thandle.id = '2';\n\t\t\thandle.x = subSections['2'].position[0];\n\t\t} else if (kind === '7') {\n\t\t\thandle.id = '7';\n\t\t\thandle.x = subSections['7'].position[0];\n\t\t}\n\n\t\treturn [handle.id, handle.x, handle.y];\n\t}\n\n\tonMouseUp(point: number[], e: MouseEvent): void {\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\tthis.stopPropagating();\n\t\t\te.stopPropagation();\n\n\t\t\tconst keepRatio = e.ctrlKey && e.shiftKey;\n\t\t\tlet handleId = this.sectionProperties.ownInfo.id;\n\t\t\tconst parentHandlerSection = this.sectionProperties.parentHandlerSection;\n\n\t\t\tlet x = parentHandlerSection.sectionProperties.closestX ?? point[0] + this.position[0];\n\t\t\tlet y = parentHandlerSection.sectionProperties.closestY ?? point[1] + this.position[1];\n\n\t\t\tif (keepRatio) {\n\t\t\t\t[handleId, x, y] = this.overrideHandle(this.sectionProperties.ownInfo.kind);\n\t\t\t}\n\n\t\t\tconst parameters = {\n\t\t\t\tHandleNum: { type: 'long', value: handleId },\n\t\t\t\tNewPosX: { type: 'long', value: Math.round(x * app.pixelsToTwips) },\n\t\t\t\tNewPosY: { type: 'long', value: Math.round(y * app.pixelsToTwips) }\n\t\t\t};\n\n\t\t\tapp.map.sendUnoCommand('.uno:MoveShapeHandle', parameters);\n\t\t\tparentHandlerSection.hideSVG();\n\t\t}\n\n\t\t(window as any).IgnorePanning = false;\n\t}\n\n\tadjustSVGProperties(shapeRecProps: any) {\n\t\tif (this.sectionProperties.parentHandlerSection.sectionProperties.svg) {\n\t\t\tconst svg = this.sectionProperties.parentHandlerSection.sectionProperties.svg;\n\n\t\t\tconst scaleX = shapeRecProps.width / this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.width;\n\t\t\tconst scaleY = shapeRecProps.height / this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.height;\n\n\t\t\tlet diffX = shapeRecProps.center[0] - this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.center[0];\n\t\t\tlet diffY = shapeRecProps.center[1] - this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties.center[1];\n\n\t\t\tdiffX = diffX / app.dpiScale;\n\t\t\tdiffY = diffY / app.dpiScale;\n\n\t\t\tsvg.children[0].style.transform = 'translate(' + Math.round(diffX) + 'px, ' + Math.round(diffY) + 'px)' + 'rotate(' + -shapeRecProps.angleRadian + 'rad) scale(' + scaleX + ', ' + scaleY + ') rotate(' + shapeRecProps.angleRadian + 'rad)';\n\n\t\t\tthis.sectionProperties.parentHandlerSection.showSVG();\n\t\t}\n\t}\n\n\tprivate calculateRatioPoint(point: number[], shapeRecProps: any) {\n\t\tconst isVerticalHandler = ['2', '7'].includes(this.sectionProperties.ownInfo.kind);\n\n\t\tconst primaryDelta = isVerticalHandler\n\t\t    ? point[1] - shapeRecProps.center[1]\n\t\t    : point[0] - shapeRecProps.center[0];\n\n\t\tconst aspectRatio = isVerticalHandler\n\t\t    ? shapeRecProps.width / shapeRecProps.height\n\t\t    : shapeRecProps.height / shapeRecProps.width;\n\n\t\tconst secondaryDelta = primaryDelta * aspectRatio;\n\n\t\tconst direction = ['3', '4', '6', '2'].includes(this.sectionProperties.ownInfo.kind) ? -1 : 1;\n\n\t\tif (isVerticalHandler) {\n\t\t    point[0] = shapeRecProps.center[0] + secondaryDelta * direction;\n\t\t} else {\n\t\t    point[1] = shapeRecProps.center[1] + secondaryDelta * direction;\n\t\t}\n\n\t\treturn point;\n\t}\n\n\tcalculateNewShapeRectangleProperties(point: number[], e: MouseEvent) {\n\t\tconst shapeRecProps: any = JSON.parse(JSON.stringify(this.sectionProperties.parentHandlerSection.sectionProperties.shapeRectangleProperties));\n\t\tconst keepRatio = e.ctrlKey && e.shiftKey;\n\n\t\tif (keepRatio) {\n\t\t\tpoint = this.calculateRatioPoint(point, shapeRecProps);\n\t\t}\n\n\t\tconst diff = [point[0] - shapeRecProps.center[0], -(point[1] - shapeRecProps.center[1])];\n\t\tconst length = Math.pow(Math.pow(diff[0], 2) + Math.pow(diff[1], 2), 0.5);\n\t\tconst pointAngle = Math.atan2(diff[1], diff[0]);\n\t\tpoint[0] = shapeRecProps.center[0] + length * Math.cos(pointAngle - shapeRecProps.angleRadian);\n\t\tpoint[1] = shapeRecProps.center[1] - length * Math.sin(pointAngle - shapeRecProps.angleRadian);\n\n\t\tconst rectangle = new cool.SimpleRectangle(\n\t\t\t(shapeRecProps.center[0] - shapeRecProps.width * 0.5) * app.pixelsToTwips,\n\t\t\t(shapeRecProps.center[1] - shapeRecProps.height * 0.5) * app.pixelsToTwips,\n\t\t\tshapeRecProps.width * app.pixelsToTwips,\n\t\t\tshapeRecProps.height * app.pixelsToTwips\n\t\t);\n\n\t\tconst oldpCenter = rectangle.pCenter;\n\n\t\tif (['1', '4', '6'].includes(this.sectionProperties.ownInfo.kind)) {\n\t\t\tconst pX2 = rectangle.pX2;\n\t\t\trectangle.pX1 = point[0];\n\t\t\trectangle.pX2 = pX2;\n\t\t}\n\t\telse if (['3', '5', '8'].includes(this.sectionProperties.ownInfo.kind))\n\t\t\trectangle.pX2 = point[0];\n\n\t\tif (['1', '2', '3'].includes(this.sectionProperties.ownInfo.kind)) {\n\t\t\tconst pY2 = rectangle.pY2;\n\t\t\trectangle.pY1 = point[1];\n\t\t\trectangle.pY2 = pY2;\n\t\t}\n\t\telse if (['6', '7', '8'].includes(this.sectionProperties.ownInfo.kind))\n\t\t\trectangle.pY2 = point[1];\n\n\t\tif (keepRatio) {\n\t\t\tif (['4', '5'].includes(this.sectionProperties.ownInfo.kind)) {\n\t\t\t\trectangle.pY2 = point[1];\n\t\t\t} else if (['2', '7'].includes(this.sectionProperties.ownInfo.kind)) {\n\t\t\t\trectangle.pX2 = point[0];\n\t\t\t}\n\t\t}\n\n\t\tconst centerAngle = Math.atan2(oldpCenter[1] - rectangle.pCenter[1], rectangle.pCenter[0] - oldpCenter[0]);\n\t\tconst centerLength = Math.pow(Math.pow(rectangle.pCenter[1] - oldpCenter[1], 2) + Math.pow(rectangle.pCenter[0] - oldpCenter[0], 2), 0.5);\n\n\t\tconst x = centerLength * Math.cos(shapeRecProps.angleRadian + centerAngle);\n\t\tconst y = centerLength * Math.sin(shapeRecProps.angleRadian + centerAngle);\n\n\t\tshapeRecProps.center[0] += x;\n\t\tshapeRecProps.center[1] -= y;\n\t\tshapeRecProps.width = rectangle.pWidth;\n\t\tshapeRecProps.height = rectangle.pHeight;\n\n\t\treturn shapeRecProps;\n\t}\n\n\t// While dragging a handle, we want to simulate handles to their final positions.\n\tmoveHandlesOnDrag(point: number[], e: MouseEvent) {\n\t\tconst shapeRecProps = this.calculateNewShapeRectangleProperties([\n\t\t\tpoint[0] + this.myTopLeft[0] + this.documentTopLeft[0] - this.containerObject.getDocumentAnchor()[0],\n\t\t\tpoint[1] + this.myTopLeft[1] + this.documentTopLeft[1] - this.containerObject.getDocumentAnchor()[1]\n\t\t], e);\n\n\t\tthis.sectionProperties.parentHandlerSection.calculateInitialAnglesOfShapeHandlers(shapeRecProps);\n\n\t\tconst halfWidth = this.sectionProperties.parentHandlerSection.sectionProperties.handleWidth * 0.5;\n\t\tconst halfHeight = this.sectionProperties.parentHandlerSection.sectionProperties.handleHeight * 0.5;\n\t\tconst subSections = this.sectionProperties.parentHandlerSection.sectionProperties.subSections;\n\n\t\tlet x = 0, y = 0;\n\t\tlet pointAngle = 0;\n\n\t\tfor (let i = 0; i < subSections.length; i++) {\n\t\t\tconst subSection = subSections[i];\n\n\t\t\tpointAngle = subSection.sectionProperties.initialAngle + shapeRecProps.angleRadian;\n\t\t\tx = shapeRecProps.center[0] + subSection.sectionProperties.distanceToCenter * Math.cos(pointAngle);\n\t\t\ty = shapeRecProps.center[1] - subSection.sectionProperties.distanceToCenter * Math.sin(pointAngle);\n\t\t\tsubSection.setPosition(x - halfWidth, y - halfHeight);\n\t\t}\n\n\t\tif (!this.sectionProperties.cropModeEnabled)\n\t\t\tthis.adjustSVGProperties(shapeRecProps);\n\t}\n\n\tonMouseMove(point: Array<number>, dragDistance: Array<number>, e: MouseEvent) {\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\t(window as any).IgnorePanning = true;\n\t\t\tthis.stopPropagating();\n\t\t\te.stopPropagation();\n\t\t\tthis.sectionProperties.parentHandlerSection.sectionProperties.svg.style.opacity = 0.5;\n\t\t\tthis.moveHandlesOnDrag(point, e);\n\n\t\t\t// Here we are checking a point, so the size 0. dragDistance is also 0 because we already set the new position (moveHandlesOnDrag).\n\t\t\tthis.sectionProperties.parentHandlerSection.checkHelperLinesAndSnapPoints([0, 0], this.position, [0, 0]);\n\n\t\t\tthis.containerObject.requestReDraw();\n\t\t\tthis.sectionProperties.parentHandlerSection.showSVG();\n\t\t}\n\t\telse\n\t\t\t(window as any).IgnorePanning = false;\n\t}\n}\n\napp.definitions.shapeHandleScalingSubSection = ShapeHandleScalingSubSection;\n"]}