{"version":3,"file":"ShapeHandlesSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/ShapeHandlesSection.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* global Proxy _ */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n\n/*\n\tThis class is for the modifier handles of shape objects.\n\tShape is rendered on the core side. Only the handles are drawn here and modification commands are sent to the core side.\n*/\n\nclass HelperLineStyles {\n\tstatic initiated: false;\n\tstatic gridSolidStyle: string = null;\n\tstatic gridDashedStyle: string = null;\n\tstatic smartGuidesStyle: string = null;\n\tstatic darkModeListenerAdded = false;\n\n\tprivate static addListener() {\n\t\tapp.map.on('darkmodechanged', function() {\n\t\t\tthis.gridSolidStyle = null;\n\t\t\tthis.gridDashedStyle = null;\n\t\t\tthis.smartGuidesStyle = null;\n\t\t}.bind(this));\n\n\t\tthis.darkModeListenerAdded = true;\n\t}\n\n\tpublic static initiate() {\n\t\tif (!this.darkModeListenerAdded) this.addListener();\n\n\t\tconst tempElement = document.createElement('div');\n\n\t\ttempElement.style.display = 'none';\n\t\tdocument.body.appendChild(tempElement);\n\n\t\ttempElement.style.color = 'var(--color-grid-helper-line-solid)';\n\t\tlet computedStyle = window.getComputedStyle(tempElement);\n\t\tthis.gridSolidStyle = computedStyle.color;\n\n\t\ttempElement.style.color = 'var(--color-grid-helper-line-dashed)';\n\t\tcomputedStyle = window.getComputedStyle(tempElement);\n\t\tthis.gridDashedStyle = computedStyle.color;\n\n\t\ttempElement.style.color = 'var(--color-smart-guides-helper-line)';\n\t\tcomputedStyle = window.getComputedStyle(tempElement);\n\t\tthis.smartGuidesStyle = computedStyle.color;\n\n\t\ttempElement.remove();\n\t}\n}\n\nclass ShapeHandlesSection extends CanvasSectionObject {\n\tname: string = \"shapeHandlesSection\";\n\tprocessingOrder: number = L.CSections.DefaultForDocumentObjects.processingOrder;\n\tdrawingOrder: number = L.CSections.DefaultForDocumentObjects.drawingOrder;\n\tzIndex: number = L.CSections.DefaultForDocumentObjects.zIndex;\n\tdocumentObject: boolean = true;\n\tshowSection: boolean = false;\n\n\tconstructor (info: any) {\n        super();\n\n\t\tthis.sectionProperties.info = null;\n\t\tthis.sectionProperties.handles = [];\n\t\tthis.sectionProperties.subSections = [];\n\t\tthis.sectionProperties.activeHandleIndex = null;\n\t\tthis.sectionProperties.mouseIsInside = false;\n\t\tthis.sectionProperties.handleWidth = 12 * app.dpiScale;\n\t\tthis.sectionProperties.handleHeight = 12 * app.dpiScale;\n\t\tthis.sectionProperties.anchorWidth = 20 * app.dpiScale;\n\t\tthis.sectionProperties.anchorHeight = 20 * app.dpiScale;\n\t\tthis.sectionProperties.rotationHandleWidth = 15 * app.dpiScale;\n\t\tthis.sectionProperties.rotationHandleHeight = 15 * app.dpiScale;\n\t\tthis.sectionProperties.gluePointRadius = 10 * app.dpiScale;\n\t\tthis.sectionProperties.subSectionPrefix = 'shape-handle-';\n\t\tthis.sectionProperties.previousCursorStyle = null;\n\t\tthis.sectionProperties.svg = null; // This is for preview of modifications.\n\t\tthis.sectionProperties.hasVideo = false; // Don't hide svg when there is video content.\n\t\tthis.sectionProperties.shapeRectangleProperties = null; // Not null when there are scaling handles.\n\t\tthis.sectionProperties.lastDragDistance = [0, 0];\n\t\tthis.sectionProperties.pickedIndexX = 0; // Which corner of shape is closest to snap point when moving the shape.\n\t\tthis.sectionProperties.pickedIndexY = 0; // Which corner of shape is closest to snap point when moving the shape.\n\t\tthis.sectionProperties.mathObjectBorderColor = 'red'; // Border color for Math objects.\n\n\t\t// These are for snapping the objects to the same level with others' boundaries.\n\t\tthis.sectionProperties.closestX = null;\n\t\tthis.sectionProperties.closestY = null;\n\n\t\tthis.refreshInfo(info);\n\n\t\tif (HelperLineStyles.gridDashedStyle === null) HelperLineStyles.initiate();\n\t}\n\n\tpublic refreshInfo(info: any) {\n\t\tthis.sectionProperties.info = info;\n\t\tthis.convertToTileTwipsIfNeeded();\n\t\tthis.getHandles();\n\t\tthis.updateSize();\n\n\t\tif (GraphicSelection?.extraInfo?.isMathObject === true) {\n\t\t\t// Math objects don't need handles. They are not resizable or rotateable.\n\t\t\t// In this case, we want to draw a rectangle around it. So the user can be sure that they selected the object.\n\n\t\t\t// For drawing the rectangle, use CanvasSectionContainer's awesome border drawing feature.\n\t\t\tthis.borderColor = this.sectionProperties.mathObjectBorderColor;\n\t\t} else {\n\t\t\tthis.addSubSections();\n\t\t\tthis.sectionProperties.shapeRectangleProperties = this.getShapeRectangleProperties();\n\t\t\tthis.calculateInitialAnglesOfShapeHandlers();\n\t\t\tthis.borderColor = null;\n\t\t}\n\t}\n\n\tprivate convertToTileTwipsIfNeeded() {\n\t\tif (app.map._docLayer._docType === 'spreadsheet' && this.sectionProperties.info?.handles?.kinds?.rectangle) {\n\t\t\tconst kindList = ['1', '2', '3', '4', '5', '6', '7', '8', '16', '22', '9'];\n\n\t\t\tfor (let i = 0; i < kindList.length; i++) {\n\t\t\t\tif (this.sectionProperties.info.handles.kinds.rectangle[kindList[i]]) {\n\t\t\t\t\tconst point = new cool.SimplePoint(parseInt(this.sectionProperties.info.handles.kinds.rectangle[kindList[i]][0].point.x), parseInt(this.sectionProperties.info.handles.kinds.rectangle[kindList[i]][0].point.y));\n\t\t\t\t\tapp.map._docLayer.sheetGeometry.convertToTileTwips(point);\n\t\t\t\t\tthis.sectionProperties.info.handles.kinds.rectangle[kindList[i]][0].point.x = point.x;\n\t\t\t\t\tthis.sectionProperties.info.handles.kinds.rectangle[kindList[i]][0].point.y = point.y;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic calculateInitialAnglesOfShapeHandlers(shapeRecProps?: any) {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.rectangle) {\n\t\t\tif (!shapeRecProps)\n\t\t\t\tshapeRecProps = this.sectionProperties.shapeRectangleProperties;\n\n\t\t\tconst halfDiagonal = Math.pow(Math.pow(shapeRecProps.width * 0.5, 2) + Math.pow(shapeRecProps.height * 0.5, 2), 0.5);\n\t\t\tfor (let i = 0; i < this.sectionProperties.subSections.length; i++) {\n\t\t\t\tconst subSection = this.sectionProperties.subSections[i];\n\n\t\t\t\tif (subSection.sectionProperties.ownInfo.kind === '1') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = halfDiagonal;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(shapeRecProps.height * 0.5, -shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '2') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = shapeRecProps.height * 0.5;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(shapeRecProps.height * 0.5, 0);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '3') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = halfDiagonal;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(shapeRecProps.height * 0.5, shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '4') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = shapeRecProps.width * 0.5;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(0, -shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '5') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = shapeRecProps.width * 0.5;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(0, shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '6') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = halfDiagonal;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(-shapeRecProps.height * 0.5, -shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '7') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = shapeRecProps.height * 0.5;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(-shapeRecProps.height * 0.5, 0);\n\t\t\t\t}\n\t\t\t\telse if (subSection.sectionProperties.ownInfo.kind === '8') {\n\t\t\t\t\tsubSection.sectionProperties.distanceToCenter = halfDiagonal;\n\t\t\t\t\tsubSection.sectionProperties.initialAngle = Math.atan2(-shapeRecProps.height * 0.5, shapeRecProps.width * 0.5);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static moveHTMLObjectToMapElement(htmlObjectSection: HTMLObjectSection) {\n\t\thtmlObjectSection.getHTMLObject().remove();\n\t\tdocument.getElementById('map').appendChild(htmlObjectSection.getHTMLObject());\n\t}\n\n\tpublic static mirrorEventsFromSourceToCanvasSectionContainer (sourceElement: HTMLElement): void {\n\t\tsourceElement.addEventListener('mousedown', function (e) { app.sectionContainer.onMouseDown(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('click', function (e) { app.sectionContainer.onClick(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('dblclick', function (e) { app.sectionContainer.onDoubleClick(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('contextmenu', function (e) { app.sectionContainer.onContextMenu(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('wheel', function (e) { app.sectionContainer.onMouseWheel(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('mouseleave', function (e) { app.sectionContainer.onMouseLeave(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('mouseenter', function (e) { app.sectionContainer.onMouseEnter(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('touchstart', function (e) { app.sectionContainer.onTouchStart(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('touchmove', function (e) { app.sectionContainer.onTouchMove(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('touchend', function (e) { app.sectionContainer.onTouchEnd(e); e.stopPropagation(); }, true);\n\t\tsourceElement.addEventListener('touchcancel', function (e) { app.sectionContainer.onTouchCancel(e); e.stopPropagation(); }, true);\n\t}\n\n\tgetShapeWidth(twips = true) {\n\t\tlet middleLeft = this.sectionProperties.info.handles.kinds.rectangle['4'][0];\n\t\tmiddleLeft = new cool.SimplePoint(parseInt(middleLeft.point.x), parseInt(middleLeft.point.y));\n\n\t\tlet middleRight = this.sectionProperties.info.handles.kinds.rectangle['5'][0];\n\t\tmiddleRight = new cool.SimplePoint(parseInt(middleRight.point.x), parseInt(middleRight.point.y));\n\n\t\tif (twips)\n\t\t\treturn Math.abs(middleLeft.distanceTo(middleRight.toArray()));\n\t\telse\n\t\t\treturn Math.abs(middleLeft.pDistanceTo(middleRight.pToArray()));\n\t}\n\n\tgetShapeHeight(twips = true) {\n\t\tlet topMiddle = this.sectionProperties.info.handles.kinds.rectangle['2'][0];\n\t\ttopMiddle = new cool.SimplePoint(parseInt(topMiddle.point.x), parseInt(topMiddle.point.y));\n\n\t\tlet bottomMiddle = this.sectionProperties.info.handles.kinds.rectangle['7'][0];\n\t\tbottomMiddle = new cool.SimplePoint(parseInt(bottomMiddle.point.x), parseInt(bottomMiddle.point.y));\n\n\t\tif (twips)\n\t\t\treturn Math.abs(topMiddle.distanceTo(bottomMiddle.toArray()));\n\t\telse\n\t\t\treturn Math.abs(topMiddle.pDistanceTo(bottomMiddle.pToArray()))\n\t}\n\n\t/*\n\t\tThis is also sent from the core side.\n\t*/\n\tgetShapeAngleRadians() {\n\t\tlet topMiddle = this.sectionProperties.info.handles.kinds.rectangle['2'][0];\n\t\ttopMiddle = new cool.SimplePoint(parseInt(topMiddle.point.x), parseInt(topMiddle.point.y));\n\n\t\tconst center = this.getShapeCenter();\n\n\t\tconst radians = Math.atan2((center[1] - topMiddle.y), (topMiddle.x - center[0]));\n\t\treturn radians - Math.PI * 0.5;\n\t}\n\n\tgetShapeCenter(twips = true) {\n\t\tlet topLeft = this.sectionProperties.info.handles.kinds.rectangle['1'][0];\n\t\ttopLeft = new cool.SimplePoint(parseInt(topLeft.point.x), parseInt(topLeft.point.y));\n\n\t\tlet bottomRight = this.sectionProperties.info.handles.kinds.rectangle['8'][0];\n\t\tbottomRight = new cool.SimplePoint(parseInt(bottomRight.point.x), parseInt(bottomRight.point.y));\n\n\t\tif (twips)\n\t\t\treturn [Math.round((topLeft.x + bottomRight.x) / 2), Math.round((topLeft.y + bottomRight.y) / 2)]; // number array in twips.\n\t\telse\n\t\t\treturn [Math.round((topLeft.pX + bottomRight.pX) / 2), Math.round((topLeft.pY + bottomRight.pY) / 2)]; // number array in core pixels.\n\t}\n\n\t/*\n\t\tSelection rectangle is different from the object's inner rectangle.\n\t\tHandlers are positioned based on object's inner rectangle (~borders). So we need to get the object's inner rectangle and its rotation angle.\n\t*/\n\tgetShapeRectangleProperties() {\n\t\tif (!this.sectionProperties.info.handles?.kinds?.rectangle)\n\t\t\treturn null;\n\n\t\treturn {\n\t\t\tangleRadian: this.getShapeAngleRadians(),\n\t\t\tcenter: this.getShapeCenter(false),\n\t\t\theight: this.getShapeHeight(false),\n\t\t\twidth: this.getShapeWidth(false)\n\t\t};\n\t}\n\n\tprivate getScalingHandles(halfWidth: number, halfHeight: number) {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.rectangle) {\n\t\t\tconst topLeft = this.sectionProperties.info.handles.kinds.rectangle['1'][0];\n\t\t\tconst topMiddle = this.sectionProperties.info.handles.kinds.rectangle['2'][0];\n\t\t\tconst topRight = this.sectionProperties.info.handles.kinds.rectangle['3'][0];\n\t\t\tconst middleLeft = this.sectionProperties.info.handles.kinds.rectangle['4'][0];\n\t\t\tconst middleRight = this.sectionProperties.info.handles.kinds.rectangle['5'][0];\n\t\t\tconst bottomLeft = this.sectionProperties.info.handles.kinds.rectangle['6'][0];\n\t\t\tconst bottomMiddle = this.sectionProperties.info.handles.kinds.rectangle['7'][0];\n\t\t\tconst bottomRight = this.sectionProperties.info.handles.kinds.rectangle['8'][0];\n\n\t\t\tthis.sectionProperties.handles.push({ info: topLeft, point: new app.definitions.simplePoint(topLeft.point.x - halfWidth, topLeft.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: topMiddle, point: new app.definitions.simplePoint(topMiddle.point.x - halfWidth, topMiddle.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: topRight, point: new app.definitions.simplePoint(topRight.point.x - halfWidth, topRight.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: middleLeft, point: new app.definitions.simplePoint(middleLeft.point.x - halfWidth, middleLeft.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: middleRight, point: new app.definitions.simplePoint(middleRight.point.x - halfWidth, middleRight.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: bottomLeft, point: new app.definitions.simplePoint(bottomLeft.point.x - halfWidth, bottomLeft.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: bottomMiddle, point: new app.definitions.simplePoint(bottomMiddle.point.x - halfWidth, bottomMiddle.point.y - halfHeight) });\n\t\t\tthis.sectionProperties.handles.push({ info: bottomRight, point: new app.definitions.simplePoint(bottomRight.point.x - halfWidth, bottomRight.point.y - halfHeight) });\n\t\t}\n\t}\n\n\tprivate getAnchorHandle(halfWidth: number, halfHeight: number) {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.anchor) {\n\t\t\tconst anchor = this.sectionProperties.info.handles.kinds.anchor['16'][0];\n\t\t\tthis.sectionProperties.handles.push({ info: anchor, point: new app.definitions.simplePoint(anchor.point.x - halfWidth, anchor.point.y - halfHeight) });\n\t\t}\n\t}\n\n\tpublic getRotationInfo(): any {\n\t\tif (!this.sectionProperties.info?.handles?.kinds?.rectangle)\n\t\t\treturn;\n\n\t\tlet coreAngle = GraphicSelection.selectionAngle;\n\t\tif (this.sectionProperties.svg)\n\t\t\tcoreAngle = this.sectionProperties.svg.innerHTML.includes('class=\"Group\"') ? 0: coreAngle;\n\n\t\tif (coreAngle !== undefined && coreAngle !== null) {\n\t\t\tcoreAngle = coreAngle / 100;\n\t\t\tcoreAngle = (coreAngle * Math.PI) / 180;\n\n\t\t\twhile (coreAngle > Math.PI * 2) coreAngle -= Math.PI * 2;\n\t\t\twhile (coreAngle < 0) coreAngle += Math.PI * 2;\n\t\t}\n\t\telse\n\t\t\tcoreAngle = null;\n\n\t\tconst result = {\n\t\t\tkind: 'ShapeRotationHandle',\n\t\t\tcoreAngle: coreAngle\n\t\t};\n\n\t\treturn result;\n\t}\n\n\tgetRotationHandlePosition(rotationInfo: any) {\n\t\tconst centerX = parseInt(this.sectionProperties.info.handles.kinds.rectangle['2'][0].point.x) * app.twipsToPixels - this.position[0];\n\t\tconst centerY = parseInt(this.sectionProperties.info.handles.kinds.rectangle['2'][0].point.y) * app.twipsToPixels - this.position[1];\n\t\tconst diff = 30 * app.dpiScale;\n\n\t\tlet y = centerY - diff * Math.sin(rotationInfo.coreAngle + Math.PI * 0.5);\n\t\tlet x = centerX + diff * Math.cos(rotationInfo.coreAngle + Math.PI * 0.5);\n\n\t\tx -= this.sectionProperties.rotationHandleWidth * 0.5;\n\t\ty -= this.sectionProperties.rotationHandleHeight * 0.5;\n\n\t\treturn new app.definitions.simplePoint((this.position[0] + x) * app.pixelsToTwips, (this.position[1] + y) * app.pixelsToTwips);\n\t}\n\n\tprivate getRotationHandle() {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.rectangle && !this.sectionProperties.hasVideo) {\n\t\t\tconst rotationInfo = this.getRotationInfo(); // Rotation section will read the information from this (parent) class.\n\t\t\tconst rotationHandlePosition: cool.SimplePoint = this.getRotationHandlePosition(rotationInfo);\n\t\t\trotationInfo.initialPosition = rotationHandlePosition.clone();\n\n\t\t\t// Core side doesn't send a position information for rotation handle. We add this.\n\t\t\tthis.sectionProperties.handles.push({ info: rotationInfo, point: rotationHandlePosition });\n\t\t}\n\t}\n\n\tprivate getCustomHandles(halfWidth: number, halfHeight: number) {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.custom) {\n\t\t\tconst customHandleList = this.sectionProperties.info.handles.kinds.custom['22'];\n\n\t\t\tif (customHandleList && customHandleList.length > 0) {\n\t\t\t\tfor (let i = 0; i < customHandleList.length; i++) {\n\t\t\t\t\tconst customHandler = customHandleList[i];\n\t\t\t\t\tthis.sectionProperties.handles.push({ info: customHandler, point: new app.definitions.simplePoint(customHandler.point.x - halfWidth, customHandler.point.y - halfHeight) });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getPolyHandles(halfWidth: number, halfHeight: number) {\n\t\tif (this.sectionProperties.info?.handles?.kinds?.poly) {\n\t\t\tif (Array.isArray(this.sectionProperties.info.handles.kinds.poly['9'])) {\n\t\t\t\tconst polyArray = this.sectionProperties.info.handles.kinds.poly['9'];\n\n\t\t\t\tfor (let i = 0; i < polyArray.length; i++) {\n\t\t\t\t\tconst poly = polyArray[i];\n\t\t\t\t\tthis.sectionProperties.handles.push({ info: poly, point: new app.definitions.simplePoint(poly.point.x - halfWidth, poly.point.y - halfHeight) });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getGluePoints() {\n\t\tif (this.sectionProperties.info?.GluePoints?.shapes) {\n\t\t\tif (Array.isArray(this.sectionProperties.info.GluePoints.shapes)) {\n\t\t\t\tconst shapeArray = this.sectionProperties.info.GluePoints.shapes;\n\n\t\t\t\tfor (let i = 0; i < shapeArray.length; i++) {\n\t\t\t\t\tconst shape = shapeArray[i];\n\t\t\t\t\tshape.kind = 'GluePoint';\n\t\t\t\t\tconst glueArray = shape.gluepoints;\n\n\t\t\t\t\tfor (let j = 0; j < glueArray.length; j++) {\n\t\t\t\t\t\tconst info = Object.assign({}, shape);\n\t\t\t\t\t\tinfo.id = String(i) + String(j);\n\t\t\t\t\t\tthis.sectionProperties.handles.push({ info: info, point: new app.definitions.simplePoint(glueArray[j].point.x, glueArray[j].point.y) });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Get the handle positions and other information from the info that core side sent us.\n\tprivate getHandles() {\n\t\tthis.sectionProperties.handles = [];\n\n\t\tconst halfWidth = app.pixelsToTwips * (this.sectionProperties.handleWidth * 0.5);\n\t\tconst halfHeight = app.pixelsToTwips * (this.sectionProperties.handleHeight * 0.5);\n\n\t\tthis.getScalingHandles(halfWidth, halfHeight);\n\t\tthis.getAnchorHandle(halfWidth, halfHeight);\n\t\tthis.getRotationHandle();\n\t\tthis.getCustomHandles(halfWidth, halfHeight);\n\t\tthis.getPolyHandles(halfWidth, halfHeight);\n\t\tthis.getGluePoints();\n\t}\n\n\t// Update this section's size according to handle coordinates.\n\tupdateSize() {\n\t\tthis.size = [0, 0];\n\n\t\tif (GraphicSelection.hasActiveSelection())\n\t\t\tthis.size = [GraphicSelection.rectangle.pWidth, GraphicSelection.rectangle.pHeight];\n\t}\n\n\tisSVGVisible() {\n\t\tif (this.sectionProperties.svg)\n\t\t\treturn this.sectionProperties.svg.style.display === '';\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tremoveSVG() {\n\t\tif (this.sectionProperties.svg)\n\t\t\tthis.sectionProperties.svg.remove();\n\t}\n\n\taddVideoSupportHandlers(videos: any) {\n\t\tif (!videos)\n\t\t\treturn;\n\n\t\t// slide show may have more than one video and it does not require any selection\n\t\tfor (var i = 0; i < videos.length; i++) {\n\t\t\tvar video = videos[i];\n\t\t\tvar sources = video.getElementsByTagName('source');\n\n\t\t\tvideo.addEventListener('playing', function() {\n\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\tif (video.webkitDecodedFrameCount === 0 && video.webkitAudioDecodedByteCount === 0) {\n\t\t\t\t\t\tthis.showUnsupportedMediaWarning();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this), 1000);\n\t\t\t}.bind(this));\n\n\t\t\tvideo.addEventListener('error', function() {\n\t\t\t\tthis.showUnsupportedMediaWarning();\n\t\t\t}.bind(this));\n\n\t\t\tif (sources.length) {\n\t\t\t\tsources[0].addEventListener('error', function(error: string) {\n\t\t\t\t\tthis.showUnsupportedMediaWarning();\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tshowUnsupportedMediaWarning() {\n\t\tvar videoWarning = _('Document contains unsupported media');\n\t\tL.Map.THIS.uiManager.showSnackbar(videoWarning);\n\t}\n\n\taddEmbeddedVideo(svgString: any) {\n\t\tthis.sectionProperties.hasVideo = true;\n\t\tthis.setSVG(svgString);\n\t\tthis.sectionProperties.svg.remove();\n\t\tdocument.getElementById('map').appendChild(this.sectionProperties.svg);\n\t\tthis.sectionProperties.svg.style.zIndex = 11; // Update z-index or video buttons are unreachable.\n\n\t\tif (!this.sectionProperties.svg.innerHTML.includes('foreignobject')) {\n\t\t\tconsole.error('Failed to parse svg for embedded video');\n\t\t\treturn;\n\t\t}\n\n\t\tvar videoContainer = this.sectionProperties.svg;\n\t\tvar videos = this.sectionProperties.svg.getElementsByTagName('video');\n\n\t\t// fix URL, it's important to have correct WOPISrc, we need to decode \"&\" before other params\n\t\t// like ServerId and Tag so load balancer will not use it as a part of WOPISrc\n\t\t// this has to be done here (after parseSVG), because it other case we will fail to get\n\t\t// the svg object\n\t\tvar source = this.sectionProperties.svg.getElementsByTagName('source');\n\t\tsource[0].src = decodeURIComponent(source[0].src);\n\n\t\tthis.addVideoSupportHandlers(videos);\n\t}\n\n\tremoveTagFromHTML(data: string, startString: string, endString: string): string {\n\t\tlet startIndex = data.indexOf(startString);\n\t\tlet endIndex = data.indexOf(endString, startIndex + 1);\n\n\t\twhile (startIndex !== -1 && endIndex !== -1) {\n\t\t\tconst toRemove = data.substring(startIndex, endIndex + endString.length);\n\t\t\tdata = data.replace(toRemove, '');\n\n\t\t\tstartIndex = data.indexOf(startString);\n\t\t\tendIndex = data.indexOf(endString, startIndex + 1);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tgetTagFromHTML(data: string, startString: string, endString: string): string {\n\t\tconst startIndex = data.indexOf(startString);\n\t\tconst endIndex = data.indexOf(endString, startIndex + 1);\n\n\t\tif (startIndex !== -1 && endIndex !== -1) {\n\t\t\tconst pickedData = data.substring(startIndex, endIndex + endString.length);\n\t\t\treturn pickedData;\n\t\t}\n\t\telse {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tsetSVG(data: string) {\n\t\tthis.removeSVG();\n\n\t\tdata = this.removeTagFromHTML(data, ' style=\"', '\"');\n\n\t\tthis.sectionProperties.svg = document.createElement('svg');\n\t\tdocument.getElementById('canvas-container').appendChild(this.sectionProperties.svg);\n\n\t\tthis.sectionProperties.svg.innerHTML = data;\n\t\tthis.sectionProperties.svg.style.position = 'absolute';\n\t\tthis.sectionProperties.svg.children[0].style.width = this.sectionProperties.svg.children[0].style.height = 'auto';\n\t\tthis.sectionProperties.svg.children[0].style.transformOrigin = 'center';\n\t\tthis.sectionProperties.svg.children[0].setAttribute('preserveAspectRatio', 'none');\n\n\t\tthis.adjustSVGProperties();\n\t}\n\n\tshowSVG() {\n\t\tif (this.sectionProperties.svg)\n\t\t\tthis.sectionProperties.svg.style.display = '';\n\t}\n\n\thideSVG() {\n\t\tif (this.sectionProperties.svg && !this.sectionProperties.hasVideo)\n\t\t\tthis.sectionProperties.svg.style.display = 'none';\n\t}\n\n\tonSectionShowStatusChange() {\n\t\tfor (let i = 0; i < this.sectionProperties.subSections.length; i++)\n\t\t\tthis.sectionProperties.subSections[i].setShowSection(this.showSection);\n\n\t\tif (this.showSection)\n\t\t\tthis.showSVG();\n\t\telse\n\t\t\tthis.hideSVG();\n\t}\n\n\tcheckAnchorSubSection(handle: any): any {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + handle.info.id);\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandleAnchorSubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + handle.info.id,\n\t\t\t\t[this.sectionProperties.anchorWidth / app.dpiScale, this.sectionProperties.anchorHeight / app.dpiScale],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tcheckScalingSubSection(handle: any): any {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + handle.info.id);\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandleScalingSubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + handle.info.id,\n\t\t\t\t[this.sectionProperties.handleWidth, this.sectionProperties.handleHeight],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info,\n\t\t\t\tGraphicSelection.extraInfo.isCropMode\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\tif (GraphicSelection.extraInfo.isCropMode && !newSubSection.sectionProperties.cropModeEnabled) {\n\t\t\t\tnewSubSection.sectionProperties.cropModeEnabled = GraphicSelection.extraInfo.isCropMode;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tcheckRotationSubSection(handle: any) {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + 'rotation');\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandleRotationSubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + 'rotation',\n\t\t\t\t[this.sectionProperties.rotationHandleWidth, this.sectionProperties.rotationHandleHeight],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tcheckCustomSubSection(handle: any): any {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + handle.info.id);\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandleCustomSubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + handle.info.id,\n\t\t\t\t[this.sectionProperties.handleWidth, this.sectionProperties.handleHeight],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tcheckPolySubSection(handle: any): any {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + handle.info.id);\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandlePolySubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + handle.info.id,\n\t\t\t\t[this.sectionProperties.handleWidth, this.sectionProperties.handleHeight],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tcheckGluePointSubSection(handle: any): any {\n\t\tlet newSubSection = app.sectionContainer.getSectionWithName(this.sectionProperties.subSectionPrefix + handle.info.id);\n\n\t\tif (!newSubSection) {\n\t\t\tnewSubSection = new app.definitions.shapeHandleGluePointSubSection(\n\t\t\t\tthis,\n\t\t\t\tthis.sectionProperties.subSectionPrefix + handle.info.id,\n\t\t\t\t[this.sectionProperties.gluePointRadius, this.sectionProperties.gluePointRadius],\n\t\t\t\thandle.point.clone(),\n\t\t\t\thandle.info\n\t\t\t);\n\t\t\treturn newSubSection;\n\t\t}\n\t\telse {\n\t\t\tnewSubSection.sectionProperties.ownInfo = handle.info;\n\t\t\tnewSubSection.setPosition(handle.point.pX, handle.point.pY);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\taddSubSections() {\n\t\tfor (let i = 0; i < this.sectionProperties.handles.length; i++) {\n\t\t\tlet newSubSection: any = null;\n\t\t\tif (this.sectionProperties.handles[i].info.kind === '16')\n\t\t\t\tnewSubSection = this.checkAnchorSubSection(this.sectionProperties.handles[i]);\n\t\t\telse if (['1', '2', '3', '4', '5', '6', '7', '8'].includes(this.sectionProperties.handles[i].info.kind))\n\t\t\t\tnewSubSection = this.checkScalingSubSection(this.sectionProperties.handles[i]);\n\t\t\telse if (this.sectionProperties.handles[i].info.kind === 'ShapeRotationHandle')\n\t\t\t\tnewSubSection = this.checkRotationSubSection(this.sectionProperties.handles[i]);\n\t\t\telse if (this.sectionProperties.handles[i].info.kind === '22')\n\t\t\t\tnewSubSection = this.checkCustomSubSection(this.sectionProperties.handles[i]);\n\t\t\telse if (this.sectionProperties.handles[i].info.kind === '9')\n\t\t\t\tnewSubSection = this.checkPolySubSection(this.sectionProperties.handles[i]);\n\t\t\telse if (this.sectionProperties.handles[i].info.kind === 'GluePoint')\n\t\t\t\tnewSubSection = this.checkGluePointSubSection(this.sectionProperties.handles[i]);\n\n\t\t\tif (newSubSection) {\n\t\t\t\tthis.containerObject.addSection(newSubSection as any);\n\t\t\t\tthis.sectionProperties.subSections.push(newSubSection);\n\t\t\t}\n\t\t}\n\t}\n\n\tonMouseEnter() {\n\t\tthis.sectionProperties.previousCursorStyle = this.context.canvas.style.cursor;\n\t\tthis.context.canvas.style.cursor = 'move';\n\t\tthis.sectionProperties.mouseIsInside = true;\n\t}\n\n\tonMouseLeave() {\n\t\tthis.context.canvas.style.cursor = this.sectionProperties.previousCursorStyle;\n\t\tthis.sectionProperties.mouseIsInside = false;\n\t}\n\n\tadjustSnapTransformCoordinate(x: number, y: number) {\n\t\t// Transform command accepts the difference from top left corner.\n\t\t// If we are snapping to other corners, we need to adjust the coordinate.\n\n\t\tif (x !== null && [0, 3].includes(this.sectionProperties.pickedIndexX)) x -= this.size[0];\n\t\tif (y !== null && [0, 3].includes(this.sectionProperties.pickedIndexY)) y -= this.size[1];\n\n\t\treturn x !== null ? x: y;\n\t}\n\n\tsendTransformCommand(point: number[]) {\n\t\tlet x = this.sectionProperties.closestX;\n\t\tif (!x) x = this.sectionProperties.lastDragDistance[0] + this.position[0];\n\t\telse x = this.adjustSnapTransformCoordinate(x, null);\n\n\t\tlet y = this.sectionProperties.closestY;\n\t\tif (!y) y = this.sectionProperties.lastDragDistance[1] + this.position[1];\n\t\telse y = this.adjustSnapTransformCoordinate(null, y);\n\n\t\tlet yTwips = y * app.pixelsToTwips;\n\t\tconst docLayer = app.map._docLayer;\n\t\tconst verticalOffset = docLayer.getFiledBasedViewVerticalOffset();\n\t\tif (verticalOffset) {\n\t\t\t// Transform from canvas twips to core twips.\n\t\t\tyTwips -= verticalOffset;\n\t\t}\n\n\t\tconst parameters = {\n\t\t\t'TransformPosX': {\n\t\t\t\t'type': 'long',\n\t\t\t\t'value': Math.round(x * app.pixelsToTwips)\n\t\t\t},\n\t\t\t'TransformPosY': {\n\t\t\t\t'type': 'long',\n\t\t\t\t'value': Math.round(yTwips)\n\t\t\t}\n\t\t};\n\n\t\tapp.map.sendUnoCommand('.uno:TransformDialog', parameters);\n\n\t\tdocLayer.requestNewFiledBasedViewTiles();\n\t}\n\n\tonMouseUp(point: number[], e: MouseEvent): void {\n\t\tif (this.sectionProperties.svg)\n\t\t\tthis.sectionProperties.svg.style.opacity = 1;\n\n\t\tthis.hideSVG();\n\n\t\t(window as any).IgnorePanning = false;\n\n\t\tif (this.containerObject.isDraggingSomething()) {\n\t\t\tif ((window as any).mode.isTablet() || (window as any).mode.isMobile())\n\t\t\t\tthis.sendTransformCommand(point);\n\t\t\telse if ((window as any).mode.isDesktop() && (this.sectionProperties.closestX || this.sectionProperties.closestY)) {\n\t\t\t\t// We need to snap to the guide-lines. So we send a positioning command after the mouse up event (desktop case).\n\t\t\t\t// We don't need to do this on mobile because we always send the positioning commands there. No mouse events for mobile.\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.sendTransformCommand(point); // Send to back of the process queue so it performs after buttonup event is sent.\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tfindClosestX(xList: number[]) {\n\t\tlet closest = 1000;\n\t\tlet pickX = null;\n\t\tthis.sectionProperties.pickedIndexX = 0;\n\t\tif (GraphicSelection.extraInfo.ObjectRectangles) {\n\t\t\tconst ordNum = GraphicSelection.extraInfo.OrdNum;\n\t\t\tconst rectangles = GraphicSelection.extraInfo.ObjectRectangles;\n\n\t\t\tfor (let i = 0; i < rectangles.length; i++) {\n\t\t\t\tif (rectangles[i][4] !== ordNum) { // Don't compare it with itself.\n\t\t\t\t\tconst distances = [];\n\t\t\t\t\tfor (let j = 0; j < xList.length; j++) {\n\t\t\t\t\t\tdistances.unshift(Math.abs(rectangles[i][0] - xList[j]));\n\t\t\t\t\t\tdistances.push(Math.abs(rectangles[i][0] + rectangles[i][2] - xList[j]));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst min = Math.min(...distances);\n\t\t\t\t\tconst index = distances.indexOf(min);\n\t\t\t\t\tif (min < closest) {\n\t\t\t\t\t\tclosest = min;\n\t\t\t\t\t\tpickX = index < xList.length ? rectangles[i][0]: rectangles[i][0] + rectangles[i][2];\n\t\t\t\t\t\tthis.sectionProperties.pickedIndexX = index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (closest < 10 * app.dpiScale) this.sectionProperties.closestX = pickX;\n\t\telse this.sectionProperties.closestX = null;\n\t}\n\n\tfindClosestY(yList: number[]) {\n\t\tlet closest = 1000;\n\t\tlet pickY = null;\n\t\tif (GraphicSelection.extraInfo.ObjectRectangles) {\n\t\t\tconst ordNum = GraphicSelection.extraInfo.OrdNum;\n\t\t\tconst rectangles = GraphicSelection.extraInfo.ObjectRectangles;\n\t\t\tthis.sectionProperties.pickedIndexY = 0;\n\n\t\t\tfor (let i = 0; i < rectangles.length; i++) {\n\t\t\t\tif (rectangles[i][4] !== ordNum) { // Don't compare it with itself.\n\t\t\t\t\tconst distances = [];\n\t\t\t\t\tfor (let j = 0; j < yList.length; j++) {\n\t\t\t\t\t\tdistances.unshift(Math.abs(rectangles[i][1] - yList[j]));\n\t\t\t\t\t\tdistances.push(Math.abs(rectangles[i][1] + rectangles[i][3] - yList[j]));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst min = Math.min(...distances);\n\t\t\t\t\tconst index = distances.indexOf(min);\n\t\t\t\t\tif (min < closest) {\n\t\t\t\t\t\tclosest = min;\n\t\t\t\t\t\tpickY = index < yList.length ? rectangles[i][1]: rectangles[i][1] + rectangles[i][3];\n\t\t\t\t\t\tthis.sectionProperties.pickedIndexY = index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (closest < 10 * app.dpiScale) this.sectionProperties.closestY = pickY;\n\t\telse this.sectionProperties.closestY = null;\n\t}\n\n\tprivate cloneSelectedPartInfoForGridSnap() {\n\t\tconst selectedPart = Object.assign({}, app.impress.partList[app.map._docLayer._selectedPart]);\n\t\tselectedPart.leftBorder *= app.impress.twipsCorrection;\n\t\tselectedPart.upperBorder *= app.impress.twipsCorrection;\n\t\tselectedPart.rightBorder *= app.impress.twipsCorrection;\n\t\tselectedPart.lowerBorder *= app.impress.twipsCorrection;\n\t\tselectedPart.gridCoarseWidth *= app.impress.twipsCorrection;\n\t\tselectedPart.gridCoarseHeight *= app.impress.twipsCorrection;\n\n\t\treturn selectedPart;\n\t}\n\n\tprivate getInnerRecrangleForGridSnap(selectedPart: any) {\n\t\treturn new cool.SimpleRectangle(\n\t\t\tselectedPart.leftBorder,\n\t\t\tselectedPart.upperBorder,\n\t\t\t(selectedPart.width - selectedPart.leftBorder - selectedPart.rightBorder),\n\t\t\t(selectedPart.height - selectedPart.upperBorder - selectedPart.lowerBorder)\n\t\t);\n\t}\n\n\tprivate getCornerPointsForGridSnap(size: number[], position: number[], dragDistance: number[]) {\n\t\treturn [\n\t\t\tnew cool.SimplePoint((position[0] + dragDistance[0]) * app.pixelsToTwips, (position[1] + dragDistance[1]) * app.pixelsToTwips),\n\t\t\tnew cool.SimplePoint((size[0] + position[0] + dragDistance[0]) * app.pixelsToTwips, (position[1] + dragDistance[1]) * app.pixelsToTwips),\n\t\t\tnew cool.SimplePoint((position[0] + dragDistance[0]) * app.pixelsToTwips, (size[1] + position[1] + dragDistance[1]) * app.pixelsToTwips),\n\t\t\tnew cool.SimplePoint((size[0] + position[0] + dragDistance[0]) * app.pixelsToTwips, (size[1] + position[1] + dragDistance[1]) * app.pixelsToTwips),\n\t\t];\n\t}\n\n\tprivate findClosestGridPoint(size: number[], position: number[], dragDistance: number[]) {\n\t\t// First rule of snap-to-grid: If you enable snap-to-grid, you have to snap.\n\n\t\tconst selectedPart = this.cloneSelectedPartInfoForGridSnap();\n\n\t\t// The 4 corners of selected object's rectangle.\n\t\tconst checkList = this.getCornerPointsForGridSnap(size, position, dragDistance);\n\n\t\t// The rectangle that is shaped by the page margins.\n\t\tconst innerRectangle = this.getInnerRecrangleForGridSnap(selectedPart);\n\n\t\tconst gapX = selectedPart.gridCoarseWidth / (selectedPart.innerSpacesX > 0 ? selectedPart.innerSpacesX : 1);\n\t\tconst gapY = selectedPart.gridCoarseHeight / (selectedPart.innerSpacesY > 0 ? selectedPart.innerSpacesY : 1);\n\n\t\tlet minX = 100000;\n\t\tlet minY = 100000;\n\t\tfor (let i = 0; i < 1; i++) {\n\t\t\tif (innerRectangle.containsPoint(checkList[i].toArray())) {\n\n\t\t\t\tconst countX = Math.round((checkList[i].x - innerRectangle.x1) / gapX);\n\t\t\t\tconst countY = Math.round((checkList[i].y - innerRectangle.y1) / gapY);\n\n\t\t\t\tconst diffX = Math.abs(checkList[i].x - innerRectangle.x1 - gapX * countX);\n\t\t\t\tconst diffY = Math.abs(checkList[i].y - innerRectangle.y1 - gapY * countY);\n\n\t\t\t\tif (diffX < minX) {\n\t\t\t\t\tminX = diffX;\n\t\t\t\t\tthis.sectionProperties.closestX = innerRectangle.x1 + (countX * gapX);\n\t\t\t\t\tthis.sectionProperties.pickedIndexX = [1, 3].includes(i) ? 0 : 1; // Do we substract width or not.\n\t\t\t\t}\n\t\t\t\tif (diffY < minY) {\n\t\t\t\t\tminY = diffY;\n\t\t\t\t\tthis.sectionProperties.closestY = innerRectangle.y1 + (countY * gapY);\n\t\t\t\t\tthis.sectionProperties.pickedIndexY = [2, 3].includes(i) ? 0 : 1; // Do we substract height or not.\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sectionProperties.closestX *= app.twipsToPixels;\n\t\tthis.sectionProperties.closestY *= app.twipsToPixels;\n\t}\n\n\tpublic checkObjectsBoundaries(xListToCheck: number[], yListToCheck: number[]) {\n\t\tif (app.map._docLayer._docType === 'presentation') {\n\t\t\tthis.findClosestX(xListToCheck);\n\t\t\tthis.findClosestY(yListToCheck);\n\t\t}\n\t}\n\n\tpublic checkHelperLinesAndSnapPoints(size: number[], position: number[], dragDistance: number[]) {\n\t\t/*\n\t\t\tWe will first check if grid-snap is enabled and if we are close to a grid point.\n\t\t\tIf there is a grid point to snap to, then we'll ignore helper lines.\n\t\t\tBecause core side doesn't know about our helper lines, and it'll ignore them if it can snap to a grid point.\n\t\t*/\n\n\t\tthis.sectionProperties.closestX = null;\n\t\tthis.sectionProperties.closestY = null;\n\n\t\tif (app.map.stateChangeHandler.getItemValue('.uno:GridUse') === 'true') {\n\t\t\tthis.findClosestGridPoint(size, position, dragDistance)\n\t\t}\n\t\telse {\n\t\t\tthis.checkObjectsBoundaries(\n\t\t\t\t[position[0] + dragDistance[0], position[0] + dragDistance[0] + size[0]],\n\t\t\t\t[position[1] + dragDistance[1], position[1] + dragDistance[1] + size[1]]\n\t\t\t);\n\t\t}\n\n\t\tthis.containerObject.requestReDraw();\n\t}\n\n\tonMouseMove(position: number[], dragDistance: number[]) {\n\t\tlet canDrag = !app.file.textCursor.visible;\n\n\t\tif (canDrag && app.map.getDocType() === 'presentation') {\n\t\t\t// Tables get selected when multiple cells are selected. In this case, we check if DeleteRows is disabled.\n\t\t\t// Because in non-edit mode, deleteRows is disabled. So we can drag the table.\n\t\t\tconst deleteRowsState = app.map.stateChangeHandler.getItemValue('.uno:DeleteRows');\n\t\t\tcanDrag = deleteRowsState ? deleteRowsState === 'disabled': true;\n\t\t}\n\n\t\tif (this.containerObject.isDraggingSomething() && canDrag) {\n\t\t\t(window as any).IgnorePanning = true;\n\n\t\t\tif (this.sectionProperties.svg) {\n\t\t\t\tthis.sectionProperties.svg.style.left = String((this.myTopLeft[0] + dragDistance[0]) / app.dpiScale) + 'px';\n\t\t\t\tthis.sectionProperties.svg.style.top = String((this.myTopLeft[1] + dragDistance[1]) / app.dpiScale) + 'px';\n\t\t\t\tthis.sectionProperties.svg.style.opacity = 0.5;\n\t\t\t}\n\t\t\tthis.sectionProperties.lastDragDistance = [dragDistance[0], dragDistance[1]];\n\t\t\tthis.checkHelperLinesAndSnapPoints(this.size, this.position, dragDistance);\n\n\t\t\tthis.showSVG();\n\t\t}\n\t\telse\n\t\t\t(window as any).IgnorePanning = false;\n\t}\n\n\tgetViewBox(svg: any): number[] {\n\t\tlet viewBox: any = svg.getAttribute('viewBox');\n\n\t\tif (viewBox) {\n\t\t\tviewBox = viewBox.split(' ');\n\t\t\tfor (let i = 0; i < viewBox.length; i++) viewBox[i] = parseInt(viewBox[i]);\n\t\t}\n\t\telse\n\t\t\tviewBox = null;\n\n\t\treturn viewBox;\n\t}\n\n\tadjustSVGProperties() {\n\t\tif (this.sectionProperties.svg && this.sectionProperties.svg.style.display === '' && GraphicSelection.hasActiveSelection()) {\n\t\t\tconst widthText = GraphicSelection.rectangle.cWidth + 'px';\n\t\t\tconst heightText = GraphicSelection.rectangle.cHeight + 'px';\n\n\t\t\tconst viewBox: number[] = this.getViewBox(this.sectionProperties.svg.children[0]);\n\t\t\tconst isImage = this.sectionProperties.svg.querySelectorAll('.Graphic').length > 0;\n\n\t\t\tconst clientRect = (this.sectionProperties.svg.children[0] as SVGElement).getBoundingClientRect();\n\n\t\t\tif (viewBox && !isImage && clientRect.width > 0 && clientRect.height > 0) {\n\t\t\t\tthis.sectionProperties.svg.children[0].style.width = widthText;\n\t\t\t\tthis.sectionProperties.svg.children[0].style.height = heightText;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.sectionProperties.svg.style.width = widthText;\n\t\t\t\tthis.sectionProperties.svg.style.height = heightText;\n\n\t\t\t\tif (isImage) {\n\t\t\t\t\tthis.sectionProperties.svg.children[0].style.width = widthText;\n\t\t\t\t\tthis.sectionProperties.svg.children[0].style.height = heightText;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst left = GraphicSelection.rectangle.pX1;\n\t\t\tconst top = GraphicSelection.rectangle.pY1;\n\n\t\t\tthis.sectionProperties.svg.style.left = Math.round((left - this.documentTopLeft[0] + this.containerObject.getDocumentAnchor()[0]) / app.dpiScale) + 'px';\n\t\t\tthis.sectionProperties.svg.style.top = Math.round((top - this.documentTopLeft[1] + this.containerObject.getDocumentAnchor()[1]) / app.dpiScale) + 'px';\n\t\t\tthis.sectionProperties.svgPosition = [left, top];\n\t\t}\n\t\tthis.hideSVG();\n\t}\n\n\tonNewDocumentTopLeft(size: number[]): void {\n\t\tif (this.sectionProperties.svgPosition) {\n\t\t\tthis.sectionProperties.svg.style.left = (this.sectionProperties.svgPosition[0] - (this.documentTopLeft[0] + this.containerObject.getDocumentAnchor()[0]) / app.dpiScale) + 'px';\n\t\t\tthis.sectionProperties.svg.style.top = (this.sectionProperties.svgPosition[1] - (this.documentTopLeft[1] + this.containerObject.getDocumentAnchor()[1]) / app.dpiScale) + 'px';\n\t\t}\n\t}\n\n\tdrawXAxis(x: number) {\n\t\tthis.context.moveTo(x, 0);\n\t\tthis.context.lineTo(x, this.context.canvas.height);\n\t\tthis.context.stroke();\n\t}\n\n\tdrawYAxis(y: number) {\n\t\tthis.context.moveTo(0, y);\n\t\tthis.context.lineTo(this.context.canvas.width, y);\n\t\tthis.context.stroke();\n\t}\n\n\tdrawShapeAlignmentHelperLines() {\n\t\tthis.context.save();\n\n\t\tthis.context.setLineDash([4, 3]);\n\t\tthis.context.strokeStyle = HelperLineStyles.smartGuidesStyle;\n\t\tthis.context.translate(-this.myTopLeft[0], -this.myTopLeft[1]);\n\n\t\tthis.context.beginPath();\n\n\t\tif (this.sectionProperties.closestX !== null)\n\t\t\tthis.drawXAxis(this.containerObject.getDocumentAnchor()[0] + this.sectionProperties.closestX - this.documentTopLeft[0]);\n\n\t\tif (this.sectionProperties.closestY !== null)\n\t\t\tthis.drawYAxis(this.containerObject.getDocumentAnchor()[1] + this.sectionProperties.closestY - this.documentTopLeft[1]);\n\n\t\tthis.context.closePath();\n\n\t\tthis.context.restore();\n\t}\n\n\tdrawGridHelperLines() {\n\t\tthis.context.save();\n\n\t\tthis.context.translate(-this.myTopLeft[0], -this.myTopLeft[1]);\n\n\t\tthis.context.beginPath();\n\n\t\tif (this.sectionProperties.closestX !== null) {\n\t\t\tthis.context.strokeStyle = HelperLineStyles.gridSolidStyle;\n\t\t\tthis.context.setLineDash([]);\n\n\t\t\tconst x = this.containerObject.getDocumentAnchor()[0] + this.sectionProperties.closestX - this.documentTopLeft[0];\n\n\t\t\tthis.drawXAxis(x);\n\n\t\t\t// Draw a second line on top of solid white-ish line.\n\t\t\tthis.context.setLineDash([4, 3]);\n\t\t\tthis.context.strokeStyle = HelperLineStyles.gridDashedStyle;\n\n\t\t\tthis.drawXAxis(x);\n\t\t}\n\n\t\tif (this.sectionProperties.closestY !== null) {\n\t\t\tthis.context.strokeStyle = HelperLineStyles.gridSolidStyle;\n\t\t\tthis.context.setLineDash([]);\n\n\t\t\tconst y = this.containerObject.getDocumentAnchor()[1] + this.sectionProperties.closestY - this.documentTopLeft[1];\n\n\t\t\tthis.drawYAxis(y);\n\n\t\t\t// Draw a second line on top of solid white-ish line.\n\t\t\tthis.context.setLineDash([4, 3]);\n\t\t\tthis.context.strokeStyle = HelperLineStyles.gridDashedStyle;\n\n\t\t\tthis.drawYAxis(y);\n\t\t}\n\n\t\tthis.context.closePath();\n\n\t\tthis.context.restore();\n\t}\n\n\tprivate anythingToDraw(): boolean {\n\t\treturn \tthis.sectionProperties.closestX !== null ||\n\t\t\t\tthis.sectionProperties.closestY !== null;\n\t}\n\n\tpublic onDraw() {\n\t\tif (!this.showSection || !this.isVisible)\n\t\t\tthis.hideSVG();\n\t\telse if (this.anythingToDraw()) {\n\t\t\tif (app.map.stateChangeHandler.getItemValue('.uno:GridUse') === 'true')\n\t\t\t\tthis.drawGridHelperLines();\n\t\t\telse\n\t\t\t\tthis.drawShapeAlignmentHelperLines();\n\t\t}\n\t}\n\n\tremoveSubSections(): void {\n\t\tthis.removeSVG();\n\t\tfor (let i = 0; i < this.sectionProperties.subSections.length; i++) {\n\t\t\tthis.containerObject.removeSection(this.sectionProperties.subSections[i].name);\n\t\t}\n\t}\n}\n\napp.definitions.shapeHandlesSection = ShapeHandlesSection;\n"]}