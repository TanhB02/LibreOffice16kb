{"version":3,"file":"URLPopUpSection.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/canvas/sections/URLPopUpSection.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nclass URLPopUpSection extends HTMLObjectSection {\n    static sectionName = 'URL PopUp';\n\tcontainerId = 'hyperlink-pop-up-preview';\n\tlinkId = 'hyperlink-pop-up';\n\tstatic cssClass = 'hyperlink-pop-up-container';\n\tcopyButtonId = 'hyperlink-pop-up-copy';\n\teditButtonId = 'hyperlink-pop-up-edit';\n\tremoveButtonId = 'hyperlink-pop-up-remove';\n\tarrowDiv: HTMLDivElement;\n\n\tstatic arrowHalfWidth = 10;\n\tstatic horizontalPadding = 6;\n\tstatic popupVerticalMargin = 20;\n\n\tconstructor(url: string, documentPosition: cool.SimplePoint, linkPosition?: cool.SimplePoint) {\n        super(URLPopUpSection.sectionName, null, null, documentPosition, URLPopUpSection.cssClass);\n\n\t\tconst objectDiv = this.getHTMLObject();\n\t\tobjectDiv.remove();\n\t\tdocument.getElementById('document-container').appendChild(objectDiv);\n\n\t\tthis.sectionProperties.url = url;\n\n\t\tthis.createUIElements(url);\n\t\tthis.setUpCallbacks(linkPosition);\n\n\t\tdocument.getElementById('hyperlink-pop-up').title = url;\n\n\t\tif (app.map['wopi'].EnableRemoteLinkPicker)\n\t\t\tapp.map.fire('postMessage', { msgId: 'Action_GetLinkPreview', args: { url: url } });\n\n\t\tthis.sectionProperties.documentPosition = documentPosition.clone();\n    }\n\n\tgetPopUpWidth(): number {\n\t\treturn this.getHTMLObject().getBoundingClientRect().width;\n\t}\n\n\tgetPopUpHeight(): number {\n\t\treturn this.getHTMLObject().getBoundingClientRect().height;\n\t}\n\n\tgetPopUpBoundingRectangle() {\n\t\treturn this.getHTMLObject().getBoundingClientRect();\n\t}\n\n\tcreateUIElements(url: string) {\n\t\tconst parent = this.getHTMLObject();\n\t\tL.DomUtil.createWithId('div', this.containerId, parent);\n\n        const link = L.DomUtil.createWithId('a', this.linkId, parent);\n\t\tlink.innerText = url;\n\t\tconst copyLinkText = _('Copy link location');\n\t\tconst copyBtn = L.DomUtil.createWithId('div', this.copyButtonId, parent);\n\t\tL.DomUtil.addClass(copyBtn, 'hyperlink-popup-btn');\n\t\tcopyBtn.setAttribute('title', copyLinkText);\n\t\tcopyBtn.setAttribute('role', 'button');\n\t\tcopyBtn.setAttribute('aria-label', copyLinkText);\n\n        const imgCopyBtn = L.DomUtil.create('img', 'hyperlink-pop-up-copyimg', copyBtn);\n\t\tapp.LOUtil.setImage(imgCopyBtn, 'lc_copyhyperlinklocation.svg', app.map);\n\t\timgCopyBtn.setAttribute('width', 18);\n\t\timgCopyBtn.setAttribute('height', 18);\n\t\timgCopyBtn.setAttribute('alt', copyLinkText);\n\t\timgCopyBtn.style.padding = '4px';\n\n\t\tconst editLinkText = _('Edit link');\n\t\tconst editBtn = L.DomUtil.createWithId('div', this.editButtonId, parent);\n\t\tL.DomUtil.addClass(editBtn, 'hyperlink-popup-btn');\n\t\teditBtn.setAttribute('title', editLinkText);\n\t\teditBtn.setAttribute('role', 'button');\n\t\teditBtn.setAttribute('aria-label', copyLinkText);\n\n\n\t\tconst imgEditBtn = L.DomUtil.create('img', 'hyperlink-pop-up-editimg', editBtn);\n\t\tapp.LOUtil.setImage(imgEditBtn, 'lc_edithyperlink.svg', app.map);\n\t\timgEditBtn.setAttribute('width', 18);\n\t\timgEditBtn.setAttribute('height', 18);\n\t\timgEditBtn.setAttribute('alt', editLinkText);\n\t\timgEditBtn.style.padding = '4px';\n\n\t\tconst removeLinkText = _('Remove link');\n\t\tconst removeBtn = L.DomUtil.createWithId('div', this.removeButtonId, parent);\n\t\tL.DomUtil.addClass(removeBtn, 'hyperlink-popup-btn');\n\t\tremoveBtn.setAttribute('title', removeLinkText);\n\t\tremoveBtn.setAttribute('role', 'button');\n\t\tremoveBtn.setAttribute('aria-label', removeLinkText);\n\n\t\tconst imgRemoveBtn = L.DomUtil.create('img', 'hyperlink-pop-up-removeimg', removeBtn);\n\t\tapp.LOUtil.setImage(imgRemoveBtn, 'lc_removehyperlink.svg', app.map);\n\t\timgRemoveBtn.setAttribute('width', 18);\n\t\timgRemoveBtn.setAttribute('height', 18);\n\t\timgRemoveBtn.setAttribute('alt', removeLinkText);\n\t\timgRemoveBtn.style.padding = '4px';\n\n\t\tthis.arrowDiv = document.createElement('div');\n\t\tthis.arrowDiv.className = 'arrow-div';\n\t\tparent.appendChild(this.arrowDiv);\n\t}\n\n\tsetUpCallbacks(linkPosition?: cool.SimplePoint) {\n\t\tdocument.getElementById(this.linkId).onclick = () => {\n\t\t\tif (!this.sectionProperties.url.startsWith('#'))\n\t\t\t\tapp.map.fire('warn', {url: this.sectionProperties.url, map: app.map, cmd: 'openlink'});\n\t\t\telse\n\t\t\t\tapp.map.sendUnoCommand('.uno:JumpToMark?Bookmark:string=' + encodeURIComponent(this.sectionProperties.url.substring(1)));\n\t\t};\n\n\t\tvar params: any;\n\t\tif (linkPosition) {\n\t\t\tparams = {\n\t\t\t\tPositionX: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: linkPosition.x\n\t\t\t\t},\n\t\t\t\tPositionY: {\n\t\t\t\t\ttype: 'long',\n\t\t\t\t\tvalue: linkPosition.y\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tdocument.getElementById(this.copyButtonId).onclick = () => {\n\t\t\t// If _navigatorClipboardWrite is available, use it.\n\t\t\tif (L.Browser.clipboardApiAvailable || window.ThisIsTheiOSApp)\n\t\t\t\tapp.map._clip.filterExecCopyPaste('.uno:CopyHyperlinkLocation', params);\n\t\t\telse // Or use previous method.\n\t\t\t\tapp.map.sendUnoCommand('.uno:CopyHyperlinkLocation', params);\n\t\t};\n\n\t\tdocument.getElementById(this.editButtonId).onclick = () => {\n\t\t\tapp.map.sendUnoCommand('.uno:EditHyperlink', params);\n\t\t};\n\n\t\tdocument.getElementById(this.removeButtonId).onclick = () => {\n\t\t\tapp.map.sendUnoCommand('.uno:RemoveHyperlink', params);\n\t\t\tURLPopUpSection.closeURLPopUp();\n\t\t};\n\t}\n\n\treLocateArrow(arrowAtTop: boolean) {\n\t\tif (arrowAtTop) this.arrowDiv.classList.add('reverse');\n\t\telse this.arrowDiv.classList.remove('reverse');\n\n\t\t/*\n\t\t\tNormally, the documentPosition sent from the core side nicely positions the arrow.\n\t\t\tWe will check if we reposition the popup.\n\t\t\tIf the arrow position falls outside of the popup, we will put it on the edge.\n\t\t*/\n\t\tconst clientRect = this.getPopUpBoundingRectangle();\n\t\tlet arrowCSSLeft = this.sectionProperties.documentPosition.pX - this.documentTopLeft[0] + this.containerObject.getDocumentAnchor()[0] - URLPopUpSection.arrowHalfWidth;\n\t\tarrowCSSLeft /= app.dpiScale;\n\t\tarrowCSSLeft += document.getElementById('canvas-container').getBoundingClientRect().left; // Add this in case there is something on its left.\n\t\tarrowCSSLeft -= clientRect.left;\n\t\tthis.arrowDiv.style.left = (arrowCSSLeft > URLPopUpSection.horizontalPadding ? arrowCSSLeft : URLPopUpSection.horizontalPadding) + 'px';\n\t}\n\n\tpublic static resetPosition(section: URLPopUpSection) {\n\t\tif (!section) section = app.sectionContainer.getSectionWithName(URLPopUpSection.sectionName) as URLPopUpSection;\n\t\tif (!section) return;\n\n\t\tlet originalLeft = section.sectionProperties.documentPosition.pX - section.getPopUpWidth() * 0.5 * app.dpiScale;\n\t\tlet originalTop = section.sectionProperties.documentPosition.pY - (section.getPopUpHeight() + URLPopUpSection.popupVerticalMargin) * app.dpiScale;\n\n\t\tconst checkLeft = originalLeft - section.containerObject.getDocumentTopLeft()[0];\n\t\tconst checkTop = originalTop - section.containerObject.getDocumentTopLeft()[1];\n\n\t\tlet arrowAtTop = false;\n\t\tif (checkTop < 0) {\n\t\t\toriginalTop = section.sectionProperties.documentPosition.pY + (URLPopUpSection.popupVerticalMargin * 2 * app.dpiScale);\n\t\t\tarrowAtTop = true;\n\t\t}\n\n\t\tif (checkLeft < 0) originalLeft = section.documentTopLeft[0];\n\n\t\tsection.setPosition(originalLeft, originalTop);\n\t\tsection.adjustHTMLObjectPosition();\n\t\tsection.reLocateArrow(arrowAtTop);\n\t\tsection.containerObject.requestReDraw();\n\t}\n\n\tpublic static showURLPopUP(url: string, documentPosition: cool.SimplePoint, linkPosition?: cool.SimplePoint) {\n\t\tif (URLPopUpSection.isOpen())\n\t\t\tURLPopUpSection.closeURLPopUp();\n\n\t\tconst section = new URLPopUpSection(url, documentPosition, linkPosition);\n\t\tapp.sectionContainer.addSection(section);\n\t\tthis.resetPosition(section);\n    }\n\n    public static closeURLPopUp() {\n\t\tif (URLPopUpSection.isOpen())\n\t\t\tapp.sectionContainer.removeSection(URLPopUpSection.sectionName);\n\t}\n\n    public static isOpen() {\n\t\treturn app.sectionContainer.doesSectionExist(URLPopUpSection.sectionName);\n    }\n}\n\napp.definitions.urlPopUpSection = URLPopUpSection;\n"]}