{"version":3,"file":"Control.Tabs.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.Tabs.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * L.Control.Tabs is used to switch sheets in Calc\n */\n\n/* global $ _ _UNO Hammer cool app */\nL.Control.Tabs = L.Control.extend({\n\tonAdd: function() {\n\t\tapp.events.on('updatepermission', this._onUpdatePermission.bind(this));\n\t\tthis._initialized = false;\n\t},\n\n\t_onUpdatePermission: function(e) {\n\t\tif (this._map.getDocType() !== 'spreadsheet') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._initialized) {\n\t\t\tthis._initialize();\n\t\t}\n\t\tsetTimeout(function() {\n\t\t\t$('.spreadsheet-tab').contextMenu(e.detail.perm === 'edit');\n\t\t}, 100);\n\t},\n\n\t_initialize: function () {\n\t\tthis._initialized = true;\n\t\tthis._spreadsheetTabs = {};\n\t\tthis._tabForContextMenu = 0;\n\t\tvar map = this._map;\n\t\tvar tableCell = document.getElementById('spreadsheet-toolbar');\n\t\tthis._tabsCont = L.DomUtil.create('div', 'spreadsheet-tabs-container', tableCell);\n\n\t\tfunction areTabsMultiple() {\n\t\t\tvar numItems = $('.spreadsheet-tab').length;\n\t\t\tif (numItems === 1) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tthis._menuItem = {\n\t\t\t'insertsheetbefore': {name: _('Insert sheet before this'),\n\t\t\t\tcallback: (this._insertSheetBefore).bind(this)\n\t\t\t},\n\t\t\t'insertsheetafter': {name: _('Insert sheet after this'),\n\t\t\t\tcallback: (this._insertSheetAfter).bind(this)\n\t\t\t},\n\t\t\t'.uno:Remove': {\n\t\t\t\tname: _UNO('.uno:Remove', 'spreadsheet', true),\n\t\t\t\tcallback: (this._deleteSheet).bind(this),\n\t\t\t\tvisible: function() {\n\t\t\t\t\treturn areTabsMultiple() && !this._isProtectedSheet(this._tabForContextMenu);\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\t'.uno:Name': {name: _UNO('.uno:RenameTable', 'spreadsheet', true),\n\t\t\t\t      callback: (this._renameSheet).bind(this),\n\t\t\t\t      visible: function() {\n\t\t\t\t\t      return !this._isProtectedSheet(this._tabForContextMenu);\n\t\t\t\t      }.bind(this)\n\t\t\t},\n\t\t\t'.uno:Protect': {\n\t\t\t\tname: _UNO('.uno:Protect', 'spreadsheet', true),\n\t\t\t\tcallback: (this._protectSheet).bind(this),\n\t\t\t},\n\t\t\t'.uno:Show': {\n\t\t\t\tname: _UNO('.uno:Show', 'spreadsheet', true),\n\t\t\t\tcallback: (this._showSheet).bind(this),\n\t\t\t\tvisible: function() {\n\t\t\t\t\treturn app.calc.isAnyPartHidden();\n\t\t\t\t}\n\t\t\t},\n\t\t\t'.uno:Hide': {\n\t\t\t\tname: _UNO('.uno:Hide', 'spreadsheet', true),\n\t\t\t\tcallback: (this._hideSheet).bind(this),\n\t\t\t\tvisible: areTabsMultiple\n\t\t\t},\n\t\t\t'movesheetleft': {\n\t\t\t\tname: _('Move Sheet Left'),\n\t\t\t\tcallback: (this._moveSheetLeft).bind(this),\n\t\t\t\tvisible: areTabsMultiple\n\t\t\t},\n\t\t\t'movesheetright': {\n\t\t\t\tname: _('Move Sheet Right'),\n\t\t\t\tcallback: (this._moveSheetRight).bind(this),\n\t\t\t\tvisible: areTabsMultiple\n\t\t\t},\n\t\t\t'.uno:Move': {\n\t\t\t\tname: _UNO('.uno:Move', 'spreadsheet', true),\n\t\t\t\tcallback: (this._moveOrCopySheet).bind(this),\n\t\t\t\tvisible: areTabsMultiple\n\t\t\t},\n\t\t\t'.uno:CopyTab': {\n\t\t\t\tname: _('Copy Sheet...'),\n\t\t\t\tcallback: function() {this._map.sendUnoCommand('.uno:Move');}.bind(this),\n\t\t\t\tvisible: function() {\n\t\t\t\t\treturn !areTabsMultiple();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\tif ((!window.mode.isMobile() && !this._map.isReadOnlyMode()) || window.mode.isTablet()) {\n\t\t\tL.installContextMenu({\n\t\t\t\tselector: '.spreadsheet-tab',\n\t\t\t\tclassName: 'cool-font',\n\t\t\t\titems: this._menuItem,\n\t\t\t\tzIndex: 1000\n\t\t\t});\n\t\t}\n\n\t\tmap.on('updateparts', this._updateDisabled, this);\n\t},\n\n\t_updateDisabled: function (e) {\n\t\tvar parts = e.parts;\n\t\tvar selectedPart = e.selectedPart;\n\t\tvar docType = e.docType;\n\n\t\tif (docType === 'text') {\n\t\t\treturn;\n\t\t}\n\t\tif (docType === 'spreadsheet') {\n\n\t\t\t// Save scroll position\n\t\t\tvar horizScrollPos = 0;\n\t\t\tvar scrollDiv = L.DomUtil.get('spreadsheet-tab-scroll');\n\t\t\tif (scrollDiv) {\n\t\t\t\thorizScrollPos = scrollDiv.scrollLeft;\n\t\t\t}\n\n\t\t\tif ('partNames' in e) {\n\t\t\t\twhile (this._tabsCont.firstChild) {\n\t\t\t\t\tthis._tabsCont.removeChild(this._tabsCont.firstChild);\n\t\t\t\t}\n\t\t\t\tvar ssTabScroll = L.DomUtil.create('div', 'spreadsheet-tab-scroll', this._tabsCont);\n\t\t\t\tssTabScroll.id = 'spreadsheet-tab-scroll';\n\t\t\t\tif (!window.mode.isMobile())\n\t\t\t\t\tssTabScroll.style.overflowX = 'scroll';\n\n\t\t\t\tthis._tabsCont.style.display = 'grid';\n\n\t\t\t\tvar menuItemMobile = {};\n\t\t\t\tObject.assign(menuItemMobile,\n\t\t\t\t\t{\n\t\t\t\t\t\t'insertsheetbefore' : this._menuItem['insertsheetbefore'],\n\t\t\t\t\t\t'insertsheetafter'  :   this._menuItem['insertsheetafter'],\n\t\t\t\t\t\t'Name' : this._menuItem['.uno:Name'],\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (app.calc.isAnyPartHidden()) {\n\t\t\t\t\tObject.assign(menuItemMobile, {\n\t\t\t\t\t\t'Show' : this._menuItem['.uno:Show'],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (app.calc.getVisiblePartCount() !== 1) {\n\t\t\t\t\tObject.assign(menuItemMobile,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'Remove': this._menuItem['.uno:Remove'],\n\t\t\t\t\t\t\t'Hide': this._menuItem['.uno:Hide'],\n\t\t\t\t\t\t\t'movesheetleft': this._menuItem['movesheetleft'],\n\t\t\t\t\t\t\t'movesheetright': this._menuItem['movesheetright'],\n\t\t\t\t\t\t\t'Move': this._menuItem['.uno:Move'],\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tObject.assign(menuItemMobile,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'CopyTab': this._menuItem['.uno:CopyTab'],\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (window.mode.isMobile()) {\n\t\t\t\t\tvar menuData = L.Control.JSDialogBuilder.getMenuStructureForMobileWizard(menuItemMobile, true, '');\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0; i < parts; i++) {\n\t\t\t\t\tif (app.calc.isPartHidden(i))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t// create a drop zone indicator for the sheet tab\n\t\t\t\t\t// put the indicator on the left of the tab\n\t\t\t\t\tvar dropZoneIndicator = L.DomUtil.create('div', 'tab-drop-area', ssTabScroll);\n\t\t\t\t\tdropZoneIndicator.id = 'drop-zone-' + i;\n\t\t\t\t\tvar id = 'spreadsheet-tab' + i;\n\t\t\t\t\tvar tab = L.DomUtil.create('button', 'spreadsheet-tab', ssTabScroll);\n\t\t\t\t\tL.DomUtil.create('div', 'lock', tab);\n\t\t\t\t\tvar label = L.DomUtil.create('div', '', tab);\n\t\t\t\t\tif (window.mode.isMobile() || window.mode.isTablet()) {\n\t\t\t\t\t\t(new Hammer(tab, {recognizers: [[Hammer.Press]]}))\n\t\t\t\t\t\t\t.on('press', function (j) {\n\t\t\t\t\t\t\t\treturn function(e) {\n\t\t\t\t\t\t\t\t\tthis._tabForContextMenu = j;\n\t\t\t\t\t\t\t\t\tif (!this._map.isReadOnlyMode()) {\n\t\t\t\t\t\t\t\t\t\tif (window.mode.isMobile()) {\n\t\t\t\t\t\t\t\t\t\t\twindow.contextMenuWizard = true;\n\t\t\t\t\t\t\t\t\t\t\tthis._map.fire('mobilewizard', {data: menuData});\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$(e.target).trigger('contextmenu');\n                                        }\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}(i).bind(this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!scrollDiv && i === selectedPart) {\n\t\t\t\t\t\thorizScrollPos = tab.offsetLeft;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!window.mode.isMobile()) {\n\t\t\t\t\t\tL.DomEvent.on(tab, 'dblclick', function(j) {\n\t\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\t\t// window.app.console.err('Double clicked ' + j);\n\t\t\t\t\t\t\t\tthis._tabForContextMenu = j;\n\t\t\t\t\t\t\t\tthis._renameSheet();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}(i).bind(this));\n\t\t\t\t\t\tL.DomEvent.on(tab, 'contextmenu', function(j) {\n\t\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\t\tthis._tabForContextMenu = j;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}(i).bind(this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (app.calc.isPartProtected(i)) {\n\t\t\t\t\t\tL.DomUtil.addClass(tab, 'spreadsheet-tab-protected');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tL.DomUtil.removeClass(tab, 'spreadsheet-tab-protected');\n\t\t\t\t\t}\n\t\t\t\t\tlabel.textContent = e.partNames[i];\n\t\t\t\t\ttab.id = id;\n\n\t\t\t\t\tL.DomEvent\n\t\t\t\t\t\t.on(tab, 'click', L.DomEvent.stopPropagation)\n\t\t\t\t\t\t.on(tab, 'click', L.DomEvent.stop)\n\t\t\t\t\t\t.on(tab, 'click', this._setPart, this)\n\t\t\t\t\t\t.on(tab, 'click', this._map.focus, this._map);\n\t\t\t\t\tthis._addDnDHandlers(tab);\n\t\t\t\t\tthis._spreadsheetTabs[id] = tab;\n\t\t\t\t}\n\n\t\t\t\t// add an additional dropZoneIndicator for the last sheet tab\n\t\t\t\t// put the indicator on the right of the last tab\n\t\t\t\tvar dropZoneIndicatorForTheLastTab = L.DomUtil.create('div', 'tab-drop-area', ssTabScroll);\n\t\t\t\tdropZoneIndicatorForTheLastTab.id = 'drop-zone-end';\n\n\t\t\t\t// create drop zone container for the last drop zone indicator\n\t\t\t\t// when a tab is over this container, dropZoneIndicatorForTheLastTab will be shown\n\t\t\t\tvar dropZoneEndContainer = L.DomUtil.create('div', '', ssTabScroll);\n\t\t\t\tdropZoneEndContainer.id = 'drop-zone-end-container';\n\t\t\t\tthis._addDnDHandlers(dropZoneEndContainer);\n\t\t\t\tdropZoneEndContainer.setAttribute('draggable', false);\n\t\t\t}\n\t\t\tfor (var key in this._spreadsheetTabs) {\n\t\t\t\tvar part =  parseInt(key.match(/\\d+/g)[0]);\n\t\t\t\tL.DomUtil.removeClass(this._spreadsheetTabs[key], 'spreadsheet-tab-selected');\n\t\t\t\tif (part === selectedPart) {\n\t\t\t\t\t// close auto filter popups on sheet tab selected\n\t\t\t\t\tthis._map.fire('closeAutoFilterDialog');\n\t\t\t\t\tthis._map.fire('closepopups');\n\t\t\t\t\tL.DomUtil.addClass(this._spreadsheetTabs[key], 'spreadsheet-tab-selected');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Restore horizontal scroll position\n\t\t\tscrollDiv = L.DomUtil.get('spreadsheet-tab-scroll');\n\t\t\tif (scrollDiv) {\n\t\t\t\tif (this._map.insertPage && this._map.insertPage.scrollToEnd) {\n\t\t\t\t\tthis._map.insertPage.scrollToEnd = false;\n\t\t\t\t\tscrollDiv.scrollLeft = scrollDiv.scrollWidth;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tscrollDiv.scrollLeft = horizScrollPos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_addDnDHandlers: function(element) {\n\t\tif (!this._map.isReadOnlyMode()) {\n\t\t\telement.setAttribute('draggable', true);\n\t\t\telement.addEventListener('dragstart', this._handleDragStart.bind(this), false);\n\t\t\telement.addEventListener('dragenter', this._handleDragEnter, false);\n\t\t\telement.addEventListener('dragover', this._handleDragOver, false);\n\t\t\telement.addEventListener('dragleave', this._handleDragLeave, false);\n\t\t\telement.addEventListener('drop', this._handleDrop.bind(this), false);\n\t\t\telement.addEventListener('dragend', this._handleDragEnd, false);\n\t\t}\n\t},\n\n\t// Set the part by index. Return true if cancelled.\n\t_setPartIndex: function(index) {\n\t\tif (cool.Comment.isAnyEdit()) {\n\t\t\tcool.CommentSection.showCommentEditingWarning();\n\t\t\treturn true;\n\t\t}\n\n\t\tthis._map._docLayer._clearReferences();\n\t\tthis._map.setPart(index, /*external:*/ false, /*calledFromSetPartHandler:*/ true);\n\t},\n\n\t_setPart: function (e) {\n\t\tvar part = e.currentTarget.id.match(/\\d+/g)[0];\n\t\tif (part == null) {\n\t\t\treturn;\n\t\t}\n\n\t\tpart = parseInt(part);\n\n\t\tif (part !== this._map._docLayer._selectedPart) {\n\t\t\tthis._setPartIndex(part);\n\t\t}\n\t},\n\n\t//selected sheet is moved to new index\n\t_moveSheet: function (newIndex) {\n\t\tvar currentTab = this._map.getCurrentPartNumber();\n\t\t// odd but true: the base index changes according to the tab is dragged\n\t\t// on the left or on the right wrt. the current tab position\n\t\tvar newIndexZeroBased = newIndex > currentTab ? newIndex - 2 : newIndex - 1;\n\t\tthis._map._docLayer._sheetSwitch.updateOnSheetMoved(currentTab, newIndexZeroBased);\n\t\tthis._map.sendUnoCommand('.uno:Move?Copy:bool=false&UseCurrentDocument:bool=true&Index=' + newIndex);\n\t},\n\n\t_moveOrCopySheet: function () {\n\t\tvar contextMenuTab = this._tabForContextMenu;\n\t\tthis._map.sendUnoCommand('.uno:Move?FromContextMenu:bool=true&MoveOrCopySheetDialog:bool=true&ContextMenuIndex=' + contextMenuTab);\n\t},\n\n\t_moveSheetLR: function (contextMenuTab, newIndex) {\n\t\tif (contextMenuTab !== undefined && contextMenuTab >= 0)\n\t\t\tthis._map.sendUnoCommand('.uno:Move?Copy:bool=false&UseCurrentDocument:bool=true&FromContextMenu:bool=true&ContextMenuIndex=' + contextMenuTab + '&Index=' + newIndex);\n\t},\n\n\t_moveSheetLeft: function () {\n\t\t//core handles sheet with 1 base indexing\n\t\t// 0 index means last sheet\n\t\tvar contextMenuTab = this._tabForContextMenu;\n\t\tif (contextMenuTab <= 0) return;\n\n\t\tthis._map._docLayer._sheetSwitch.updateOnSheetMoved(contextMenuTab, contextMenuTab - 1);\n\n\t\t// core handles the decreasing of contextMenuTab by 1\n\t\t// so, no need to do it here (for the second parameter)\n\t\tthis._moveSheetLR(contextMenuTab, contextMenuTab);\n\t},\n\n\t_moveSheetRight: function () {\n\t\tvar contextMenuTab = this._tabForContextMenu;\n\n\t\tthis._map._docLayer._sheetSwitch.updateOnSheetMoved(contextMenuTab, contextMenuTab + 1);\n\n\t\t/*\n\t\tWhy there is '+3' ?\n\t\t- core handles sheet with 1 base indexing, add +1.\n\t\t- since we move right, add +1.\n\t\t- on the core side, there is a -1 for this value,\n\t\tso we add +1 again.\n\t\t*/\n\t\tthis._moveSheetLR(contextMenuTab, contextMenuTab + 3);\n\t},\n\n\t_insertSheetBefore: function() {\n\t\tthis._map.insertPage(this._tabForContextMenu);\n\t},\n\n\t_insertSheetAfter: function() {\n\t\tthis._map.insertPage(this._tabForContextMenu + 1);\n\t},\n\n\t_deleteSheet: function() {\n\t\tvar nPos = this._tabForContextMenu;\n\t\tvar message = _('Are you sure you want to delete sheet, {sheet}?').replace('{sheet}', $('#spreadsheet-tab' + this._tabForContextMenu).text());\n\n\t\tthis._map.uiManager.showInfoModal('delete-sheet-modal', '', message, '', _('OK'), function() {\n\t\t\tthis._map.deletePage(nPos);\n\t\t}.bind(this), true, 'delete-sheet-modal-response');\n\t},\n\n\t_renameSheet: function() {\n\t\tvar map = this._map;\n\t\tvar nPos = this._tabForContextMenu;\n\t\tvar tabName = $('#spreadsheet-tab' + this._tabForContextMenu).text();\n\t\tthis._map.uiManager.showInputModal('rename-calc-sheet', _('Rename sheet'), _('Enter new sheet name'), tabName, _('OK'),\n\t\t\tfunction (value) {\n\t\t\t\tmap.renamePage(value, nPos);\n\t\t\t});\n\t},\n\n\t// Trigger sheet protection. It seems that it does it for the current sheet\n\t// so we select it first.\n\t_protectSheet: function() {\n\t\tif (!this._setPartIndex(this._tabForContextMenu)) {\n\t\t\tthis._map.sendUnoCommand('.uno:Protect');\n\t\t}\n\t},\n\n\t_isProtectedSheet: function(idx) {\n\t\tvar tab = L.DomUtil.get('spreadsheet-tab' + idx);\n\t\treturn tab && L.DomUtil.hasClass(tab, 'spreadsheet-tab-protected');\n\t},\n\n\t_showSheet: function() {\n\t\tthis._map.showPage();\n\t},\n\n\t_hideSheet: function() {\n\t\tthis._map.hidePage(this._tabForContextMenu);\n\t},\n\n\t_handleDragStart: function(e) {\n\t\tthis._setPart(e);\n\t\te.dataTransfer.effectAllowed = 'move';\n\t},\n\n\t_handleDragEnter: function() {\n\n\t},\n\n\t_handleDragOver: function(e) {\n\t\tif (e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\t// By default we move when dragging, but can\n\t\t// support duplication with ctrl in the future.\n\t\te.dataTransfer.dropEffect = 'move';\n\n\t\te.currentTarget.previousElementSibling.classList.add('tab-drop-area-active');\n\n\t\treturn false;\n\t},\n\n\t_handleDragLeave: function (e) {\n\t\tif ($(e.target).hasClass('spreadsheet-tab') || (e.target.getAttribute('id') == 'drop-zone-end-container'))\n\t\t\te.currentTarget.previousElementSibling.classList.remove('tab-drop-area-active');\n\t},\n\n\t_handleDrop: function(e) {\n\t\tif (e.stopPropagation) {\n\t\t\te.stopPropagation();\n\t\t}\n\n\t\te.currentTarget.previousElementSibling.classList.remove('tab-drop-area-active');\n\t\tvar targetIndex = this._map._docLayer._partNames.indexOf(e.target.innerText);\n\t\tthis._moveSheet(targetIndex + 1); // drop to left side of the tab\n\t},\n\n\t_handleDragEnd: function (e) {\n\t\te.currentTarget.previousElementSibling.classList.remove('tab-drop-area-active');\n\t}\n});\n\nL.control.tabs = function (options) {\n\treturn new L.Control.Tabs(options);\n};\n"]}