{"version":3,"file":"Control.SheetsBar.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.SheetsBar.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * Control.SheetsBar - toolbar with buttons for scrolling tabs\n */\n\n/* global _ JSDialog app */\nclass SheetsBar {\n\n\tconstructor(map, showNavigation = true) {\n\t\tthis.showNavigation = showNavigation;\n\t\tthis.onAdd(map);\n\t}\n\n\tonAdd(map) {\n\t\tthis.map = map;\n\t\tthis.parentContainer = L.DomUtil.get('spreadsheet-toolbar');\n\t\tthis.builder = new L.control.jsDialogBuilder(\n\t\t\t{\n\t\t\t\tmobileWizard: this,\n\t\t\t\tmap: this.map,\n\t\t\t\tcssClass: 'jsdialog'\n\t\t\t});\n\n\t\tthis.create();\n\n\t\tmap.on('doclayerinit', this.onDocLayerInit, this);\n\t\tapp.events.on('updatepermission', this.onUpdatePermission.bind(this));\n\t}\n\n\tcreate() {\n\t\tvar data = [\n\t\t\t{\n\t\t\t\tid: 'sheets-buttons-toolbox',\n\t\t\t\ttype: 'toolbox',\n\t\t\t\tchildren: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'firstrecord',\n\t\t\t\t\t\ttype: 'customtoolitem',\n\t\t\t\t\t\ttext: _('Scroll to the first sheet'),\n\t\t\t\t\t\tcommand: 'firstrecord',\n\t\t\t\t\t\tvisible: this.showNavigation\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'prevrecord',\n\t\t\t\t\t\ttype: 'customtoolitem',\n\t\t\t\t\t\ttext: _('Scroll left'),\n\t\t\t\t\t\tcommand: 'prevrecord',\n\t\t\t\t\t\tvisible: this.showNavigation,\n\t\t\t\t\t\tpressAndHold: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'nextrecord',\n\t\t\t\t\t\ttype: 'customtoolitem',\n\t\t\t\t\t\ttext: _('Scroll right'),\n\t\t\t\t\t\tcommand: 'nextrecord',\n\t\t\t\t\t\tvisible: this.showNavigation,\n\t\t\t\t\t\tpressAndHold: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'lastrecord',\n\t\t\t\t\t\ttype: 'customtoolitem',\n\t\t\t\t\t\ttext: _('Scroll to the last sheet'),\n\t\t\t\t\t\tcommand: 'lastrecord',\n\t\t\t\t\t\tvisible: this.showNavigation\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'insertsheet',\n\t\t\t\t\t\ttype: 'customtoolitem',\n\t\t\t\t\t\ttext: _('Insert sheet'),\n\t\t\t\t\t\tcommand: 'insertsheet'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\tthis.parentContainer.replaceChildren();\n\t\tthis.builder.build(this.parentContainer, data);\n\t}\n\n\tonDocLayerInit() {\n\t\tvar docType = this.map.getDocType();\n\t\tif (docType == 'spreadsheet') {\n\t\t\tif (!window.mode.isMobile()) {\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tonUpdatePermission(e) {\n\t\tif (e.detail.perm === 'edit') {\n\t\t\tthis.enableInsertion(true);\n\t\t} else {\n\t\t\tthis.enableInsertion(false);\n\t\t}\n\t}\n\n\tenableInsertion(enable) {\n\t\tthis.builder.executeAction(this.parentContainer, {\n\t\t\t'control_id': 'insertsheet',\n\t\t\t'action_type': enable ? 'enable' : 'disable'\n\t\t});\n\t}\n\n\tshow() {\n\t\tthis.parentContainer.style.display = 'grid';\n\t}\n\n\thide() {\n\t\tthis.parentContainer.style.display = 'none';\n\t}\n}\n\nJSDialog.SheetsBar = function (map, showNavigation) {\n\treturn new SheetsBar(map, showNavigation);\n};\n"]}