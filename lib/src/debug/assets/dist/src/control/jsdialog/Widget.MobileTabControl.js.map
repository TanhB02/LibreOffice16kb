{"version":3,"file":"Widget.MobileTabControl.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.MobileTabControl.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * JSDialog.MobileTabControl - widgets handling tabs on mobile\n *\n * Example JSON:\n * {\n *     id: 'id',\n *     type: 'tabcontrol',\n *     children: [...]\n * }\n */\n\n/* global JSDialog $ */\n\n\nfunction _panelTabsHandler(parentContainer, data, builder, tabTooltip, isTabControl) {\n\tif (!builder.options.useSetTabs)\n\t\tconsole.warn('mobile panelTabsHandler: setTabs will be used ignoring useSetTabs property');\n\n\tvar tabsContainer = L.DomUtil.create('div', 'ui-tabs ' + builder.options.cssClass + ' ui-widget');\n\tvar contentsContainer = L.DomUtil.create('div', 'ui-tabs-content ' + builder.options.cssClass + ' ui-widget', parentContainer);\n\n\tvar tabIdx,item;\n\tif (!isTabControl) {\n\t\tfor (var tabIdx = data.length - 1; tabIdx >= 0; tabIdx--) {\n\t\t\tvar item = data[tabIdx];\n\t\t\tif (item.hidden === true)\n\t\t\t\tdata.splice(tabIdx, 1);\n\t\t}\n\t}\n\n\tvar tabs = [];\n\tvar contentDivs = [];\n\tvar labels = [];\n\tfor (tabIdx = 0; tabIdx < data.length; tabIdx++) {\n\t\titem = data[tabIdx];\n\n\t\tvar title = builder._cleanText(item.text);\n\n\t\tvar tab = L.DomUtil.create('div', 'ui-tab ' + builder.options.cssClass, tabsContainer);\n\t\ttab.id = title;\n\t\ttabs[tabIdx] = tab;\n\n\t\tvar label = L.DomUtil.create('span', 'ui-tab-content ' + builder.options.cssClass + ' unolabel', tab);\n\t\tlabel.textContent = title;\n\t\tlabels[tabIdx] = title;\n\n\t\tvar contentDiv = L.DomUtil.create('div', 'ui-content level-' + builder._currentDepth + ' ' + builder.options.cssClass, contentsContainer);\n\t\tcontentDiv.title = title;\n\n\t\tbuilder._currentDepth++;\n\t\tif (item.children)\n\t\t{\n\t\t\tfor (var i = 0; i < item.children.length; i++) {\n\t\t\t\tbuilder.build(contentDiv, [item.children[i]]);\n\t\t\t}\n\t\t}\n\t\telse // build ourself inside there\n\t\t{\n\t\t\tbuilder.build(contentDiv, [item]);\n\t\t}\n\t\tbuilder._currentDepth--;\n\n\t\t$(contentDiv).addClass('hidden');\n\t\tcontentDivs[tabIdx] = contentDiv;\n\t}\n\n\tif (builder.wizard) {\n\t\tbuilder.wizard.setTabs(tabsContainer, builder);\n\n\t\tfor (var t = 0; t < tabs.length; t++) {\n\t\t\t// to get capture of 't' right has to be a sub fn.\n\t\t\tvar fn = builder._createTabClick(\n\t\t\t\tbuilder, t, tabs, contentDivs, labels);\n\t\t\t$(tabs[t]).click(fn);\n\t\t}\n\t} else {\n\t\twindow.app.console.debug('Builder used outside of mobile wizard: please implement the click handler');\n\t}\n\t$(tabs[0]).click();\n\tbuilder.wizard.goLevelDown(contentsContainer);\n\n\treturn false;\n}\n\n// use unified tabs handling in mobile wizard so Tab Control is show exactly like Panels\nfunction _tabsToPanelConverter(parentContainer, data, builder, tabTooltip) {\n\tvar tabs = 0;\n\tvar tabObjects = [];\n\tfor (var tabIdx = 0; data.children && tabIdx < data.children.length; tabIdx++) {\n\t\tif (data.children[tabIdx].type === 'tabpage' || data.vertical) {\n\t\t\ttabs++;\n\t\t\ttabObjects.push(data.children[tabIdx]);\n\t\t}\n\t}\n\tvar isMultiTabJSON = tabs > 1;\n\n\tif (data.tabs) {\n\t\tfor (tabIdx = 0; data.tabs && tabIdx < data.tabs.length; tabIdx++) {\n\t\t\tvar isSelectedTab = data.selected == data.tabs[tabIdx].id;\n\t\t\tif (isSelectedTab) {\n\t\t\t\tvar singleTabId = tabIdx;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (isMultiTabJSON) {\n\t\tvar tabId = 0;\n\t\tfor (tabIdx = 0; tabIdx < data.children.length; tabIdx++) {\n\t\t\tvar tab = data.children[tabIdx];\n\n\t\t\tif (tab.type !== 'tabpage' && !data.vertical)\n\t\t\t\tcontinue;\n\n\t\t\ttabObjects[tabId].text = data.tabs[tabId].text;\n\t\t\ttabId++;\n\t\t}\n\t} else {\n\t\tfor (tabIdx = 0; tabIdx < data.children.length; tabIdx++) {\n\t\t\ttab = data.children[tabIdx];\n\n\t\t\tif (tab.type !== 'tabpage' && !data.vertical)\n\t\t\t\tcontinue;\n\n\t\t\ttabObjects[singleTabId].text = data.tabs[singleTabId].text;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t_panelTabsHandler(parentContainer, tabObjects, builder, tabTooltip, true);\n\n\treturn false;\n}\n\n// if the tabs list is too long, it ends up being pretty messy. We should switch to submenus in that case\nfunction _tabsToSubmenuConverter(parentContainer, data, builder) {\n    const submenuChildren = [];\n\n    for (const [index, tab] of Object.entries(data.children)) {\n        if (tab.type !== 'tabpage') {\n            continue\n        }\n\n        submenuChildren.push({\n            children: tab.children,\n            command: tab.command,\n            enabled: true,\n            executionType: 'menu',\n            id: tab.id,\n            parent: parentContainer,\n            text: data.tabs[index].text,\n            type: 'submenu',\n        });\n    }\n\n    data.children = submenuChildren;\n\n    return JSDialog.container(parentContainer, data, builder);\n}\n\n\nJSDialog.mobileTabControl = function (parentContainer, data, builder) {\n\tvar buildInnerData = _tabsToPanelConverter(parentContainer, data, builder);\n\treturn buildInnerData;\n};\n\nJSDialog.mobilePanelControl = function (parentContainer, data, builder) {\n\tvar buildInnerData = _panelTabsHandler(parentContainer, data, builder);\n\treturn buildInnerData;\n};\n\nJSDialog.mobileSubmenuTabControl = function (parentContainer, data, builder) {\n\tvar buildInnerData = _tabsToSubmenuConverter(parentContainer, data, builder);\n\treturn buildInnerData;\n};\n"]}