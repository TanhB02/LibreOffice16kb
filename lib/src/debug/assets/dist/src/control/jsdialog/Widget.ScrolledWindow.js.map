{"version":3,"file":"Widget.ScrolledWindow.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.ScrolledWindow.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * JSDialog.ScrolledWindow - container with scrollbars\n *\n * Example JSON:\n * {\n *     id: 'id',\n *     type: 'scrollwindow',\n *     vertical: {\n * \t       policy: always,\n *         lower: 0,\n *         upper: 5,\n *         page_size: 4\n *     },\n *     horizontal: {\n * \t       policy: always,\n *         lower: 0,\n *         upper: 5,\n *         page_size: 4\n *     },\n *     children: [...]\n * }\n */\n\n/* global JSDialog */\n\nfunction _hasDrawingAreaInside(children) {\n\tif (!children)\n\t\treturn false;\n\n\tfor (var i in children) {\n\t\tif (children[i].type === 'drawingarea')\n\t\t\treturn true;\n\t\tif (_hasDrawingAreaInside(children[i].children))\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nfunction _scrolledWindowControl(parentContainer, data, builder) {\n\tvar scrollwindow = L.DomUtil.create('div', builder.options.cssClass + ' ui-scrollwindow', parentContainer);\n\tif (data.id)\n\t\tscrollwindow.id = data.id;\n\n\t// drawing areas inside scrollwindows should be not cropped so we add special class\n\tif (_hasDrawingAreaInside(data.children))\n\t\tL.DomUtil.addClass(scrollwindow, 'has-ui-drawing-area');\n\n\tvar content = L.DomUtil.create('div', builder.options.cssClass + ' ui-scrollwindow-content', scrollwindow);\n\n\tbuilder.build(content, data.children, false);\n\n\tif (!data.vertical && !data.horizontal)\n\t\treturn false;\n\n\tvar noVertical = data.vertical.policy === 'never';\n\tif (noVertical)\n\t\tscrollwindow.style.overflowY = 'hidden';\n\tif (data.vertical.policy === 'always')\n\t\tscrollwindow.style.overflowY = 'scroll';\n\n\tvar noHorizontal = data.horizontal.policy === 'never';\n\tif (noHorizontal)\n\t\tscrollwindow.style.overflowX = 'hidden';\n\tif (data.horizontal.policy === 'always')\n\t\tscrollwindow.style.overflowX = 'scroll';\n\n\tvar realContentHeight = scrollwindow.scrollHeight;\n\tvar realContentWidth = scrollwindow.scrollwidth;\n\n\tvar margin = 15;\n\n\tvar verticalSteps = (data.vertical.upper - data.vertical.lower - data.vertical.page_size) * 10;\n\tif (verticalSteps < 0 || noVertical)\n\t\tverticalSteps = 0;\n\n\tvar horizontalSteps = (data.horizontal.upper - data.horizontal.lower - data.horizontal.page_size) * 10;\n\tif (horizontalSteps < 0 || noHorizontal)\n\t\thorizontalSteps = 0;\n\n\tvar timeoutLimit = 2;\n\tvar updateSize = function () {\n\t\trealContentHeight = scrollwindow.scrollHeight;\n\t\trealContentWidth = scrollwindow.scrollwidth;\n\t\tif (realContentHeight === 0 || realContentWidth === 0) {\n\t\t\tif (timeoutLimit--)\n\t\t\t\tsetTimeout(updateSize, 100);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!noVertical) {\n\t\t\tcontent.style.height = (realContentHeight + verticalSteps) + 'px';\n\t\t\tscrollwindow.style.height = (realContentHeight + margin) + 'px';\n\t\t}\n\t\tif (!noHorizontal) {\n\t\t\tcontent.style.width = (realContentWidth + horizontalSteps) + 'px';\n\t\t\tscrollwindow.style.width = (realContentWidth + margin) + 'px';\n\t\t}\n\n\t\tcontent.scrollTop = data.vertical.value * 10;\n\t\tcontent.scrollLeft = data.horizontal.value * 10;\n\n\t\tcontent.style.margin = content.scrollTop + 'px ' + margin + 'px ' + margin + 'px ' + content.scrollLeft + 'px';\n\t};\n\n\tif (data.user_managed_scrolling !== false)\n\t\tsetTimeout(updateSize, 0);\n\n\tvar sendTimer = null;\n\n\tif ((!noVertical && verticalSteps) || (!noHorizontal && horizontalSteps)) {\n\t\tscrollwindow.addEventListener('scroll', function () {\n\t\t\t// keep content at the same place on the screen\n\t\t\tvar scrollTop = scrollwindow.scrollTop;\n\t\t\tvar scrollLeft = scrollwindow.scrollLeft;\n\n\t\t\tif (data.user_managed_scrolling !== false) {\n\t\t\t\tcontent.style.margin = scrollTop + 'px ' + margin + 'px ' + margin + 'px ' + scrollLeft + 'px';\n\t\t\t\tcontent.style.height = (realContentHeight - scrollTop + verticalSteps) + 'px';\n\t\t\t\tcontent.style.width = (realContentWidth - scrollLeft + horizontalSteps) + 'px';\n\t\t\t}\n\n\t\t\tif (sendTimer)\n\t\t\t\tclearTimeout(sendTimer);\n\t\t\tsendTimer = setTimeout(function () {\n\t\t\t\tbuilder.callback('scrolledwindow', 'scrollv', scrollwindow, Math.round(scrollTop / 10), builder);\n\t\t\t\tbuilder.callback('scrolledwindow', 'scrollh', scrollwindow, Math.round(scrollLeft / 10), builder); }, 50);\n\t\t});\n\t}\n\n\treturn false;\n}\n\nJSDialog.scrolledWindow = function (parentContainer, data, builder) {\n\tvar buildInnerData = _scrolledWindowControl(parentContainer, data, builder);\n\treturn buildInnerData;\n};\n"]}