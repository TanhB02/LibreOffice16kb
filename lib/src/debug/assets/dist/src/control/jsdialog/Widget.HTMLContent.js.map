{"version":3,"file":"Widget.HTMLContent.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.HTMLContent.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * Util.HTMLContent - widgets created from plain HTML\n */\n\ndeclare var JSDialog: any;\ndeclare var L: any;\n\ninterface HtmlContentJson {\n\tid: string;\n\ttype: 'htmlcontent';\n\thtmlId: string;\n\tcloseCallback: EventListenerOrEventListenerObject;\n\tisReadOnlyMode: boolean | undefined;\n\tcanUserWrite: boolean | undefined;\n\ttext: string | undefined;\n\tenabled: boolean;\n}\n\nfunction sanitizeString(text: string): string {\n\tconst sanitizer = document.createElement('div');\n\tsanitizer.innerText = text;\n\treturn sanitizer.innerHTML;\n}\n\nfunction getPermissionModeElements(\n\tisReadOnlyMode: boolean,\n\tcanUserWrite: boolean,\n\tmap: any,\n) {\n\tconst permissionModeDiv = document.createElement('div');\n\tpermissionModeDiv.className = 'jsdialog ui-badge';\n\n\tif (isReadOnlyMode && !canUserWrite) {\n\t\tpermissionModeDiv.classList.add('status-readonly-mode');\n\t\tpermissionModeDiv.textContent = _('Read-only');\n\t\tpermissionModeDiv.setAttribute('data-cooltip', _('Permission Mode'));\n\t\tL.control.attachTooltipEventListener(permissionModeDiv, map);\n\t} else if (isReadOnlyMode && canUserWrite) {\n\t\tpermissionModeDiv.classList.add('status-readonly-transient-mode');\n\t\tpermissionModeDiv.style.display = 'none';\n\t} else {\n\t\tpermissionModeDiv.classList.add('status-edit-mode');\n\t\tpermissionModeDiv.textContent = _('Edit mode');\n\t\tpermissionModeDiv.setAttribute('data-cooltip', _('Permission Mode'));\n\t\tL.control.attachTooltipEventListener(permissionModeDiv, map);\n\t}\n\n\treturn permissionModeDiv;\n}\n\nfunction getStatusbarItemElements(\n\tid: string,\n\ttitle: string,\n\ttext: string,\n\tbuilder: any,\n) {\n\tconst div = document.createElement('div');\n\tdiv.id = id;\n\tdiv.className = 'jsdialog ui-badge';\n\tdiv.textContent = text;\n\tdiv.setAttribute('data-cooltip', title);\n\tL.control.attachTooltipEventListener(div, builder.map);\n\n\treturn div;\n}\n\nfunction getPageNumberElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'StatePageNumber',\n\t\t_('Number of Pages'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getWordCountElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'StateWordCount',\n\t\t_('Word Counter'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getStatusDocPosElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'StatusDocPos',\n\t\t_('Number of Sheets'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getInsertModeElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'InsertMode',\n\t\t_('Entering text mode'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getSelectionModeElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'StatusSelectionMode',\n\t\t_('Selection Mode'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getRowColSelCountElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'RowColSelCount',\n\t\t_('Selected range of cells'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getStateTableCellElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'StateTableCell',\n\t\t_('Choice of functions'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getSlideStatusElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'SlideStatus',\n\t\t_('Number of Slides'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getPageStatusElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'PageStatus',\n\t\t_('Number of Pages'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nfunction getDocumentStatusElements(text: string, builder: any) {\n\tconst docstat = getStatusbarItemElements(\n\t\t'DocumentStatus',\n\t\t_('Your changes have been saved'),\n\t\t'',\n\t\tbuilder,\n\t);\n\n\tif (text === 'SAVING') docstat.textContent = _('Saving...');\n\telse if (text === 'SAVED') {\n\t\tconst lastSaved = document.createElement('span');\n\t\tlastSaved.id = 'last-saved';\n\t\tlastSaved.textContent = '';\n\t\tlastSaved.setAttribute(\n\t\t\t'data-cooltip',\n\t\t\t_('Your changes have been saved') + '.',\n\t\t);\n\t\tL.control.attachTooltipEventListener(lastSaved, builder.map);\n\t\tdocstat.appendChild(lastSaved);\n\t}\n\n\treturn docstat;\n}\n\nfunction getShowCommentsStatusElements(text: string, builder: any) {\n\treturn getStatusbarItemElements(\n\t\t'ShowComments',\n\t\t_('Show Comments'),\n\t\ttext,\n\t\tbuilder,\n\t);\n}\n\nvar getElementsFromId = function (\n\tid: string,\n\tcloseCallback: EventListenerOrEventListenerObject,\n\tdata: HtmlContentJson,\n\tbuilder: any,\n) {\n\tif (id === 'iconset')\n\t\treturn (window as any).getConditionalFormatMenuElements(\n\t\t\t'iconsetoverlay',\n\t\t\ttrue,\n\t\t);\n\telse if (id === 'scaleset')\n\t\treturn (window as any).getConditionalColorScaleMenuElements(\n\t\t\t'iconsetoverlay',\n\t\t\ttrue,\n\t\t);\n\telse if (id === 'databarset')\n\t\treturn (window as any).getConditionalDataBarMenuElements(\n\t\t\t'iconsetoverlay',\n\t\t\ttrue,\n\t\t);\n\telse if (id === 'inserttablepopup')\n\t\treturn (window as any).getInsertTablePopupElements(closeCallback);\n\telse if (id === 'borderstylepopup')\n\t\treturn (window as any).getBorderStyleMenuElements(closeCallback);\n\telse if (id === 'insertshapespopup')\n\t\treturn (window as any).getShapesPopupElements(closeCallback);\n\telse if (id === 'insertconnectorspopup')\n\t\treturn (window as any).getConnectorsPopupElements(closeCallback);\n\telse if (id === 'userslistpopup') return L.control.createUserListWidget();\n\telse if (id === 'permissionmode')\n\t\treturn getPermissionModeElements(\n\t\t\tdata.isReadOnlyMode,\n\t\t\tdata.canUserWrite,\n\t\t\tbuilder.map,\n\t\t);\n\telse if (id === 'statepagenumber')\n\t\treturn getPageNumberElements(data.text, builder);\n\telse if (id === 'statewordcount')\n\t\treturn getWordCountElements(data.text, builder);\n\telse if (id === 'showcomments')\n\t\treturn getShowCommentsStatusElements(data.text, builder);\n\telse if (id === 'statusdocpos')\n\t\treturn getStatusDocPosElements(data.text, builder);\n\telse if (id === 'insertmode')\n\t\treturn getInsertModeElements(data.text, builder);\n\telse if (id === 'statusselectionmode')\n\t\treturn getSelectionModeElements(data.text, builder);\n\telse if (id === 'rowcolselcount')\n\t\treturn getRowColSelCountElements(data.text, builder);\n\telse if (id === 'statetablecell')\n\t\treturn getStateTableCellElements(data.text, builder);\n\telse if (id === 'slidestatus')\n\t\treturn getSlideStatusElements(data.text, builder);\n\telse if (id === 'pagestatus')\n\t\treturn getPageStatusElements(data.text, builder);\n\telse if (id === 'documentstatus')\n\t\treturn getDocumentStatusElements(data.text, builder);\n};\n\nfunction htmlContent(\n\tparentContainer: Element,\n\tdata: HtmlContentJson,\n\tbuilder: JSBuilder,\n) {\n\tparentContainer.replaceChildren();\n\n\tconst elements = getElementsFromId(\n\t\tdata.htmlId,\n\t\tdata.closeCallback,\n\t\tdata,\n\t\tbuilder,\n\t);\n\n\tparentContainer.appendChild(elements);\n\n\t// TODO: remove this and create real widget for userslistpopup\n\tif (data.htmlId === 'userslistpopup')\n\t\tsetTimeout(() => builder.map.userList.renderAll(), 0);\n\n\tif (data.enabled === false && parentContainer.firstChild)\n\t\t(parentContainer.firstChild as HTMLElement).setAttribute(\n\t\t\t'disabled',\n\t\t\t'true',\n\t\t);\n}\n\nJSDialog.htmlContent = htmlContent;\n"]}