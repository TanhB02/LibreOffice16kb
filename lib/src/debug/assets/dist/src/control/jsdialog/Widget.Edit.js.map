{"version":3,"file":"Widget.Edit.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.Edit.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * JSDialog.Edit - single line input field widget\n *\n * Example JSON:\n * {\n *     id: 'id',\n *     type: 'edit',\n *     text: 'abc',\n *     placeholder: 'this is shown when empty',\n *     password: false,\n *     hidden: false,\n *     changedCallback: null\n * }\n */\n\ndeclare var JSDialog: any;\n\ntype EditWidgetControl = {\n\tcontainer: HTMLElement;\n\tinput: HTMLInputElement;\n};\n\nclass EditWidget {\n\tprotected parentContainer: HTMLElement;\n\tprotected data: EditWidgetJSON;\n\tprotected builder: JSBuilder;\n\tprotected callback: JSDialogCallback;\n\tprotected edit: EditWidgetControl;\n\n\tconstructor(\n\t\tparentContainer: HTMLElement,\n\t\tdata: EditWidgetJSON,\n\t\tbuilder: JSBuilder,\n\t\tcallback: JSDialogCallback,\n\t) {\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.data = data;\n\t\tthis.builder = builder;\n\t\tthis.callback = callback;\n\t}\n\n\tprotected static buildImpl(\n\t\tparentContainer: HTMLElement,\n\t\tdata: EditWidgetJSON,\n\t\tbuilder: JSBuilder,\n\t): EditWidgetControl {\n\t\tconst result: EditWidgetControl = { container: null, input: null };\n\n\t\tvar container = L.DomUtil.create(\n\t\t\t'div',\n\t\t\t'ui-edit-container ' + builder.options.cssClass,\n\t\t\tparentContainer,\n\t\t);\n\t\tcontainer.id = data.id;\n\t\tresult.container = container;\n\n\t\tvar edit = L.DomUtil.create(\n\t\t\t'input',\n\t\t\t'ui-edit ' + builder.options.cssClass,\n\t\t\tcontainer,\n\t\t);\n\t\tedit.value = data.text;\n\t\tedit.id = data.id + '-input';\n\t\tedit.dir = 'auto';\n\t\tedit.setAttribute('autocomplete', 'off');\n\n\t\tresult.input = edit;\n\n\t\tif (data.password === true) edit.type = 'password';\n\n\t\tif (data.enabled === false) {\n\t\t\tcontainer.setAttribute('disabled', 'true');\n\t\t\tedit.disabled = true;\n\t\t}\n\n\t\tJSDialog.SynchronizeDisabledState(container, [edit]);\n\n\t\tif (data.hidden) $(edit).hide();\n\n\t\tif (data.placeholder) {\n\t\t\tedit.setAttribute('placeholder', data.placeholder);\n\t\t\tedit.setAttribute('aria-label', data.placeholder);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onKeyUp(e: KeyboardEvent) {\n\t\tvar callbackToUse =\n\t\t\te.key === 'Enter' && this.data.changedCallback\n\t\t\t\t? this.data.changedCallback\n\t\t\t\t: null;\n\t\tif (this.callback) callbackToUse = this.callback;\n\t\tif (typeof callbackToUse === 'function')\n\t\t\tcallbackToUse(this.edit.input.value);\n\t\telse\n\t\t\tthis.builder.callback(\n\t\t\t\t'edit',\n\t\t\t\t'change',\n\t\t\t\tthis.edit.container,\n\t\t\t\tthis.edit.input.value,\n\t\t\t\tthis.builder,\n\t\t\t);\n\t}\n\n\tprotected onClick(e: MouseEvent) {\n\t\te.stopPropagation();\n\t}\n\n\tprotected setupEventListeners() {\n\t\tthis.edit.input.addEventListener('keyup', this.onKeyUp.bind(this));\n\t\tthis.edit.input.addEventListener('click', this.onClick.bind(this));\n\t}\n\n\tpublic build(): boolean {\n\t\tthis.edit = EditWidget.buildImpl(\n\t\t\tthis.parentContainer,\n\t\t\tthis.data,\n\t\t\tthis.builder,\n\t\t);\n\n\t\tthis.setupEventListeners();\n\n\t\treturn false;\n\t}\n}\n\nJSDialog.edit = function (\n\tparentContainer: HTMLElement,\n\tdata: EditWidgetJSON,\n\tbuilder: JSBuilder,\n\tcallback: JSDialogCallback,\n) {\n\tconst widget = new EditWidget(parentContainer, data, builder, callback);\n\treturn widget.build();\n};\n"]}