{"version":3,"file":"Widget.Containers.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.Containers.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * JSDialog.Containers - various container widgets\n */\n\ndeclare var JSDialog: any;\n\nfunction _getGridChild(\n\tchildren: Array<WidgetJSON>,\n\trow: number,\n\tcol: number,\n): WidgetJSON {\n\tfor (var index in children) {\n\t\tif (\n\t\t\tparseInt(children[index].top) == row &&\n\t\t\tparseInt(children[index].left) == col\n\t\t)\n\t\t\treturn children[index];\n\t}\n\treturn null;\n}\n\nJSDialog.container = function (\n\tparentContainer: Element,\n\tdata: ContainerWidgetJSON | GridWidgetJSON,\n\tbuilder: any,\n) {\n\tif ((data as GridWidgetJSON).cols && (data as GridWidgetJSON).rows)\n\t\treturn JSDialog.grid(parentContainer, data, builder);\n\n\tif (parentContainer && !parentContainer.id) parentContainer.id = data.id;\n\n\treturn true;\n};\n\nJSDialog.grid = function (\n\tparentContainer: Element,\n\tdata: GridWidgetJSON,\n\tbuilder: JSBuilder,\n) {\n\tconst rows = builder._getGridRows(data.children);\n\tconst cols = builder._getGridColumns(data.children);\n\n\tconst processedChildren = [];\n\n\tconst table = L.DomUtil.create(\n\t\t'div',\n\t\tbuilder.options.cssClass + ' ui-grid',\n\t\tparentContainer,\n\t);\n\ttable.id = data.id;\n\n\tconst gridRowColStyle =\n\t\t'grid-template-rows: repeat(' +\n\t\trows +\n\t\t', auto); \\\n\t\tgrid-template-columns: repeat(' +\n\t\tcols +\n\t\t', auto);';\n\n\ttable.style = gridRowColStyle;\n\n\tfor (let row = 0; row < rows; row++) {\n\t\tlet prevChild = null;\n\n\t\tfor (let col = 0; col < cols; col++) {\n\t\t\tconst child = _getGridChild(data.children, row, col);\n\t\t\tconst isMergedCell =\n\t\t\t\tprevChild &&\n\t\t\t\tprevChild.width &&\n\t\t\t\tparseInt(prevChild.left) + parseInt(prevChild.width) > col;\n\n\t\t\tif (child) {\n\t\t\t\tif (!child.id || child.id === '')\n\t\t\t\t\t// required for postprocess...\n\t\t\t\t\tchild.id = table.id + '-cell-' + row + '-' + col;\n\n\t\t\t\tconst sandbox = L.DomUtil.create('div');\n\t\t\t\tbuilder.build(sandbox, [child], false);\n\n\t\t\t\tconst control = sandbox.firstChild;\n\t\t\t\tif (control) {\n\t\t\t\t\tL.DomUtil.addClass(control, 'ui-grid-cell');\n\t\t\t\t\ttable.appendChild(control);\n\t\t\t\t}\n\n\t\t\t\tprocessedChildren.push(child);\n\t\t\t\tprevChild = child;\n\t\t\t} else if (!isMergedCell) {\n\t\t\t\t// empty placeholder to keep correct order\n\t\t\t\tL.DomUtil.create('div', 'ui-grid-cell', table);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (let i = 0; i < (data.children || []).length; i++) {\n\t\tconst child = data.children[i];\n\t\tif (processedChildren.indexOf(child) === -1) {\n\t\t\tconst sandbox = L.DomUtil.create('div');\n\t\t\tbuilder.build(sandbox, [child], false);\n\t\t\tconst control = sandbox.firstChild;\n\t\t\tif (control) {\n\t\t\t\tL.DomUtil.addClass(control, 'ui-grid-cell');\n\t\t\t\ttable.appendChild(control);\n\t\t\t}\n\t\t\tprocessedChildren.push(child);\n\t\t}\n\t}\n\n\treturn false;\n};\n\nJSDialog.toolbox = function (\n\tparentContainer: Element,\n\tdata: ToolboxWidgetJSON,\n\tbuilder: JSBuilder,\n) {\n\tconst levelClass =\n\t\tbuilder._currentDepth !== undefined\n\t\t\t? ' level-' + builder._currentDepth\n\t\t\t: '';\n\tconst toolbox = L.DomUtil.create(\n\t\t'div',\n\t\tbuilder.options.cssClass + ' horizontal toolbox' + levelClass,\n\t\tparentContainer,\n\t);\n\ttoolbox.id = data.id;\n\n\tif (data.enabled === false) {\n\t\ttoolbox.disabled = true;\n\t\tfor (const index in data.children) {\n\t\t\tdata.children[index].enabled = false;\n\t\t}\n\t}\n\n\tconst enabledCallback = function (enable: boolean) {\n\t\tfor (const j in data.children) {\n\t\t\tconst childId = data.children[j].id;\n\t\t\tconst toolboxChild = toolbox.querySelector('#' + childId);\n\t\t\tif (!toolboxChild) continue;\n\t\t\tif (enable) {\n\t\t\t\ttoolboxChild.removeAttribute('disabled');\n\t\t\t\ttoolboxChild.classList.remove('disabled');\n\t\t\t} else {\n\t\t\t\ttoolboxChild.disabled = true;\n\t\t\t\ttoolboxChild.classList.add('disabled');\n\t\t\t}\n\t\t}\n\t};\n\tJSDialog.OnStateChange(toolbox, enabledCallback);\n\n\t// builder modifiers\n\tconst noLabels = builder.options.noLabelsForUnoButtons;\n\tbuilder.options.noLabelsForUnoButtons = true;\n\n\tconst inlineLabels = builder.options.useInLineLabelsForUnoButtons;\n\tif (data.hasVerticalParent === true && data.children.length === 1)\n\t\tbuilder.options.useInLineLabelsForUnoButtons = true;\n\n\tbuilder.build(toolbox, data.children, false);\n\n\t// reset modifiers\n\tbuilder.options.useInLineLabelsForUnoButtons = inlineLabels;\n\tbuilder.options.noLabelsForUnoButtons = noLabels;\n\n\treturn false;\n};\n\nJSDialog.spacer = function (\n\tparentContainer: Element,\n\tdata: WidgetJSON,\n\tbuilder: JSBuilder,\n) {\n\tconst spacer = L.DomUtil.create(\n\t\t'div',\n\t\tbuilder.options.cssClass + ' ui-spacer',\n\t\tparentContainer,\n\t);\n\tspacer.id = data.id;\n\n\treturn false;\n};\n"]}