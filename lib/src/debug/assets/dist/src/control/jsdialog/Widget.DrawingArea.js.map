{"version":3,"file":"Widget.DrawingArea.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/control/jsdialog/Widget.DrawingArea.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * JSDialog.DrawingArea - drawing area displaying picture sent from the server\n *\n * Example JSON:\n * {\n *     id: 'id',\n *     type: 'drawingarea',\n *     image: 'base64 encoded image',\n *     text: 'alternative text',\n *     loading: true, - show additional spinner div\n *     placeholderText: false,  - 'show text next to image'\n * }\n */\n\n/* global JSDialog $ UNOKey UNOModifier */\n\nfunction _drawingAreaControl (parentContainer, data, builder) {\n\tvar container = L.DomUtil.create('div', builder.options.cssClass + ' ui-drawing-area-container', parentContainer);\n\tcontainer.id = data.id;\n\n\tif (!data.image)\n\t\treturn;\n\n\tvar image = L.DomUtil.create('img', builder.options.cssClass + ' ui-drawing-area', container);\n\tvar imageId = data.id + '-img';\n\timage.id = imageId;\n\timage.src = data.image.replace(/\\\\/g, '');\n\timage.alt = data.text;\n\timage.tabIndex = 0;\n\timage.draggable = false;\n\timage.ondragstart = function() { return false; };\n\n\tif (data.text) {\n\t\timage.setAttribute('data-cooltip', data.text);\n\n\t\tif (builder.map) {\n\t\t\tL.control.attachTooltipEventListener(image, builder.map);\n\t\t}\n\t} else if (data.aria && data.aria.label) {\n\t\timage.setAttribute('aria-label', data.aria.label);\n\t}\n\n\t// Line width dialog is affected from delay on image render.\n\t// So If the image render is delayed, use width and height of the data\n\tif (JSDialog.isWidgetInModalPopup(data) && image.width == 0 && image.height == 0) {\n\t\timage.width = data.imagewidth;\n\t\timage.height = data.imageheight;\n\t}\n\n\tif (data.loading && data.loading === 'true') {\n\t\tvar loaderContainer = L.DomUtil.create('div', 'ui-drawing-area-loader-container', container);\n\t\tL.DomUtil.create('div', 'ui-drawing-area-loader', loaderContainer);\n\t}\n\tif (data.placeholderText && data.placeholderText === 'true') {\n\t\tvar spanContainer = L.DomUtil.create('div', 'ui-drawing-area-placeholder-container', container);\n\t\tvar span = L.DomUtil.create('span', 'ui-drawing-area-placeholder', spanContainer);\n\t\tspan.innerText = data.text;\n\t}\n\n\tvar getCoordinatesFromEvent = function (e) {\n\t\tvar imageElement = document.getElementById(imageId);\n\t\tvar ret = [0, 0];\n\n\t\tif (e.offsetX) {\n\t\t\tret[0] = e.offsetX;\n\t\t\tret[1] = e.offsetY;\n\t\t} else if (e.changedTouches && e.changedTouches.length) {\n\t\t\tret[0] = e.changedTouches[e.changedTouches.length-1].pageX - $(imageElement).offset().left;\n\t\t\tret[1] = e.changedTouches[e.changedTouches.length-1].pageY - $(imageElement).offset().top;\n\t\t}\n\n\t\tret[0] = ret[0] / imageElement.offsetWidth;\n\t\tret[1] = ret[1] / imageElement.offsetHeight;\n\n\t\treturn ret;\n\t};\n\n\tvar moveTimer = null;\n\tvar moveFunc = null;\n\n\tL.DomEvent.on(image, 'dblclick', function(e) {\n\t\tvar pos = getCoordinatesFromEvent(e);\n\t\tvar coordinates = pos[0] + ';' + pos[1];\n\n\t\tclearTimeout(moveTimer);\n\t\tmoveTimer = null;\n\t\tmoveFunc = null;\n\t\tbuilder.callback('drawingarea', 'dblclick', container, coordinates, builder);\n\t}, this);\n\n\tL.DomEvent.on(image, 'click touchend', function(e) {\n\t\tvar pos = getCoordinatesFromEvent(e);\n\t\tvar coordinates = pos[0] + ';' + pos[1];\n\n\t\tclearTimeout(moveTimer);\n\t\tmoveTimer = null;\n\t\tmoveFunc = null;\n\n\t\tbuilder.callback('drawingarea', 'click', container, coordinates, builder);\n\t}, this);\n\n\tvar onMove = function (e) {\n\t\tif (moveTimer && moveFunc) {\n\t\t\tclearTimeout(moveTimer);\n\t\t\tmoveTimer = null;\n\t\t\tmoveFunc();\n\t\t\tmoveFunc = null;\n\t\t}\n\n\t\tvar pos = getCoordinatesFromEvent(e);\n\t\tvar coordinates = pos[0] + ';' + pos[1];\n\t\tbuilder.callback('drawingarea', 'mousemove', container, coordinates, builder);\n\t};\n\n\tvar endMove = function (e) {\n\t\tclearTimeout(moveTimer);\n\t\tmoveTimer = null;\n\t\tmoveFunc = null;\n\n\t\twindow.removeEventListener('mousemove', onMove);\n\t\twindow.removeEventListener('mouseup', endMove);\n\n\t\tvar pos = getCoordinatesFromEvent(e);\n\t\tvar coordinates = pos[0] + ';' + pos[1];\n\t\tbuilder.callback('drawingarea', 'mouseup', container, coordinates, builder);\n\t};\n\n\timage.addEventListener('mousedown', function (e) {\n\t\tmoveFunc = function () {\n\t\t\tvar pos = getCoordinatesFromEvent(e);\n\t\t\tvar coordinates = pos[0] + ';' + pos[1];\n\t\t\tbuilder.callback('drawingarea', 'mousedown', container, coordinates, builder);\n\t\t};\n\n\t\tmoveTimer = setTimeout(function () {\n\t\t\tmoveFunc();\n\t\t\tmoveFunc = null;\n\t\t\tmoveTimer = null;\n\t\t}, 200);\n\n\t\twindow.addEventListener('mousemove', onMove);\n\t\twindow.addEventListener('mouseup', endMove);\n\t});\n\n\tvar modifier = 0;\n\n\timage.addEventListener('keydown', function(event) {\n\t\tif (event.key === 'Enter') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.RETURN | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Escape' || event.key === 'Esc') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.ESCAPE | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Left' || event.key === 'ArrowLeft') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.LEFT | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Right' || event.key === 'ArrowRight') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.RIGHT | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Up' || event.key === 'ArrowUp') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.UP | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Down' || event.key === 'ArrowDown') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.DOWN | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Home') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.HOME | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'End') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.END | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Backspace') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.BACKSPACE | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Delete') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.DELETE | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Space') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.SPACE | modifier, builder);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Tab') {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.TAB | modifier, builder);\n\t\t} else if (event.key === 'Shift') {\n\t\t\tmodifier = modifier | UNOModifier.SHIFT;\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Control') {\n\t\t\tmodifier = modifier | UNOModifier.CTRL;\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'a' && event.ctrlKey) {\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, UNOKey.A | UNOModifier.CTRL, builder);\n\t\t}\n\t});\n\n\timage.addEventListener('keyup', function(event) {\n\t\tif (event.key === 'Shift') {\n\t\t\tmodifier = modifier & (~UNOModifier.SHIFT);\n\t\t\tevent.preventDefault();\n\t\t} else if (event.key === 'Control') {\n\t\t\tmodifier = modifier & (~UNOModifier.CTRL);\n\t\t\tevent.preventDefault();\n\t\t}\n\t});\n\n\timage.addEventListener('blur', function() {\n\t\tmodifier = 0;\n\t});\n\n\timage.addEventListener('keypress', function(event) {\n\t\tif (event.key === 'Enter' ||\n\t\t\tevent.key === 'Escape' ||\n\t\t\tevent.key === 'Esc' ||\n\t\t\tevent.key === 'Left' ||\n\t\t\tevent.key === 'ArrowLeft' ||\n\t\t\tevent.key === 'Right' ||\n\t\t\tevent.key === 'ArrowRight' ||\n\t\t\tevent.key === 'Up' ||\n\t\t\tevent.key === 'ArrowUp' ||\n\t\t\tevent.key === 'Down' ||\n\t\t\tevent.key === 'ArrowDown' ||\n\t\t\tevent.key === 'Home' ||\n\t\t\tevent.key === 'End' ||\n\t\t\tevent.key === 'Backspace' ||\n\t\t\tevent.key === 'Delete' ||\n\t\t\tevent.key === 'Space' ||\n\t\t\tevent.key === 'Tab') {\n\t\t\t// skip\n\t\t} else {\n\t\t\tvar keyCode = event.keyCode;\n\t\t\tif (event.ctrlKey) {\n\t\t\t\tkeyCode = event.key.toUpperCase().charCodeAt(0);\n\t\t\t\tkeyCode = builder.map.keyboard._toUNOKeyCode(keyCode);\n\t\t\t\tkeyCode |= UNOModifier.CTRL;\n\t\t\t}\n\n\t\t\tbuilder.callback('drawingarea', 'keypress', container, keyCode, builder);\n\t\t}\n\n\t\tevent.preventDefault();\n\t});\n\n\treturn false;\n}\n\nJSDialog.drawingArea = function (parentContainer, data, builder) {\n\tvar buildInnerData = _drawingAreaControl(parentContainer, data, builder);\n\treturn buildInnerData;\n};\n"]}