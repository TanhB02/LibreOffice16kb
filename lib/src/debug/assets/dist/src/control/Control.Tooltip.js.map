{"version":3,"file":"Control.Tooltip.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.Tooltip.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * Class Tooltip - tooltip manager\n */\n\n/* global app */\n\nclass Tooltip {\n\tconstructor(options) {\n\t\tthis._options = L.extend({ timeout: 150 }, options);\n\t\tlet win = this._options.window ? this._options.window : window;\n\t\tthis._container = this._options.container\n\t\t\t? this._options.container\n\t\t\t: L.DomUtil.create('div', 'cooltip-text', win.document.body);\n\t\tthis._container.id = 'cooltip';\n\t\tthis._container.addEventListener(\n\t\t\t'mouseenter',\n\t\t\tL.bind(this.mouseEnter, this),\n\t\t);\n\t\tthis._container.addEventListener(\n\t\t\t'mouseleave',\n\t\t\tL.bind(this.mouseLeave, this),\n\t\t);\n\n\t\twin.addEventListener('keydown', L.bind(this.keyDown, this), {\n\t\t\tcapture: true,\n\t\t\tpassive: true,\n\t\t});\n\t}\n\n\tbeginShow(elem) {\n\t\tif (this._cancel) return;\n\n\t\tlet win = this._options.window ? this._options.window : window;\n\t\twin.clearTimeout(this._showTimeout);\n\t\tthis._showTimeout = win.setTimeout(\n\t\t\tL.bind(this.show, this, elem),\n\t\t\tthis._options.timeout,\n\t\t);\n\t}\n\n\tbeginHide(elem) {\n\t\tif (this._cancel) return;\n\n\t\tlet win = this._options.window ? this._options.window : window;\n\t\twin.clearTimeout(this._showTimeout);\n\t\twin.clearTimeout(this._hideTimeout);\n\t\tif (this._current)\n\t\t\tthis._hideTimeout = win.setTimeout(\n\t\t\t\tL.bind(this.hide, this, elem),\n\t\t\t\tthis._options.timeout,\n\t\t\t);\n\t}\n\n\t/**\n\t * Calculate one of the 8 different position\n\t * of the tooltip, around the elem parameter\n\t *\n\t * - bottom-right, bottom-left, top-right, top-left\n\t * - and their left/right aligned versions\n\t *\n\t * @param elem - element that the cursor is over\n\t * @param popup - tooltip rectangle\n\t * @param index - used to determine one of the 8 tooltip location\n\t * @returns tooltip rectangle with its location calculated\n\t */\n\tposition(elem, popup, index) {\n\t\tlet rect = new DOMRect();\n\t\tswitch (index) {\n\t\t\tcase 0: // below cursor, bottom-right (aligned to left)\n\t\t\t\trect.x = elem.left;\n\t\t\t\trect.y = elem.bottom + 12;\n\t\t\t\tbreak;\n\t\t\tcase 1: // below cursor, bottom-left (aligned to right)\n\t\t\t\trect.x = elem.right - popup.width;\n\t\t\t\trect.y = elem.bottom + 12;\n\t\t\t\tbreak;\n\t\t\tcase 2: // above cursor, top-right (aligned to left)\n\t\t\t\trect.x = elem.left;\n\t\t\t\trect.y = elem.top - popup.height - 8;\n\t\t\t\tbreak;\n\t\t\tcase 3: // above cursor, top-left (aligned to right)\n\t\t\t\trect.x = elem.right - popup.width;\n\t\t\t\trect.y = elem.top - popup.height - 8;\n\t\t\t\tbreak;\n\t\t\tcase 4: // below cursor, bottom-right\n\t\t\t\trect.x = elem.right;\n\t\t\t\trect.y = elem.bottom + 4;\n\t\t\t\tbreak;\n\t\t\tcase 5: // below cursor, bottom-left\n\t\t\t\trect.x = elem.left - popup.width;\n\t\t\t\trect.y = elem.bottom + 4;\n\t\t\t\tbreak;\n\t\t\tcase 6: // above cursor, top-right\n\t\t\t\trect.x = elem.right;\n\t\t\t\trect.y = elem.top - popup.height - 4;\n\t\t\t\tbreak;\n\t\t\tcase 7: // above cursor, top-left\n\t\t\t\trect.x = elem.left - popup.width;\n\t\t\t\trect.y = elem.top - popup.height - 4;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\trect.width = popup.width;\n\t\trect.height = popup.height;\n\n\t\treturn rect;\n\t}\n\n\tshow(elem, textContent) {\n\t\t// `textContent` adds flexibility, enabling custom messages like document \"Saved\" instead of the fixed \"cool-tooltip.\"\n\t\tlet content = textContent ? textContent : elem.dataset.cooltip,\n\t\t\trectView = new DOMRect(0, 0, window.innerWidth, window.innerHeight),\n\t\t\trectElem = elem.getBoundingClientRect(),\n\t\t\trectCont,\n\t\t\trectTooltip,\n\t\t\tindex = 0;\n\n\t\tthis._container.textContent = content;\n\t\tif (!this._container.textContent) return;\n\n\t\trectCont = this._container.getBoundingClientRect();\n\n\t\tdo {\n\t\t\trectTooltip = this.position(rectElem, rectCont, index++);\n\t\t} while (index < 8 && !app.LOUtil.containsDOMRect(rectView, rectTooltip));\n\t\t// containsDOMRect() checks if the tooltip box(rectTooltip) is inside the boundaries of the window(rectView)\n\n\t\tthis._container.style.left = rectTooltip.left + 'px';\n\t\tthis._container.style.top = rectTooltip.top + 'px';\n\t\tthis._container.style.visibility = 'visible';\n\t\tthis._current = elem;\n\t}\n\n\thide() {\n\t\tif (this._cancel) return;\n\n\t\tthis._container.style.visibility = 'hidden';\n\t\tthis._current = null;\n\t}\n\n\tmouseEnter() {\n\t\tif (this._current) {\n\t\t\tlet win = this._options.window ? this._options.window : window;\n\t\t\tthis._cancel = true;\n\t\t\twin.clearTimeout(this._hideTimeout);\n\t\t\twin.clearTimeout(this._showTimeout);\n\t\t}\n\t}\n\n\tmouseLeave() {\n\t\tthis._cancel = false;\n\t\tthis.beginHide();\n\t}\n\n\tkeyDown(e) {\n\t\tlet key = e.key.toUpperCase();\n\t\tif (key === 'ESCAPE') {\n\t\t\tthis.mouseLeave();\n\t\t}\n\t}\n\n\tstatic attachEventListener(elem, map) {\n\t\tif (!map.tooltip) {\n\t\t\treturn;\n\t\t}\n\n\t\telem.addEventListener('mouseenter', function () {\n\t\t\tmap.tooltip.beginShow(elem);\n\t\t});\n\t\telem.addEventListener('mouseleave', function () {\n\t\t\tmap.tooltip.beginHide(elem);\n\t\t});\n\t}\n}\n\nL.control.tooltip = function (options) {\n\treturn new Tooltip(options);\n};\n\nL.control.attachTooltipEventListener = Tooltip.attachEventListener;\n"]}