{"version":3,"file":"Control.RowGroup.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.RowGroup.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * L.Control.RowGroup\n */\n\n/* global app */\n\n/*\n\tThis file is Calc only. This adds a section for grouped rows in Calc.\n\tWhen user selects some rows and groups them using \"Data->Group and Outline->Group\" menu path, this section is added into\n\tsections list of CanvasSectionContainer. See _addRemoveGroupSections in file CalcTileLayer.js\n\n\tThis class is an extended version of \"CanvasSectionObject\".\n*/\nnamespace cool {\n\nexport class RowGroup extends GroupBase {\n\tname: string = L.CSections.RowGroup.name;\n\tanchor: any = [[L.CSections.CornerGroup.name, 'bottom', 'top'], 'left'];\n\texpand: string[] = ['top', 'bottom']; // Expand vertically.\n\tprocessingOrder: number = L.CSections.RowGroup.processingOrder;\n\tdrawingOrder: number = L.CSections.RowGroup.drawingOrder;\n\tzIndex: number = L.CSections.RowGroup.zIndex;\n\n\t_sheetGeometry: cool.SheetGeometry;\n\t_cornerHeaderHeight: number;\n\t_splitPos: cool.Point;\n\n\tconstructor() { super(); }\n\n\tupdate(): void {\n\t\tif (this.isRemoved) // Prevent calling while deleting the section. It causes errors.\n\t\t\treturn;\n\n\t\tthis._sheetGeometry = this._map._docLayer.sheetGeometry;\n\t\tthis._groups = Array(this._sheetGeometry.getRowGroupLevels());\n\n\t\t// Calculate width on the fly.\n\t\tthis.size[0] = this._computeSectionWidth();\n\n\t\tthis._cornerHeaderHeight = this.containerObject.getSectionWithName(L.CSections.CornerHeader.name).size[1];\n\n\t\tthis._splitPos = (this._map._docLayer._splitPanesContext as cool.SplitPanesContext).getSplitPos();\n\n\t\tthis._collectGroupsData(this._sheetGeometry.getRowGroupsDataInView());\n\t}\n\n\t// This returns the required width for the section.\n\t_computeSectionWidth(): number {\n\t\treturn this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * (this._groups.length + 1);\n\t}\n\n\tisGroupHeaderVisible (startY: number, startPos: number): boolean {\n\t\tif (startPos > this._splitPos.y) {\n\t\t\treturn startY > this._splitPos.y + this._cornerHeaderHeight;\n\t\t}\n\t\telse {\n\t\t\treturn startY >= this._cornerHeaderHeight;\n\t\t}\n\t}\n\n\tgetEndPosition (endPos: number): number {\n\t\tif (endPos <= this._splitPos.y)\n\t\t\treturn endPos;\n\t\telse {\n\t\t\treturn Math.max(endPos + this._cornerHeaderHeight - this.documentTopLeft[1], this._splitPos.y + this._cornerHeaderHeight);\n\t\t}\n\t}\n\n\tgetRelativeY (docPos: number): number {\n\t\tif (docPos < this._splitPos.y)\n\t\t\treturn docPos + this._cornerHeaderHeight;\n\t\telse\n\t\t\treturn Math.max(docPos - this.documentTopLeft[1], this._splitPos.y) + this._cornerHeaderHeight;\n\t}\n\n\tdrawGroupControl (group: GroupEntry): void {\n\t\tlet startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group.level;\n\t\tlet startY = this.getRelativeY(group.startPos);\n\t\tconst endY = this.getEndPosition(group.endPos);\n\t\tconst strokeColor = GroupBase.getColors().strokeColor;\n\n\t\tif (this.isGroupHeaderVisible(startY, group.startPos)) {\n\t\t\t// draw head\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.fillStyle = this.backgroundColor;\n\t\t\tthis.context.fillRect(this.transformRectX(startX, this._groupHeadSize), startY, this._groupHeadSize, this._groupHeadSize);\n\t\t\tthis.context.strokeStyle = strokeColor;\n\t\t\tthis.context.lineWidth = 1.0;\n\t\t\tthis.context.strokeRect(this.transformRectX(startX + 0.5, this._groupHeadSize), startY + 0.5, this._groupHeadSize, this._groupHeadSize);\n\n\t\t\tif (!group.hidden) {\n\t\t\t\t// draw '-'\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.25), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.75 + app.roundedDpiScale), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// draw '+'\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.25), startY + this._groupHeadSize / 2 + 0.5);\n\t\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.75 + app.roundedDpiScale), startY + this._groupHeadSize / 2 + 0.5);\n\n\t\t\t\tthis.context.stroke();\n\n\t\t\t\tthis.context.moveTo(this.transformX(startX + this._groupHeadSize * 0.50 + 0.5), startY + this._groupHeadSize * 0.25);\n\t\t\t\tthis.context.lineTo(this.transformX(startX + this._groupHeadSize * 0.50 + 0.5), startY + this._groupHeadSize * 0.75 + app.roundedDpiScale);\n\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\t\t}\n\n\t\tif (!group.hidden && endY > this._cornerHeaderHeight + this._groupHeadSize && endY > startY) {\n\t\t\t//draw tail\n\t\t\tthis.context.beginPath();\n\t\t\tstartY += this._groupHeadSize;\n\t\t\tstartY = startY >= this._cornerHeaderHeight + this._groupHeadSize ? startY: this._cornerHeaderHeight + this._groupHeadSize;\n\t\t\tstartX += this._groupHeadSize * 0.5;\n\t\t\tstartX = Math.round(startX);\n\t\t\tstartY = Math.round(startY) + 1;\n\t\t\tthis.context.strokeStyle = strokeColor;\n\t\t\tthis.context.lineWidth = 2.0;\n\t\t\tthis.context.moveTo(this.transformX(startX), startY);\n\t\t\tthis.context.lineTo(this.transformX(startX), endY - app.roundedDpiScale);\n\t\t\tthis.context.stroke();\n\t\t\tthis.context.lineTo(Math.round(this.transformX(startX + this._groupHeadSize / 2)), endY - app.roundedDpiScale);\n\t\t\tthis.context.stroke();\n\t\t}\n\t}\n\n\tdrawLevelHeader (level: number): void {\n\t\tthis.context.beginPath();\n\t\tconst ctx = this.context;\n\t\tconst ctrlHeadSize = this._groupHeadSize;\n\t\tconst levelSpacing = this._levelSpacing;\n\n\t\tconst startX = levelSpacing + (ctrlHeadSize + levelSpacing) * level;\n\t\tconst startY = Math.round((this._cornerHeaderHeight - ctrlHeadSize) * 0.5);\n\n\t\tctx.strokeStyle = GroupBase.getColors().strokeColor;\n\t\tctx.lineWidth = 1.0;\n\t\tctx.strokeRect(this.transformRectX(startX + 0.5, ctrlHeadSize), startY + 0.5, ctrlHeadSize, ctrlHeadSize);\n\t\t// draw level number\n\t\tctx.fillStyle = this._textColor;\n\t\tctx.font = this._getFont();\n\t\tctx.textAlign = 'center';\n\t\tctx.textBaseline = 'middle';\n\t\tctx.fillText((level + 1).toString(), this.transformX(startX + (ctrlHeadSize / 2)), startY + (ctrlHeadSize / 2) + 2 * app.dpiScale);\n\t}\n\n\t// Handle user interaction.\n\t_updateOutlineState (group: Partial<GroupEntry>): void {\n\t\tconst state = group.hidden ? 'visible' : 'hidden'; // we have to send the new state\n\t\tconst payload = 'outlinestate type=row' + ' level=' + group.level + ' index=' + group.index + ' state=' + state;\n\t\tapp.socket.sendMessage(payload);\n\t}\n\n\t// When user clicks somewhere on the section, onMouseClick event is called by CanvasSectionContainer.\n\t// Clicked point is also given to handler function. This function finds the clicked header.\n\tfindClickedLevel (point: number[]): number {\n\t\tif (point[1] < this._cornerHeaderHeight) {\n\t\t\tlet index = (this.transformX(point[0]) / this.size[0]) * 100; // Percentage.\n\t\t\tconst levelPercentage = (1 / (this._groups.length + 1)) * 100; // There is one more button than the number of levels.\n\t\t\tindex = Math.floor(index / levelPercentage);\n\t\t\treturn index;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tfindClickedGroup (point: number[]): GroupEntry {\n\t\tconst mirrorX = this.isCalcRTL();\n\t\tfor (let i = 0; i < this._groups.length; i++) {\n\t\t\tif (this._groups[i]) {\n\t\t\t\tfor (const group in this._groups[i]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\tconst group_ = this._groups[i][group];\n\t\t\t\t\t\tconst startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group_.level;\n\t\t\t\t\t\tconst startY = this.getRelativeY(group_.startPos);\n\t\t\t\t\t\tconst endX = startX + this._groupHeadSize;\n\t\t\t\t\t\tconst endY = startY + this._groupHeadSize;\n\t\t\t\t\t\tif (group_.level == 0 && this.isPointInRect(point, startX, startY, endX, endY, mirrorX))\n\t\t\t\t\t\t\treturn group_;\n\t\t\t\t\t\telse if (this._isPreviousGroupVisible(group_.level, group_.startPos, group_.endPos, group_.hidden) && this.isPointInRect(point, startX, startY, endX, endY, mirrorX)) {\n\t\t\t\t\t\t\treturn group_;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetTailsGroupRect (group: GroupEntry): number[] {\n\t\tconst startX = this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * group.level;\n\t\tconst startY = this.getRelativeY(group.startPos);\n\t\tconst endX = startX + this._groupHeadSize; // Let's use this as thikcness. User doesn't have to double click on a pixel:)\n\t\tconst endY = group.endPos + this._cornerHeaderHeight - this.documentTopLeft[1];\n\t\treturn [startX, endX, startY, endY];\n\t}\n\n\tonRemove(): void {\n\t\tthis.isRemoved = true;\n\t\tthis.containerObject.getSectionWithName(L.CSections.RowHeader.name).position[0] = 0;\n\t\tthis.containerObject.getSectionWithName(L.CSections.CornerHeader.name).position[0] = 0;\n\t}\n}\n\n}\n\nL.Control.RowGroup = cool.RowGroup;\n\nL.control.rowGroup = function () {\n\treturn new L.Control.RowGroup();\n};\n"]}