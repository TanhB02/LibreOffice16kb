{"version":3,"file":"Control.GroupBase.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.GroupBase.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * L.Control.GroupBase\n */\n\nnamespace cool {\n\nexport interface GroupEntry {\n\tlevel: number,\n\tindex: number,\n\tstartPos: number,\n\tendPos: number,\n\thidden: boolean\n}\n\nexport interface GroupEntryStrings {\n\tlevel: string,\n\tindex: string,\n\tstartPos: string,\n\tendPos: string,\n\thidden: string\n}\n\n/*\n\tThis file is Calc only. This is the base class for Control.RowGroup and Control.ColumnGroup files.\n\n\tThis class is an extended version of \"CanvasSectionObject\".\n*/\n\nexport abstract class GroupBase extends app.definitions.canvasSectionObject {\n\t_map: any;\n\t_textColor: string;\n\t_getFont: () => string;\n\t_levelSpacing: number;\n\t_groupHeadSize: number;\n\t_groups: Array<Array<GroupEntry>>;\n\tisRemoved: boolean = false;\n\n\tconstructor () { super(); }\n\n\t// This function is called by CanvasSectionContainer when the section is added to the sections list.\n\tonInitialize(): void {\n\t\tthis._map = L.Map.THIS;\n\t\tthis.sectionProperties.docLayer = this._map._docLayer;\n\t\tthis._groups = null;\n\n\t\t// group control styles\n\t\tthis._groupHeadSize = Math.round(12 * app.dpiScale);\n\t\tthis._levelSpacing = app.roundedDpiScale;\n\n\t\tthis._map.on('sheetgeometrychanged', this.update, this);\n\t\tthis._map.on('viewrowcolumnheaders', this.update, this);\n\t\tthis._map.on('darkmodechanged', this._groupBaseColors, this);\n\t\tthis._createFont();\n\t\tthis._groupBaseColors();\n\t\tthis.update();\n\t\tthis.isRemoved = false;\n\t}\n\n\t// override in subclasses\n\tabstract update(): void;\n\n\t// Create font for the group headers. Group headers are on the left side of corner header.\n\t_createFont(): void {\n\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\tconst elem = L.DomUtil.create('div', 'spreadsheet-header-row', baseElem);\n\n\t\tconst fontFamily = L.DomUtil.getStyle(elem, 'font-family');\n\t\tconst fontSize = parseInt(L.DomUtil.getStyle(elem, 'font-size'));\n\t\tthis._getFont = function() {\n\t\t\treturn Math.round(fontSize * app.dpiScale) + 'px ' + fontFamily;\n\t\t};\n\t\tL.DomUtil.remove(elem);\n\t}\n\n\tpublic static getColors(): { backgroundColor: string, borderColor: string, textColor?: string, strokeColor?: string } {\t\n\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\tconst elem = L.DomUtil.create('div', 'spreadsheet-header-row', baseElem);\n\t\tconst isDark = window.prefs.getBoolean('darkTheme');\n\n\t\tthis.backgroundColor = L.DomUtil.getStyle(elem, 'background-color');\n\t\tthis.borderColor = this.backgroundColor;\n\n\t\tthis._textColor = L.DomUtil.getStyle(elem, 'color');\n\t\tL.DomUtil.remove(elem);\n\t\treturn {\n\t\t\tbackgroundColor: this.backgroundColor,\n\t\t\tborderColor: this.borderColor,\n\t\t\ttextColor: this._textColor,\n\t\t\tstrokeColor: isDark ? 'white' : 'black'\n\t\t};\n\t}\n\n\tprivate _groupBaseColors(): void {\n\t\tconst colors = GroupBase.getColors();\n\t\tthis.backgroundColor = colors.backgroundColor;\n\t\tthis.borderColor = colors.borderColor;\n\t\tthis._textColor = colors.textColor;\n\t}\n\n\t// This returns the required width for the section.\n\t_computeSectionWidth(): number {\n\t\treturn this._levelSpacing + (this._groupHeadSize + this._levelSpacing) * (this._groups.length + 1);\n\t}\n\n\t// This function puts data into a good shape for use of this class.\n\t_collectGroupsData (groups: Array<GroupEntryStrings>): void {\n\t\tlet level: number, groupEntry: GroupEntry;\n\n\t\tconst lastGroupIndex = new Array(groups.length);\n\t\tconst firstChildGroupIndex = new Array(groups.length);\n\t\tlet lastLevel = -1;\n\t\tfor (let i = 0; i < groups.length; ++i) {\n\t\t\t// a new group start\n\t\t\tconst groupData = groups[i];\n\t\t\tlevel = parseInt(groupData.level) - 1;\n\t\t\tif (!this._groups[level]) {\n\t\t\t\tthis._groups[level] = [];\n\t\t\t}\n\t\t\tlet startPos = parseInt(groupData.startPos);\n\t\t\tconst endPos = parseInt(groupData.endPos);\n\t\t\tconst isHidden = !!parseInt(groupData.hidden);\n\t\t\tif (!isHidden) {\n\t\t\t\tlet moved = false;\n\t\t\t\t// if the first child is collapsed the parent head has to be top-aligned with the child\n\t\t\t\tif (level < lastLevel && firstChildGroupIndex[lastLevel] !== undefined) {\n\t\t\t\t\tconst childGroupEntry = this._groups[lastLevel][firstChildGroupIndex[lastLevel]];\n\t\t\t\t\tif (childGroupEntry.hidden) {\n\t\t\t\t\t\tif (startPos > childGroupEntry.startPos && startPos < childGroupEntry.endPos) {\n\t\t\t\t\t\t\tstartPos = childGroupEntry.startPos;\n\t\t\t\t\t\t\tmoved = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// if 2 groups belonging to the same level are contiguous and the first group is collapsed,\n\t\t\t\t// the second one has to be shifted as much as possible in order to avoid overlapping.\n\t\t\t\tif (!moved && lastGroupIndex[level] !== undefined) {\n\t\t\t\t\tconst prevGroupEntry = this._groups[level][lastGroupIndex[level]];\n\t\t\t\t\tif (prevGroupEntry.hidden) {\n\t\t\t\t\t\tif (startPos <= prevGroupEntry.endPos) {\n\t\t\t\t\t\t\tstartPos = prevGroupEntry.endPos + this._groupHeadSize;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tgroupEntry = {\n\t\t\t\tlevel: level,\n\t\t\t\tindex: parseInt(groupData.index),\n\t\t\t\tstartPos: startPos,\n\t\t\t\tendPos: endPos,\n\t\t\t\thidden: isHidden\n\t\t\t};\n\t\t\tthis._groups[level][parseInt(groupData.index)] = groupEntry;\n\t\t\tlastGroupIndex[level] = groupData.index;\n\t\t\tif (level > lastLevel) {\n\t\t\t\tfirstChildGroupIndex[level] = groupData.index;\n\t\t\t\tlastLevel = level;\n\t\t\t}\n\t\t\telse if (level === lastLevel) {\n\t\t\t\tfirstChildGroupIndex[level + 1] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\t_isParentGroupVisible(group_: GroupEntry): boolean {\n\t\tif (group_.hidden === false) {\n\t\t\tif (group_.level > 0) {\n\t\t\t\t// This recursive call is needed.\n\t\t\t\t// Because first upper group may have been expanded and second upper group may have been collapsed.\n\t\t\t\t// If one of the upper groups is not expanded, this function should return false.\n\t\t\t\tif (this._isPreviousGroupVisible(group_.level, group_.startPos, group_.endPos, group_.hidden)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t// If previous group is visible (expanded), current group's plus sign etc. will be drawn. If previous group is not expanded, current group's plus sign etc. won't be drawn.\n\t_isPreviousGroupVisible(level: number, startPos: number, endPos: number, hidden: boolean): boolean {\n\t\tfor (let i = 0; i < this._groups.length; i++) {\n\t\t\tvar parentGroup;\n\n\t\t\t// find the correct parent group level\n\t\t\tif (i == level - 1) {\n\t\t\t\tfor (const group in this._groups[i]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\tconst group_ = this._groups[i][group];\n\n\t\t\t\t\t\t// parent group is expanded\n\t\t\t\t\t\tif ((startPos != endPos) && (startPos >= group_.startPos && endPos <= group_.endPos)) {\n\t\t\t\t\t\t\treturn this._isParentGroupVisible(group_);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// parent group is collapsed and has a '-' sign\n\t\t\t\t\t\telse if ((startPos == endPos) && hidden == false) {\n\t\t\t\t\t\t\tif ((startPos == group_.startPos && endPos == group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t\t// special condition: parent group is found, return.\n\t\t\t\t\t\t\t\treturn this._isParentGroupVisible(parentGroup);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos == group_.startPos && endPos != group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos != group_.startPos && endPos == group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos > group_.startPos && endPos < group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// parent group is collapsed and has a '+' sign\n\t\t\t\t\t\telse if ((startPos == endPos) && hidden == true) {\n\t\t\t\t\t\t\tif ((startPos == group_.startPos && endPos == group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos == group_.startPos && endPos != group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos != group_.startPos && endPos == group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ((startPos > group_.startPos && endPos < group_.endPos)) {\n\t\t\t\t\t\t\t\tparentGroup = group_;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (parentGroup !== undefined) {\n\t\t\t\t\treturn this._isParentGroupVisible(parentGroup);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawGroupControl (entry: GroupEntry): void {\n\t\treturn;\n\t}\n\n\t// This calls drawing functions related to tails and plus & minus signs etc.\n\tdrawOutline(): void {\n\t\tif (this._groups) {\n\t\t\tfor (let i = 0; i < this._groups.length; i++) {\n\t\t\t\tif (this._groups[i]) {\n\t\t\t\t\tfor (const group in this._groups[i]) {\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\t\t// always draw the first level\n\t\t\t\t\t\t\tif (this._groups[i][group].level == 0) {\n\t\t\t\t\t\t\t\tthis.drawGroupControl(this._groups[i][group]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (this._isPreviousGroupVisible(this._groups[i][group].level, this._groups[i][group].startPos, this._groups[i][group].endPos, this._groups[i][group].hidden)) {\n\t\t\t\t\t\t\t\tthis.drawGroupControl(this._groups[i][group]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawLevelHeader (level: number): void {\n\t\treturn;\n\t}\n\n\t// This function calls drawing function for related to headers of groups. Headers are drawn on the left of corner header.\n\tdrawLevelHeaders(): void {\n\t\tfor (let i = 0; i < this._groups.length + 1; ++i) {\n\t\t\tthis.drawLevelHeader(i);\n\t\t}\n\t}\n\n\t/// In Calc RTL mode, x-coordinate of a given rectangle of given width is horizontally mirrored\n\ttransformRectX (xcoord: number, rectWidth: number): number {\n\t\treturn this.isCalcRTL() ? this.size[0] - xcoord - rectWidth : xcoord;\n\t}\n\n\t/// In Calc RTL mode, x-coordinate of a given point is horizontally mirrored\n\ttransformX (xcoord: number): number {\n\t\treturn this.isCalcRTL() ? this.size[0] - xcoord : xcoord;\n\t}\n\n\t/**\n\t * Checks if the given point is within the bounds of the rectangle defined by\n\t * startX, startY, endX, endY. If mirrorX is true then point is horizontally\n\t * mirrored before checking.\n\t */\n\tisPointInRect (point: number[], startX: number, startY: number, endX: number, endY: number, mirrorX: boolean): boolean {\n\t\tconst x = mirrorX ? this.size[0] - point[0] : point[0];\n\t\tconst y = point[1];\n\n\t\treturn (x > startX && x < endX && y > startY && y < endY);\n\t}\n\n\tonDraw(): void {\n\t\tthis.drawOutline();\n\t\tthis.drawLevelHeaders();\n\t}\n\n\tfindClickedGroup (point: number[]): GroupEntry {\n\t\treturn null;\n\t}\n\n\tfindClickedLevel (point: number[]): number {\n\t\treturn -1;\n\t}\n\n\tonMouseMove (point: number[]): void {\n\t\t// If mouse is above a group header or a group control, we change the cursor.\n\t\tif (this.findClickedGroup(point) !== null || this.findClickedLevel(point) !== -1)\n\t\t\tthis.context.canvas.style.cursor = 'pointer';\n\t\telse\n\t\t\tthis.context.canvas.style.cursor = 'default';\n\t}\n\n\tonMouseLeave(): void {\n\t\tthis.context.canvas.style.cursor = 'default';\n\t}\n\n\t_updateOutlineState(group: Partial<GroupEntry>): void {\n\t\treturn;\n\t}\n\n\tonClick (point: number[]): void {\n\t\t// User may have clicked on one of the level headers.\n\t\tconst level = this.findClickedLevel(point);\n\t\tif (level !== -1) {\n\t\t\tthis._updateOutlineState({level: level, index: -1}); // index: -1 targets all groups (there may be multiple separate row groups.).\n\t\t}\n\t\telse {\n\t\t\t// User may have clicked on one of the group control boxes (boxes with plus / minus symbols).\n\t\t\tvar group = this.findClickedGroup(point);\n\n\t\t\tif (group) {\n\t\t\t\tthis._updateOutlineState(group);\n\t\t\t}\n\t\t}\n\t}\n\n\t// returns [startX, endX, startY, endY]\n\tgetTailsGroupRect (group: GroupEntry): number[] {\n\t\treturn [0, 0, 0, 0];\n\t}\n\n\tfindTailsGroup (point: number[]): GroupEntry {\n\t\tconst mirrorX = this.isCalcRTL();\n\t\tfor (let i = 0; i < this._groups.length; i++) {\n\t\t\tif (this._groups[i]) {\n\t\t\t\tfor (const group in this._groups[i]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this._groups[i], group)) {\n\t\t\t\t\t\tconst group_ = this._groups[i][group];\n\t\t\t\t\t\tconst rect = this.getTailsGroupRect(group_);\n\t\t\t\t\t\tconst startX = rect[0];\n\t\t\t\t\t\tconst startY = rect[2];\n\t\t\t\t\t\tconst endX = rect[1];\n\t\t\t\t\t\tconst endY = rect[3];\n\n\t\t\t\t\t\tif (this.isPointInRect(point, startX, startY, endX, endY, mirrorX)) {\n\t\t\t\t\t\t\treturn group_;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/* Double clicking on a group's tail closes it. */\n\tonDoubleClick (point: number[]): void {\n\t\tconst group = this.findTailsGroup(point);\n\t\tif (group)\n\t\t\tthis._updateOutlineState(group);\n\t}\n\n\tonMouseEnter(): void {\n\t\t$.contextMenu('destroy', '#document-canvas');\n\t}\n\n\tonRemove(): void {\n\t\tthis.isRemoved = true;\n\t\tthis.containerObject.getSectionWithName(L.CSections.RowHeader.name).position[0] = 0;\n\t\tthis.containerObject.getSectionWithName(L.CSections.CornerHeader.name).position[0] = 0;\n\t}\n}\n}\n\nL.Control.GroupBase = cool.GroupBase;\n"]}