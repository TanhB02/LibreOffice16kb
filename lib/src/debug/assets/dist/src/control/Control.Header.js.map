{"version":3,"file":"Control.Header.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.Header.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * Control.Header\n *\n * Abstract class, basis for ColumnHeader and RowHeader controls.\n * Used only in spreadsheets, implements the row/column headers.\n */\n/* global $ L app */\n\nnamespace cool {\n\nexport interface SelectionRange {\n\tstart: number,\n\tend: number,\n}\n\nexport class Header extends app.definitions.canvasSectionObject {\n\t_map: any;\n\t_textColor: string;\n\t_backgroundColor: string;\n\t_borderColor: string;\n\t_borderWidth: number;\n\t_cursor: string;\n\t_hoverColor: string;\n\t_selectionTextColor: string;\n\t_selectionBackgroundGradient: string[];\n\t_resizeCursor: string;\n\t_lastMouseOverIndex: number;\n\t_menuData: any;\n\t_headerInfo: HeaderInfo;\n\t_dragEntry: HeaderEntryData;\n\t_mouseOverEntry: HeaderEntryData;\n\t_prevMouseOverEntry: HeaderEntryData;\n\t_startSelectionEntry: HeaderEntryData;\n\t_lastSelectedIndex: number;\n\t_hitResizeArea: boolean;\n\t_menuItem: any;\n\t_dragDistance: number[];\n\t_isColumn: boolean;\n\tcursor: string;\n\n\tgetFont: () => string;\n\n\tconstructor () {\n\t\tsuper();\n\t}\n\n\t_initHeaderEntryStyles (className: string): void {\n\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\tconst elem = L.DomUtil.create('div', className, baseElem);\n\t\tthis._textColor = L.DomUtil.getStyle(elem, 'color');\n\t\tthis._backgroundColor = L.DomUtil.getStyle(elem, 'background-color');\n\t\tconst fontFamily = L.DomUtil.getStyle(elem, 'font-family');\n\t\tthis.getFont = function() {\n\t\t\tconst selectedSize = this._getFontSize();\n\t\t\treturn selectedSize + 'px ' + fontFamily;\n\t\t}.bind(this);\n\t\tthis._borderColor = L.DomUtil.getStyle(elem, 'border-top-color');\n\t\tconst borderWidth = L.DomUtil.getStyle(elem, 'border-top-width');\n\t\tthis._borderWidth = Math.round(parseFloat(borderWidth));\n\t\tthis._cursor = L.DomUtil.getStyle(elem, 'cursor');\n\t\tL.DomUtil.remove(elem);\n\t}\n\n\t_getFontSize(): number {\n\t\tconst map = this._map;\n\t\tconst zoomScale = map.getZoomScale(map.getZoom(), map.options.defaultZoom);\n\t\tif (zoomScale < 0.68)\n\t\t\treturn Math.round(8 * app.dpiScale);\n\t\telse if (zoomScale < 0.8)\n\t\t\treturn Math.round(10 * app.dpiScale);\n\t\telse\n\t\t\treturn Math.round(12 * app.dpiScale);\n\t}\n\n\t_initHeaderEntryHoverStyles (className: string): void {\n\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\tconst elem = L.DomUtil.create('div', className, baseElem);\n\t\tthis._hoverColor = L.DomUtil.getStyle(elem, 'background-color');\n\t\tL.DomUtil.remove(elem);\n\t}\n\n\t_initHeaderEntrySelectedStyles(className: string): void {\n\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\tconst elem = L.DomUtil.create('div', className, baseElem);\n\t\tthis._selectionTextColor = L.DomUtil.getStyle(elem, 'color');\n\n\t\tconst selectionBackgroundGradient: string[] = [];\n\t\tlet gradientColors: string = L.DomUtil.getStyle(elem, 'background-image');\n\t\tgradientColors = gradientColors.slice('linear-gradient('.length, -1);\n\t\twhile (gradientColors) {\n\t\t\tconst color = gradientColors.split(',', 3);\n\t\t\tconst colorJoin = color.join(','); // color = 'rgb(r, g, b)'\n\t\t\tselectionBackgroundGradient.push(colorJoin);\n\t\t\tgradientColors = gradientColors.substr(color.length); // remove last parsed color\n\t\t\tgradientColors = gradientColors.substr(gradientColors.indexOf('r')); // remove ', ' stuff\n\t\t}\n\n\t\tif (selectionBackgroundGradient.length) {\n\t\t\tthis._selectionBackgroundGradient = selectionBackgroundGradient;\n\t\t}\n\t\tL.DomUtil.remove(elem);\n\t}\n\n\t_initHeaderEntryResizeStyles (className: string): void {\n\t\tif (this.cursor) {\n\t\t\tthis._resizeCursor = this.cursor;\n\t\t}\n\t\telse {\n\t\t\tconst baseElem = document.getElementsByTagName('body')[0];\n\t\t\tconst elem = L.DomUtil.create('div', className, baseElem);\n\t\t\tthis._resizeCursor = L.DomUtil.getStyle(elem, 'cursor');\n\t\t\tL.DomUtil.remove(elem);\n\t\t}\n\t}\n\n\t_isRowColumnInSelectedRange (index: number): boolean {\n\t\treturn (!!this._headerInfo.getElementData(index)?.isCurrent) || (!!this._headerInfo.getElementData(index)?.isHighlighted);\n\t}\n\n\tonContextMenu(evt: MouseEvent): void {\n\t\tif ((window as any).mode.isMobile() && this._map.isEditMode()) {\n\t\t\t(window as any).contextMenuWizard = true;\n\t\t\tthis._map.fire('mobilewizard', {data: this._menuData});\n\t\t}\n\t\telse if (this._map.isEditMode()) {\n\t\t\tthis._bindContextMenu();\n\t\t\t$('#canvas-container').contextMenu({x: evt.clientX, y: evt.clientY});\n\t\t}\n\t}\n\n\t_updateCanvas(): void {\n\t\tif (this._headerInfo) {\n\t\t\tthis._headerInfo.update(this as any as CanvasSectionObject);\n\t\t\tthis.containerObject.requestReDraw();\n\t\t}\n\t}\n\n\t_reInitRowColumnHeaderStylesAfterModeChange(): void {\n\t\t// add a separation to update row/column DOM element info\n\t\tif (this._isColumn) {\n\t\t\t// update column DOM element info\n\t\t\tthis._initHeaderEntryStyles('spreadsheet-header-column');\n\t\t\tthis._initHeaderEntryHoverStyles('spreadsheet-header-column-hover');\n\t\t\tthis._initHeaderEntrySelectedStyles('spreadsheet-header-column-selected');\n\t\t\tthis._initHeaderEntryResizeStyles('spreadsheet-header-column-resize');\n\t\t}\n\t\telse {\n\t\t\t// update row DOM element info\n\t\t\tthis._initHeaderEntryStyles('spreadsheet-header-row');\n\t\t\tthis._initHeaderEntryHoverStyles('spreadsheet-header-row-hover');\n\t\t\tthis._initHeaderEntrySelectedStyles('spreadsheet-header-row-selected');\n\t\t\tthis._initHeaderEntryResizeStyles('spreadsheet-header-row-resize');\n\t\t}\n\t}\n\n\toptimalHeight (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:SetOptimalRowHeight');\n\t}\n\n\tinsertRowAbove (index: number): void {\n\t\t// First select the corresponding row because\n\t\t// .uno:InsertRows doesn't accept any row number\n\t\t// as argument and just inserts before the selected row\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:InsertRows');\n\t}\n\n\tinsertRowBelow (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:InsertRowsAfter');\n\t}\n\n\tdeleteRow (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:DeleteRows');\n\t}\n\n\thideRow (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:HideRow');\n\t}\n\n\tshowRow (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectRow(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:ShowRow');\n\t}\n\n\t_selectRow (row: number, modifier: number): void {\n\t\t// If function dialog is open and user wants to add the whole row to function.\n\t\tif (this._map.dialog.hasOpenedDialog() && this._map.dialog.getCurrentDialogContainer()) {\n\t\t\tconst dialogContainer = this._map.dialog.getCurrentDialogContainer();\n\t\t\tif (dialogContainer.dataset.uniqueId === 'FormulaDialog') {\n\t\t\t\tconst alpha = String(row + 1);\n\t\t\t\tconst text = alpha + ':' + alpha;\n\t\t\t\tthis._map._textInput._sendText(text);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Normal behavior.\n\t\tconst command = {\n\t\t\tRow: {\n\t\t\t\ttype: 'long',\n\t\t\t\tvalue: row\n\t\t\t},\n\t\t\tModifier: {\n\t\t\t\ttype: 'unsigned short',\n\t\t\t\tvalue: modifier\n\t\t\t}\n\t\t};\n\n\t\tthis._map.wholeRowSelected = true; // This variable is set early, state change will set this again.\n\t\tthis._map.sendUnoCommand('.uno:SelectRow ', command);\n\t\t// Ensures the focus is returned to the map area after the row is selected\n\t\tthis._map.focus();\n\t}\n\n\t_insertRowAbove(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.insertRowAbove.call(this, index);\n\t\t}\n\t}\n\n\t_insertRowBelow(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.insertRowBelow.call(this, index);\n\t\t}\n\t}\n\n\t_deleteSelectedRow(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.deleteRow.call(this, index);\n\t\t}\n\t}\n\n\t_rowHeight(): void {\n\t\tthis._map.sendUnoCommand('.uno:RowHeight');\n\t}\n\n\t_optimalHeight(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.optimalHeight.call(this, index);\n\t\t}\n\t}\n\n\t_hideRow(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.hideRow.call(this, index);\n\t\t}\n\t}\n\n\t_showRow(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.showRow.call(this, index);\n\t\t}\n\t}\n\n\toptimalWidth (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:SetOptimalColumnWidth');\n\t}\n\n\tinsertColumnBefore (index: number): void {\n\t\t// First select the corresponding column because\n\t\t// .uno:InsertColumn doesn't accept any column number\n\t\t// as argument and just inserts before the selected column\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:InsertColumns');\n\t\tthis._updateColumnHeader();\n\t}\n\n\tinsertColumnAfter (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:InsertColumnsAfter');\n\t\tthis._updateColumnHeader();\n\t}\n\n\tdeleteColumn (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:DeleteColumns');\n\t\tthis._updateColumnHeader();\n\t}\n\n\thideColumn (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:HideColumn');\n\t\tthis._updateColumnHeader();\n\t}\n\n\tshowColumn (index: number): void {\n\t\tif (!this._isRowColumnInSelectedRange(index)) {\n\t\t\tthis._selectColumn(index, 0);\n\t\t}\n\t\tthis._map.sendUnoCommand('.uno:ShowColumn');\n\t\tthis._updateColumnHeader();\n\t}\n\n\t_updateColumnHeader(): void {\n\t\tthis._map._docLayer.refreshViewData({x: this._map._getTopLeftPoint().x, y: 0, offset: {x: undefined, y: 0}});\n\t}\n\n\t_colIndexToAlpha (columnNumber: number): string {\n\t\tconst offset = 'A'.charCodeAt(0);\n\t\tlet dividend = columnNumber;\n\t\tlet columnName = '';\n\n\t\twhile (dividend > 0) {\n\t\t\tconst modulo: number = (dividend - 1) % 26;\n\t\t\tcolumnName = String.fromCharCode(offset + modulo) + columnName;\n\t\t\tdividend = Math.floor((dividend - modulo) / 26);\n\t\t}\n\n\t\treturn columnName;\n\t}\n\n\t_selectColumn (colNumber: number, modifier: number): void {\n\t\t// If function dialog is open and user wants to add the whole column to function.\n\t\tif (this._map.dialog.hasOpenedDialog() && this._map.dialog.getCurrentDialogContainer()) {\n\t\t\tconst dialogContainer = this._map.dialog.getCurrentDialogContainer();\n\t\t\tif (dialogContainer.dataset.uniqueId === 'FormulaDialog') {\n\t\t\t\tconst alpha = this._colIndexToAlpha(colNumber + 1);\n\t\t\t\tconst text = alpha + ':' + alpha;\n\t\t\t\tthis._map._textInput._sendText(text);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Normal behavior.\n\t\tconst command = {\n\t\t\tCol: {\n\t\t\t\ttype: 'unsigned short',\n\t\t\t\tvalue: colNumber\n\t\t\t},\n\t\t\tModifier: {\n\t\t\t\ttype: 'unsigned short',\n\t\t\t\tvalue: modifier\n\t\t\t}\n\t\t};\n\n\t\tthis._map.wholeColumnSelected = true; // This variable is set early, state change will set this again.\n\t\tthis._map.sendUnoCommand('.uno:SelectColumn ', command);\n\t\t// Ensures the focus is returned to the map area after the column is selected\n\t\tthis._map.focus();\n\t}\n\n\t_insertColBefore(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.insertColumnBefore.call(this, index);\n\t\t}\n\t}\n\n\t_insertColAfter(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.insertColumnAfter.call(this, index);\n\t\t}\n\t}\n\n\t_deleteSelectedCol(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.deleteColumn.call(this, index);\n\t\t}\n\t}\n\n\t_columnWidth(): void {\n\t\tthis._map.sendUnoCommand('.uno:ColumnWidth');\n\t}\n\n\t_optimalWidth(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.optimalWidth.call(this, index);\n\t\t}\n\t}\n\n\t_hideColumn(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.hideColumn.call(this, index);\n\t\t}\n\t}\n\n\t_showColumn(): void {\n\t\tconst index = this._lastMouseOverIndex;\n\t\tif (index !== undefined) {\n\t\t\tthis.showColumn.call(this, index);\n\t\t}\n\t}\n\n\t_freezePanes (): void {\n\t\tthis._map.sendUnoCommand('.uno:FreezePanes');\n\t}\n\n\t_entryAtPoint(point: number[]): PointEntryQueryResult {\n\t\tif (!this._headerInfo)\n\t\t\treturn undefined;\n\n\t\tconst isColumn = this._headerInfo._isColumn;\n\t\tconst position = isColumn ? point[0]: point[1];\n\n\t\tlet result:PointEntryQueryResult  = null;\n\t\tconst isRTL = isColumn && this.isCalcRTL();\n\t\tthis._headerInfo.forEachElement(function(entry: HeaderEntryData): boolean {\n\t\t\tconst end = isRTL ? this.size[0] - entry.pos + entry.size : entry.pos;\n\t\t\tconst start = end - entry.size;\n\t\t\tif (position >= start && position < end) {\n\t\t\t\t// NOTE: From a geometric perspective resizeAreaStart is really \"resizeAreaEnd\" in RTL case.\n\t\t\t\tlet resizeAreaStart = isRTL ? Math.min(start + 3 * app.dpiScale, end) : Math.max(start, end - 3 * app.dpiScale);\n\t\t\t\tif (entry.isCurrent || (window as any).mode.isMobile()) {\n\t\t\t\t\tresizeAreaStart = isRTL ? start + this._resizeHandleSize : end - this._resizeHandleSize;\n\t\t\t\t}\n\t\t\t\tconst isMouseOverResizeArea = isRTL ? (position < resizeAreaStart) : (position > resizeAreaStart);\n\t\t\t\tresult = {entry: entry, hit: isMouseOverResizeArea};\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}.bind(this));\n\t\treturn result;\n\t}\n\n\tdrawHeaderEntry (entry: HeaderEntryData): void {\n\t\treturn;\n\t}\n\n\tonDraw(): void {\n\t\tthis._headerInfo.forEachElement(function(elemData: HeaderEntryData): boolean {\n\t\t\tthis.drawHeaderEntry(elemData);\n\t\t\treturn false; // continue till last.\n\t\t}.bind(this));\n\n\t\tthis.drawResizeLineIfNeeded();\n\t}\n\n\tonDragEnd (dragDistance: number[]): void {\n\t\treturn;\n\t}\n\n\tonMouseEnter(): void {\n\t\tthis.containerObject.getCanvasStyle().cursor = this._cursor;\n\t\tthis._bindContextMenu();\n\t}\n\n\tonMouseLeave (point: number[]): void {\n\t\tif (point === null) { // This means that the mouse pointer is outside the canvas.\n\t\t\tif (this.containerObject.isDraggingSomething() && this._dragEntry) { // Were we resizing a row / column before mouse left.\n\t\t\t\tthis.onDragEnd(this.containerObject.getDragDistance());\n\t\t\t}\n\t\t}\n\n\t\tif (this._mouseOverEntry) {\n\t\t\tthis.containerObject.setPenPosition(this);\n\t\t\tthis._mouseOverEntry.isOver = false;\n\t\t\tthis.drawHeaderEntry(this._mouseOverEntry);\n\t\t\tthis._mouseOverEntry = null;\n\t\t}\n\t\tthis._hitResizeArea = false;\n\t\tthis.containerObject.getCanvasStyle().cursor = 'default';\n\t}\n\n\t_bindContextMenu(): void {\n\t\tif ((window as any).mode.isMobile() || this._map.isReadOnlyMode()) {\n\t\t\t// On mobile, we use the mobile wizard rather than the context menu\n\t\t\treturn;\n\t\t}\n\n\t\tthis._unBindContextMenu();\n\t\t$.contextMenu({\n\t\t\tselector: '#canvas-container',\n\t\t\tclassName: 'cool-font',\n\t\t\tzIndex: 1500,\n\t\t\titems: this._menuItem,\n\t\t\tcallback: function() { return; }\n\t\t});\n\t\t$('#canvas-container').contextMenu('update');\n\t\tthis._map._contextMenu.stopRightMouseUpEvent();\n\t}\n\n\t_unBindContextMenu(): void {\n\t\t$.contextMenu('destroy', '#canvas-container');\n\t}\n\n\tinResize(): boolean {\n\t\treturn this.containerObject.isDraggingSomething() && this._dragEntry && (this._dragDistance !== null);\n\t}\n\n\tdrawResizeLineIfNeeded(): void {\n\t\tif (!this.inResize())\n\t\t\treturn;\n\n\t\tthis.containerObject.setPenPosition(this);\n\t\tconst isRTL = this.isCalcRTL();\n\t\tconst x = this._isColumn ? ((isRTL ? this.size[0] - this._dragEntry.pos: this._dragEntry.pos) + this._dragDistance[0]): (isRTL ? 0 : this.size[0]);\n\t\tconst y = this._isColumn ? this.size[1]: (this._dragEntry.pos + this._dragDistance[1]);\n\n\t\tthis.context.lineWidth = app.dpiScale;\n\t\tthis.context.strokeStyle = 'darkblue';\n\t\tthis.context.beginPath();\n\t\tthis.context.moveTo(x, y);\n\t\tthis.context.lineTo(this._isColumn ? x: (isRTL ? -this.myTopLeft[0]: this.containerObject.getWidth()), this._isColumn ? this.containerObject.getHeight(): y);\n\t\tthis.context.stroke();\n\t}\n\n\tonMouseMove (point: number[], dragDistance?: number[]): void {\n\t\tconst result = this._entryAtPoint(point); // Data related to current entry that the mouse is over now.\n\t\tif (result) { // Is mouse over an entry.\n\t\t\tthis._prevMouseOverEntry = this._mouseOverEntry;\n\t\t\tthis._mouseOverEntry = result.entry;\n\t\t}\n\t\telse return;\n\n\t\tif (!this.containerObject.isDraggingSomething()) { // If we are not dragging anything.\n\t\t\tthis._dragDistance = null;\n\n\t\t\t// If mouse was over another entry previously, we draw that again (without mouse-over effect).\n\t\t\tif (this._prevMouseOverEntry && (result && result.entry.index !== this._prevMouseOverEntry.index)) {\n\t\t\t\tthis.containerObject.setPenPosition(this);\n\t\t\t\tthis._prevMouseOverEntry.isOver = false;\n\t\t\t\tthis.drawHeaderEntry(this._prevMouseOverEntry);\n\t\t\t}\n\n\t\t\tlet isMouseOverResizeArea = false;\n\n\t\t\tthis._mouseOverEntry.isOver = true;\n\t\t\tthis._lastMouseOverIndex = this._mouseOverEntry.index; // used by context menu\n\t\t\tthis.containerObject.setPenPosition(this);\n\t\t\tthis.drawHeaderEntry(result.entry);\n\t\t\tisMouseOverResizeArea = result.hit;\n\n\t\t\t// cypress mobile emulation sometimes triggers resizing unintentionally.\n\t\t\tif (L.Browser.cypressTest)\n\t\t\t\treturn;\n\n\t\t\tif (isMouseOverResizeArea !== this._hitResizeArea) { // Do we need to change cursor (to resize or pointer).\n\t\t\t\tconst cursor = isMouseOverResizeArea ? this._resizeCursor : this._cursor;\n\t\t\t\tthis.containerObject.getCanvasStyle().cursor = cursor;\n\t\t\t\tthis._hitResizeArea = isMouseOverResizeArea;\n\t\t\t}\n\t\t}\n\t\telse { // We are in dragging mode.\n\t\t\tthis._dragDistance = dragDistance;\n\t\t\tthis.containerObject.requestReDraw(); // Remove previously drawn line and paint a new one.\n\n\t\t\tif (this._prevMouseOverEntry && this._lastSelectedIndex == this._prevMouseOverEntry.index)\n\t\t\t\treturn;\n\t\t\tif (this._dragEntry)\n\t\t\t\treturn;\n\t\t\tconst modifier = typeof this._lastSelectedIndex === 'number' && this._lastSelectedIndex >= 0 ? UNOModifier.SHIFT : 0;\n\t\t\tthis._lastSelectedIndex = this._mouseOverEntry.index;\n\t\t\tthis.selectIndex(this._mouseOverEntry.index, modifier);\n\t\t}\n\t}\n\n\tselectIndex(index: number, modifier: number): void {\n\t\treturn;\n\t}\n\n\tsetOptimalWidthAuto(): void {\n\t\treturn;\n\t}\n\n\tsetOptimalHeightAuto(): void {\n\t\treturn;\n\t}\n\n\tonDoubleClick(): void {\n\t\tthis._isColumn ? this.setOptimalWidthAuto(): this.setOptimalHeightAuto();\n\t}\n\n\tonMouseDown (point: number[]): void {\n\t\tthis.onMouseMove(point);\n\n\t\tif (this._hitResizeArea) {\n\t\t\tL.DomUtil.disableImageDrag();\n\t\t\tL.DomUtil.disableTextSelection();\n\n\t\t\t// When code is here, this._mouseOverEntry should never be null.\n\n\t\t\tthis._dragEntry = { // In case dragging takes place, we will remember this entry.\n\t\t\t\tindex: this._mouseOverEntry.index,\n\t\t\t\torigsize: this._mouseOverEntry.origsize,\n\t\t\t\tpos: this._mouseOverEntry.pos,\n\t\t\t\tsize: this._mouseOverEntry.size\n\t\t\t};\n\t\t}\n\t\telse {\n\t\t\tthis._dragEntry = null;\n\t\t}\n\n\t\tthis._startSelectionEntry = this._mouseOverEntry;\n\t\tthis._lastSelectedIndex = null;\n\t}\n\n\tonMouseUp(): void {\n\t\tL.DomUtil.enableImageDrag();\n\t\tL.DomUtil.enableTextSelection();\n\n\t\tthis._map.fire('closepopups'); // close all popups if a row/column header is selected\n\n\t\tif (this.containerObject.isDraggingSomething() && this._dragEntry) {\n\t\t\tthis.onDragEnd(this.containerObject.getDragDistance());\n\t\t\tthis._dragEntry = null;\n\t\t}\n\t}\n\n\tonNewDocumentTopLeft(): void {\n\t\treturn;\n\t}\n}\n\nexport interface HeaderEntryData {\n\tindex: number,\n\tpos: number, // end position on the header canvas\n\tsize: number,\n\torigsize: number,\n\tisHighlighted?: boolean,\n\tisCurrent?: boolean,\n\tisOver?: boolean,\n}\n\nexport interface PointEntryQueryResult {\n\tentry: HeaderEntryData,\n\thit: boolean,\n}\n\nexport class HeaderInfo {\n\t_map: any;\n\t_isColumn: boolean;\n\t_dimGeom: cool.SheetDimension;\n\t_docVisStart: number;\n\t_elements: HeaderEntryData[];\n\t_startIndex: number;\n\t_endIndex: number;\n\t_hasSplits: boolean;\n\t_splitIndex: number;\n\t_splitPos: number;\n\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\tconstructor(map: any, _isColumn: boolean) {\n\t\twindow.app.console.assert(map && _isColumn !== undefined, 'map and isCol required');\n\t\tthis._map = map;\n\t\tthis._isColumn = _isColumn;\n\t\twindow.app.console.assert(this._map._docLayer.sheetGeometry, 'no sheet geometry data-structure found!');\n\t\tconst sheetGeom = this._map._docLayer.sheetGeometry as cool.SheetGeometry;\n\t\tthis._dimGeom = this._isColumn ? sheetGeom.getColumnsGeometry() : sheetGeom.getRowsGeometry();\n\t}\n\n\tfindXInCellSelections (cellSelections: cool.Rectangle[], ordinate: number): boolean {\n\t\tfor (let i = 0; i < cellSelections.length; i++) {\n\t\t\tif (cellSelections[i].containsPixelOrdinateX(ordinate))\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfindYInCellSelections (cellSelections: cool.Rectangle[], ordinate: number): boolean {\n\t\tfor (let i = 0; i < cellSelections.length; i++) {\n\t\t\tif (cellSelections[i].containsPixelOrdinateY(ordinate))\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tisHeaderEntryHighLighted (cellSelections: cool.Rectangle[], ordinate: number): boolean {\n\t\tif (this._isColumn && this._map.wholeRowSelected)\n\t\t\treturn true;\n\t\telse if (!this._isColumn && this._map.wholeColumnSelected)\n\t\t\treturn true;\n\t\telse if (this._isColumn && cellSelections.length > 0) {\n\t\t\treturn this.findXInCellSelections(cellSelections, ordinate);\n\t\t}\n\t\telse if (!this._isColumn && cellSelections.length > 0) {\n\t\t\treturn this.findYInCellSelections(cellSelections, ordinate);\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tupdate(section: CanvasSectionObject): void {\n\t\tconst cellSelections: cool.Rectangle[] = this._map._docLayer._cellSelections;\n\n\t\tlet currentIndex: number;\n\t\tif (app.calc.cellCursorVisible) {\n\t\t\tcurrentIndex = this._isColumn ? app.calc.cellAddress.x: app.calc.cellAddress.y;\n\t\t} else {\n\t\t\tcurrentIndex = -1;\n\t\t}\n\n\t\tconst tsManager = this._map._docLayer._painter;\n\t\tconst ctx = tsManager._paintContext();\n\n\t\tconst splitPos = this._isColumn ?\n\t\t\tctx.splitPos.x\n\t\t\t: ctx.splitPos.y;\n\n\t\tlet startPx: number;\n\t\tlet scale: number;\n\t\tif (tsManager._inZoomAnim) {\n\t\t\tconst viewBounds = ctx.viewBounds;\n\t\t\tconst freePaneBounds = new L.Bounds(viewBounds.min.add(ctx.splitPos), viewBounds.max);\n\n\t\t\tscale = tsManager._zoomFrameScale;\n\n\t\t\tconst zoomPos = tsManager._getZoomDocPos(\n\t\t\t\ttsManager._newCenter,\n\t\t\t\ttsManager._layer._pinchStartCenter,\n\t\t\t\tfreePaneBounds,\n\t\t\t\t{ freezeX: false, freezeY: false },\n\t\t\t\tctx.splitPos,\n\t\t\t\tscale,\n\t\t\t\tfalse\n\t\t\t);\n\n\t\t\tstartPx = this._isColumn ?\n\t\t\t\tzoomPos.topLeft.x\n\t\t\t\t: zoomPos.topLeft.y;\n\t\t} else {\n\t\t\tstartPx = this._isColumn ?\n\t\t\t\tsection.documentTopLeft[0] + splitPos\n\t\t\t\t: section.documentTopLeft[1] + splitPos;\n\t\t\tscale = 1;\n\t\t}\n\n\t\tconst endPx = this._isColumn ?\n\t\t\tstartPx + section.size[0] / scale\n\t\t\t: startPx + section.size[1] / scale;\n\n\t\tthis._docVisStart = startPx;\n\t\tlet startIdx = this._dimGeom.getIndexFromPos(startPx, 'corepixels');\n\t\tconst maxIndex = this._isColumn ? this._map._docLayer.sheetGeometry.maxVisibleColumnIndex : this._map._docLayer.sheetGeometry.maxVisibleRowIndex;\n\t\tconst endIdx = Math.min(this._dimGeom.getIndexFromPos(endPx - 1, 'corepixels'), 1048576 - 1, maxIndex);\n\t\tthis._elements = [];\n\n\t\tthis._hasSplits = false;\n\t\tthis._splitIndex = 0;\n\n\t\tif (splitPos) {\n\t\t\tconst splitIndex = this._dimGeom.getIndexFromPos(splitPos + 1, 'corepixels');\n\n\t\t\tif (splitIndex) {\n\t\t\t\tthis._splitPos = splitPos;\n\t\t\t\tthis._dimGeom.forEachInRange(0,\n\t\t\t\t\tsplitIndex - 1,\n\t\t\t\t\t(idx: number, data: DimensionPosSize) => {\n\t\t\t\t\t\tthis._elements[idx] = {\n\t\t\t\t\t\t\tindex: idx,\n\t\t\t\t\t\t\tpos: (data.startpos + data.size) * scale, // end position on the header canvas\n\t\t\t\t\t\t\tsize: data.size * scale,\n\t\t\t\t\t\t\torigsize: data.size,\n\t\t\t\t\t\t\tisHighlighted: this.isHeaderEntryHighLighted(cellSelections, data.startpos + data.size * 0.5),\n\t\t\t\t\t\t\tisCurrent: idx === currentIndex\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis._hasSplits = true;\n\t\t\t\tthis._splitIndex = splitIndex;\n\n\t\t\t\tconst freeStartPos = startPx;\n\t\t\t\tconst freeStartIndex = this._dimGeom.getIndexFromPos(freeStartPos + 1, 'corepixels');\n\n\t\t\t\tstartIdx = freeStartIndex;\n\t\t\t}\n\t\t}\n\n\t\t// first free index\n\t\tconst dataFirstFree = this._dimGeom.getElementData(startIdx);\n\t\tconst firstFreeEnd = dataFirstFree.startpos + dataFirstFree.size - startPx + splitPos;\n\t\tconst firstFreeStart = splitPos;\n\t\tconst firstFreeSize = Math.max(0, firstFreeEnd - firstFreeStart);\n\t\tthis._elements[startIdx] = {\n\t\t\tindex: startIdx,\n\t\t\tpos: firstFreeEnd * scale, // end position on the header canvas\n\t\t\tsize: firstFreeSize * scale,\n\t\t\torigsize: dataFirstFree.size,\n\t\t\tisHighlighted: this.isHeaderEntryHighLighted(cellSelections, dataFirstFree.startpos + dataFirstFree.size * 0.5),\n\t\t\tisCurrent: startIdx === currentIndex\n\t\t};\n\n\t\tthis._dimGeom.forEachInRange(startIdx + 1,\n\t\t\tendIdx,\n\t\t\t(idx: number, data: DimensionPosSize) => {\n\t\t\t\tthis._elements[idx] = {\n\t\t\t\t\tindex: idx,\n\t\t\t\t\tpos: (data.startpos - startPx + splitPos + data.size) * scale, // end position on the header canvas\n\t\t\t\t\tsize: data.size * scale,\n\t\t\t\t\torigsize: data.size,\n\t\t\t\t\tisHighlighted: this.isHeaderEntryHighLighted(cellSelections, data.startpos + data.size * 0.5),\n\t\t\t\t\tisCurrent: idx === currentIndex\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\n\t\tthis._startIndex = startIdx;\n\t\tthis._endIndex = endIdx;\n\t}\n\n\tdocToHeaderPos (docPos: number): number {\n\t\tif (!this._hasSplits) {\n\t\t\treturn docPos - this._docVisStart;\n\t\t}\n\n\t\tif (docPos <= this._splitPos) {\n\t\t\treturn docPos;\n\t\t}\n\n\t\t// max here is to prevent encroachment of the fixed pane-area.\n\t\treturn Math.max(docPos - this._docVisStart, this._splitPos);\n\t}\n\n\theaderToDocPos (hdrPos: number): number {\n\t\tif (!this._hasSplits) {\n\t\t\treturn hdrPos + this._docVisStart;\n\t\t}\n\n\t\tif (hdrPos <= this._splitPos) {\n\t\t\treturn hdrPos;\n\t\t}\n\n\t\treturn hdrPos + this._docVisStart;\n\t}\n\n\tisZeroSize (i: number): boolean {\n\t\tconst elem = this._elements[i];\n\t\twindow.app.console.assert(elem, 'queried a non existent row/col in the header : ' + i);\n\t\treturn elem.size === 0;\n\t}\n\n\tgetMinIndex(): number {\n\t\treturn this._hasSplits ? 0 : this._startIndex;\n\t}\n\n\tgetMaxIndex(): number {\n\t\treturn this._endIndex;\n\t}\n\n\tgetElementData (index: number): HeaderEntryData {\n\t\treturn this._elements[index];\n\t}\n\n\tgetRowData (index: number): HeaderEntryData {\n\t\twindow.app.console.assert(!this._isColumn, 'this is a column header instance!');\n\t\treturn this.getElementData(index);\n\t}\n\n\tgetColData (index: number): HeaderEntryData {\n\t\twindow.app.console.assert(this._isColumn, 'this is a row header instance!');\n\t\treturn this.getElementData(index);\n\t}\n\n\tgetPreviousIndex (index: number): number {\n\n\t\tlet prevIndex: number;\n\t\tif (this._splitIndex && index === this._startIndex) {\n\t\t\tprevIndex = this._splitIndex - 1;\n\t\t}\n\t\telse {\n\t\t\tprevIndex = index - 1;\n\t\t}\n\n\t\treturn prevIndex;\n\t}\n\n\tgetNextIndex (index: number): number {\n\n\t\tlet nextIndex;\n\t\tif (this._splitIndex && index === (this._splitIndex - 1)) {\n\t\t\tnextIndex = this._startIndex;\n\t\t}\n\t\telse {\n\t\t\tnextIndex = index + 1;\n\t\t}\n\n\t\treturn nextIndex;\n\t}\n\n\tforEachElement (callback: (entry: HeaderEntryData) => boolean): void {\n\t\tlet idx: number;\n\t\tif (this._hasSplits) {\n\t\t\tfor (idx = 0; idx < this._splitIndex; ++idx) {\n\t\t\t\twindow.app.console.assert(this._elements[idx], 'forEachElement failed');\n\t\t\t\tif (callback(this._elements[idx])) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (idx = this._startIndex; idx <= this._endIndex; ++idx) {\n\t\t\twindow.app.console.assert(this._elements[idx], 'forEachElement failed');\n\t\t\tif (callback(this._elements[idx])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n}\n\nL.Control.Header = cool.Header;\nL.Control.Header.HeaderInfo = cool.HeaderInfo;\n"]}