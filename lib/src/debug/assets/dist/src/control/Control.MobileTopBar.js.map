{"version":3,"file":"Control.MobileTopBar.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.MobileTopBar.ts"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * JSDialog.MobileTopBar - component of top bar on mobile\n */\n\nclass MobileTopBar extends JSDialog.Toolbar {\n\tconstructor(map: any) {\n\t\tsuper(map, 'toolbar-up');\n\n\t\tapp.events.on('updatepermission', this.onUpdatePermission.bind(this));\n\t\tmap.on('commandstatechanged', this.onCommandStateChanged, this);\n\t}\n\n\tprivate getToolItems() {\n\t\tif (this.docType == 'text') {\n\t\t\treturn [\n\t\t\t\t{type: 'toolitem', id: 'signstatus', command: '.uno:Signature', w2icon: '', text: _UNO('.uno:Signature'), visible: false},\n\t\t\t\t{type: 'toolitem',  id: 'undo', text: _UNO('.uno:Undo'), command: '.uno:Undo', enabled: false},\n\t\t\t\t{type: 'toolitem',  id: 'redo', text: _UNO('.uno:Redo'), command: '.uno:Redo', enabled: false},\n\t\t\t\t{type: 'spacer', id: 'before-permissionmode'},\n\t\t\t\tthis._generateHtmlItem('permissionmode'),\n\t\t\t\t{type: 'spacer', id: 'after-permissionmode'},\n\t\t\t\t{type: 'customtoolitem',  id: 'mobile_wizard', command: 'mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'insertion_mobile_wizard', command: 'insertion_mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'comment_wizard', command: 'comment_wizard', w2icon: 'viewcomments'},\n\t\t\t\t{type: 'menubutton', id: 'userlist:UsersListMenu', visible: false},\n\t\t\t];\n\t\t} else if (this.docType == 'spreadsheet') {\n\t\t\treturn [\n\t\t\t\t{type: 'toolitem', id: 'signstatus', command: '.uno:Signature', w2icon: '', text: _UNO('.uno:Signature'), visible: false},\n\t\t\t\t{type: 'toolitem',  id: 'undo', text: _UNO('.uno:Undo'), command: '.uno:Undo', enabled: false},\n\t\t\t\t{type: 'toolitem',  id: 'redo', text: _UNO('.uno:Redo'), command: '.uno:Redo', enabled: false},\n\t\t\t\t{type: 'customtoolitem', visible: false, id: 'acceptformula', command: 'acceptformula', text: _('Accept')},\n\t\t\t\t{type: 'customtoolitem', visible: false, id: 'cancelformula', command: 'cancelformula', text: _('Cancel')},\n\t\t\t\t{type: 'spacer', id: 'before-PermissionMode'},\n\t\t\t\tthis._generateHtmlItem('permissionmode'),\n\t\t\t\t{type: 'spacer', id: 'after-PermissionMode'},\n\t\t\t\t{type: 'customtoolitem',  id: 'mobile_wizard', command: 'mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'insertion_mobile_wizard', command: 'insertion_mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'comment_wizard', command: 'comment_wizard', w2icon: 'viewcomments'},\n\t\t\t\t{type: 'menubutton', id: 'userlist:UsersListMenu', visible: false},\n\t\t\t];\n\t\t} else if (this.docType == 'presentation') {\n\t\t\treturn [\n\t\t\t\t{type: 'toolitem', id: 'signstatus', command: '.uno:Signature', w2icon: '', text: _UNO('.uno:Signature'), visible: false},\n\t\t\t\t{type: 'toolitem',  id: 'undo', text: _UNO('.uno:Undo'), command: '.uno:Undo', enabled: false},\n\t\t\t\t{type: 'toolitem',  id: 'redo', text: _UNO('.uno:Redo'), command: '.uno:Redo', enabled: false},\n\t\t\t\t{type: 'spacer', id: 'before-permissionmode'},\n\t\t\t\tthis._generateHtmlItem('permissionmode'),\n\t\t\t\t{type: 'spacer', id: 'after-permissionmode'},\n\t\t\t\t{type: 'customtoolitem',  id: 'mobile_wizard', command: 'mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'insertion_mobile_wizard', command: 'insertion_mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'comment_wizard', command: 'comment_wizard', w2icon: 'viewcomments'},\n\t\t\t\t{type: 'customtoolitem', id: 'fullscreen-' + this.docType, text: _UNO('.uno:FullScreen', this.docType)},\n\t\t\t\t{type: 'menubutton', id: 'userlist:UsersListMenu', visible: false},\n\t\t\t];\n\t\t} else if (this.docType == 'drawing') {\n\t\t\treturn [\n\t\t\t\t{type: 'toolitem', id: 'signstatus', command: '.uno:Signature', w2icon: '', text: _UNO('.uno:Signature'), visible: false},\n\t\t\t\t{type: 'toolitem',  id: 'undo', text: _UNO('.uno:Undo'), command: '.uno:Undo', enabled: false},\n\t\t\t\t{type: 'toolitem',  id: 'redo', text: _UNO('.uno:Redo'), command: '.uno:Redo', enabled: false},\n\t\t\t\t{type: 'spacer', id: 'before-PermissionMode'},\n\t\t\t\tthis._generateHtmlItem('permissionmode'),\n\t\t\t\t{type: 'spacer', id: 'after-PermissionMode'},\n\t\t\t\t{type: 'customtoolitem',  id: 'mobile_wizard', command: 'mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'insertion_mobile_wizard', command: 'insertion_mobile_wizard'},\n\t\t\t\t{type: 'customtoolitem',  id: 'comment_wizard', command: 'comment_wizard', w2icon: 'viewcomments'},\n\t\t\t\t{type: 'menubutton', id: 'userlist:UsersListMenu', visible: false},\n\t\t\t];\n\t\t}\n\t}\n\n\tcreate() {\n\t\tconst items = this.getToolItems();\n\t\tthis.builder.build(this.parentContainer, items);\n\t}\n\n\tonUpdatePermission(e: any) {\n\t\tconst toolbarButtons: string[] = ['undo', 'redo', 'mobile_wizard', 'insertion_mobile_wizard', 'comment_wizard'];\n\t\tif (e.detail.perm === 'edit') {\n\t\t\ttoolbarButtons.forEach((id) => {\n\t\t\t\tthis.showItem(id, true);\n\t\t\t});\n\t\t\tthis.showItem('PermissionMode', false);\n\t\t} else {\n\t\t\ttoolbarButtons.forEach((id) => {\n\t\t\t\tthis.showItem(id, false);\n\t\t\t});\n\t\t\tthis.showItem('comment_wizard', true);\n\t\t\tif ($('#mobile-edit-button').is(':hidden')) {\n\t\t\t\tthis.showItem('PermissionMode', true);\n\t\t\t}\n\t\t}\n\t}\n\n\tonCommandStateChanged(e: any) {\n\t\tconst commandName: string = e.commandName;\n\t\tconst state: string = e.state;\n\n\t\tif (this.map.isEditMode() && (state === 'enabled' || state === 'disabled')) {\n\t\t\tconst id: string = (window as any).unoCmdToToolbarId(commandName);\n\n\t\t\tif (state === 'enabled') {\n\t\t\t\tthis.enableItem(id, true);\n\t\t\t} else {\n\t\t\t\t//this.uncheck(id);\n\t\t\t\tthis.enableItem(id, false);\n\t\t\t}\n\t\t}\n\t}\n\n\t_generateHtmlItem(id: string) {\n\t\tconst isReadOnlyMode: boolean = app.map ? app.isReadOnly() : true;\n\t\tconst canUserWrite: boolean = !app.isReadOnly();\n\n\t\treturn {\n\t\t\ttype: 'container',\n\t\t\tid: id + '-container',\n\t\t\tchildren: [\n\t\t\t\t{type: 'htmlcontent', id: id, htmlId: id, text: '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp', isReadOnlyMode: isReadOnlyMode, canUserWrite: canUserWrite, visible: false},\n\t\t\t\t{type: 'spacer', id: id + '-break'}\n\t\t\t],\n\t\t\tvertical: false,\n\t\t};\n\t}\n}\n\nJSDialog.MobileTopBar = function (map: any) {\n\treturn new MobileTopBar(map);\n};\n"]}