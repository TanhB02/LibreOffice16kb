{"version":3,"file":"Signing.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Signing.js"],"names":[],"mappings":"AAAA,gCAAgC;AAChC;;;;;;;;GAQG;AACH;;GAEG;AAEH,kBAAkB;AAElB,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC;IACb,kBAAkB,EAAE,UAAS,UAAU;QACtC,4EAA4E;QAC5E,qCAAqC;QACrC,IAAI,UAAU,GAAG,CAAC,CAAC,6BAA6B,CAAC,CAAC;QAClD,kFAAkF;QAClF,+EAA+E;QAC/E,WAAW;QACX,IAAI,UAAU,GAAG,GAAG,CAAC;QACrB,4CAA4C;QAC5C,mDAAmD;QACnD,QAAQ,UAAU,EAAE;YACpB,KAAK,GAAG,EAAE,+BAA+B;gBACxC,MAAM;YACP,KAAK,GAAG,EAAE,qBAAqB;gBAC9B,UAAU,GAAG,CAAC,CAAC,+DAA+D,CAAC,CAAC;gBAChF,UAAU,GAAG,SAAS,CAAC;gBACvB,MAAM;YACP,KAAK,GAAG,EAAE,yBAAyB;gBAClC,UAAU,GAAG,CAAC,CAAC,yCAAyC,CAAC,CAAC;gBAC1D,UAAU,GAAG,aAAa,CAAC;gBAC3B,MAAM;YACP,KAAK,GAAG,EAAE,0BAA0B;gBACnC,UAAU,GAAG,CAAC,CAAC,8DAA8D,CAAC,CAAC;gBAC/E,UAAU,GAAG,aAAa,CAAC;gBAC3B,MAAM;YACP,KAAK,GAAG,EAAE,+BAA+B;gBACxC,UAAU,GAAG,CAAC,CAAC,kEAAkE,CAAC,CAAC;gBACnF,UAAU,GAAG,aAAa,CAAC;gBAC3B,MAAM;YACP,KAAK,GAAG,EAAE,6BAA6B;gBACtC,UAAU,GAAG,CAAC,CAAC,iEAAiE,CAAC,CAAC;gBAClF,UAAU,GAAG,aAAa,CAAC;gBAC3B,MAAM;YACP,KAAK,GAAG,EAAE,0CAA0C;gBACnD,UAAU,GAAG,CAAC,CAAC,4GAA4G,CAAC,CAAC;gBAC7H,UAAU,GAAG,aAAa,CAAC;gBAC3B,MAAM;SACN;QAED,IAAI,UAAU,KAAK,GAAG,EAAE;YACvB,IAAI,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;YAC9D,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;gBACxE,iEAAiE;gBACjE,OAAO;aACP;SACD;QAED,IAAI,UAAU,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE;gBAC5B,GAAG,CAAC,GAAG,CAAC,SAAS,CAAC,eAAe,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;gBAE1D,8DAA8D;gBAC9D,WAAW;gBACX,IAAM,UAAU,GAAG,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC;gBACtC,IAAI,UAAU,IAAI,UAAU,CAAC,0BAA0B,EAAE;oBACxD,UAAU,CAAC,0BAA0B,GAAG,KAAK,CAAC;oBAC9C,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC;iBACzC;aACD;iBAAM,IAAI,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,eAAe;gBAC9C,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,eAAe,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;SAC9D;IACF,CAAC;CACD,CAAC,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n/*\n * Document Signing\n */\n\n/* global _ app */\n\nL.Map.include({\n\tonChangeSignStatus: function(signstatus) {\n\t\t// Have a non-empty status text by default, so a signatures -> no signatures\n\t\t// transition updates the status bar.\n\t\tvar statusText = _('The document is not signed.');\n\t\t// Most documents don't have signatures, so have no disturbing icon for that case,\n\t\t// also don't have an empty icon, which would get the icon for the matching UNO\n\t\t// command.\n\t\tvar statusIcon = ' ';\n\t\t// This is meant to be in sync with core.git\n\t\t// include/sfx2/signaturestate.hxx, SignatureState.\n\t\tswitch (signstatus) {\n\t\tcase '0': // SignatureState::NOSIGNATURES\n\t\t\tbreak;\n\t\tcase '1': // SignatureState::OK\n\t\t\tstatusText = _('This document is digitally signed and the signature is valid.');\n\t\t\tstatusIcon = 'sign_ok';\n\t\t\tbreak;\n\t\tcase '2': // SignatureState::BROKEN\n\t\t\tstatusText = _('This document has an invalid signature.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tbreak;\n\t\tcase '3': // SignatureState::INVALID\n\t\t\tstatusText = _('The signature was valid, but the document has been modified.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tbreak;\n\t\tcase '4': // SignatureState::NOTVALIDATED\n\t\t\tstatusText = _('The signature is OK, but the certificate could not be validated.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tbreak;\n\t\tcase '5': // SignatureState::PARTIAL_OK\n\t\t\tstatusText = _('The signature is OK, but the document is only partially signed.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tbreak;\n\t\tcase '6': // SignatureState::NOTVALIDATED_PARTIAL_OK\n\t\t\tstatusText = _('The signature is OK, but the certificate could not be validated and the document is only partially signed.');\n\t\t\tstatusIcon = 'sign_not_ok';\n\t\t\tbreak;\n\t\t}\n\n\t\tif (signstatus === '0') {\n\t\t\tlet signstatusElement = document.querySelector('#signstatus');\n\t\t\tif (signstatusElement && signstatusElement.classList.contains('hidden')) {\n\t\t\t\t// Had no signatures and have no signatures: can skip the update.\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (statusText) {\n\t\t\tif (!window.mode.isMobile()) {\n\t\t\t\tapp.map.statusBar.showSigningItem(statusIcon, statusText);\n\n\t\t\t\t// If requested, show the signatures, now that the sign status\n\t\t\t\t// changed.\n\t\t\t\tconst eSignature = app.map.eSignature;\n\t\t\t\tif (eSignature && eSignature.showSignaturesOnNextUpdate) {\n\t\t\t\t\teSignature.showSignaturesOnNextUpdate = false;\n\t\t\t\t\tapp.map.sendUnoCommand('.uno:Signature');\n\t\t\t\t}\n\t\t\t} else if (app.map.mobileTopBar.showSigningItem)\n\t\t\t\tapp.map.mobileTopBar.showSigningItem(statusIcon, statusText);\n\t\t}\n\t}\n});\n"]}