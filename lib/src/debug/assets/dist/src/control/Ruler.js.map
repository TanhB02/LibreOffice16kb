{"version":3,"file":"Ruler.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Ruler.ts"],"names":[],"mappings":"AAAA,oBAAoB;AACpB;;;;;;;;;;;;;;;;;;;;;;;;;GAyBG;;;;;;;;;;;;AAyDH;IAGC,eAAY,OAAyB;QACpC,wCAAwC;QACxC,IAAI,CAAC,OAAO,cACX,WAAW,EAAE,IAAI,EACjB,SAAS,EAAE,KAAK,EAChB,aAAa,EAAE,IAAI,EACnB,UAAU,EAAE,EAAE,EACd,OAAO,EAAE,IAAI,EACb,OAAO,EAAE,IAAI,EACb,UAAU,EAAE,IAAI,EAChB,UAAU,EAAE,IAAI,EAChB,SAAS,EAAE,IAAI,EACf,aAAa,EAAE,IAAI,EACnB,gBAAgB,EAAE,IAAI,EACtB,eAAe,EAAE,IAAI,EACrB,mBAAmB,EAAE,IAAI,EACzB,oBAAoB,EAAE,IAAI,EAC1B,IAAI,EAAE,EAAE,EACR,IAAI,EAAE,IAAI,EACV,qBAAqB,EAAE,IAAI,EAC3B,KAAK,EAAE,IAAI,EACX,SAAS,EAAE,IAAI,EACf,QAAQ,EAAE,SAAS,EACnB,aAAa,EAAE,KAAK,IACjB,OAAO,CACV,CAAC;IACH,CAAC;IAKD,iCAAiB,GAAjB;QACC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACjC,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;IAC7E,CAAC;IAED,iCAAiB,GAAjB,UAAqB,YAAoB;QACxC,OAAQ,MAAc,CAAC,YAAY,CAAC,CAAC;IACtC,CAAC;IAED,uDAAuD;IAChD,qBAAe,GAAtB,UACC,GAA6B,EAC7B,OAAyB;;QAEzB,IAAM,KAAK,GAAG,QAAQ,CAAC,eAAe,CAAC,GAAG,KAAK,KAAK,CAAC;QACrD,IAAM,gBAAgB,GAAG,GAAG,CAAC,UAAU,EAAE,CAAC;QAC1C,IAAM,SAAS,GAAG,MAAA,OAAO,CAAC,SAAS,mCAAI,IAAI,CAAC;QAE5C,kCAAkC;QAClC,IAAI,MAAM,CAAC,GAAG,EAAE;YACf,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;YACxC,WAAW,EAAE,gBAAgB;YAC7B,SAAS,EAAE,SAAS;SACpB,CAAC,CAAC;QAEH,uEAAuE;QACvE,IAAI,CAAC,GAAG,CAAC,uBAAuB,EAAE,EAAE;YACnC,IAAI,MAAM,CAAC,GAAG,EAAE;gBACf,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;gBACxC,WAAW,EAAE,gBAAgB;gBAC7B,SAAS,EAAE,SAAS;aACpB,CAAC,CAAC;SACH;QAED,gCAAgC;QAChC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IAC1B,CAAC;IACF,YAAC;AAAD,CAAC,AAvED,IAuEC;AAED,GAAG,CAAC,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC","sourcesContent":["// @ts-strict-ignore\n/**\n /*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n *\n * Ruler.ts - Base Class for Ruler Functionality\n *\n * This file defines the core logic for the Ruler feature, shared by both \n * horizontal (HRuler) and vertical (VRuler) implementations.\n *\n * ### Key Features:\n * - **Configurable Options**: Supports margins, tab stops, interactivity, and display settings.\n * - **Abstract Design**: Subclasses must implement `_updateBreakPoints()` for specific behaviors.\n * - **Shared Utilities**: Includes reusable methods like `_updatePaintTimer` and `getWindowProperty`.\n * - **Easy Initialization**: `initializeRuler` simplifies setup for HRuler and VRuler.\n *\n * ### Guidelines:\n * - Extend the `Options` interface for new features.\n * - Implement subclass-specific logic in `_updateBreakPoints()`.\n * - Ensure event handling (e.g., `rulerchanged`) for updates.\n */\n\ninterface CustomHTMLDivElement extends HTMLDivElement {\n\ttabStops?: any;\n}\n\ninterface TabStopLocation {\n\tleft: number;\n\tright: number;\n\tcenter: number;\n}\n\ninterface TabStop {\n\ttabStopLocation: TabStopLocation;\n\ttabStopNumber: number;\n}\n\ninterface TabStopContainer {\n\ttabStops: TabStop[];\n}\n\ninterface Params {\n\t[key: string]: {\n\t\ttype: string;\n\t\tvalue: any;\n\t};\n}\n\ninterface TabstopObject {\n\tposition: number;\n\tstyle: number;\n}\n\ninterface Options {\n\tinteractive: boolean;\n\tmarginSet: boolean;\n\tdisplayNumber: boolean;\n\ttileMargin: number;\n\tmargin1: number | null;\n\tmargin2: number | null;\n\tleftOffset: number | null;\n\tpageOffset: number | null;\n\tpageWidth: number | null;\n\tpageTopMargin: number | null;\n\tpageBottomMargin: number | null;\n\tfirstLineIndent: number | null;\n\tleftParagraphIndent: number | null;\n\trightParagraphIndent: number | null;\n\ttabs: TabstopObject[] | string;\n\tunit: string | null;\n\tDraggableConvertRatio: number | null;\n\ttimer: ReturnType<typeof setTimeout>;\n\tshowruler: boolean;\n\tposition: string;\n\tdisableMarker: boolean;\n}\n\nabstract class Ruler {\n\tprotected options: Options;\n\n\tconstructor(options: Partial<Options>) {\n\t\t// Init default values for ruler options\n\t\tthis.options = {\n\t\t\tinteractive: true,\n\t\t\tmarginSet: false,\n\t\t\tdisplayNumber: true,\n\t\t\ttileMargin: 18,\n\t\t\tmargin1: null,\n\t\t\tmargin2: null,\n\t\t\tleftOffset: null,\n\t\t\tpageOffset: null,\n\t\t\tpageWidth: null,\n\t\t\tpageTopMargin: null,\n\t\t\tpageBottomMargin: null,\n\t\t\tfirstLineIndent: null,\n\t\t\tleftParagraphIndent: null,\n\t\t\trightParagraphIndent: null,\n\t\t\ttabs: '',\n\t\t\tunit: null,\n\t\t\tDraggableConvertRatio: null,\n\t\t\ttimer: null,\n\t\t\tshowruler: true,\n\t\t\tposition: 'topleft',\n\t\t\tdisableMarker: false,\n\t\t\t...options,\n\t\t};\n\t}\n\n\t// Abstract method: Must be implemented by subclasses\n\tprotected abstract _updateBreakPoints(): void;\n\n\t_updatePaintTimer() {\n\t\tclearTimeout(this.options.timer);\n\t\tthis.options.timer = setTimeout(L.bind(this._updateBreakPoints, this), 300);\n\t}\n\n\tgetWindowProperty<T>(propertyName: string): T | undefined {\n\t\treturn (window as any)[propertyName];\n\t}\n\n\t// Static method to handle the initialization of rulers\n\tstatic initializeRuler(\n\t\tmap: ReturnType<typeof L.map>,\n\t\toptions: Partial<Options>,\n\t) {\n\t\tconst isRTL = document.documentElement.dir === 'rtl';\n\t\tconst interactiveRuler = map.isEditMode();\n\t\tconst showRuler = options.showruler ?? true;\n\n\t\t// Initialize the horizontal ruler\n\t\tnew HRuler(map, {\n\t\t\tposition: isRTL ? 'topright' : 'topleft',\n\t\t\tinteractive: interactiveRuler,\n\t\t\tshowruler: showRuler,\n\t\t});\n\n\t\t// Initialize the vertical ruler if not in presentation or drawing mode\n\t\tif (!map.isPresentationOrDrawing()) {\n\t\t\tnew VRuler(map, {\n\t\t\t\tposition: isRTL ? 'topright' : 'topleft',\n\t\t\t\tinteractive: interactiveRuler,\n\t\t\t\tshowruler: showRuler,\n\t\t\t});\n\t\t}\n\n\t\t// Fire the 'rulerchanged' event\n\t\tmap.fire('rulerchanged');\n\t}\n}\n\napp.definitions.ruler = Ruler;\n"]}