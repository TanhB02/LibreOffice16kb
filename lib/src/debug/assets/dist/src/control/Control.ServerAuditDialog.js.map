{"version":3,"file":"Control.ServerAuditDialog.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/control/Control.ServerAuditDialog.ts"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * ServerAuditDialog - Dialog for admin users showing checklist of server security settings\n */\n\ndeclare var JSDialog: any;\n\ninterface AuditEntry {\n\tcode: string;\n\tstatus: string;\n}\n\nclass ClientAuditor {\n\tprivate static checkPostMessages(entries: Array<AuditEntry>) {\n\t\tif ((window as any).WOPIPostmessageReady)\n\t\t\tentries.push({ code: 'postmessage', status: 'ok' });\n\t\telse entries.push({ code: 'postmessage', status: 'hostnotready' });\n\t}\n\n\tpublic static performClientAudit(): Array<AuditEntry> {\n\t\tconst entries = new Array<AuditEntry>();\n\t\tClientAuditor.checkPostMessages(entries);\n\t\treturn entries;\n\t}\n}\n\nclass ServerAuditDialog {\n\tmap: any;\n\tid: string = 'ServerAuditDialog';\n\terrorCodes: any;\n\n\tconstructor(map: any) {\n\t\tthis.map = map;\n\t\tthis.map.on('receivedserveraudit', this.onServerAudit.bind(this), this);\n\n\t\tthis.errorCodes = {\n\t\t\tis_admin: {\n\t\t\t\tmissing: [\n\t\t\t\t\t_('The IsAdminUser property is not set by integration'),\n\t\t\t\t\t'SDK: IsAdminUser',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/advanced_integration.html?highlight=IsAdminUser#isadminuser',\n\t\t\t\t],\n\t\t\t\tdeprecated: [\n\t\t\t\t\t_(\n\t\t\t\t\t\t'Used deprecated is_admin field, integration should use IsAdminUser property instead',\n\t\t\t\t\t),\n\t\t\t\t\t'SDK: IsAdminUser',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/advanced_integration.html?highlight=IsAdminUser#isadminuser',\n\t\t\t\t],\n\t\t\t\tok: [\n\t\t\t\t\t_('The IsAdminUser user property is set by integration'),\n\t\t\t\t\t'SDK: IsAdminUser',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/advanced_integration.html?highlight=IsAdminUser#isadminuser',\n\t\t\t\t],\n\t\t\t},\n\t\t\tcertwarning: {\n\t\t\t\tsslverifyfail: [\n\t\t\t\t\t_('Your WOPI server is not secure: SSL verification failed'),\n\t\t\t\t\t'SDK: ssl-configuration',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/installation/Configuration.html?highlight=ssl#ssl-configuration',\n\t\t\t\t],\n\t\t\t\tok: [\n\t\t\t\t\t_('No problems with SSL verification detected'),\n\t\t\t\t\t'SDK: ssl-configuration',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/installation/Configuration.html?highlight=ssl#ssl-configuration',\n\t\t\t\t],\n\t\t\t},\n\t\t\tpostmessage: {\n\t\t\t\tok: [\n\t\t\t\t\t_('PostMessage API is initialized'),\n\t\t\t\t\t'SDK: post-message-initialization',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/postmessage_api.html#initialization',\n\t\t\t\t],\n\t\t\t\thostnotready: [\n\t\t\t\t\t_('Integrator is not ready for PostMessage calls'),\n\t\t\t\t\t'SDK: post-message-initialization',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/postmessage_api.html#initialization',\n\t\t\t\t],\n\t\t\t},\n\t\t\thardwarewarning: {\n\t\t\t\tlowresources: [\n\t\t\t\t\t_(\n\t\t\t\t\t\t'Your server is configured with insufficient hardware resources, which may lead to poor performance.',\n\t\t\t\t\t),\n\t\t\t\t\t'SDK: hardware-requirements',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/installation/Configuration.html#performance',\n\t\t\t\t],\n\t\t\t\tok: [\n\t\t\t\t\t_('Hardware resources are sufficient for optimal performance'),\n\t\t\t\t\t'SDK: hardware-requirements',\n\t\t\t\t\t'https://sdk.collaboraonline.com/docs/installation/Configuration.html#performance',\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic open() {\n\t\tconst serverEntries = this.getEntries(app.serverAudit);\n\t\tconst clientEntries = this.getEntries(ClientAuditor.performClientAudit());\n\n\t\tconst dialogBuildEvent = {\n\t\t\tdata: this.getJSON(serverEntries.concat(clientEntries)),\n\t\t\tcallback: this.callback.bind(this) as JSDialogCallback,\n\t\t};\n\n\t\tthis.map.fire(\n\t\t\twindow.mode.isMobile() ? 'mobilewizard' : 'jsdialog',\n\t\t\tdialogBuildEvent,\n\t\t);\n\t}\n\n\tprivate getEntries(source: any): Array<TreeEntryJSON> {\n\t\tconst entries = new Array<TreeEntryJSON>();\n\n\t\tif (!source) return entries;\n\n\t\tconst errorIcon = { collapsed: 'serverauditerror.svg' };\n\t\tconst okIcon = { collapsed: 'serverauditok.svg' };\n\n\t\tsource.forEach((entry: AuditEntry) => {\n\t\t\tconst found = this.errorCodes[entry.code];\n\t\t\tif (found) {\n\t\t\t\tconst status = found[entry.status];\n\t\t\t\tif (status) {\n\t\t\t\t\tentries.push({\n\t\t\t\t\t\trow: 0,\n\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\tentry.status === 'ok' ? okIcon : errorIcon,\n\t\t\t\t\t\t\t{ text: status[0] },\n\t\t\t\t\t\t\tstatus[1] && status[2]\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\ttext: status[1],\n\t\t\t\t\t\t\t\t\t\tlink: status[2],\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t: { text: '' },\n\t\t\t\t\t\t],\n\t\t\t\t\t} as TreeEntryJSON);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn('Unknown server audit entry: ' + entry.code);\n\t\t\t}\n\t\t});\n\n\t\treturn entries;\n\t}\n\n\tprivate hasErrors(): boolean {\n\t\tlet hasErrors = false;\n\t\tif (app.serverAudit) {\n\t\t\tapp.serverAudit.forEach((entry: any) => {\n\t\t\t\tif (entry.status !== 'ok') {\n\t\t\t\t\thasErrors = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (app.clientAudit) {\n\t\t\tapp.clientAudit.forEach((entry: any) => {\n\t\t\t\tif (entry.status !== 'ok') {\n\t\t\t\t\thasErrors = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn hasErrors;\n\t}\n\n\tprivate countErrors(): number {\n\t\treturn (\n\t\t\t(app.serverAudit?.filter((entry: AuditEntry) => entry.status !== 'ok')\n\t\t\t\t.length ?? 0) +\n\t\t\t(app.clientAudit?.filter((entry: AuditEntry) => entry.status !== 'ok')\n\t\t\t\t.length ?? 0)\n\t\t);\n\t}\n\n\tprivate getJSON(entries: Array<any>): JSDialogJSON {\n\t\tconst hasErrors = this.hasErrors();\n\t\tconst countErrors = this.countErrors();\n\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tdialogid: this.id,\n\t\t\ttype: 'dialog',\n\t\t\ttext: _('Server audit'),\n\t\t\ttitle: _('Server audit'),\n\t\t\tjsontype: 'dialog',\n\t\t\tresponses: [\n\t\t\t\t{\n\t\t\t\t\tid: 'ok',\n\t\t\t\t\tresponse: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: this.id + '-mainbox',\n\t\t\t\t\ttype: 'container',\n\t\t\t\t\tvertical: true,\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'auditlist',\n\t\t\t\t\t\t\ttype: 'treelistbox',\n\t\t\t\t\t\t\theaders: [\n\t\t\t\t\t\t\t\t/* icon */ { text: _('Status'), sortable: false },\n\t\t\t\t\t\t\t\t{ text: _('Help'), sortable: false },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tentries: entries,\n\t\t\t\t\t\t\tenabled: entries.length > 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!hasErrors\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\tid: 'auditsuccess',\n\t\t\t\t\t\t\t\t\ttype: 'fixedtext',\n\t\t\t\t\t\t\t\t\ttext: _('No issues found'),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\tid: 'auditerror',\n\t\t\t\t\t\t\t\t\ttype: 'fixedtext',\n\t\t\t\t\t\t\t\t\ttext: _('Alerts:') + ' ' + countErrors,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: this.id + '-buttonbox',\n\t\t\t\t\t\t\ttype: 'buttonbox',\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: 'ok',\n\t\t\t\t\t\t\t\t\ttype: 'pushbutton',\n\t\t\t\t\t\t\t\t\ttext: _('OK'),\n\t\t\t\t\t\t\t\t} as PushButtonWidget,\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tlayoutstyle: 'end',\n\t\t\t\t\t\t} as ButtonBoxWidget,\n\t\t\t\t\t],\n\t\t\t\t} as ContainerWidgetJSON,\n\t\t\t],\n\t\t} as JSDialogJSON;\n\t}\n\n\tpublic close() {\n\t\tconst closeEvent = {\n\t\t\tdata: {\n\t\t\t\taction: 'close',\n\t\t\t\tid: this.id,\n\t\t\t},\n\t\t};\n\t\tthis.map.fire(\n\t\t\twindow.mode.isMobile() ? 'closemobilewizard' : 'jsdialog',\n\t\t\tcloseEvent,\n\t\t);\n\t}\n\n\tprivate onServerAudit() {\n\t\tif (app.serverAudit.length) {\n\t\t\tlet hasErrors = false;\n\t\t\tapp.serverAudit.forEach((entry: any) => {\n\t\t\t\tif (entry.status !== 'ok') {\n\t\t\t\t\thasErrors = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// only show the snackbar if there are specific warnings\n\t\t\t// and if the current view isadminuser\n\t\t\tif (hasErrors && app.isAdminUser) {\n\t\t\t\tthis.map.uiManager.showSnackbar(\n\t\t\t\t\t_('Check security warnings of your server'),\n\t\t\t\t\t_('OPEN'),\n\t\t\t\t\tthis.open.bind(this),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// but if we any results, enable the toolbar entry for the server audit\n\t\t\tthis.map.uiManager.refreshUI();\n\t\t}\n\t}\n\n\tprivate callback(\n\t\tobjectType: string,\n\t\teventType: string,\n\t\tobject: any,\n\t\tdata: any,\n\t\tbuilder: any,\n\t) {\n\t\tif (eventType === 'response' || object.id === 'ok') this.close();\n\t}\n}\n\nJSDialog.serverAuditDialog = (map: any) => {\n\treturn new ServerAuditDialog(map);\n};\n"]}