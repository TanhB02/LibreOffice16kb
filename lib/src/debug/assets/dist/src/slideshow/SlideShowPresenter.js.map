{"version":3,"file":"SlideShowPresenter.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/slideshow/SlideShowPresenter.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/*\n * SlideShowPresenter is responsible for presenting the slide show and transitions\n */\n\ndeclare var SlideShow: any;\n\ninterface VideoInfo {\n\tid: number;\n\turl: string;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n}\n\ninterface ClickRect {\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n}\n\nfunction hitTest(bounds: ClickRect, x: number, y: number) {\n\treturn (\n\t\tx >= bounds.x &&\n\t\tx <= bounds.x + bounds.width &&\n\t\ty >= bounds.y &&\n\t\ty <= bounds.y + bounds.height\n\t);\n}\n\ninterface ClickAction {\n\taction:\n\t\t| 'bookmark'\n\t\t| 'document'\n\t\t| 'prevpage'\n\t\t| 'nextpage'\n\t\t| 'firstpage'\n\t\t| 'lastpage'\n\t\t| 'sound'\n\t\t| 'verb'\n\t\t| 'program'\n\t\t| 'macro'\n\t\t| 'stoppresentation';\n\tbookmark?: string;\n\tdocument?: string;\n\tsound?: string;\n\tverb?: string;\n\tprogram?: string;\n\tmacro?: string;\n}\n\ninterface Interaction {\n\tbounds: ClickRect;\n\tclickAction?: ClickAction;\n}\n\ninterface Trigger {\n\thash: string;\n\tbounds: DOMRect;\n}\n\ninterface SlideInfo {\n\thash: string;\n\tindex: number;\n\tname: string;\n\tnotes: string;\n\tempty: boolean;\n\thidden?: boolean;\n\tmasterPage: string;\n\tmasterPageObjectsVisibility: boolean;\n\tvideos: Array<VideoInfo>;\n\tinteractions: Array<Interaction>;\n\ttransitionDuration: number;\n\tnextSlideDuration: number;\n\ttransitionDirection: boolean;\n\ttransitionType: string | undefined;\n\ttransitionSubtype: string | undefined;\n\ttransitionFadeColor: string | undefined;\n\tbackground: {\n\t\tisCustom: boolean;\n\t\tfillColor: string;\n\t};\n\tanimations: any;\n\ttriggers: Array<Trigger>;\n\tnext: string;\n\tprev: string;\n\tindexInSlideShow?: number;\n}\n\ninterface PresentationInfo {\n\tslides: Array<SlideInfo>;\n\tdocWidth: number;\n\tdocHeight: number;\n\tisEndless: boolean;\n\tloopAndRepeatDuration: number | undefined;\n}\n\nclass SlideShowPresenter {\n\t_map: any = null;\n\t_presentationInfo: PresentationInfo = null;\n\t_slideCompositor: SlideCompositor = null;\n\t_fullscreen: Element = null;\n\t_presenterContainer: HTMLDivElement = null;\n\t_slideShowCanvas: HTMLCanvasElement = null;\n\t_slideShowWindowProxy: HTMLIFrameElement = null;\n\t_windowCloseInterval: ReturnType<typeof setInterval> = null;\n\t_slideRenderer: SlideRenderer = null;\n\t_canvasLoader: CanvasLoader | null = null;\n\tprivate _pauseTimer: PauseTimerGl | PauseTimer2d;\n\tprivate _slideShowHandler: SlideShowHandler;\n\tprivate _slideShowNavigator: SlideShowNavigator;\n\tprivate _metaPresentation: MetaPresentation;\n\tprivate _startSlide: number;\n\tprivate _presentationInfoChanged: boolean = false;\n\t_skipNextSlideShowInfoChangedMsg: boolean = false;\n\tprivate _cypressSVGPresentationTest: boolean = false;\n\tprivate _onKeyDownHandler: (e: KeyboardEvent) => void;\n\tprivate _onImpressModeChanged: any = null;\n\tprivate _startingPresentation: boolean = false;\n\tprivate _hammer: HammerManager;\n\n\tconstructor(map: any) {\n\t\tthis._cypressSVGPresentationTest =\n\t\t\tL.Browser.cypressTest || 'Cypress' in window;\n\t\tthis._map = map;\n\t\tthis._init();\n\t\tthis.addHooks();\n\t}\n\n\taddHooks() {\n\t\tthis._map.on('presentationinfo', this.onSlideShowInfo, this);\n\t\tthis._map.on('newfullscreen', this._onStart, this);\n\t\tthis._map.on('newpresentinwindow', this._onStartInWindow, this);\n\t\tL.DomEvent.on(document, 'fullscreenchange', this._onFullScreenChange, this);\n\t\tthis._map.on('updateparts', this.onUpdateParts, this);\n\t}\n\n\tremoveHooks() {\n\t\tthis._map.off('presentationinfo', this.onSlideShowInfo, this);\n\t\tthis._map.off('newfullscreen', this._onStart, this);\n\t\tthis._map.off('newpresentinwindow', this._onStartInWindow, this);\n\t\tL.DomEvent.off(\n\t\t\tdocument,\n\t\t\t'fullscreenchange',\n\t\t\tthis._onFullScreenChange,\n\t\t\tthis,\n\t\t);\n\t\tthis._map.off('updateparts', this.onUpdateParts, this);\n\t}\n\n\tprivate _init() {\n\t\tthis._slideShowHandler = new SlideShowHandler(this);\n\t\tthis._slideShowNavigator = new SlideShowNavigator(this._slideShowHandler);\n\t\t// do not allow user interaction until we get presentation info\n\t\tthis._slideShowNavigator.disable();\n\t\tthis._slideShowHandler.setNavigator(this._slideShowNavigator);\n\t\tthis._slideShowNavigator.setPresenter(this);\n\t\tthis._onKeyDownHandler = this._slideShowNavigator.onKeyDown.bind(\n\t\t\tthis._slideShowNavigator,\n\t\t);\n\t}\n\n\tprivate onUpdateParts() {\n\t\tif (this._checkAlreadyPresenting() && !this._startingPresentation)\n\t\t\tthis.onSlideShowInfoChanged();\n\t}\n\n\tpublic getNavigator() {\n\t\treturn this._slideShowNavigator;\n\t}\n\n\tpublic getSlideInfo(slideNumber: number): SlideInfo | null {\n\t\treturn this._presentationInfo\n\t\t\t? this._presentationInfo.slides[slideNumber]\n\t\t\t: null;\n\t}\n\n\t_getSlidesCount() {\n\t\treturn this._presentationInfo ? this._presentationInfo.slides.length : 0;\n\t}\n\n\t_getRepeatDuration() {\n\t\treturn this._presentationInfo\n\t\t\t? this._presentationInfo.loopAndRepeatDuration\n\t\t\t: 0;\n\t}\n\n\tpublic isSlideHidden(slideNumber: number) {\n\t\tconst slideInfo = this.getSlideInfo(slideNumber);\n\t\treturn slideInfo ? slideInfo.hidden : true;\n\t}\n\n\tpublic getVisibleSlidesCount() {\n\t\tlet count = 0;\n\t\tconst slideCount = this._getSlidesCount();\n\t\tfor (let i = 0; i < slideCount; ++i) {\n\t\t\tif (this.isSlideHidden(i)) continue;\n\t\t\t++count;\n\t\t}\n\t\treturn count;\n\t}\n\n\tpublic getNextVisibleSlide(slideNumber: number) {\n\t\tlet next = slideNumber;\n\t\twhile (next < this._getSlidesCount()) {\n\t\t\t++next;\n\t\t\tif (!this.isSlideHidden(next)) break;\n\t\t}\n\t\treturn next;\n\t}\n\n\tpublic getVisibleIndex(slideNumber: number) {\n\t\tlet index = slideNumber;\n\t\tfor (let i = 0; i < slideNumber; ++i) {\n\t\t\tif (this.isSlideHidden(i)) --index;\n\t\t}\n\t\treturn index;\n\t}\n\n\tpublic isFullscreen() {\n\t\tif (this._cypressSVGPresentationTest) return false;\n\t\treturn !!this._fullscreen;\n\t}\n\n\tpublic getCanvas(): HTMLCanvasElement {\n\t\treturn this._slideShowCanvas;\n\t}\n\n\tpublic getNotes(slide: number) {\n\t\tconst info = this.getSlideInfo(slide);\n\t\treturn info.notes;\n\t}\n\n\tpublic getVideoRenderer(\n\t\tslideHash: string,\n\t\tvideoInfo: VideoInfo,\n\t): VideoRenderer {\n\t\treturn this._slideCompositor.getVideoRenderer(slideHash, videoInfo);\n\t}\n\n\t_onFullScreenChange() {\n\t\tthis._fullscreen = document.fullscreenElement;\n\t\tif (this._fullscreen) {\n\t\t\t// window.addEventListener('keydown', this._onCanvasKeyDown.bind(this));\n\t\t\twindow.addEventListener('keydown', this._onKeyDownHandler);\n\t\t\tthis.centerCanvas();\n\t\t} else {\n\t\t\t// we need to cleanup current/prev slide\n\t\t\tthis._slideShowNavigator.quit();\n\t\t}\n\t}\n\n\t_stopFullScreen() {\n\t\tif (!this._slideShowCanvas) return;\n\n\t\tif (this._slideCompositor) this._slideCompositor.deleteResources();\n\t\tthis._slideRenderer.deleteResources();\n\n\t\twindow.removeEventListener('keydown', this._onKeyDownHandler);\n\n\t\tL.DomUtil.remove(this._slideShowCanvas);\n\t\tthis._slideShowCanvas = null;\n\t\tif (this._presenterContainer) {\n\t\t\tL.DomUtil.remove(this._presenterContainer);\n\t\t\tthis._presenterContainer = null;\n\t\t}\n\t\t// #7102 on exit from fullscreen we don't get a 'focus' event\n\t\t// in Chrome so a later second attempt at launching a presentation\n\t\t// fails\n\t\tthis._map.focus();\n\t}\n\n\tprivate centerCanvas() {\n\t\tif (!this._slideShowCanvas) return;\n\t\tlet winWidth = 0;\n\t\tlet winHeight = 0;\n\t\tif (this._slideShowWindowProxy) {\n\t\t\twinWidth = this._slideShowWindowProxy.clientWidth;\n\t\t\twinHeight = this._slideShowWindowProxy.clientHeight;\n\t\t} else if (this.isFullscreen()) {\n\t\t\twinWidth = window.screen.width;\n\t\t\twinHeight = window.screen.height;\n\t\t}\n\n\t\t// set canvas styles\n\t\tif (\n\t\t\twinWidth * this._slideShowCanvas.height <\n\t\t\twinHeight * this._slideShowCanvas.width\n\t\t) {\n\t\t\t// clean previous styles\n\t\t\tthis._slideShowCanvas.style.height = '';\n\t\t\tthis._slideShowCanvas.style.left = '';\n\t\t\t// set new styles\n\t\t\tthis._slideShowCanvas.style.width = '100%';\n\t\t\tthis._slideShowCanvas.style.top = '50%';\n\t\t\tthis._slideShowCanvas.style.transform = 'translateY(-50%)';\n\t\t} else {\n\t\t\t// clean previous styles\n\t\t\tthis._slideShowCanvas.style.width = '';\n\t\t\tthis._slideShowCanvas.style.top = '';\n\t\t\t// set new styles\n\t\t\tthis._slideShowCanvas.style.height = '100%';\n\t\t\tthis._slideShowCanvas.style.left = '50%';\n\t\t\tthis._slideShowCanvas.style.transform = 'translateX(-50%)';\n\t\t}\n\t}\n\n\tprivate _createPresenterHTML(parent: Element, width: number, height: number) {\n\t\tconst presenterContainer = L.DomUtil.create(\n\t\t\t'div',\n\t\t\t'leaflet-slideshow2',\n\t\t\tparent,\n\t\t);\n\t\tpresenterContainer.id = 'presenter-container';\n\t\tconst slideshowContainer = L.DomUtil.create(\n\t\t\t'div',\n\t\t\t'leaflet-slideshow2',\n\t\t\tpresenterContainer,\n\t\t);\n\t\tslideshowContainer.id = 'slideshow-container';\n\t\tthis._slideShowCanvas = this._createCanvas(\n\t\t\tslideshowContainer,\n\t\t\twidth,\n\t\t\theight,\n\t\t);\n\t\treturn presenterContainer;\n\t}\n\n\t_createCanvas(parent: Element, width: number, height: number) {\n\t\tconst canvas = L.DomUtil.create('canvas', 'leaflet-slideshow2', parent);\n\n\t\tcanvas.id = 'slideshow-canvas';\n\t\t// set canvas styles\n\t\tcanvas.style.margin = 0;\n\t\tcanvas.style.position = 'absolute';\n\n\t\tcanvas.addEventListener(\n\t\t\t'click',\n\t\t\tthis._slideShowNavigator.onClick.bind(this._slideShowNavigator),\n\t\t);\n\t\tcanvas.addEventListener(\n\t\t\t'mousemove',\n\t\t\tthis._slideShowNavigator.onMouseMove.bind(this._slideShowNavigator),\n\t\t);\n\n\t\tif (this._hammer) {\n\t\t\tthis._hammer.off('swipe');\n\t\t}\n\t\tthis._hammer = new Hammer(canvas);\n\t\tthis._hammer.get('swipe').set({\n\t\t\tdirection: Hammer.DIRECTION_ALL,\n\t\t});\n\t\tthis._hammer.on(\n\t\t\t'swipe',\n\t\t\twindow.touch\n\t\t\t\t.touchOnly(this._slideShowNavigator.onSwipe)\n\t\t\t\t.bind(this._slideShowNavigator),\n\t\t);\n\n\t\tthis._slideShowHandler.getContext().aCanvas = canvas;\n\n\t\ttry {\n\t\t\tthis._slideRenderer = new SlideRendererGl(canvas);\n\t\t} catch (error) {\n\t\t\tthis._slideRenderer = new SlideRenderer2d(canvas);\n\t\t}\n\n\t\treturn canvas;\n\t}\n\n\texitSlideshowWithWarning(): boolean {\n\t\t// TODO 2D version for disabled webGL\n\t\tif (this._slideRenderer._context.is2dGl()) return false;\n\t\tnew SlideShow.StaticTextRenderer(this._slideRenderer._context).display(\n\t\t\t_('Click to exit presentation...'),\n\t\t);\n\t\treturn true;\n\t}\n\n\tprivate startTimer(loopAndRepeatDuration: number) {\n\t\tconsole.debug('SlideShowPresenter.startTimer');\n\t\tconst renderContext = this._slideRenderer._context;\n\t\tconst onTimeoutHandler = this._slideShowNavigator.goToFirstSlide.bind(\n\t\t\tthis._slideShowNavigator,\n\t\t);\n\t\tconst PauseTimerType =\n\t\t\trenderContext instanceof RenderContextGl ? PauseTimerGl : PauseTimer2d;\n\t\tthis._pauseTimer = new PauseTimerType(\n\t\t\trenderContext,\n\t\t\tloopAndRepeatDuration,\n\t\t\tonTimeoutHandler,\n\t\t);\n\n\t\tthis._pauseTimer.startTimer();\n\t}\n\n\tendPresentation(force: boolean) {\n\t\tconsole.debug('SlideShowPresenter.endPresentation');\n\t\tif (this._pauseTimer) this._pauseTimer.stopTimer();\n\n\t\tconst settings = this._presentationInfo;\n\t\tif (force || !settings.isEndless) {\n\t\t\tif (!force && this.exitSlideshowWithWarning()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._stopFullScreen();\n\t\t\tthis._closeSlideShowWindow();\n\t\t\treturn;\n\t\t}\n\t\tthis.startTimer(settings.loopAndRepeatDuration);\n\t}\n\n\tprivate startLoader(): void {\n\t\ttry {\n\t\t\tthis._canvasLoader = new CanvasLoaderGl(this._slideRenderer._context);\n\t\t} catch (error) {\n\t\t\tthis._canvasLoader = new CanvasLoader2d(this._slideRenderer._context);\n\t\t}\n\n\t\tthis._canvasLoader.startLoader();\n\t\tthis._startingPresentation = false;\n\t}\n\n\tpublic stopLoader(): void {\n\t\tif (!this._canvasLoader) return;\n\n\t\tthis._canvasLoader.stopLoader();\n\t\tthis._canvasLoader = null;\n\t}\n\n\t_generateSlideWindowHtml(title: string) {\n\t\tconst sanitizer = document.createElement('div');\n\t\tsanitizer.innerText = title;\n\n\t\tconst sanitizedTitle = sanitizer.innerHTML;\n\n\t\treturn `\n\t\t\t<!DOCTYPE html>\n\t\t\t<html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"UTF-8\">\n\t\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\t\t\t\t<title>${sanitizedTitle}</title>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<div id=\"root-in-window\"></div>\n\t\t\t</body>\n\t\t\t</html>\n\t\t\t`;\n\t}\n\n\t_closeSlideShowWindow() {\n\t\tif (this._slideShowWindowProxy) {\n\t\t\tthis._slideShowWindowProxy.parentElement.removeChild(\n\t\t\t\tthis._slideShowWindowProxy,\n\t\t\t);\n\t\t\tthis._map.fire('presentinwindowclose');\n\t\t\tthis._slideShowWindowProxy = null;\n\t\t}\n\t\t// enable present in console on closeSlideShowWindow\n\t\tthis._enablePresenterConsole(false);\n\t\tthis._map.uiManager.closeSnackbar();\n\t\tthis._map.focus();\n\t}\n\n\t_doFallbackPresentation() {\n\t\tthis._stopFullScreen();\n\t\tthis._doInWindowPresentation();\n\t}\n\n\t_getProxyDocumentNode() {\n\t\treturn this._slideShowWindowProxy.contentWindow.document;\n\t}\n\n\t_doInWindowPresentation() {\n\t\tconst popupTitle =\n\t\t\t_('Windowed Presentation: ') + this._map['wopi'].BaseFileName;\n\t\tconst htmlContent = this._generateSlideWindowHtml(popupTitle);\n\n\t\tthis._slideShowWindowProxy = L.DomUtil.createWithId(\n\t\t\t'iframe',\n\t\t\t'slideshow-cypress-iframe',\n\t\t\tdocument.body,\n\t\t);\n\t\tthis._getProxyDocumentNode().open();\n\t\tthis._getProxyDocumentNode().write(htmlContent);\n\n\t\tif (!this._slideShowWindowProxy) {\n\t\t\tthis._notifyBlockedPresenting();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._slideShowWindowProxy.focus();\n\n\t\t// set body styles\n\t\tthis._getProxyDocumentNode().body.style.margin = '0';\n\t\tthis._getProxyDocumentNode().body.style.padding = '0';\n\t\tthis._getProxyDocumentNode().body.style.height = '100%';\n\t\tthis._getProxyDocumentNode().body.style.overflow = 'hidden';\n\n\t\tconst body = this._getProxyDocumentNode().querySelector('#root-in-window');\n\t\tthis._presenterContainer = this._createPresenterHTML(\n\t\t\tbody,\n\t\t\twindow.screen.width,\n\t\t\twindow.screen.height,\n\t\t);\n\t\tthis._slideShowCanvas.focus();\n\n\t\twindow.addEventListener('resize', this.onSlideWindowResize.bind(this));\n\t\tthis._getProxyDocumentNode().addEventListener(\n\t\t\t'keydown',\n\t\t\tthis._onKeyDownHandler,\n\t\t);\n\t\tthis._slideShowWindowProxy.addEventListener(\n\t\t\t'unload',\n\t\t\tL.bind(this._closeSlideShowWindow, this),\n\t\t);\n\t\tconst slideShowWindow = this._slideShowWindowProxy;\n\t\tthis._map.uiManager.showSnackbar(\n\t\t\t_('Presenting in window'),\n\t\t\t_('Close Presentation'),\n\t\t\tL.bind(this._closeSlideShowWindow, this),\n\t\t\t-1,\n\t\t\tfalse,\n\t\t\ttrue,\n\t\t);\n\n\t\tthis._windowCloseInterval = setInterval(\n\t\t\tfunction () {\n\t\t\t\tif (!slideShowWindow.isConnected) this.slideshowWindowCleanUp();\n\t\t\t}.bind(this),\n\t\t\t500,\n\t\t);\n\n\t\twindow.addEventListener(\n\t\t\t'beforeunload',\n\t\t\tthis.slideshowWindowCleanUp.bind(this),\n\t\t);\n\t}\n\n\tslideshowWindowCleanUp() {\n\t\tclearInterval(this._windowCloseInterval);\n\t\tthis._slideShowNavigator.quit();\n\t\tthis._map.uiManager.closeSnackbar();\n\t\tthis._slideShowCanvas = null;\n\t\tthis._presenterContainer = null;\n\t\tthis._slideShowWindowProxy = null;\n\t\twindow.removeEventListener('resize', this.onSlideWindowResize.bind(this));\n\t\twindow.removeEventListener(\n\t\t\t'beforeunload',\n\t\t\tthis.slideshowWindowCleanUp.bind(this),\n\t\t);\n\t}\n\n\t_onImpressModeChangedImpl(e: any, inWindow: boolean) {\n\t\tif (this._onImpressModeChanged && e.mode === 0) {\n\t\t\tthis._map.off('impressmodechanged', this._onImpressModeChanged, this);\n\t\t\tthis._onImpressModeChanged = null;\n\t\t\tconst startSlide = {\n\t\t\t\tstartSlideNumber: this._startSlide,\n\t\t\t};\n\t\t\tconst startSlideshow = inWindow ? this._onStartInWindow : this._onStart;\n\t\t\tsetTimeout(startSlideshow.bind(this, startSlide), 500);\n\t\t}\n\t}\n\n\t/// returns true on success\n\t_onPrepareScreen(inWindow: boolean) {\n\t\tif (this._checkPresentationDisabled()) {\n\t\t\tthis._notifyPresentationDisabled();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._checkAlreadyPresenting()) {\n\t\t\tthis._notifyAlreadyPresenting();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (app.impress.notesMode) {\n\t\t\tconsole.debug(\n\t\t\t\t'SlideShowPresenter._onPrepareScreen: notes mode is enabled, exiting',\n\t\t\t);\n\t\t\t// exit notes view mode and wait for status update notification\n\t\t\t// so we're sure that impress mode is changed\n\t\t\t// finally skip next partsupdate event,\n\t\t\t// since it's only due to the mode change\n\t\t\tthis._skipNextSlideShowInfoChangedMsg = true;\n\t\t\tthis._onImpressModeChanged = function (e: any) {\n\t\t\t\tthis._onImpressModeChangedImpl(e, inWindow);\n\t\t\t};\n\t\t\tthis._map.on('impressmodechanged', this._onImpressModeChanged, this);\n\t\t\tapp.map.sendUnoCommand('.uno:NormalMultiPaneGUI');\n\t\t\treturn false;\n\t\t}\n\n\t\tif (app.impress.areAllSlidesHidden()) {\n\t\t\tthis._notifyAllSlidesHidden();\n\t\t\treturn false;\n\t\t}\n\n\t\t// if we're playing a video, it'll continue *under* the presentation if we aren't careful\n\t\t// that's not a problem for visuals, but the audio of the video will also play\n\t\t// we don't currently need to do this for <audio> elements, since as we just use <video> tags for that anyway\n\t\tconst videos = document.getElementsByTagName('video');\n\t\tfor (const video of Array.from(videos)) {\n\t\t\tvideo.pause();\n\t\t}\n\n\t\tif (!this._map['wopi'].DownloadAsPostMessage) {\n\t\t\tif (inWindow) {\n\t\t\t\tthis._doInWindowPresentation();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// fullscreen\n\t\t\tthis._presenterContainer = this._createPresenterHTML(\n\t\t\t\tthis._map._container,\n\t\t\t\twindow.screen.width,\n\t\t\t\twindow.screen.height,\n\t\t\t);\n\t\t\tif (this._presenterContainer.requestFullscreen) {\n\t\t\t\tthis._presenterContainer\n\t\t\t\t\t.requestFullscreen()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t// success\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tthis._doFallbackPresentation();\n\t\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tthis._doFallbackPresentation();\n\t\treturn true;\n\t}\n\n\tonSlideWindowResize() {\n\t\tthis.centerCanvas();\n\t}\n\n\t_checkAlreadyPresenting() {\n\t\tif (this._slideShowCanvas) return true;\n\t\treturn false;\n\t}\n\n\t_notifyAllSlidesHidden() {\n\t\tthis._map.uiManager.showInfoModal(\n\t\t\t'allslidehidden-modal',\n\t\t\t_('Empty Slide Show'),\n\t\t\t'All slides are hidden!',\n\t\t\t'',\n\t\t\t_('OK'),\n\t\t\t() => {\n\t\t\t\t0;\n\t\t\t},\n\t\t\tfalse,\n\t\t\t'allslidehidden-modal-response',\n\t\t);\n\t}\n\n\t_notifyAlreadyPresenting() {\n\t\tthis._map.uiManager.showInfoModal(\n\t\t\t'already-presenting-modal',\n\t\t\t_('Already presenting'),\n\t\t\t_('You are already presenting this document'),\n\t\t\t'',\n\t\t\t_('OK'),\n\t\t\tnull,\n\t\t\tfalse,\n\t\t);\n\t}\n\n\t_notifyBlockedPresenting() {\n\t\tthis._enablePresenterConsole(false);\n\t\tthis._map.uiManager.showInfoModal(\n\t\t\t'popup-blocked-modal',\n\t\t\t_('Windowed Presentation Blocked'),\n\t\t\t_(\n\t\t\t\t'Presentation was blocked. Please allow pop-ups in your browser. This lets slide shows to be displayed in separated windows, allowing for easy screen sharing.',\n\t\t\t),\n\t\t\t'',\n\t\t\t_('OK'),\n\t\t\tnull,\n\t\t\tfalse,\n\t\t);\n\t}\n\n\t_enablePresenterConsole(state: boolean) {\n\t\tthis._map.fire('commandstatechanged', {\n\t\t\tcommandName: 'presenterconsole',\n\t\t\tdisabled: state,\n\t\t});\n\t}\n\n\t_checkPresentationDisabled() {\n\t\treturn this._map['wopi'].DisablePresentation;\n\t}\n\n\t_notifyPresentationDisabled() {\n\t\tthis._map.uiManager.showInfoModal(\n\t\t\t'presentation-disabled-modal',\n\t\t\t_('Presentation disabled'),\n\t\t\t_('Presentation mode has been disabled for this document'),\n\t\t\t'',\n\t\t\t_('OK'),\n\t\t\tnull,\n\t\t\tfalse,\n\t\t);\n\t}\n\n\t/// called when user triggers the presentation using UI\n\t_onStart(that: any) {\n\t\tthis._startSlide = that?.startSlideNumber ?? 0;\n\t\tif (!this._onPrepareScreen(false))\n\t\t\t// opens full screen, has to be on user interaction\n\t\t\treturn;\n\t\t// disable slide sorter or it will receive key events\n\t\tthis._map._docLayer._preview.partsFocused = false;\n\t\tthis._startingPresentation = true;\n\t\tapp.socket.sendMessage('getpresentationinfo');\n\t}\n\n\t/// called when user triggers the in-window presentation using UI\n\t_onStartInWindow(that: any) {\n\t\tthis._startSlide = that?.startSlideNumber ?? 0;\n\t\tif (!this._onPrepareScreen(true))\n\t\t\t// opens full screen, has to be on user interaction\n\t\t\treturn;\n\t\t// disable present in console onStartInWindow\n\t\tthis._enablePresenterConsole(true);\n\t\tthis._startingPresentation = true;\n\t\tapp.socket.sendMessage('getpresentationinfo');\n\t}\n\n\t/// called as a response on getpresentationinfo\n\tonSlideShowInfo(data: PresentationInfo) {\n\t\tconsole.debug('SlideShow: received information about presentation');\n\t\tthis._presentationInfo = data;\n\n\t\tconst numberOfSlides = this._getSlidesCount();\n\t\tif (numberOfSlides === 0) return;\n\n\t\tif (!this.getCanvas()) {\n\t\t\tconsole.debug('onSlideShowInfo: no canvas available');\n\t\t\treturn;\n\t\t}\n\n\t\tlet skipTransition = false;\n\n\t\tif (!this._metaPresentation) {\n\t\t\tthis._metaPresentation = new MetaPresentation(\n\t\t\t\tdata,\n\t\t\t\tthis._slideShowHandler,\n\t\t\t\tthis._slideShowNavigator,\n\t\t\t);\n\t\t\tthis._slideShowHandler.setMetaPresentation(this._metaPresentation);\n\t\t\tthis._slideShowNavigator.setMetaPresentation(this._metaPresentation);\n\t\t} else {\n\t\t\t// don't allow user interaction\n\t\t\tthis._slideShowNavigator.disable();\n\t\t\tconst currentSlideHash = this._metaPresentation.getCurrentSlideHash();\n\t\t\tif (this._presentationInfoChanged || currentSlideHash) {\n\t\t\t\t// presentation is changed and presentation info has been updated\n\t\t\t\tthis._presentationInfoChanged = false;\n\t\t\t\t// clean\n\t\t\t\tif (currentSlideHash)\n\t\t\t\t\tthis._slideCompositor.pauseVideos(currentSlideHash);\n\t\t\t\tthis._slideShowHandler.skipAllEffects();\n\t\t\t\tthis._slideShowHandler.cleanLeavingSlideStatus(\n\t\t\t\t\tthis._slideShowNavigator.currentSlideIndex,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\n\t\t\t\tthis._metaPresentation.update(data);\n\t\t\t\t// try to restore previously displayed slide\n\t\t\t\tconst slideInfo = this._metaPresentation.getSlideInfo(currentSlideHash);\n\t\t\t\tthis._startSlide = slideInfo ? slideInfo.indexInSlideShow : 0;\n\t\t\t\tskipTransition = true;\n\t\t\t} else {\n\t\t\t\t// slideshow has been started again\n\t\t\t\tthis._metaPresentation.update(data);\n\t\t\t}\n\t\t}\n\n\t\tif (!this._slideCompositor) {\n\t\t\tthis._slideCompositor = new SlideShow.LayersCompositor(\n\t\t\t\tthis,\n\t\t\t\tthis._metaPresentation,\n\t\t\t);\n\t\t}\n\n\t\tthis._slideCompositor.onUpdatePresentationInfo();\n\t\tconst canvasSize = this._slideCompositor.getCanvasSize();\n\t\tthis._slideShowCanvas.width = canvasSize[0];\n\t\tthis._slideShowCanvas.height = canvasSize[1];\n\t\tthis.centerCanvas();\n\n\t\t// animated elements needs to update canvas size\n\t\tthis._metaPresentation.getMetaSlides().forEach((metaSlide) => {\n\t\t\tif (metaSlide.animationsHandler) {\n\t\t\t\tconst animElemMap = metaSlide.animationsHandler.getAnimatedElementMap();\n\t\t\t\tanimElemMap.forEach((animatedElement) => {\n\t\t\t\t\tanimatedElement.updateCanvasSize(canvasSize);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.startLoader();\n\n\t\t// allow user interaction\n\t\tthis._slideShowNavigator.enable();\n\n\t\tthis._slideShowNavigator.startPresentation(\n\t\t\tthis._startSlide,\n\t\t\tskipTransition,\n\t\t);\n\t}\n\n\tonSlideShowInfoChanged() {\n\t\tif (this._presentationInfoChanged) return;\n\t\tif (this._skipNextSlideShowInfoChangedMsg) {\n\t\t\tthis._skipNextSlideShowInfoChangedMsg = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._presentationInfoChanged = true;\n\t\tapp.socket.sendMessage('getpresentationinfo');\n\t}\n}\n\nSlideShow.SlideShowPresenter = SlideShowPresenter;\n"]}