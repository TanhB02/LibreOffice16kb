{"version":3,"file":"BaseNode.js","sourceRoot":"","sources":["../../../../../../../../../../../../TanhX/online/browser/src/slideshow/engine/animationnodes/BaseNode.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- tab-width: 4 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nenum NodeState {\n\tInvalid = 0,\n\tUnresolved = 1,\n\tResolved = 2,\n\tActive = 4,\n\tFrozen = 8,\n\tEnded = 16,\n}\n\nenum FillModes {\n\tDefault = 0,\n\tInherit = 0,\n\tRemove,\n\tFreeze,\n\tHold,\n\tTransition,\n\tAuto,\n}\n\nenum RestartMode {\n\tDefault = 0,\n\tInherit = 0,\n\tAlways,\n\tWhenNotActive,\n\tNever,\n}\n\nenum ImpressNodeType {\n\tDefault,\n\tOnClick,\n\tWithPrevious,\n\tAfterPrevious,\n\tMainSequence,\n\tTimingRoot,\n\tInteractiveSequence,\n}\n\nenum TransitionMode {\n\tout,\n\tin,\n}\n\nenum AdditiveMode {\n\tUnknown,\n\tBase,\n\tReplace,\n\tMultiply,\n\tNone,\n}\n\nenum AccumulateMode {\n\tNone,\n\tSum,\n}\n\nenum CalcMode {\n\tDiscrete = 1,\n\tLinear,\n\tPaced,\n\tSpline,\n}\n\nfunction createStateTransitionTable() {\n\tconst aSTT: Map<\n\t\tRestartMode,\n\t\tMap<FillModes, Map<NodeState, number>>\n\t> = new Map();\n\n\taSTT.set(RestartMode.Never, new Map());\n\taSTT.set(RestartMode.WhenNotActive, new Map());\n\taSTT.set(RestartMode.Always, new Map());\n\n\t// transition table for restart=NEVER, fill=REMOVE\n\tconst aTable0 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[NodeState.Active, NodeState.Ended],\n\t\t[NodeState.Frozen, NodeState.Invalid], // this state is unreachable here\n\t\t[NodeState.Ended, NodeState.Ended], // this state is a sink here (cannot restart)\n\t]);\n\taSTT.get(RestartMode.Never).set(FillModes.Remove, aTable0);\n\n\t// transition table for restart=NEVER, fill=FREEZE, HOLD, TRANSITION\n\tconst aTable1 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[NodeState.Active, NodeState.Frozen | NodeState.Ended],\n\t\t[NodeState.Frozen, NodeState.Ended],\n\t\t[NodeState.Ended, NodeState.Ended], // this state is a sink here (cannot restart)\n\t]);\n\n\taSTT.get(RestartMode.Never).set(FillModes.Freeze, aTable1);\n\taSTT.get(RestartMode.Never).set(FillModes.Hold, aTable1);\n\taSTT.get(RestartMode.Never).set(FillModes.Transition, aTable1);\n\n\t// transition table for restart=WHEN_NOT_ACTIVE, fill=REMOVE\n\tconst aTable2 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[NodeState.Active, NodeState.Ended],\n\t\t[NodeState.Frozen, NodeState.Invalid], // this state is unreachable here\n\t\t[NodeState.Ended, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t]);\n\taSTT.get(RestartMode.WhenNotActive).set(FillModes.Remove, aTable2);\n\n\t// transition table for restart=WHEN_NOT_ACTIVE, fill=FREEZE, HOLD, TRANSITION\n\tconst aTable3 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[NodeState.Active, NodeState.Frozen | NodeState.Ended],\n\t\t[NodeState.Frozen, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t\t[NodeState.Ended, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t]);\n\taSTT.get(RestartMode.WhenNotActive).set(FillModes.Freeze, aTable3);\n\taSTT.get(RestartMode.WhenNotActive).set(FillModes.Hold, aTable3);\n\taSTT.get(RestartMode.WhenNotActive).set(FillModes.Transition, aTable3);\n\n\t// transition table for restart=ALWAYS, fill=REMOVE\n\tconst aTable4 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[NodeState.Active, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t\t[NodeState.Frozen, NodeState.Invalid], // this state is unreachable here\n\t\t[NodeState.Ended, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t]);\n\taSTT.get(RestartMode.Always).set(FillModes.Remove, aTable4);\n\n\t// transition table for restart=ALWAYS, fill=FREEZE, HOLD, TRANSITION\n\tconst aTable5 = new Map([\n\t\t[NodeState.Invalid, NodeState.Invalid],\n\t\t[NodeState.Unresolved, NodeState.Resolved | NodeState.Ended],\n\t\t[NodeState.Resolved, NodeState.Active | NodeState.Ended],\n\t\t[\n\t\t\tNodeState.Active,\n\t\t\tNodeState.Resolved |\n\t\t\t\tNodeState.Active |\n\t\t\t\tNodeState.Frozen |\n\t\t\t\tNodeState.Ended,\n\t\t],\n\t\t[NodeState.Frozen, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t\t[NodeState.Ended, NodeState.Resolved | NodeState.Active | NodeState.Ended], // restart is possible\n\t]);\n\taSTT.get(RestartMode.Always).set(FillModes.Freeze, aTable5);\n\taSTT.get(RestartMode.Always).set(FillModes.Hold, aTable5);\n\taSTT.get(RestartMode.Always).set(FillModes.Transition, aTable5);\n\n\treturn aSTT;\n}\n\nconst aStateTransitionTable = createStateTransitionTable();\n\nfunction getTransitionTable(eRestartMode: RestartMode, eFillMode: FillModes) {\n\t// If restart mode has not been resolved we use 'never'.\n\t// Note: RestartMode.Default == RestartMode.Inherit.\n\tif (eRestartMode == RestartMode.Default) {\n\t\twindow.app.console.log(\n\t\t\t'getTransitionTable: unexpected restart mode: ' +\n\t\t\t\teRestartMode +\n\t\t\t\t'. Used NEVER instead.',\n\t\t);\n\t\teRestartMode = RestartMode.Never;\n\t}\n\n\t// If fill mode has not been resolved we use 'remove'.\n\t// Note: FillModes.Default == FillModes.Inherit.\n\tif (eFillMode == FillModes.Default || eFillMode == FillModes.Auto) {\n\t\teFillMode = FillModes.Remove;\n\t}\n\n\treturn aStateTransitionTable.get(eRestartMode).get(eFillMode);\n}\n\nclass StateTransition {\n\tprivate aNode: BaseNode;\n\tprivate eToState: NodeState;\n\n\tconstructor(aBaseNode: BaseNode) {\n\t\tthis.aNode = aBaseNode;\n\t\tthis.eToState = NodeState.Invalid;\n\t}\n\n\tpublic enter(eNodeState: NodeState, bForce?: boolean) {\n\t\tif (!bForce) bForce = false;\n\n\t\tif (this.eToState != NodeState.Invalid) {\n\t\t\twindow.app.console.log(\n\t\t\t\t'StateTransition.enter: commit() before enter()ing again!',\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\t\tif (!bForce && !this.aNode.isTransition(this.aNode.getState(), eNodeState))\n\t\t\treturn false;\n\n\t\t// recursion detection:\n\t\tif ((this.aNode.nCurrentStateTransition & eNodeState) != 0) return false; // already in wanted transition\n\n\t\t// mark transition:\n\t\tthis.aNode.nCurrentStateTransition |= eNodeState;\n\t\tthis.eToState = eNodeState;\n\t\treturn true;\n\t}\n\n\tpublic commit() {\n\t\tif (this.eToState != NodeState.Invalid) {\n\t\t\tthis.aNode.setState(this.eToState);\n\t\t\tthis.clear();\n\t\t}\n\t}\n\n\tpublic clear() {\n\t\tif (this.eToState != NodeState.Invalid) {\n\t\t\tthis.aNode.nCurrentStateTransition &= ~this.eToState;\n\t\t\tthis.eToState = NodeState.Invalid;\n\t\t}\n\t}\n}\n\nabstract class BaseNode {\n\tprivate static CURR_UNIQUE_ID = 0;\n\tprivate readonly nId: number;\n\n\tprotected sClassName = 'BaseNode';\n\tpublic readonly eAnimationNodeType: AnimationNodeType;\n\tprotected bIsContainer: boolean;\n\tprotected bIsFirstAutoEffect: boolean = false;\n\tprotected readonly aNodeInfo: AnimationNodeInfo;\n\tprotected readonly aParentNode: BaseContainerNode;\n\tprotected readonly aNodeContext: NodeContext;\n\tprotected aContext: SlideShowContext;\n\tprivate nStartDelay: number;\n\tprotected eCurrentState: NodeState;\n\tpublic nCurrentStateTransition: number;\n\tprivate aDeactivatingListenerArray: BaseNode[];\n\tprivate aActivationEvent: DelayEvent;\n\tprivate aDeactivationEvent: DelayEvent;\n\n\tprivate aBegin: Timing;\n\tprivate aEnd: Timing;\n\tprivate aDuration: Duration;\n\tprotected bIsMainSequenceRootNode: boolean = false;\n\tprotected bIsInteractiveSequenceRootNode: boolean = false;\n\tprivate eFillMode: FillModes;\n\tprivate eRestartMode: RestartMode;\n\tprivate nRepeatCount: number;\n\tprivate nAccelerate: number;\n\tprivate nDecelerate: number;\n\tprivate bAutoReverse: boolean;\n\n\tprivate aAnimationNodeMap: AnimationNodeMap;\n\tprivate aStateTransTable: Map<NodeState, number>;\n\n\tprotected constructor(\n\t\taNodeInfo: AnimationNodeInfo,\n\t\taParentNode: BaseContainerNode,\n\t\taNodeContext: NodeContext,\n\t) {\n\t\tthis.nId = BaseNode.getUniqueId();\n\n\t\tif (!aNodeInfo)\n\t\t\twindow.app.console.log(\n\t\t\t\t'BaseNode(id:' + this.nId + ') constructor: aNodeInfo is not valid',\n\t\t\t);\n\n\t\tif (!aNodeContext)\n\t\t\twindow.app.console.log(\n\t\t\t\t'BaseNode(id:' + this.nId + ') constructor: aNodeContext is not valid',\n\t\t\t);\n\n\t\tif (!aNodeContext.aContext)\n\t\t\twindow.app.console.log(\n\t\t\t\t'BaseNode(id:' +\n\t\t\t\t\tthis.nId +\n\t\t\t\t\t') constructor: aNodeContext.aContext is not valid',\n\t\t\t);\n\n\t\tthis.eAnimationNodeType = getAnimationNodeType(aNodeInfo);\n\n\t\tthis.bIsContainer = false;\n\t\tthis.aNodeInfo = aNodeInfo;\n\t\tthis.aParentNode = aParentNode;\n\t\tthis.aNodeContext = aNodeContext;\n\t\tthis.aContext = aNodeContext.aContext;\n\t\tthis.nStartDelay = aNodeContext.nStartDelay;\n\t\tthis.eCurrentState = NodeState.Unresolved;\n\t\tthis.nCurrentStateTransition = 0;\n\t\tthis.aDeactivatingListenerArray = [];\n\t\tthis.aActivationEvent = null;\n\t\tthis.aDeactivationEvent = null;\n\n\t\tthis.aBegin = null;\n\t\tthis.aDuration = null;\n\t\tthis.aEnd = null;\n\t\tthis.eFillMode = FillModes.Freeze;\n\t\tthis.eRestartMode = RestartMode.Never;\n\t\tthis.nRepeatCount = undefined;\n\t\tthis.nAccelerate = 0.0;\n\t\tthis.nDecelerate = 0.0;\n\t\tthis.bAutoReverse = false;\n\t}\n\n\tprivate static getUniqueId() {\n\t\t++BaseNode.CURR_UNIQUE_ID;\n\t\treturn BaseNode.CURR_UNIQUE_ID;\n\t}\n\n\tgetId() {\n\t\treturn this.nId;\n\t}\n\n\tpublic parseNodeInfo() {\n\t\tif (this.aNodeInfo.id)\n\t\t\tthis.aNodeContext.aAnimationNodeMap.set(this.aNodeInfo.id, this);\n\n\t\tthis.aBegin = new Timing(this, this.aNodeInfo.begin);\n\t\tthis.aBegin.parse();\n\n\t\tthis.aEnd = null;\n\t\tif (this.aNodeInfo.end) {\n\t\t\tthis.aEnd = new Timing(this, this.aNodeInfo.end);\n\t\t\tthis.aEnd.parse();\n\t\t}\n\n\t\tthis.aDuration = new Duration(this.aNodeInfo.dur);\n\t\tif (!this.aDuration.isSet()) {\n\t\t\tif (this.isContainer()) this.aDuration = null;\n\t\t\telse this.aDuration = new Duration('indefinite');\n\t\t}\n\n\t\tif (this.aNodeInfo.fill && this.aNodeInfo.fill in FillModes) {\n\t\t\tconst sFill = this.aNodeInfo.fill as keyof typeof FillModes;\n\t\t\tthis.eFillMode = FillModes[sFill];\n\t\t} else {\n\t\t\tthis.eFillMode = FillModes.Default;\n\t\t}\n\n\t\tif (this.aNodeInfo.restart && this.aNodeInfo.restart in RestartMode) {\n\t\t\tconst sRestart = this.aNodeInfo.restart as keyof typeof RestartMode;\n\t\t\tthis.eRestartMode = RestartMode[sRestart];\n\t\t} else {\n\t\t\tthis.eRestartMode = RestartMode.Default;\n\t\t}\n\n\t\tthis.nRepeatCount = 1;\n\t\tif (this.aNodeInfo.repeatCount)\n\t\t\tthis.nRepeatCount = parseFloat(this.aNodeInfo.repeatCount);\n\t\tif (isNaN(this.nRepeatCount) && this.aNodeInfo.repeatCount !== 'indefinite')\n\t\t\tthis.nRepeatCount = 1;\n\n\t\tthis.nAccelerate = 0.0;\n\t\tconst sAccelerate = this.aNodeInfo.accelerate;\n\t\tif (sAccelerate) this.nAccelerate = parseFloat(sAccelerate);\n\t\tif (isNaN(this.nAccelerate)) this.nAccelerate = 0.0;\n\n\t\tthis.nDecelerate = 0.0;\n\t\tconst sDecelerate = this.aNodeInfo.decelerate;\n\t\tif (sDecelerate) this.nDecelerate = parseFloat(sDecelerate);\n\t\tif (isNaN(this.nDecelerate)) this.nDecelerate = 0.0;\n\n\t\tthis.bAutoReverse = false;\n\t\tconst sAutoReverse = this.aNodeInfo.autoreverse;\n\t\tif (sAutoReverse == 'true') this.bAutoReverse = true;\n\n\t\t// resolve fill value\n\t\tif (this.eFillMode === FillModes.Default) {\n\t\t\tif (this.getParentNode())\n\t\t\t\tthis.eFillMode = this.getParentNode().getFillMode();\n\t\t\telse this.eFillMode = FillModes.Auto;\n\t\t}\n\n\t\tif (this.eFillMode === FillModes.Auto) {\n\t\t\t// see SMIL recommendation document\n\t\t\tthis.eFillMode =\n\t\t\t\tthis.aEnd ||\n\t\t\t\tthis.nRepeatCount != 1 ||\n\t\t\t\t(this.aDuration && !this.aDuration.isIndefinite())\n\t\t\t\t\t? FillModes.Remove\n\t\t\t\t\t: FillModes.Freeze;\n\t\t}\n\n\t\t// resolve restart value\n\t\tif (this.eRestartMode === RestartMode.Default) {\n\t\t\tif (this.getParentNode())\n\t\t\t\tthis.eRestartMode = this.getParentNode().getRestartMode();\n\t\t\t// SMIL recommendation document says to set it to 'always'\n\t\t\telse this.eRestartMode = RestartMode.Always;\n\t\t}\n\n\t\t// resolve accelerate and decelerate attributes\n\t\t// from the SMIL recommendation document: if the individual values of the accelerate\n\t\t// and decelerate attributes are between 0 and 1 and the sum is greater than 1,\n\t\t// then both the accelerate and decelerate attributes will be ignored and the timed\n\t\t// element will behave as if neither attribute was specified.\n\t\tif (this.nAccelerate + this.nDecelerate > 1.0) {\n\t\t\tthis.nAccelerate = 0.0;\n\t\t\tthis.nDecelerate = 0.0;\n\t\t}\n\n\t\tthis.aStateTransTable = getTransitionTable(\n\t\t\tthis.getRestartMode(),\n\t\t\tthis.getFillMode(),\n\t\t);\n\t}\n\n\tpublic getParentNode(): BaseContainerNode {\n\t\treturn this.aParentNode;\n\t}\n\n\tpublic init(): boolean {\n\t\tthis.DBG(this.callInfo('init'));\n\t\tif (!this.checkValidNode()) return false;\n\t\tif (this.aActivationEvent) this.aActivationEvent.dispose();\n\t\tif (this.aDeactivationEvent) this.aDeactivationEvent.dispose();\n\n\t\tthis.eCurrentState = NodeState.Unresolved;\n\n\t\treturn this.init_st();\n\t}\n\n\tpublic resolve() {\n\t\tif (this.aNodeContext.bIsInvalid || !this.checkValidNode()) return false;\n\n\t\tthis.DBG(this.callInfo('resolve'));\n\n\t\tif (this.eCurrentState == NodeState.Resolved)\n\t\t\twindow.app.console.log('BaseNode.resolve: already in RESOLVED state');\n\n\t\tconst aStateTrans = new StateTransition(this);\n\n\t\tif (\n\t\t\taStateTrans.enter(NodeState.Resolved) &&\n\t\t\tthis.isTransition(NodeState.Resolved, NodeState.Active) &&\n\t\t\tthis.resolve_st()\n\t\t) {\n\t\t\taStateTrans.commit();\n\n\t\t\tif (this.aActivationEvent) {\n\t\t\t\tthis.aActivationEvent.charge();\n\t\t\t} else {\n\t\t\t\tthis.aActivationEvent = makeDelay(\n\t\t\t\t\tthis.activate.bind(this),\n\t\t\t\t\tthis.getBegin().getOffset() + this.nStartDelay,\n\t\t\t\t);\n\t\t\t}\n\t\t\tregisterEvent(\n\t\t\t\tthis.getId(),\n\t\t\t\tthis.aNodeContext.aContext.aSlideShowHandler,\n\t\t\t\tthis.getBegin(),\n\t\t\t\tthis.aActivationEvent,\n\t\t\t\tthis.aNodeContext,\n\t\t\t);\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic activate() {\n\t\tif (!this.checkValidNode()) return false;\n\n\t\tif (this.eCurrentState === NodeState.Active)\n\t\t\twindow.app.console.log('BaseNode.activate: already in ACTIVE state');\n\n\t\tthis.DBG(this.callInfo('activate'), getCurrentSystemTime());\n\n\t\tconst aStateTrans = new StateTransition(this);\n\n\t\tif (aStateTrans.enter(NodeState.Active)) {\n\t\t\tthis.activate_st();\n\t\t\taStateTrans.commit();\n\n\t\t\tif (this.bIsFirstAutoEffect)\n\t\t\t\tthis.aNodeContext.aContext.aSlideShowHandler.notifyFirstAutoEffectStarted();\n\t\t\tif (!this.aContext.aEventMultiplexer)\n\t\t\t\twindow.app.console.log(\n\t\t\t\t\t'BaseNode.activate: this.aContext.aEventMultiplexer is not valid',\n\t\t\t\t);\n\t\t\tthis.aContext.aEventMultiplexer.notifyEvent(\n\t\t\t\tEventTrigger.BeginEvent,\n\t\t\t\tthis.getId(),\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic deactivate() {\n\t\tif (\n\t\t\tthis.inStateOrTransition(NodeState.Ended | NodeState.Frozen) ||\n\t\t\t!this.checkValidNode()\n\t\t)\n\t\t\treturn;\n\n\t\tif (this.isTransition(this.eCurrentState, NodeState.Frozen)) {\n\t\t\tthis.DBG(this.callInfo('deactivate'), getCurrentSystemTime());\n\n\t\t\tconst aStateTrans = new StateTransition(this);\n\t\t\tif (aStateTrans.enter(NodeState.Frozen, true /* FORCE */)) {\n\t\t\t\tthis.deactivate_st(NodeState.Frozen);\n\t\t\t\taStateTrans.commit();\n\n\t\t\t\tthis.notifyEndListeners();\n\t\t\t\tif (this.bIsFirstAutoEffect)\n\t\t\t\t\tthis.aNodeContext.aContext.aSlideShowHandler.notifyFirstAutoEffectEnded();\n\n\t\t\t\tif (this.aActivationEvent) this.aActivationEvent.dispose();\n\t\t\t\tif (this.aDeactivationEvent) this.aDeactivationEvent.dispose();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.end();\n\t\t}\n\t\t// state has changed either to FROZEN or ENDED\n\t}\n\n\tpublic end() {\n\t\tconst bIsFrozenOrInTransitionToFrozen = this.inStateOrTransition(\n\t\t\tNodeState.Frozen,\n\t\t);\n\t\tif (this.inStateOrTransition(NodeState.Ended) || !this.checkValidNode())\n\t\t\treturn;\n\n\t\tif (!this.isTransition(this.eCurrentState, NodeState.Ended))\n\t\t\twindow.app.console.log(\n\t\t\t\t'BaseNode.end: end state not reachable in transition table',\n\t\t\t);\n\n\t\tthis.DBG(this.callInfo('end'), getCurrentSystemTime());\n\n\t\tconst aStateTrans = new StateTransition(this);\n\t\tif (aStateTrans.enter(NodeState.Ended, true /* FORCE */)) {\n\t\t\tthis.deactivate_st(NodeState.Ended);\n\t\t\taStateTrans.commit();\n\n\t\t\t// if is FROZEN or is to be FROZEN, then\n\t\t\t// will/already notified deactivating listeners\n\t\t\tif (!bIsFrozenOrInTransitionToFrozen) this.notifyEndListeners();\n\t\t\tif (this.bIsFirstAutoEffect)\n\t\t\t\tthis.aNodeContext.aContext.aSlideShowHandler.notifyFirstAutoEffectEnded();\n\n\t\t\tif (this.aActivationEvent) this.aActivationEvent.dispose();\n\t\t\tif (this.aDeactivationEvent) this.aDeactivationEvent.dispose();\n\t\t}\n\t}\n\n\tpublic dispose() {\n\t\tif (this.aActivationEvent) this.aActivationEvent.dispose();\n\t\tif (this.aDeactivationEvent) this.aDeactivationEvent.dispose();\n\t\tthis.aDeactivatingListenerArray = [];\n\t}\n\n\tpublic getState() {\n\t\treturn this.eCurrentState;\n\t}\n\n\tpublic setState(nodeState: NodeState) {\n\t\tthis.eCurrentState = nodeState;\n\t}\n\n\tpublic registerDeactivatingListener(aNotifiee: BaseNode) {\n\t\tif (!this.checkValidNode()) return false;\n\n\t\tif (!aNotifiee) {\n\t\t\twindow.app.console.log(\n\t\t\t\t'BaseNode.registerDeactivatingListener(): invalid notifiee',\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\t\tthis.aDeactivatingListenerArray.push(aNotifiee);\n\n\t\treturn true;\n\t}\n\n\tpublic notifyDeactivating(aNotifier: BaseNode) {\n\t\tassert(\n\t\t\taNotifier.getState() === NodeState.Frozen ||\n\t\t\t\taNotifier.getState() === NodeState.Ended,\n\t\t\t'BaseNode.notifyDeactivating: Notifier node is neither in FROZEN nor in ENDED state',\n\t\t);\n\t}\n\n\tpublic isContainer(): boolean {\n\t\treturn this.bIsContainer;\n\t}\n\n\tpublic isMainSequenceRootNode(): boolean {\n\t\treturn this.bIsMainSequenceRootNode;\n\t}\n\n\tpublic isInteractiveSequenceRootNode(): boolean {\n\t\treturn this.bIsInteractiveSequenceRootNode;\n\t}\n\n\tpublic makeDeactivationEvent(nDelay: number): EventBase {\n\t\tif (this.aDeactivationEvent) {\n\t\t\tthis.aDeactivationEvent.charge();\n\t\t} else if (typeof nDelay == typeof 0) {\n\t\t\tthis.aDeactivationEvent = makeDelay(this.deactivate.bind(this), nDelay);\n\t\t} else {\n\t\t\tthis.aDeactivationEvent = null;\n\t\t}\n\t\treturn this.aDeactivationEvent;\n\t}\n\n\tpublic scheduleDeactivationEvent(aEvent?: EventBase) {\n\t\tthis.DBG(this.callInfo('scheduleDeactivationEvent'));\n\n\t\tif (!aEvent) {\n\t\t\tif (this.getDuration() && this.getDuration().isValue())\n\t\t\t\taEvent = this.makeDeactivationEvent(this.getDuration().getValue());\n\t\t}\n\t\tif (aEvent) {\n\t\t\tthis.aContext.aTimerEventQueue.addEvent(aEvent);\n\t\t}\n\t}\n\n\tpublic checkValidNode() {\n\t\treturn this.eCurrentState !== NodeState.Invalid;\n\t}\n\n\tprotected init_st() {\n\t\treturn true;\n\t}\n\n\tprotected resolve_st() {\n\t\treturn true;\n\t}\n\n\tprotected activate_st() {\n\t\tthis.scheduleDeactivationEvent();\n\t}\n\n\tprotected deactivate_st(aNodeState?: NodeState) {\n\t\t// empty body\n\t}\n\n\tpublic notifyEndListeners() {\n\t\tconst nDeactivatingListenerCount = this.aDeactivatingListenerArray.length;\n\n\t\tfor (let i = 0; i < nDeactivatingListenerCount; ++i) {\n\t\t\tthis.aDeactivatingListenerArray[i].notifyDeactivating(this);\n\t\t}\n\n\t\tthis.aContext.aEventMultiplexer.notifyEvent(\n\t\t\tEventTrigger.EndEvent,\n\t\t\tthis.getId(),\n\t\t);\n\t\tif (this.getParentNode() && this.getParentNode().isMainSequenceRootNode())\n\t\t\tthis.aContext.aEventMultiplexer.notifyNextEffectEndEvent();\n\n\t\tif (this.isMainSequenceRootNode())\n\t\t\tthis.aContext.aEventMultiplexer.notifyAnimationsEndEvent();\n\t}\n\n\tpublic getContext() {\n\t\treturn this.aContext;\n\t}\n\n\tpublic isTransition(eFromState: NodeState, eToState: NodeState) {\n\t\treturn (this.aStateTransTable.get(eFromState) & eToState) !== 0;\n\t}\n\n\tpublic inStateOrTransition(nMask: number) {\n\t\treturn (\n\t\t\t(this.eCurrentState & nMask) != 0 ||\n\t\t\t(this.nCurrentStateTransition & nMask) != 0\n\t\t);\n\t}\n\n\tpublic getBegin(): Timing {\n\t\treturn this.aBegin;\n\t}\n\n\tpublic getEnd(): Timing {\n\t\treturn this.aEnd;\n\t}\n\n\tpublic getDuration(): Duration {\n\t\treturn this.aDuration;\n\t}\n\n\tpublic getFillMode() {\n\t\treturn this.eFillMode;\n\t}\n\n\tpublic getRestartMode() {\n\t\treturn this.eRestartMode;\n\t}\n\n\tpublic getRepeatCount() {\n\t\treturn this.nRepeatCount;\n\t}\n\n\tpublic getAccelerateValue() {\n\t\treturn this.nAccelerate;\n\t}\n\n\tpublic getDecelerateValue() {\n\t\treturn this.nDecelerate;\n\t}\n\n\tpublic isAutoReverseEnabled() {\n\t\treturn this.bAutoReverse;\n\t}\n\n\tpublic info(bVerbose: boolean = false) {\n\t\tlet sInfo = `${this.sClassName}(${this.aNodeInfo.nodeName}, ${this.getId()}, ${NodeState[this.getState()]})`;\n\n\t\tif (bVerbose) {\n\t\t\t// is container\n\t\t\tsInfo += ';  is container: ' + this.isContainer();\n\n\t\t\t// begin\n\t\t\tif (this.getBegin()) {\n\t\t\t\tif (this.getBegin().getEventType() === EventTrigger.OnNext)\n\t\t\t\t\t// on click starts the next effect\n\t\t\t\t\tsInfo += ';  \\x1B[31mbegin: ' + this.getBegin().info() + '\\x1B[m';\n\t\t\t\telse sInfo += ';  begin: ' + this.getBegin().info();\n\t\t\t}\n\n\t\t\t// duration\n\t\t\tif (this.getDuration()) sInfo += ';  dur: ' + this.getDuration().info();\n\n\t\t\t// end\n\t\t\tif (this.getEnd()) sInfo += ';  end: ' + this.getEnd().info();\n\n\t\t\t// fill mode\n\t\t\tif (this.getFillMode())\n\t\t\t\tsInfo += ';  fill: ' + FillModes[this.getFillMode()];\n\n\t\t\t// restart mode\n\t\t\tif (this.getRestartMode())\n\t\t\t\tsInfo += ';  restart: ' + RestartMode[this.getRestartMode()];\n\n\t\t\t// repeatCount\n\t\t\tif (this.getRepeatCount() && this.getRepeatCount() != 1.0)\n\t\t\t\tsInfo += ';  repeatCount: ' + this.getRepeatCount();\n\n\t\t\t// preset id (effect type)\n\t\t\tif (this.aNodeInfo.presetId)\n\t\t\t\tsInfo += `; \\x1B[31mpresetId: ${this.aNodeInfo.presetId}\\x1B[m`;\n\n\t\t\t// preset subType\n\t\t\tif (this.aNodeInfo.presetSubType)\n\t\t\t\tsInfo += `; presetSubType: ${this.aNodeInfo.presetSubType}`;\n\n\t\t\t// accelerate\n\t\t\tif (this.getAccelerateValue())\n\t\t\t\tsInfo += ';  accelerate: ' + this.getAccelerateValue();\n\n\t\t\t// decelerate\n\t\t\tif (this.getDecelerateValue())\n\t\t\t\tsInfo += ';  decelerate: ' + this.getDecelerateValue();\n\n\t\t\t// auto reverse\n\t\t\tif (this.isAutoReverseEnabled()) sInfo += ';  autoReverse: true';\n\t\t}\n\n\t\treturn sInfo;\n\t}\n\n\tcallInfo(sMethodName: string) {\n\t\tconst sInfo =\n\t\t\tthis.sClassName +\n\t\t\t'( ' +\n\t\t\tthis.getId() +\n\t\t\t', ' +\n\t\t\tNodeState[this.getState()] +\n\t\t\t' ).' +\n\t\t\tsMethodName;\n\t\treturn sInfo;\n\t}\n\n\tDBG(sMessage: string, nTime?: number) {\n\t\tANIMDBG.print(sMessage, nTime);\n\t}\n\n\tpublic abstract hasPendingAnimation(): boolean;\n\tpublic abstract removeEffect(): void;\n\tpublic abstract saveStateOfAnimatedElement(): void;\n}\n"]}