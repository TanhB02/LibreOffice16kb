{"version":3,"file":"AnimationColorNode.js","sourceRoot":"","sources":["../../../../../../../../../../../../TanhX/online/browser/src/slideshow/engine/animationnodes/AnimationColorNode.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- tab-width: 4 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nenum ColorSpace {\n\trgb,\n\thsl,\n}\n\nenum ClockDirection {\n\tclockwise,\n\tcounterClockwise,\n}\n\nclass AnimationColorNode extends AnimationBaseNode3 {\n\tprivate eColorInterpolation: ColorSpace;\n\tprivate eColorInterpolationDirection: ClockDirection;\n\n\tconstructor(\n\t\taNodeInfo: AnimationNodeInfo,\n\t\taParentNode: BaseContainerNode,\n\t\taNodeContext: NodeContext,\n\t) {\n\t\tsuper(aNodeInfo, aParentNode, aNodeContext);\n\t\tthis.sClassName = 'AnimationColorNode';\n\t}\n\n\tpublic parseNodeInfo() {\n\t\tsuper.parseNodeInfo();\n\n\t\tconst aNodeInfo = this.aNodeInfo as AnimateColorNodeInfo;\n\n\t\tthis.eColorInterpolation = ColorSpace.rgb;\n\t\tif (\n\t\t\taNodeInfo.colorInterpolation &&\n\t\t\taNodeInfo.colorInterpolation in ColorSpace\n\t\t) {\n\t\t\tconst sColorInterpolation =\n\t\t\t\taNodeInfo.colorInterpolation as keyof typeof ColorSpace;\n\t\t\tthis.eColorInterpolation = ColorSpace[sColorInterpolation];\n\t\t}\n\n\t\tthis.eColorInterpolationDirection = ClockDirection.clockwise;\n\t\tif (\n\t\t\taNodeInfo.colorInterpolationDirection &&\n\t\t\taNodeInfo.colorInterpolationDirection in ClockDirection\n\t\t) {\n\t\t\tconst sColorInterpolationDir =\n\t\t\t\taNodeInfo.colorInterpolationDirection as keyof typeof ClockDirection;\n\t\t\tthis.eColorInterpolationDirection =\n\t\t\t\tClockDirection[sColorInterpolationDir];\n\t\t}\n\t}\n\n\tpublic createActivity(): AnimationActivity {\n\t\tconst aActivityParamSet = this.fillActivityParams();\n\n\t\t// initialize object dim color\n\t\tif (\n\t\t\tthis.getAnimatedElement() &&\n\t\t\tthis.getToValue() &&\n\t\t\tthis.getAttributeName() === 'dimcolor'\n\t\t) {\n\t\t\tthis.getAnimatedElement().setDefaultDimColor(\n\t\t\t\tcolorParser(this.getToValue()) as RGBColor,\n\t\t\t);\n\t\t}\n\n\t\tconst aAnimation = createPropertyAnimation(\n\t\t\tthis.getAttributeName(),\n\t\t\tthis.getAnimatedElement(),\n\t\t\tthis.aNodeContext.aContext.nSlideWidth,\n\t\t\tthis.aNodeContext.aContext.nSlideHeight,\n\t\t);\n\n\t\tlet aColorAnimation: AnimationBase;\n\t\tlet aInterpolator;\n\t\tif (this.getColorInterpolation() === ColorSpace.hsl) {\n\t\t\tANIMDBG.print('AnimationColorNode.createActivity: color space hsl');\n\t\t\taColorAnimation = new HSLAnimationWrapper(aAnimation);\n\t\t\taInterpolator = PropertyInterpolator.getInterpolator(\n\t\t\t\tPropertyValueType.Color,\n\t\t\t\tColorSpace.hsl,\n\t\t\t\tthis.getColorInterpolationDirection(),\n\t\t\t);\n\t\t} else {\n\t\t\tANIMDBG.print('AnimationColorNode.createActivity: color space rgb');\n\t\t\taColorAnimation = aAnimation;\n\t\t\taInterpolator = PropertyInterpolator.getInterpolator(\n\t\t\t\tPropertyValueType.Color,\n\t\t\t\tColorSpace.rgb,\n\t\t\t);\n\t\t}\n\n\t\treturn createActivity(\n\t\t\taActivityParamSet,\n\t\t\tthis,\n\t\t\taColorAnimation,\n\t\t\taInterpolator,\n\t\t);\n\t}\n\n\tpublic getColorInterpolation() {\n\t\treturn this.eColorInterpolation;\n\t}\n\n\tpublic getColorInterpolationDirection() {\n\t\treturn this.eColorInterpolationDirection;\n\t}\n\n\tpublic info(bVerbose: boolean = false) {\n\t\tlet sInfo = super.info.call(this, bVerbose);\n\n\t\tif (bVerbose) {\n\t\t\t// color interpolation\n\t\t\tsInfo +=\n\t\t\t\t';  color-interpolation: ' + ColorSpace[this.getColorInterpolation()];\n\n\t\t\t// color interpolation direction\n\t\t\tsInfo +=\n\t\t\t\t';  color-interpolation-direction: ' +\n\t\t\t\tClockDirection[this.getColorInterpolationDirection()];\n\t\t}\n\t\treturn sInfo;\n\t}\n}\n"]}