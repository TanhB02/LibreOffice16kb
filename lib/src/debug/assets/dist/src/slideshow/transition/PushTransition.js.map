{"version":3,"file":"PushTransition.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/transition/PushTransition.ts"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;;;;;;AAchC,IAAK,WAKJ;AALD,WAAK,WAAW;IACf,yDAAU,CAAA;IACV,qDAAQ,CAAA;IACR,uDAAS,CAAA;IACT,mDAAO,CAAA;AACR,CAAC,EALI,WAAW,KAAX,WAAW,QAKf;AAED;IAA6B,kCAAY;IAGxC,wBAAY,oBAA0C;QAAtD,YACC,kBAAM,oBAAoB,CAAC,SAC3B;QAJO,eAAS,GAAW,CAAC,CAAC;;IAI9B,CAAC;IAEM,8BAAK,GAAZ;QACC,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,CAAC;QAEtE,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,EAAE;YACnD,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,OAAO,CAAC;SACrC;aAAM,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,SAAS,EAAE;YAC5D,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,SAAS,CAAC;SACvC;aAAM,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,QAAQ,EAAE;YAC3D,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,QAAQ,CAAC;SACtC;aAAM;YACN,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,UAAU,CAAC;SACxC;QACD,IAAI,CAAC,eAAe,EAAE,CAAC;IACxB,CAAC;IAED,qBAAqB;IACd,2CAAkB,GAAzB;QACC,IAAI,CAAC,EAAE,CAAC,SAAS,CAChB,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC,EACrD,IAAI,CAAC,SAAS,CACd,CAAC;IACH,CAAC;IAEM,0CAAiB,GAAxB;QACC,OAAO,m7DA6CQ,CAAC;IACjB,CAAC;IAEF,qBAAC;AAAD,CAAC,AA/ED,CAA6B,YAAY,GA+ExC;AAED,SAAS,CAAC,cAAc,GAAG,cAAc,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var SlideShow: any;\n\nenum PushSubType {\n\tFROMBOTTOM,\n\tFROMLEFT,\n\tFROMRIGHT,\n\tFROMTOP,\n}\n\nclass PushTransition extends Transition2d {\n\tprivate direction: number = 0;\n\n\tconstructor(transitionParameters: TransitionParameters) {\n\t\tsuper(transitionParameters);\n\t}\n\n\tpublic start(): void {\n\t\tconst transitionSubType = this.transitionFilterInfo.transitionSubtype;\n\n\t\tif (transitionSubType == TransitionSubType.FROMTOP) {\n\t\t\tthis.direction = PushSubType.FROMTOP;\n\t\t} else if (transitionSubType == TransitionSubType.FROMRIGHT) {\n\t\t\tthis.direction = PushSubType.FROMRIGHT;\n\t\t} else if (transitionSubType == TransitionSubType.FROMLEFT) {\n\t\t\tthis.direction = PushSubType.FROMLEFT;\n\t\t} else {\n\t\t\tthis.direction = PushSubType.FROMBOTTOM;\n\t\t}\n\t\tthis.startTransition();\n\t}\n\n\t// jscpd:ignore-start\n\tpublic renderUniformValue(): void {\n\t\tthis.gl.uniform1i(\n\t\t\tthis.gl.getUniformLocation(this.program, 'direction'),\n\t\t\tthis.direction,\n\t\t);\n\t}\n\n\tpublic getFragmentShader(): string {\n\t\treturn `#version 300 es\n                precision mediump float;\n\n                uniform sampler2D leavingSlideTexture;\n                uniform sampler2D enteringSlideTexture;\n                uniform float time;\n                uniform int direction;\n\n                in vec2 v_texCoord;\n                out vec4 outColor;\n\n                void main() {\n                    vec2 uv = v_texCoord;\n                    float progress = time;\n\n                    vec2 leavingUV = uv;\n                    vec2 enteringUV = uv;\n\n                    if (direction == 0) {\n                        // bottom to top\n                        leavingUV = uv + vec2(0.0, progress);\n                        enteringUV = uv + vec2(0.0, -1.0 + progress);\n                    } else if (direction == 1) {\n                        // left to right\n                        leavingUV = uv + vec2(-progress, 0.0);\n                        enteringUV = uv + vec2(1.0 - progress, 0.0);\n                    } else if (direction == 2) {\n                        // right to left\n                        leavingUV = uv + vec2(progress, 0.0);\n                        enteringUV = uv + vec2(-1.0 + progress, 0.0);\n                    } else if (direction == 3) {\n                        // top to bottom\n                        leavingUV = uv + vec2(0.0, -progress);\n                        enteringUV = uv + vec2(0.0, 1.0 - progress);\n                    }\n\n                    if ((direction == 0 && uv.y > 1.0 - progress) ||\n                        (direction == 1 && uv.x < progress) ||\n                        (direction == 2 && uv.x > 1.0 - progress) ||\n                        (direction == 3 && uv.y < progress)) {\n                        outColor = texture(enteringSlideTexture, enteringUV);\n                    } else {\n                        outColor = texture(leavingSlideTexture, leavingUV);\n                    }\n                }\n                `;\n\t}\n\t// jscpd:ignore-end\n}\n\nSlideShow.PushTransition = PushTransition;\n"]}