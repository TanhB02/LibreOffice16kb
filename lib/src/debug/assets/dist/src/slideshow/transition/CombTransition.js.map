{"version":3,"file":"CombTransition.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/transition/CombTransition.ts"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;;;;;;AAchC,IAAK,WAGJ;AAHD,WAAK,WAAW;IACf,iEAAc,CAAA;IACd,6DAAY,CAAA;AACb,CAAC,EAHI,WAAW,KAAX,WAAW,QAGf;AAED;IAA6B,kCAAY;IAGxC,wBAAY,oBAA0C;QAAtD,YACC,kBAAM,oBAAoB,CAAC,SAC3B;QAJO,eAAS,GAAW,CAAC,CAAC;;IAI9B,CAAC;IACS,kDAAyB,GAAnC;QACC,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,CAAC;QAEtE,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,YAAY,EAAE;YACxD,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,YAAY,CAAC;SAC1C;aAAM;YACN,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,cAAc,CAAC;SAC5C;IACF,CAAC;IAED,qBAAqB;IACd,0CAAiB,GAAxB;QACC,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,IAAI,WAAW,CAAC,YAAY,CAAC;QAC9D,kBAAkB;QAClB,OAAO,+dAe2B,UAAU,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,cAAc,sUAStD,UAAU,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,cAAc,sCAC5C,UAAU,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,oBAAoB,4GAIvD,UAAU,CAAC,CAAC;YACR,kDAAkD,CAAC,CAAC;YACpD,kDAAkD,wKAKrD,UAAU,CAAC,CAAC;YACR,kDAAkD,CAAC,CAAC;YACpD,kDAAkD,iIAIhE,CAAC;IAClB,CAAC;IAEF,qBAAC;AAAD,CAAC,AAjED,CAA6B,YAAY,GAiExC;AAED,SAAS,CAAC,cAAc,GAAG,cAAc,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var SlideShow: any;\n\nenum CombSubType {\n\tCOMBHORIZONTAL,\n\tCOMBVERTICAL,\n}\n\nclass CombTransition extends Transition2d {\n\tprivate direction: number = 0;\n\n\tconstructor(transitionParameters: TransitionParameters) {\n\t\tsuper(transitionParameters);\n\t}\n\tprotected initProgramTemplateParams() {\n\t\tconst transitionSubType = this.transitionFilterInfo.transitionSubtype;\n\n\t\tif (transitionSubType == TransitionSubType.COMBVERTICAL) {\n\t\t\tthis.direction = CombSubType.COMBVERTICAL;\n\t\t} else {\n\t\t\tthis.direction = CombSubType.COMBHORIZONTAL;\n\t\t}\n\t}\n\n\t// jscpd:ignore-start\n\tpublic getFragmentShader(): string {\n\t\tconst isVertical = this.direction == CombSubType.COMBVERTICAL;\n\t\t// prettier-ignore\n\t\treturn `#version 300 es\n                precision mediump float;\n\n                uniform sampler2D leavingSlideTexture;\n                uniform sampler2D enteringSlideTexture;\n                uniform float time;\n\n                in vec2 v_texCoord;\n                out vec4 outColor;\n\n                void main() {\n                    const float numTeeth = 20.0;\n\n                    float progress = smoothstep(0.0, 1.0, time);\n\n                    float coord = ${isVertical ? 'v_texCoord.x' : 'v_texCoord.y'};\n\n                    float toothIndex = floor(coord * numTeeth);\n\n                    float moveDirection = mod(toothIndex, 2.0) == 0.0 ? 1.0 : -1.0;\n\n                    float offset = moveDirection * (1.0 - progress);\n\n                    float threshold = moveDirection > 0.0 ?\n                        ${isVertical ? 'v_texCoord.y' : 'v_texCoord.x'} :\n                        ${isVertical ? '1.0 - v_texCoord.y' : '1.0 - v_texCoord.x'};\n\n                    if (threshold < progress) {\n                       vec2 enteringCoord = ${\n                           isVertical ?\n                               'vec2(v_texCoord.x, fract(v_texCoord.y + offset))' :\n                               'vec2(fract(v_texCoord.x + offset), v_texCoord.y)'\n                       };\n                       outColor = texture(enteringSlideTexture, enteringCoord);\n                    } else {\n                        vec2 leavingCoord = ${\n                            isVertical ?\n                                'vec2(v_texCoord.x, fract(v_texCoord.y + offset))' :\n                                'vec2(fract(v_texCoord.x + offset), v_texCoord.y)'\n                        };\n                        outColor = texture(leavingSlideTexture, leavingCoord);\n                    }\n                }`;\n\t}\n\t// jscpd:ignore-end\n}\n\nSlideShow.CombTransition = CombTransition;\n"]}