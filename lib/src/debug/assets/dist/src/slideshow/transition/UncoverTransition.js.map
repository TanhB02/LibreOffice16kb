{"version":3,"file":"UncoverTransition.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/transition/UncoverTransition.ts"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;;;;;;AAchC,IAAK,cAKJ;AALD,WAAK,cAAc;IAClB,yDAAO,CAAA;IACP,6DAAS,CAAA;IACT,2DAAQ,CAAA;IACR,+DAAU,CAAA;AACX,CAAC,EALI,cAAc,KAAd,cAAc,QAKlB;AAED;IAAgC,qCAAY;IAG3C,2BAAY,oBAA0C;QAAtD,YACC,kBAAM,oBAAoB,CAAC,SAC3B;QAJO,eAAS,GAAW,CAAC,CAAC;;IAI9B,CAAC;IAEM,iCAAK,GAAZ;QACC,IAAM,iBAAiB,GAAG,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,CAAC;QAEtE,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,EAAE;YACnD,IAAI,CAAC,SAAS,GAAG,cAAc,CAAC,OAAO,CAAC;SACxC;aAAM,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,QAAQ,EAAE;YAC3D,IAAI,CAAC,SAAS,GAAG,cAAc,CAAC,QAAQ,CAAC;SACzC;aAAM,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,SAAS,EAAE;YAC5D,IAAI,CAAC,SAAS,GAAG,cAAc,CAAC,SAAS,CAAC;SAC1C;aAAM;YACN,IAAI,CAAC,SAAS,GAAG,cAAc,CAAC,UAAU,CAAC;SAC3C;QAED,IAAI,CAAC,eAAe,EAAE,CAAC;IACxB,CAAC;IAEM,8CAAkB,GAAzB;QACC,IAAI,CAAC,EAAE,CAAC,SAAS,CAChB,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC,EACrD,IAAI,CAAC,SAAS,CACd,CAAC;IACH,CAAC;IAED,qBAAqB;IACd,6CAAiB,GAAxB;QACC,OAAO,2qDAmDJ,CAAC;IACL,CAAC;IAEF,wBAAC;AAAD,CAAC,AAtFD,CAAgC,YAAY,GAsF3C;AAED,SAAS,CAAC,iBAAiB,GAAG,iBAAiB,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var SlideShow: any;\n\nenum UncoverSubType {\n\tFROMTOP,\n\tFROMRIGHT,\n\tFROMLEFT,\n\tFROMBOTTOM,\n}\n\nclass UncoverTransition extends Transition2d {\n\tprivate direction: number = 0;\n\n\tconstructor(transitionParameters: TransitionParameters) {\n\t\tsuper(transitionParameters);\n\t}\n\n\tpublic start(): void {\n\t\tconst transitionSubType = this.transitionFilterInfo.transitionSubtype;\n\n\t\tif (transitionSubType == TransitionSubType.FROMTOP) {\n\t\t\tthis.direction = UncoverSubType.FROMTOP;\n\t\t} else if (transitionSubType == TransitionSubType.FROMLEFT) {\n\t\t\tthis.direction = UncoverSubType.FROMLEFT;\n\t\t} else if (transitionSubType == TransitionSubType.FROMRIGHT) {\n\t\t\tthis.direction = UncoverSubType.FROMRIGHT;\n\t\t} else {\n\t\t\tthis.direction = UncoverSubType.FROMBOTTOM;\n\t\t}\n\n\t\tthis.startTransition();\n\t}\n\n\tpublic renderUniformValue(): void {\n\t\tthis.gl.uniform1i(\n\t\t\tthis.gl.getUniformLocation(this.program, 'direction'),\n\t\t\tthis.direction,\n\t\t);\n\t}\n\n\t// jscpd:ignore-start\n\tpublic getFragmentShader(): string {\n\t\treturn `#version 300 es\n\t\t\t\tprecision mediump float;\n\n\t\t\t\tuniform sampler2D leavingSlideTexture;\n\t\t\t\tuniform sampler2D enteringSlideTexture;\n\t\t\t\tuniform float time;\n\t\t\t\tuniform int direction;\n\n\t\t\t\tin vec2 v_texCoord;\n\t\t\t\tout vec4 outColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 uv = v_texCoord;\n\t\t\t\t\tfloat progress = time;\n\n\t\t\t\t\tvec2 leavingUV = uv;\n\t\t\t\t\tvec2 enteringUV = uv;\n\n\t\t\t\t\tif (direction == 0) {\n\t\t\t\t\t\tleavingUV = uv + vec2(0.0, -progress);\n\t\t\t\t\t} else if (direction == 1) {\n\t\t\t\t\t\tleavingUV = uv + vec2(progress, 0.0);\n\t\t\t\t\t} else if (direction == 2) {\n\t\t\t\t\t\tleavingUV = uv + vec2(-progress, 0.0);\n\t\t\t\t\t} else if (direction == 3) {\n\t\t\t\t\t\tleavingUV = uv + vec2(0.0, progress);\n\t\t\t\t\t}\n\t\t\t\t\telse if (direction == 4) {\n\t\t\t\t\t\t// TODO: Meed to fix this bug, top right to bottom left\n\t\t\t\t\t\tleavingUV = uv + vec2(progress, -progress);\n\t\t\t\t\t}\n\n\t\t\t\t\tbool showEntering = false;\n\t\t\t\t\tif (direction == 0) {\n\t\t\t\t\t\tshowEntering = uv.y < progress;\n\t\t\t\t\t} else if (direction == 1) {\n\t\t\t\t\t\tshowEntering = uv.x > 1.0 - progress;\n\t\t\t\t\t} else if (direction == 2) {\n\t\t\t\t\t\tshowEntering = uv.x < progress;\n\t\t\t\t\t} else if (direction == 3) {\n\t\t\t\t\t\tshowEntering = uv.y > 1.0 - progress;\n\t\t\t\t\t} else if (direction == 4) {\n\t\t\t\t\t\tshowEntering = uv.x > 1.0 - progress && uv.y < progress;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (showEntering) {\n\t\t\t\t\t\toutColor = texture(enteringSlideTexture, enteringUV);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutColor = texture(leavingSlideTexture, leavingUV);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t`;\n\t}\n\t// jscpd:ignore-end\n}\n\nSlideShow.UncoverTransition = UncoverTransition;\n"]}