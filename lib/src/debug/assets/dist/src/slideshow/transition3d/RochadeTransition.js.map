{"version":3,"file":"RochadeTransition.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/transition3d/RochadeTransition.ts"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var SlideShow: any;\n\nclass RochadeTransitionImp extends SimpleTransition {\n\tconstructor(transitionParameters: TransitionParameters3D) {\n\t\tsuper(transitionParameters);\n\t}\n\n\t// TODO - remove code duplication\n\t/* jscpd:ignore-start */\n\tpublic displaySlides_(t: number): void {\n\t\tthis.applyAllOperation(t);\n\n\t\tif (t < 0.5) {\n\t\t\tthis.displayPrimitive(\n\t\t\t\tt,\n\t\t\t\tthis.gl.TEXTURE0,\n\t\t\t\t1,\n\t\t\t\tthis.enteringPrimitives,\n\t\t\t\t'slideTexture',\n\t\t\t);\n\t\t\tthis.displayPrimitive(\n\t\t\t\tt,\n\t\t\t\tthis.gl.TEXTURE0,\n\t\t\t\t0,\n\t\t\t\tthis.leavingPrimitives,\n\t\t\t\t'slideTexture',\n\t\t\t);\n\t\t} else {\n\t\t\tthis.displayPrimitive(\n\t\t\t\tt,\n\t\t\t\tthis.gl.TEXTURE0,\n\t\t\t\t0,\n\t\t\t\tthis.leavingPrimitives,\n\t\t\t\t'slideTexture',\n\t\t\t);\n\t\t\tthis.displayPrimitive(\n\t\t\t\tt,\n\t\t\t\tthis.gl.TEXTURE0,\n\t\t\t\t1,\n\t\t\t\tthis.enteringPrimitives,\n\t\t\t\t'slideTexture',\n\t\t\t);\n\t\t}\n\t}\n\t/* jscpd:ignore-end */\n}\n\n// TODO - remove code duplication\n/* jscpd:ignore-start */\nfunction RochadeTransition(transitionParameters: TransitionParameters) {\n\tconst slide = new Primitive();\n\n\tconst w = 2.2;\n\tconst h = 10.0;\n\n\tslide.pushTriangle([0, 0], [1, 0], [0, 1]);\n\tslide.pushTriangle([1, 0], [0, 1], [1, 1]);\n\n\tslide.operations.push(makeSEllipseTranslate(w, h, 0.25, -0.25, true, 0, 1));\n\tslide.operations.push(\n\t\tmakeRotateAndScaleDepthByWidth(\n\t\t\tvec3.fromValues(0, 1, 0),\n\t\t\tvec3.fromValues(0, 0, 0),\n\t\t\t-45,\n\t\t\ttrue,\n\t\t\ttrue,\n\t\t\t0.0,\n\t\t\t1.0,\n\t\t),\n\t);\n\n\tconst aLeavingPrimitives: Primitive[] = [];\n\taLeavingPrimitives.push(Primitive.cloneDeep(slide));\n\n\tslide.operations.push(\n\t\tmakeSScale(\n\t\t\tvec3.fromValues(1.0, -1.0, 1.0),\n\t\t\tvec3.fromValues(0, -1.02, 0),\n\t\t\tfalse,\n\t\t\t-1,\n\t\t\t0,\n\t\t),\n\t);\n\taLeavingPrimitives.push(Primitive.cloneDeep(slide));\n\n\tslide.clear();\n\tslide.operations.push(\n\t\tmakeSEllipseTranslate(w, h, 0.75, 0.25, true, 0.0, 1.0),\n\t);\n\tslide.operations.push(\n\t\tmakeSTranslate(vec3.fromValues(0.0, 0.0, -h), false, -1.0, 0.0),\n\t);\n\tslide.operations.push(\n\t\tmakeRotateAndScaleDepthByWidth(\n\t\t\tvec3.fromValues(0.0, 1.0, 0.0),\n\t\t\tvec3.fromValues(0.0, 0.0, 0.0),\n\t\t\t-45.0,\n\t\t\ttrue,\n\t\t\ttrue,\n\t\t\t0.0,\n\t\t\t1.0,\n\t\t),\n\t);\n\tslide.operations.push(\n\t\tmakeRotateAndScaleDepthByWidth(\n\t\t\tvec3.fromValues(0.0, 1.0, 0.0),\n\t\t\tvec3.fromValues(0.0, 0.0, 0.0),\n\t\t\t45.0,\n\t\t\ttrue,\n\t\t\tfalse,\n\t\t\t-1.0,\n\t\t\t0.0,\n\t\t),\n\t);\n\tconst aEnteringPrimitives: Primitive[] = [Primitive.cloneDeep(slide)];\n\n\tslide.operations.push(\n\t\tmakeSScale(\n\t\t\tvec3.fromValues(1.0, -1.0, 1.0),\n\t\t\tvec3.fromValues(0, -1.02, 0),\n\t\t\tfalse,\n\t\t\t-1,\n\t\t\t0,\n\t\t),\n\t);\n\taEnteringPrimitives.push(Primitive.cloneDeep(slide));\n\n\t// Todo: Improve second view\n\tconst newTransitionParameters: TransitionParameters3D = {\n\t\t...transitionParameters,\n\t\tleavingPrimitives: aLeavingPrimitives,\n\t\tenteringPrimitives: aEnteringPrimitives,\n\t\tallOperations: [],\n\t};\n\n\treturn new RochadeTransitionImp(newTransitionParameters);\n}\n/* jscpd:ignore-end */\n\nSlideShow.RochadeTransition = RochadeTransition;\n"]}