{"version":3,"file":"Venetian3dTransition.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/transition3d/Venetian3dTransition.ts"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;;AAchC,SAAS,oBAAoB,CAC5B,oBAA0C,EAC1C,QAAiB,EACjB,KAAa;IAEb,IAAM,GAAG,GAAW,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;IAC5C,IAAI,EAAE,GAAG,CAAC,CAAC;IACX,IAAM,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC;IAEtB,IAAM,kBAAkB,GAAgB,EAAE,CAAC;IAC3C,IAAM,mBAAmB,GAAgB,EAAE,CAAC;IAC5C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE;QAC/B,IAAM,KAAK,GAAc,IAAI,SAAS,EAAE,CAAC;QACzC,IAAM,CAAC,GAAW,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC;QACpC,IAAI,CAAC,QAAQ,EAAE;YACd,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC7C,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC5C,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,+BAA+B,CAC9B,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC,EACxC,CAAC,GAAG,EACJ,IAAI,EACJ,IAAI,EACJ,GAAG,EACH,GAAG,CACH,CACD,CAAC;SACF;aAAM;YACN,KAAK,CAAC,YAAY,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;YAC7C,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC5C,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,8BAA8B,CAC7B,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC,EACxC,CAAC,GAAG,EACJ,IAAI,EACJ,IAAI,EACJ,GAAG,EACH,GAAG,CACH,CACD,CAAC;SACF;QACD,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;QAEpD,IAAI,CAAC,QAAQ,EAAE;YACd,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,WAAW,CACV,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,EAChC,CAAC,EAAE,EACH,KAAK,EACL,CAAC,CAAC,EACF,CAAC,CACD,CACD,CAAC;YACF,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,WAAW,CACV,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,EACjC,GAAG,EACH,KAAK,EACL,CAAC,CAAC,EACF,CAAC,CACD,CACD,CAAC;SACF;aAAM;YACN,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,WAAW,CACV,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAChC,CAAC,EAAE,EACH,KAAK,EACL,CAAC,CAAC,EACF,CAAC,CACD,CACD,CAAC;YACF,KAAK,CAAC,UAAU,CAAC,IAAI,CACpB,WAAW,CACV,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACxB,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACjC,GAAG,EACH,KAAK,EACL,CAAC,CAAC,EACF,CAAC,CACD,CACD,CAAC;SACF;QACD,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChC,EAAE,GAAG,CAAC,CAAC;KACP;IAED,IAAM,uBAAuB,yBACzB,oBAAoB,KACvB,iBAAiB,EAAE,kBAAkB,EACrC,kBAAkB,EAAE,mBAAmB,EACvC,aAAa,EAAE,EAAE,GACjB,CAAC;IAEF,OAAO,IAAI,gBAAgB,CAAC,uBAAuB,CAAC,CAAC;AACtD,CAAC;AAED,SAAS,CAAC,oBAAoB,GAAG,oBAAoB,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var SlideShow: any;\n\nfunction Venetian3dTransition(\n\ttransitionParameters: TransitionParameters,\n\tvertical: boolean,\n\tparts: number,\n) {\n\tconst t30: number = Math.tan(Math.PI / 6.0);\n\tlet ln = 0;\n\tconst p = 1.0 / parts;\n\n\tconst aLeavingPrimitives: Primitive[] = [];\n\tconst aEnteringPrimitives: Primitive[] = [];\n\tfor (let i = 0; i < parts; i++) {\n\t\tconst Slide: Primitive = new Primitive();\n\t\tconst n: number = (i + 1.0) / parts;\n\t\tif (!vertical) {\n\t\t\tSlide.pushTriangle([0, ln], [1, ln], [0, n]);\n\t\t\tSlide.pushTriangle([1, ln], [0, n], [1, n]);\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeRotateAndScaleDepthByHeight(\n\t\t\t\t\tvec3.fromValues(1, 0, 0),\n\t\t\t\t\tvec3.fromValues(0, 1 - n - ln, -t30 * p),\n\t\t\t\t\t-120,\n\t\t\t\t\ttrue,\n\t\t\t\t\ttrue,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0,\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tSlide.pushTriangle([ln, 0], [n, 0], [ln, 1]);\n\t\t\tSlide.pushTriangle([n, 0], [ln, 1], [n, 1]);\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeRotateAndScaleDepthByWidth(\n\t\t\t\t\tvec3.fromValues(0, 1, 0),\n\t\t\t\t\tvec3.fromValues(n + ln - 1, 0, -t30 * p),\n\t\t\t\t\t-120,\n\t\t\t\t\ttrue,\n\t\t\t\t\ttrue,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\taLeavingPrimitives.push(Primitive.cloneDeep(Slide));\n\n\t\tif (!vertical) {\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeSRotate(\n\t\t\t\t\tvec3.fromValues(1, 0, 0),\n\t\t\t\t\tvec3.fromValues(0, 1 - 2 * n, 0),\n\t\t\t\t\t-60,\n\t\t\t\t\tfalse,\n\t\t\t\t\t-1,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t);\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeSRotate(\n\t\t\t\t\tvec3.fromValues(1, 0, 0),\n\t\t\t\t\tvec3.fromValues(0, 1 - n - ln, 0),\n\t\t\t\t\t180,\n\t\t\t\t\tfalse,\n\t\t\t\t\t-1,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeSRotate(\n\t\t\t\t\tvec3.fromValues(0, 1, 0),\n\t\t\t\t\tvec3.fromValues(2 * n - 1, 0, 0),\n\t\t\t\t\t-60,\n\t\t\t\t\tfalse,\n\t\t\t\t\t-1,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t);\n\t\t\tSlide.operations.push(\n\t\t\t\tmakeSRotate(\n\t\t\t\t\tvec3.fromValues(0, 1, 0),\n\t\t\t\t\tvec3.fromValues(n + ln - 1, 0, 0),\n\t\t\t\t\t180,\n\t\t\t\t\tfalse,\n\t\t\t\t\t-1,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\taEnteringPrimitives.push(Slide);\n\t\tln = n;\n\t}\n\n\tconst newTransitionParameters: TransitionParameters3D = {\n\t\t...transitionParameters,\n\t\tleavingPrimitives: aLeavingPrimitives,\n\t\tenteringPrimitives: aEnteringPrimitives,\n\t\tallOperations: [],\n\t};\n\n\treturn new SimpleTransition(newTransitionParameters);\n}\n\nSlideShow.Venetian3dTransition = Venetian3dTransition;\n"]}