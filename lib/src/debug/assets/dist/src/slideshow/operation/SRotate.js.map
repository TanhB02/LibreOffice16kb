{"version":3,"file":"SRotate.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/operation/SRotate.ts"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var glMatrix: any;\ndeclare var SlideShow: any;\n\nvar { vec3, mat4 } = glMatrix;\n\nclass SRotate extends Operation {\n\tprivate axis: vec3 = vec3.create();\n\tprivate origin: vec3 = vec3.create();\n\tprivate angle: number = 0.0;\n\tprivate mbInterpolate: boolean = false;\n\tprivate mnT0: number = 0.0;\n\tprivate mnT1: number = 0.0;\n\n\t// TODO - remove code duplication\n\t/* jscpd:ignore-start */\n\tconstructor(\n\t\taxis: vec3,\n\t\torigin: vec3,\n\t\tangle: number,\n\t\tmbInterpolate: boolean,\n\t\tmnT0: number,\n\t\tmnT1: number,\n\t) {\n\t\tsuper();\n\t\tthis.axis = axis;\n\t\tthis.origin = origin;\n\t\tthis.angle = OpsHelper.deg2rad(angle);\n\t\tthis.mbInterpolate = mbInterpolate;\n\t\tthis.mnT0 = mnT0;\n\t\tthis.mnT1 = mnT1;\n\t}\n\n\tpublic interpolate(\n\t\tmatrix: mat4,\n\t\tt: number,\n\t\tSlideWidthScale: number,\n\t\tSlideHeightScale: number,\n\t): mat4 {\n\t\tif (t <= this.mnT0) return matrix;\n\n\t\tif (!this.mbInterpolate || t > this.mnT1) t = this.mnT1;\n\n\t\tt = OpsHelper.intervalInter(t, this.mnT0, this.mnT1);\n\n\t\tconst translationVector = vec3.fromValues(\n\t\t\tSlideWidthScale * this.origin[0],\n\t\t\tSlideHeightScale * this.origin[1],\n\t\t\tthis.origin[2],\n\t\t);\n\t\tconst scaleVector = vec3.fromValues(\n\t\t\tSlideWidthScale * SlideWidthScale,\n\t\t\tSlideHeightScale * SlideHeightScale,\n\t\t\t1,\n\t\t);\n\n\t\tmat4.translate(matrix, matrix, translationVector);\n\t\tmat4.scale(matrix, matrix, scaleVector);\n\t\tmat4.rotate(matrix, matrix, this.angle * t, this.axis);\n\t\tmat4.scale(\n\t\t\tmatrix,\n\t\t\tmatrix,\n\t\t\tvec3.fromValues(\n\t\t\t\t1 / scaleVector[0],\n\t\t\t\t1 / scaleVector[1],\n\t\t\t\t1 / scaleVector[2],\n\t\t\t),\n\t\t);\n\t\tmat4.translate(\n\t\t\tmatrix,\n\t\t\tmatrix,\n\t\t\tvec3.negate(vec3.create(), translationVector),\n\t\t);\n\n\t\treturn matrix;\n\t}\n\t/* jscpd:ignore-end */\n}\n\nfunction makeSRotate(\n\taxis: vec3,\n\torigin: vec3,\n\tangle: number,\n\tmbInterpolate: boolean,\n\tmnT0: number,\n\tmnT1: number,\n) {\n\treturn new SRotate(axis, origin, angle, mbInterpolate, mnT0, mnT1);\n}\n\nSlideShow.makeSRotate = makeSRotate;\n"]}