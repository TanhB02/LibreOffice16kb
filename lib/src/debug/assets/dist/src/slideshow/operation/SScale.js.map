{"version":3,"file":"SScale.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/slideshow/operation/SScale.ts"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;;;;;;;;AAe1B,IAAA,IAAI,GAAW,QAAQ,KAAnB,EAAE,IAAI,GAAK,QAAQ,KAAb,CAAc;AAE9B;IAAqB,0BAAS;IAO7B,gBACC,KAAW,EACX,MAAY,EACZ,aAAsB,EACtB,IAAY,EACZ,IAAY;QALb,YAOC,iBAAO,SAMP;QAnBO,WAAK,GAAS,IAAI,CAAC,MAAM,EAAE,CAAC;QAC5B,YAAM,GAAS,IAAI,CAAC,MAAM,EAAE,CAAC;QAC7B,mBAAa,GAAY,KAAK,CAAC;QAC/B,UAAI,GAAW,GAAG,CAAC;QACnB,UAAI,GAAW,GAAG,CAAC;QAU1B,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,KAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;;IAClB,CAAC;IACO,4BAAW,GAAnB,UAAoB,MAAY,EAAE,CAAS,EAAE,KAAW;QACvD,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAClC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,cAAc;QACjD,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,WAAW,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,wBAAwB;QAEnF,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACxC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,YAAY,EAAE,WAAW,CAAC,CAAC;QAEpD,OAAO,YAAY,CAAC;IACrB,CAAC;IAEM,4BAAW,GAAlB,UACC,MAAY,EACZ,CAAS,EACT,eAAuB,EACvB,gBAAwB;QAExB,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI;YAAE,OAAO,MAAM,CAAC;QAClC,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI;YAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC;QACxD,CAAC,GAAG,SAAS,CAAC,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAErD,IAAM,iBAAiB,GAAG,IAAI,CAAC,UAAU,CACxC,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAChC,gBAAgB,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EACjC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CACd,CAAC;QAEF,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE,iBAAiB,CAAC,CAAC;QAClD,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACjD,IAAI,CAAC,SAAS,CACb,MAAM,EACN,MAAM,EACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,iBAAiB,CAAC,CAC7C,CAAC;QACF,OAAO,MAAM,CAAC;IACf,CAAC;IACF,aAAC;AAAD,CAAC,AAzDD,CAAqB,SAAS,GAyD7B;AACD,SAAS,UAAU,CAClB,KAAW,EACX,MAAY,EACZ,aAAsB,EACtB,IAAY,EACZ,IAAY;IAEZ,OAAO,IAAI,MAAM,CAAC,KAAK,EAAE,MAAM,EAAE,aAAa,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AAC7D,CAAC;AAED,SAAS,CAAC,UAAU,GAAG,UAAU,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var glMatrix: any;\ndeclare var SlideShow: any;\n\nvar { vec3, mat4 } = glMatrix;\n\nclass SScale extends Operation {\n\tprivate scale: vec3 = vec3.create();\n\tprivate origin: vec3 = vec3.create();\n\tprivate mbInterpolate: boolean = false;\n\tprivate mnT0: number = 0.0;\n\tprivate mnT1: number = 0.0;\n\n\tconstructor(\n\t\tscale: vec3,\n\t\torigin: vec3,\n\t\tmbInterpolate: boolean,\n\t\tmnT0: number,\n\t\tmnT1: number,\n\t) {\n\t\tsuper();\n\t\tthis.scale = scale;\n\t\tthis.origin = origin;\n\t\tthis.mbInterpolate = mbInterpolate;\n\t\tthis.mnT0 = mnT0;\n\t\tthis.mnT1 = mnT1;\n\t}\n\tprivate scaleMatrix(matrix: mat4, t: number, scale: vec3): mat4 {\n\t\tconst scaleFactor = vec3.create();\n\t\tvec3.scale(scaleFactor, scale, t); // (t * scale)\n\t\tvec3.add(scaleFactor, scaleFactor, [1 - t, 1 - t, 1 - t]); // (1 - t) + (t * scale)\n\n\t\tconst scaledMatrix = mat4.clone(matrix);\n\t\tmat4.scale(scaledMatrix, scaledMatrix, scaleFactor);\n\n\t\treturn scaledMatrix;\n\t}\n\n\tpublic interpolate(\n\t\tmatrix: mat4,\n\t\tt: number,\n\t\tSlideWidthScale: number,\n\t\tSlideHeightScale: number,\n\t): mat4 {\n\t\tif (t <= this.mnT0) return matrix;\n\t\tif (!this.mbInterpolate || t > this.mnT1) t = this.mnT1;\n\t\tt = OpsHelper.intervalInter(t, this.mnT0, this.mnT1);\n\n\t\tconst translationVector = vec3.fromValues(\n\t\t\tSlideWidthScale * this.origin[0],\n\t\t\tSlideHeightScale * this.origin[1],\n\t\t\tthis.origin[2],\n\t\t);\n\n\t\tmat4.translate(matrix, matrix, translationVector);\n\t\tmatrix = this.scaleMatrix(matrix, t, this.scale);\n\t\tmat4.translate(\n\t\t\tmatrix,\n\t\t\tmatrix,\n\t\t\tvec3.negate(vec3.create(), translationVector),\n\t\t);\n\t\treturn matrix;\n\t}\n}\nfunction makeSScale(\n\tscale: vec3,\n\torigin: vec3,\n\tmbInterpolate: boolean,\n\tmnT0: number,\n\tmnT1: number,\n) {\n\treturn new SScale(scale, origin, mbInterpolate, mnT0, mnT1);\n}\n\nSlideShow.makeSScale = makeSScale;\n"]}