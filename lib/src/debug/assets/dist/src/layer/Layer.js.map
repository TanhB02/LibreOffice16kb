{"version":3,"file":"Layer.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/layer/Layer.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/* global app */\n\nL.Layer = L.Evented.extend({\n\n\toptions: {\n\t\tpane: 'overlayPane'\n\t},\n\n\tinitialize: function () {\n\t\tL.Evented.prototype.initialize.call(this);\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tremove: function () {\n\t\treturn this.removeFrom(this._map || this._mapToAdd);\n\t},\n\n\tremoveFrom: function (obj) {\n\t\tif (obj) {\n\t\t\tobj.removeLayer(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tgetPane: function (name) {\n\t\treturn this._map.getPane(name ? (this.options[name] || name) : this.options.pane);\n\t},\n\n\taddInteractiveTarget: function (targetEl) {\n\t\tthis._map._targets[app.util.stamp(targetEl)] = this;\n\t\treturn this;\n\t},\n\n\tremoveInteractiveTarget: function (targetEl) {\n\t\tdelete this._map._targets[app.util.stamp(targetEl)];\n\t\treturn this;\n\t},\n\n\t_layerAdd: function (e) {\n\t\tvar map = e.target;\n\n\t\t// check in case layer gets added and then removed before the map is ready\n\t\tif (!map.hasLayer(this)) { return; }\n\n\t\tthis._map = map;\n\t\tthis._zoomAnimated = map._zoomAnimated;\n\n\t\tthis.onAdd(map);\n\n\t\tif (this.getEvents) {\n\t\t\tmap.on(this.getEvents(), this);\n\t\t}\n\n\t\tthis.fire('add');\n\t\tmap.fire('layeradd', {layer: this});\n\t}\n});\n\n\nL.Map.include({\n\taddLayer: function (layer) {\n\t\tvar id = app.util.stamp(layer);\n\t\tif (this._layers[id]) { return layer; }\n\t\tthis._layers[id] = layer;\n\n\t\tlayer._mapToAdd = this;\n\n\t\tif (layer.beforeAdd) {\n\t\t\tlayer.beforeAdd(this);\n\t\t}\n\n\t\tthis.whenReady(layer._layerAdd, layer);\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer) {\n\t\tvar id = app.util.stamp(layer);\n\n\t\tif (!this._layers[id]) { return this; }\n\n\t\tif (this._loaded) {\n\t\t\tlayer.onRemove(this);\n\t\t}\n\n\t\tif (layer.getEvents) {\n\t\t\tthis.off(layer.getEvents(), layer);\n\t\t}\n\n\t\tdelete this._layers[id];\n\n\t\tif (this._loaded) {\n\t\t\tthis.fire('layerremove', {layer: layer});\n\t\t\tlayer.fire('remove');\n\t\t}\n\n\t\tlayer._map = layer._mapToAdd = null;\n\n\t\treturn this;\n\t},\n\n\thasLayer: function (layer) {\n\t\treturn !!layer && (app.util.stamp(layer) in this._layers);\n\t},\n\n\teachLayer: function (method, context) {\n\t\tfor (var i in this._layers) {\n\t\t\tmethod.call(context, this._layers[i]);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_addLayers: function (layers) {\n\t\tlayers = layers ? (app.util.isArray(layers) ? layers : [layers]) : [];\n\n\t\tfor (var i = 0, len = layers.length; i < len; i++) {\n\t\t\tthis.addLayer(layers[i]);\n\t\t}\n\t},\n\n\t_addZoomLimit: function (layer) {\n\t\tif (isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom)) {\n\t\t\tthis._zoomBoundLayers[app.util.stamp(layer)] = layer;\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\t},\n\n\t_removeZoomLimit: function (layer) {\n\t\tvar id = app.util.stamp(layer);\n\n\t\tif (this._zoomBoundLayers[id]) {\n\t\t\tdelete this._zoomBoundLayers[id];\n\t\t\tthis._updateZoomLevels();\n\t\t}\n\t},\n\n\t_updateZoomLevels: function () {\n\t\tvar minZoom = Infinity,\n\t\t    maxZoom = -Infinity,\n\t\t    oldZoomSpan = this._getZoomSpan();\n\n\t\tfor (var i in this._zoomBoundLayers) {\n\t\t\tvar options = this._zoomBoundLayers[i].options;\n\n\t\t\tminZoom = options.minZoom === undefined ? minZoom : Math.min(minZoom, options.minZoom);\n\t\t\tmaxZoom = options.maxZoom === undefined ? maxZoom : Math.max(maxZoom, options.maxZoom);\n\t\t}\n\n\t\tthis._layersMaxZoom = maxZoom === -Infinity ? undefined : maxZoom;\n\t\tthis._layersMinZoom = minZoom === Infinity ? undefined : minZoom;\n\n\t\tif (oldZoomSpan !== this._getZoomSpan()) {\n\t\t\tthis.fire('zoomlevelschange');\n\t\t}\n\t}\n});\n\n// Used in L.Marker and L.Popup for computing layer position from latlng optionally with offsets\n// with or without freeze-panes. This also indicates in the returned object\n// whether the object should be visible or not when freeze panes are active.\nL.Layer.getLayerPositionVisibility = function (latlng, boundingClientRect, map, offset) {\n\tvar splitPanesContext = map.getSplitPanesContext();\n\n\tif (!splitPanesContext) {\n\t\treturn {\n\t\t\tposition: map.latLngToLayerPoint(latlng).round(),\n\t\t\tvisibility: 'visible'\n\t\t};\n\t}\n\n\tvar splitPos = splitPanesContext.getSplitPos();\n\tvar docPos = map.project(latlng);\n\tvar docPosWithOffset = docPos.clone();\n\tif (offset) {\n\t\tdocPosWithOffset._add(offset);\n\t}\n\tvar pixelOrigin = map.getPixelOrigin();\n\tvar mapPanePos = map._getMapPanePos();\n\tvar mirrorX = map._docLayer.isCalcRTL();\n\tvar layerSplitPos = splitPos.subtract(mapPanePos);\n\tif (mirrorX)\n\t\tlayerSplitPos.x = map._size.x - splitPos.x - mapPanePos.x;\n\n\tvar makeHidden = false;\n\n\tif (splitPos.x) {\n\t\tlayerSplitPos.x += (mirrorX ? -1 : 1);\n\t}\n\n\tif (splitPos.y) {\n\t\tlayerSplitPos.y += 1;\n\t}\n\n\tvar layerPos = new L.Point(0, 0);\n\tvar layerPosWithOffset = new L.Point(0, 0);\n\tvar eps = new L.Point(boundingClientRect.width, boundingClientRect.height);\n\n\tif (docPosWithOffset.x <= splitPos.x) {\n\t\t// fixed region.\n\t\t// mirroring should always be done in container coordinates.\n\t\t// In the fixed region, document coordinates and container coordinates are the same.\n\t\tlayerPos.x = (mirrorX ? map._size.x - docPosWithOffset.x : docPos.x) - mapPanePos.x;\n\t\tlayerPosWithOffset.x = (mirrorX ? map._size.x - docPos.x : docPosWithOffset.x) - mapPanePos.x;\n\t\tif (splitPos.x - docPosWithOffset.x <= eps.x) {\n\t\t\t// Hide the object if it is close to the split *and* the non-fixed region has moved away from the fixed.\n\t\t\tmakeHidden = (mapPanePos.x !== pixelOrigin.x);\n\t\t}\n\t}\n\telse {\n\t\t// Movable region.\n\t\t// Mirroring should always be done in container coordinates.\n\t\t// The mirrorX expression does the following:\n\t\t// The document coordinate is first converted to container coordinate,\n\t\t// then it is mirrored w.r.t the container and finally converted to layer coordinate.\n\t\tlayerPos.x = mirrorX ? map._size.x - (docPosWithOffset.x - pixelOrigin.x + mapPanePos.x) - mapPanePos.x : docPos.x - pixelOrigin.x;\n\t\tlayerPosWithOffset.x = mirrorX ? map._size.x - (docPos.x - pixelOrigin.x + mapPanePos.x) - mapPanePos.x : docPosWithOffset.x - pixelOrigin.x;\n\t\tif ((!mirrorX && layerPosWithOffset.x < layerSplitPos.x) || (mirrorX && layerPosWithOffset.x >= layerSplitPos.x)) {\n\t\t\t// do not encroach the fixed region.\n\t\t\tmakeHidden = true;\n\t\t}\n\t}\n\n\tif (docPosWithOffset.y <= splitPos.y) {\n\t\t// fixed region.\n\t\tlayerPos.y = docPos.y - mapPanePos.y;\n\t\tlayerPosWithOffset.y = docPosWithOffset.y - mapPanePos.y;\n\t\tif (splitPos.y - docPosWithOffset.y <= eps.y) {\n\t\t\t// Hide the marker if it is close to the split *and* the non-fixed region has moved away from the fixed.\n\t\t\tmakeHidden = (mapPanePos.y !== pixelOrigin.y);\n\t\t}\n\t}\n\telse {\n\t\tlayerPos.y = docPos.y - pixelOrigin.y;\n\t\tlayerPosWithOffset.y = docPosWithOffset.y - pixelOrigin.y;\n\t\tif (layerPosWithOffset.y < layerSplitPos.y) {\n\t\t\t// do not encroach the fixed region.\n\t\t\tmakeHidden = true;\n\t\t}\n\t}\n\n\treturn {\n\t\tposition: layerPos,\n\t\tvisibility: makeHidden ? 'hidden' : 'visible'\n\t};\n};\n"]}