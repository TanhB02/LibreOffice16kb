{"version":3,"file":"CanvasTileLayer.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/layer/tile/CanvasTileLayer.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8; fill-column: 100 -*- */\n/*\n * L.CanvasTileLayer is a layer with canvas based rendering.\n */\n\n/* global app L JSDialog CanvasSectionContainer GraphicSelection CanvasOverlay CDarkOverlay CursorHeaderSection $ _ CPointSet CPolyUtil CPolygon Cursor CCellSelection PathGroupType UNOKey UNOModifier cool OtherViewCellCursorSection TileManager MultiPageViewLayout SplitSection */\n\nfunction clamp(num, min, max)\n{\n\treturn Math.min(Math.max(num, min), max);\n}\n\n// CStyleData is used to obtain CSS property values from style data\n// stored in DOM elements in the form of custom CSS properties/variables.\nvar CStyleData = L.Class.extend({\n\n\tinitialize: function (styleDataDiv) {\n\t\tthis._div = styleDataDiv;\n\t},\n\n\tgetPropValue: function (name) {\n\t\treturn getComputedStyle(this._div).getPropertyValue(name);\n\t},\n\n\tgetIntPropValue: function(name) { // (String) -> Number\n\t\treturn parseInt(this.getPropValue(name));\n\t},\n\n\tgetFloatPropValue: function(name) { // (String) -> Number\n\t\treturn parseFloat(this.getPropValue(name));\n\t},\n\n\tgetFloatPropWithoutUnit: function(name) { // (String) -> Number\n\t\tvar value = this.getPropValue(name);\n\t\tif (value.indexOf('px'))\n\t\t\tvalue = value.split('px')[0];\n\t\treturn parseFloat(value);\n\t}\n});\n\n// CSelections is used to add/modify/clear selections (text/cell-area(s)/ole)\n// on canvas using polygons (CPolygon).\nvar CSelections = L.Class.extend({\n\tinitialize: function (pointSet, canvasOverlay, selectionsDataDiv, map, isView, viewId, selectionType) {\n\t\tthis._pointSet = pointSet ? pointSet : new CPointSet();\n\t\tthis._overlay = canvasOverlay;\n\t\tthis._styleData = new CStyleData(selectionsDataDiv);\n\t\tthis._map = map;\n\t\tthis._name = 'selections' + (isView ? '-viewid-' + viewId : '');\n\t\tthis._isView = isView;\n\t\tthis._viewId = viewId;\n\t\tthis._isText = selectionType === 'text';\n\t\tthis._isOle = selectionType === 'ole';\n\t\tthis._selection = undefined;\n\t\tthis._updateSelection();\n\t\tthis._selectedMode = 0;\n\t},\n\n\tempty: function () {\n\t\treturn !this._pointSet || this._pointSet.empty();\n\t},\n\n\tclear: function () {\n\t\tthis.setPointSet(new CPointSet());\n\t},\n\n\tsetPointSet: function(pointSet) {\n\t\tthis._pointSet = pointSet;\n\t\tthis._updateSelection();\n\t},\n\n\tcontains: function(corePxPoint) {\n\t\tif (!this._selection)\n\t\t\treturn false;\n\n\t\treturn this._selection.anyRingBoundContains(corePxPoint);\n\t},\n\n\tgetBounds: function() {\n\t\treturn this._selection.getBounds();\n\t},\n\n\t_updateSelection: function() {\n\t\tif (!this._selection) {\n\t\t\tif (!this._isOle) {\n\t\t\t\tvar fillColor = this._isView ?\n\t\t\t\t\tapp.LOUtil.rgbToHex(this._map.getViewColor(this._viewId)) :\n\t\t\t\t\tthis._styleData.getPropValue('background-color');\n\t\t\t\tvar opacity = this._styleData.getFloatPropValue('opacity');\n\t\t\t\tvar weight = this._styleData.getFloatPropWithoutUnit('border-top-width');\n\t\t\t\tvar attributes = this._isText ? {\n\t\t\t\t\tviewId: this._isView ? this._viewId : undefined,\n\t\t\t\t\tgroupType: PathGroupType.TextSelection,\n\t\t\t\t\tname: this._name,\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: fillColor,\n\t\t\t\t\tfillOpacity: opacity,\n\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\topacity: 0.60,\n\t\t\t\t\tstroke: true,\n\t\t\t\t\tfill: true,\n\t\t\t\t\tweight: 1.0\n\t\t\t\t} : {\n\t\t\t\t\tviewId: this._isView ? this._viewId : undefined,\n\t\t\t\t\tname: this._name,\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\tfillColor: fillColor,\n\t\t\t\t\tfillOpacity: opacity,\n\t\t\t\t\topacity: 1.0,\n\t\t\t\t\tweight: Math.round(weight * app.dpiScale)\n\t\t\t\t};\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar attributes = {\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: 'black',\n\t\t\t\t\tfillOpacity: 0.25,\n\t\t\t\t\tweight: 0,\n\t\t\t\t\topacity: 0.25\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this._isText) {\n\t\t\t\tthis._selection = new CPolygon(this._pointSet, attributes);\n\t\t\t}\n\t\t\telse if (this._isOle) {\n\t\t\t\tthis._selection = new CDarkOverlay(this._pointSet, attributes);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._selection = new CCellSelection(this._pointSet, attributes);\n\t\t\t}\n\n\t\t\tif (this._isText)\n\t\t\t\tthis._overlay.initPath(this._selection);\n\t\t\telse\n\t\t\t\tthis._overlay.initPathGroup(this._selection);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._selection.setPointSet(this._pointSet);\n\t},\n\n\tremove: function() {\n\t\tif (!this._selection)\n\t\t\treturn;\n\t\tif (this._isText)\n\t\t\tthis._overlay.removePath(this._selection);\n\t\telse\n\t\t\tthis._overlay.removePathGroup(this._selection);\n\t},\n});\n\n// CReferences is used to store and manage the CPath's of all\n// references in the current sheet.\nvar CReferences = L.Class.extend({\n\n\tinitialize: function (canvasOverlay) {\n\n\t\tthis._overlay = canvasOverlay;\n\t\tthis._marks = [];\n\t},\n\n\t// mark should be a CPath.\n\taddMark: function (mark) {\n\t\tthis._overlay.initPath(mark);\n\t\tthis._marks.push(mark);\n\t},\n\n\t// mark should be a CPath.\n\thasMark: function (mark) {\n\t\tfor (var i = 0; i < this._marks.length; ++i) {\n\t\t\tif (mark.getBounds().equals(this._marks[i].getBounds()))\n\t\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tclear: function () {\n\t\tfor (var i = 0; i < this._marks.length; ++i)\n\t\t\tthis._overlay.removePath(this._marks[i]);\n\t\tthis._marks = [];\n\t}\n\n});\n\nL.TileSectionManager = L.Class.extend({\n\n\tinitialize: function (layer) {\n\t\tthis._layer = layer;\n\t\tthis._canvas = this._layer._canvas;\n\t\tthis._map = this._layer._map;\n\t\tvar mapSize = this._map.getPixelBoundsCore().getSize();\n\t\tthis._tilesSection = null; // Shortcut.\n\n\t\tif (L.Browser.cypressTest) // If cypress is active, create test divs.\n\t\t\tapp.sectionContainer.testing = true;\n\n\t\tapp.sectionContainer.onResize(mapSize.x, mapSize.y);\n\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\tthis._splitPos = splitPanesContext ?\n\t\t\tsplitPanesContext.getSplitPos() : new L.Point(0, 0);\n\t\tthis._updatesRunning = false;\n\t\tthis._mirrorEventsFromSourceToCanvasSectionContainer(document.getElementById('map'));\n\n\t\tvar canvasContainer = document.getElementById('document-container');\n\t\tvar that = this;\n\t\tthis.resObserver = new ResizeObserver(function() {\n\t\t\tthat._layer._syncTileContainerSize();\n\t\t});\n\t\tthis.resObserver.observe(canvasContainer);\n\n\t\tthis._zoomAtDocEdgeX = true;\n\t\tthis._zoomAtDocEdgeY = true;\n\t},\n\n\t// Map and TilesSection overlap entirely. Map is above tiles section. In order to handle events in tiles section, we need to mirror them from map.\n\t_mirrorEventsFromSourceToCanvasSectionContainer: function (sourceElement) {\n\t\tsourceElement.addEventListener('mousedown', function (e) { app.sectionContainer.onMouseDown(e); }, true);\n\t\tsourceElement.addEventListener('click', function (e) { app.sectionContainer.onClick(e); }, true);\n\t\tsourceElement.addEventListener('dblclick', function (e) { app.sectionContainer.onDoubleClick(e); }, true);\n\t\tsourceElement.addEventListener('contextmenu', function (e) { app.sectionContainer.onContextMenu(e); }, true);\n\t\tsourceElement.addEventListener('wheel', function (e) { app.sectionContainer.onMouseWheel(e); }, true);\n\t\tsourceElement.addEventListener('mouseleave', function (e) { app.sectionContainer.onMouseLeave(e); }, true);\n\t\tsourceElement.addEventListener('mouseenter', function (e) { app.sectionContainer.onMouseEnter(e); }, true);\n\t\tsourceElement.addEventListener('touchstart', function (e) { app.sectionContainer.onTouchStart(e); }, true);\n\t\tsourceElement.addEventListener('touchmove', function (e) { app.sectionContainer.onTouchMove(e); }, true);\n\t\tsourceElement.addEventListener('touchend', function (e) { app.sectionContainer.onTouchEnd(e); }, true);\n\t\tsourceElement.addEventListener('touchcancel', function (e) { app.sectionContainer.onTouchCancel(e); }, true);\n\t},\n\n\tgetSplitPos: function () {\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\treturn splitPanesContext ?\n\t\t\tsplitPanesContext.getSplitPos().multiplyBy(app.dpiScale) :\n\t\t\tnew L.Point(0, 0);\n\t},\n\n\t// Details of tile areas to render\n\t_paintContext: function() {\n\t\tvar viewBounds = this._map.getPixelBoundsCore();\n\t\tvar splitPanesContext = this._layer.getSplitPanesContext();\n\t\tvar paneBoundsList = splitPanesContext ?\n\t\t    splitPanesContext.getPxBoundList(viewBounds) :\n\t\t    [viewBounds];\n\n\t\treturn {\n\t\t\t viewBounds: viewBounds,\n\t\t\t paneBoundsList: paneBoundsList,\n\t\t\t paneBoundsActive: splitPanesContext ? true: false,\n\t\t\t splitPos: this.getSplitPos(),\n\t\t};\n\t},\n\n\t// Debug tool. Splits are enabled for only Calc for now.\n\t_addSplitsSection: function () {\n\t\tconst splitSection = new SplitSection();\n\t\tapp.sectionContainer.addSection(splitSection);\n\t},\n\n\t_removeSplitsSection: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName('calc grid');\n\t\tif (section) {\n\t\t\tsection.setDrawingOrder(L.CSections.CalcGrid.drawingOrder);\n\t\t\tsection.sectionProperties.strokeStyle = '#c0c0c0';\n\t\t}\n\t\tapp.sectionContainer.removeSection(L.CSections.Debug.Splits.name);\n\t},\n\n\t// Debug tool\n\t_addTilePixelGridSection: function () {\n\t\tapp.sectionContainer.addSection(new app.definitions.pixelGridSection());\n\t},\n\n\t_removeTilePixelGridSection: function () {\n\t\tapp.sectionContainer.removeSection(L.CSections.Debug.TilePixelGrid.name);\n\t},\n\n\t_addDebugOverlaySection: function () {\n\t\tapp.sectionContainer.addSection(new app.definitions.debugOverlaySection(this._map._debug));\n\t},\n\n\t_removeDebugOverlaySection: function () {\n\t\tapp.sectionContainer.removeSection(L.CSections.Debug.DebugOverlay.name);\n\t},\n\n\t_addPreloadMap: function () {\n\t\tapp.sectionContainer.addSection(new app.definitions.preloadMapSection());\n\t},\n\n\t_removePreloadMap: function () {\n\t\tapp.sectionContainer.removeSection(L.CSections.Debug.PreloadMap.name);\n\t},\n\n\tupdate: function () {\n\t\tapp.sectionContainer.requestReDraw();\n\t},\n\n\t/**\n\t * Everything in this doc comment is speculation: I didn't write the code that supplies it and I'm guessing to\n\t * have something to work on for this function. That said, given my observations, they seem incredibly likely to be correct\n\t *\n\t * @param pinchCenter {{x: number, y: number}} The current pinch center in doc core-pixels\n\t * Normally expressed as an L.Point instance\n\t *\n\t * @param pinchStartCenter {{x: number, y: number}} The pinch center at the start of the pinch in doc core-pixels\n\t * Normally expressed as an L.Point instance\n\t *\n\t * @param paneBounds {{min: {x: number, y: number}, max: {x: number, y: number}}} The edges of the current pane\n\t * Traditionally this is the map border at the start of the pinch\n\t *\n\t * @param freezePane {{freezeX: boolean, freezeY: boolean}} Whether the pane is frozen in the x or y directions\n\t *\n\t * @param splitPos {{x: number, y: number}} The inset in core-pixels into the document caused by any splits (e.g. a frozen row at the start of the document)\n\t *\n\t * @param scale {number} The scale, relative to the initial size, of the document currently\n\t * Or rather this is equivalent to: old_width / new_width\n\t *\n\t * @param findFreePaneCenter {boolean} Wether to return a center point\n\t *\n\t * @returns {{topLeft: {x: number, y: number}, center?: {x: number, y: number}}} An object with a top left point in core-pixels and optionally a center point\n\t * Center is included iff findFreePaneCenter is true\n\t * (probably this should be encoded into the type, e.g. with an overload when this is converted to TypeScript)\n\t **/\n\t_getZoomDocPos: function (pinchCenter, pinchStartCenter, paneBounds, freezePane, splitPos, scale, findFreePaneCenter) {\n\t\tlet xMin = 0;\n\t\tconst hasXMargin = !this._layer.isCalc();\n\t\tif (hasXMargin) {\n\t\t\txMin = -Infinity;\n\t\t} else if (paneBounds.min.x > 0) {\n\t\t\txMin = splitPos.x;\n\t\t}\n\n\t\tlet yMin = 0;\n\t\tif (paneBounds.min.y < 0) {\n\t\t\tyMin = -Infinity;\n\t\t} else if (paneBounds.min.y > 0) {\n\t\t\tyMin = splitPos.y;\n\t\t}\n\n\t\tconst minTopLeft = new L.Point(xMin, yMin);\n\n\t\tconst paneSize = paneBounds.getSize();\n\n\t\tpinchCenter = pinchCenter.subtract(this._offset);\n\n\t\tlet centerOffset = {\n\t\t\tx: pinchCenter.x - pinchStartCenter.x,\n\t\t\ty: pinchCenter.y - pinchStartCenter.y,\n\t\t};\n\n\t\t// Portion of the pane away that our pinchStart (which should be where we zoom round) is\n\t\tconst panePortion = {\n\t\t\tx: (pinchStartCenter.x - this._offset.x - paneBounds.min.x) / paneSize.x,\n\t\t\ty: (pinchStartCenter.y - this._offset.y - paneBounds.min.y) / paneSize.y,\n\t\t};\n\n\t\tlet docTopLeft = new L.Point(\n\t\t\tpinchStartCenter.x + (centerOffset.x - paneSize.x * panePortion.x) / scale,\n\t\t\tpinchStartCenter.y + (centerOffset.y - paneSize.y * panePortion.y) / scale\n\t\t);\n\n\t\t// Top left in document coordinates.\n\t\tconst clampedDocTopLeft = new L.Point(\n\t\t\tMath.max(minTopLeft.x, docTopLeft.x),\n\t\t\tMath.max(minTopLeft.y, docTopLeft.y)\n\t\t);\n\n\t\tconst offset = clampedDocTopLeft.subtract(docTopLeft);\n\n\t\tif (freezePane.freezeX) {\n\t\t\tdocTopLeft.x = paneBounds.min.x;\n\t\t} else {\n\t\t\tthis._offset.x = Math.round(Math.max(this._offset.x, offset.x));\n\t\t\tdocTopLeft.x += this._offset.x;\n\t\t}\n\n\t\tif (freezePane.freezeY) {\n\t\t\tdocTopLeft.y = paneBounds.min.y;\n\t\t} else {\n\t\t\tthis._offset.y = Math.round(Math.max(this._offset.y, offset.y));\n\t\t\tdocTopLeft.y += this._offset.y;\n\t\t}\n\n\t\tif (!findFreePaneCenter) {\n\t\t\treturn { offset: this._offset, topLeft: docTopLeft };\n\t\t}\n\n\t\tconst newPaneCenter = new L.Point(\n\t\t\t(docTopLeft.x - splitPos.x + (paneSize.x + splitPos.x) * 0.5 / scale),\n\t\t\t(docTopLeft.y - splitPos.y + (paneSize.y + splitPos.y) * 0.5 / scale));\n\n\t\treturn {\n\t\t\toffset: this._offset,\n\t\t\ttopLeft: docTopLeft.add(this._offset),\n\t\t\tcenter: this._map.rescale(newPaneCenter, this._map.getZoom(), this._map.getScaleZoom(scale)),\n\t\t};\n\t},\n\n\t_getZoomMapCenter: function (zoom) {\n\t\tvar scale = this._calcZoomFrameScale(zoom);\n\t\tvar ctx = this._paintContext();\n\t\tvar splitPos = ctx.splitPos;\n\t\tvar viewBounds = ctx.viewBounds;\n\t\tvar freePaneBounds = new L.Bounds(viewBounds.min.add(splitPos), viewBounds.max);\n\n\t\treturn this._getZoomDocPos(\n\t\t\tthis._newCenter,\n\t\t\tthis._layer._pinchStartCenter,\n\t\t\tfreePaneBounds,\n\t\t\t{ freezeX: false, freezeY: false },\n\t\t\tsplitPos,\n\t\t\tscale,\n\t\t\ttrue /* findFreePaneCenter */\n\t\t).center;\n\t},\n\n\t_zoomAnimation: function () {\n\t\tvar painter = this;\n\t\tvar ctx = this._paintContext();\n\t\tvar canvasOverlay = this._layer._canvasOverlay;\n\n\t\tvar rafFunc = function (timeStamp, final) {\n\t\t\tpainter._layer._refreshRowColumnHeaders();\n\n\t\t\t// Draw zoom frame with grids and directly from the tiles.\n\t\t\t// This will clear the doc area first.\n\t\t\tpainter._tilesSection.drawZoomFrame(ctx);\n\t\t\t// Draw the overlay objects.\n\t\t\tcanvasOverlay.onDraw();\n\n\t\t\tif (!final)\n\t\t\t\tpainter._zoomRAF = requestAnimationFrame(rafFunc);\n\t\t};\n\t\tthis.rafFunc = rafFunc;\n\t\trafFunc();\n\t},\n\n\t_calcZoomFrameScale: function (zoom) {\n\t\tzoom = this._layer._map._limitZoom(zoom);\n\t\tvar origZoom = this._layer._map.getZoom();\n\t\t// Compute relative-multiplicative scale of this zoom-frame w.r.t the starting zoom(ie the current Map's zoom).\n\t\treturn this._layer._map.zoomToFactor(zoom - origZoom + this._layer._map.options.zoom);\n\t},\n\n\t_calcZoomFrameParams: function (zoom, newCenter) {\n\t\tthis._zoomFrameScale = this._calcZoomFrameScale(zoom);\n\t\tthis._newCenter = this._layer._map.project(newCenter).multiplyBy(app.dpiScale); // in core pixels\n\t},\n\n\tsetWaitForTiles: function (wait) {\n\t\tthis._waitForTiles = wait;\n\t},\n\n\twaitForTiles: function () {\n\t\treturn this._waitForTiles;\n\t},\n\n\tzoomStep: function (zoom, newCenter) {\n\t\tif (this._finishingZoom) // finishing steps of animation still going on.\n\t\t\treturn;\n\n\t\tthis._calcZoomFrameParams(zoom, newCenter);\n\n\t\tif (!this._inZoomAnim) {\n\t\t\tapp.sectionContainer.setInZoomAnimation(true);\n\t\t\tthis._inZoomAnim = true;\n\t\t\t// Start RAF loop for zoom-animation\n\t\t\tthis._zoomAnimation();\n\t\t}\n\t},\n\n\tzoomStepEnd: function (zoom, newCenter, mapUpdater, runAtFinish, noGap) {\n\n\t\tif (!this._inZoomAnim || this._finishingZoom)\n\t\t\treturn;\n\n\t\tthis._finishingZoom = true;\n\n\t\tthis._map.disableTextInput();\n\t\t// Do a another animation from current non-integral log-zoom to\n\t\t// the final integral zoom, but maintain the same center.\n\t\tvar steps = 10;\n\t\tvar stepId = noGap ? steps : 0;\n\n\t\tvar startZoom = this._zoomFrameScale;\n\t\tvar endZoom = this._calcZoomFrameScale(zoom);\n\t\tvar painter = this;\n\t\tvar map = this._map;\n\n\t\t// Calculate the final center at final zoom in advance.\n\t\tvar newMapCenter = this._getZoomMapCenter(zoom).divideBy(app.dpiScale);\n\t\tvar newMapCenterLatLng = map.unproject(newMapCenter, zoom);\n\t\tapp.sectionContainer.setZoomChanged(true);\n\n\t\tvar stopAnimation = noGap ? true : false;\n\t\tvar waitForTiles = false;\n\t\tvar waitTries = 30;\n\t\tvar finishingRAF = undefined;\n\n\t\tvar finishAnimation = function () {\n\n\t\t\tif (stepId < steps) {\n\t\t\t\t// continue animating till we reach \"close\" to 'final zoom'.\n\t\t\t\tpainter._zoomFrameScale = startZoom + (endZoom - startZoom) * stepId / steps;\n\t\t\t\tstepId += 1;\n\t\t\t\tif (stepId >= steps)\n\t\t\t\t\tstopAnimation = true;\n\t\t\t}\n\n\t\t\tif (stopAnimation) {\n\t\t\t\tstopAnimation = false;\n\t\t\t\tcancelAnimationFrame(painter._zoomRAF);\n\t\t\t\tpainter._calcZoomFrameParams(zoom, newCenter);\n\t\t\t\t// Draw one last frame at final zoom.\n\t\t\t\tpainter.rafFunc(undefined, true /* final? */);\n\t\t\t\tpainter._zoomFrameScale = undefined;\n\t\t\t\tapp.sectionContainer.setInZoomAnimation(false);\n\t\t\t\tpainter._inZoomAnim = false;\n\n\t\t\t\tpainter.setWaitForTiles(true);\n\t\t\t\t// Set view and paint the tiles if all available.\n\t\t\t\tmapUpdater(newMapCenterLatLng);\n\t\t\t\twaitForTiles = true;\n\t\t\t}\n\n\t\t\tif (waitForTiles) {\n\t\t\t\t// Wait until we get all tiles or wait time exceeded.\n\t\t\t\tif (waitTries <= 0 || painter._tilesSection.haveAllTilesInView()) {\n\t\t\t\t\t// All done.\n\t\t\t\t\twaitForTiles = false;\n\t\t\t\t\tcancelAnimationFrame(finishingRAF);\n\t\t\t\t\tpainter.setWaitForTiles(false);\n\t\t\t\t\tapp.sectionContainer.setZoomChanged(false);\n\t\t\t\t\tmap.enableTextInput();\n\t\t\t\t\tmap.focus(map.canAcceptKeyboardInput());\n\t\t\t\t\t// Paint everything.\n\t\t\t\t\tapp.sectionContainer.requestReDraw();\n\t\t\t\t\t// Don't let a subsequent pinchZoom start before finishing all steps till this point.\n\t\t\t\t\tpainter._finishingZoom = false;\n\t\t\t\t\t// Run the finish callback.\n\t\t\t\t\trunAtFinish();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\twaitTries -= 1;\n\t\t\t}\n\n\t\t\tfinishingRAF = requestAnimationFrame(finishAnimation);\n\t\t};\n\n\t\tfinishAnimation();\n\t},\n\n\tgetTileSectionPos : function () {\n\t\treturn new L.Point(this._tilesSection.myTopLeft[0], this._tilesSection.myTopLeft[1]);\n\t}\n});\n\nL.CanvasTileLayer = L.Layer.extend({\n\n\toptions: {\n\t\ttileSize: window.tileSize,\n\t\topacity: 1,\n\n\t\tupdateWhenIdle: (window.mode.isMobile() || window.mode.isTablet()),\n\t\tupdateInterval: 200,\n\n\t\tattribution: null,\n\t\tzIndex: null,\n\t\tbounds: null,\n\n\t\tpreviewInvalidationTimeout: 1000,\n\t},\n\n\t_pngCache: [],\n\n\tinitialize: function (options) {\n\n\t\tL.Layer.prototype.initialize.call(this);\n\n\t\toptions = L.setOptions(this, options);\n\n\t\t// text, presentation, spreadsheet, etc\n\t\tthis._docType = options.docType;\n\t\tthis._documentInfo = '';\n\t\tif (this._docType !== 'text')\n\t\t\tapp.setCursorVisibility(false); // Don't change the default for Writer.\n\t\t// Last cursor position for invalidation\n\t\tthis.lastCursorPos = null;\n\t\t// Are we zooming currently ? - if so, no cursor.\n\t\tthis._isZooming = false;\n\n\t\tapp.calc.cellCursorVisible = false;\n\t\tthis._prevCellCursorAddress = null;\n\t\tthis._shapeGridOffset = new app.definitions.simplePoint(0, 0);\n\n\t\t// Position and size of the selection start (as if there would be a cursor caret there).\n\n\t\t// View selection of other views\n\t\tthis._viewSelections = {};\n\n\t\tthis._lastValidPart = -1;\n\t\t// Cursor marker\n\t\tthis._cursorMarker = null;\n\n\t\tthis._initializeTableOverlay();\n\n\t\tthis._msgQueue = [];\n\t\tthis._toolbarCommandValues = {};\n\t\tthis._previewInvalidations = [];\n\n\t\tthis._editorId = -1;\n\t\tapp.setFollowingUser(options.viewId);\n\n\t\tthis._selectedTextContent = '';\n\n\t\tthis._moveInProgress = false;\n\t\t// tile requests issued while _moveInProgress is true,\n\t\t// i.e. issued between moveStart and moveEnd\n\t\tthis._moveTileRequests = [];\n\t\tthis._canonicalIdInitialized = false;\n\n\t\tTileManager.initialize();\n\t},\n\n\t_initContainer: function () {\n\t\tif (this._canvasContainer) {\n\t\t\twindow.app.console.error('called _initContainer() when this._canvasContainer is present!');\n\t\t}\n\n\t\tif (this._container) { return; }\n\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-layer');\n\t\tthis._updateZIndex();\n\n\t\tthis.getPane().appendChild(this._container);\n\n\t\tvar mapContainer = document.getElementById('document-container');\n\t\tvar canvasContainerClass = 'leaflet-canvas-container';\n\t\tthis._canvasContainer = L.DomUtil.create('div', canvasContainerClass, mapContainer);\n\t\tthis._canvasContainer.id = 'canvas-container';\n\t\tthis._setup();\n\t},\n\n\t_setup: function () {\n\n\t\tif (!this._canvasContainer) {\n\t\t\twindow.app.console.error('canvas container not found. _initContainer failed ?');\n\t\t}\n\n\t\tthis._canvas = L.DomUtil.createWithId('canvas', 'document-canvas', this._canvasContainer);\n\t\tthis._canvas.style.visibility = 'hidden';\n\t\tapp.sectionContainer = new CanvasSectionContainer(this._canvas, this.isCalc() /* disableDrawing? */);\n\t\tthis._container.style.position = 'absolute';\n\t\tthis._cursorDataDiv = L.DomUtil.create('div', 'cell-cursor-data', this._canvasContainer);\n\t\tthis._selectionsDataDiv = L.DomUtil.create('div', 'selections-data', this._canvasContainer);\n\t\tthis._splittersDataDiv = L.DomUtil.create('div', 'splitters-data', this._canvasContainer);\n\t\tthis._cursorOverlayDiv = L.DomUtil.create('div', 'cursor-overlay', this._canvasContainer);\n\t\tif (L.Browser.cypressTest) {\n\t\t\tthis._emptyDeltaDiv = L.DomUtil.create('div', 'empty-deltas', this._canvasContainer);\n\t\t\tthis._emptyDeltaDiv.innerText = 0;\n\t\t}\n\t\tthis._splittersStyleData = new CStyleData(this._splittersDataDiv);\n\n\t\tthis._painter = new L.TileSectionManager(this);\n\n\t\tapp.sectionContainer.addSection(L.getNewTilesSection());\n\t\tthis._painter._tilesSection = app.sectionContainer.getSectionWithName('tiles');\n\t\tapp.sectionContainer.setDocumentAnchorSection(L.CSections.Tiles.name);\n\n\t\tapp.sectionContainer.getSectionWithName('tiles').onResize();\n\n\t\tthis._canvasOverlay = new CanvasOverlay(this._map, app.sectionContainer.getContext());\n\t\tapp.sectionContainer.addSection(this._canvasOverlay);\n\n\t\tapp.sectionContainer.addSection(L.getNewScrollSection(() => this.isCalcRTL()));\n\n\t\t// For mobile/tablet the hammerjs swipe handler already uses a requestAnimationFrame to fire move/drag events\n\t\t// Using L.TileSectionManager's own requestAnimationFrame loop to do the updates in that case does not perform well.\n\t\tif (window.mode.isMobile() || window.mode.isTablet()) {\n\t\t\tthis._map.on('move', this._painter.update, this._painter);\n\t\t\tthis._map.on('moveend', function () {\n\t\t\t\tsetTimeout(this.update.bind(this), 200);\n\t\t\t}, this._painter);\n\t\t}\n\t\tthis._map.on('zoomend', this._painter.update, this._painter);\n\t\tthis._map.on('splitposchanged', function () {\n\t\t\tTileManager.update();\n\t\t}, this);\n\t\tthis._map.on('sheetgeometrychanged', this._painter.update, this._painter);\n\t\tthis._map.on('move', this._syncTilePanePos, this);\n\n\t\tthis._map.on('viewrowcolumnheaders', this._painter.update, this._painter);\n\t\tthis._map.on('messagesdone', TileManager.sendProcessedResponse, TileManager);\n\n\t\tif (this._docType === 'spreadsheet') {\n\t\t\tconst calcGridSection = new app.definitions.calcGridSection();\n\t\t\tcalcGridSection.sectionProperties.tsManager = this._painter;\n\t\t\tthis._painter._calcGridSection = calcGridSection;\n\t\t\tapp.sectionContainer.addSection(calcGridSection);\n\t\t}\n\n\t\t// Add it regardless of the file type.\n\t\tapp.sectionContainer.addSection(new app.definitions.CommentSection());\n\n\t\tthis._syncTileContainerSize();\n\t\tthis._setupTableOverlay();\n\t},\n\n\t// Returns true if the document type is Writer.\n\tisWriter: function() {\n\t\treturn this._docType === 'text';\n\t},\n\n\t// Returns true if the document type is Calc.\n\tisCalc: function() {\n\t\treturn this._docType === 'spreadsheet';\n\t},\n\n\t// Returns true if the document type is Impress.\n\tisImpress: function() {\n\t\treturn this._docType === 'presentation';\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\t_updateZIndex: function () {\n\t\tif (this._container && this.options.zIndex !== undefined && this.options.zIndex !== null) {\n\t\t\tthis._container.style.zIndex = this.options.zIndex;\n\t\t}\n\t},\n\n\t_reset: function (hard) {\n\t\tvar tileZoom = Math.round(this._map.getZoom()),\n\t\t    tileZoomChanged = this._tileZoom !== tileZoom;\n\n\t\tif (hard || tileZoomChanged) {\n\t\t\tthis._resetClientVisArea();\n\n\t\t\tthis._tileZoom = tileZoom;\n\t\t\tif (tileZoomChanged) {\n\t\t\t\tthis._updateTileTwips();\n\t\t\t\tthis._updateMaxBounds();\n\t\t\t}\n\n\t\t\tif (app.tile.size.x === 0 || app.tile.size.y === 0) {\n\t\t\t\tlet tileWidthTwips = this.options.tileWidthTwips;\n\t\t\t\tapp.twipsToPixels =  TileManager.tileSize / tileWidthTwips;\n\t\t\t\tapp.pixelsToTwips = 1 / app.twipsToPixels;\n\t\t\t\tapp.tile.size.pX = app.tile.size.pY = TileManager.tileSize;\n\t\t\t}\n\n\t\t\tif (!L.Browser.mobileWebkit)\n\t\t\t\tTileManager.update(this._map.getCenter(), tileZoom);\n\n\t\t\tif (tileZoomChanged)\n\t\t\t\tTileManager.pruneTiles();\n\n\t\t\tif (this._docType === 'spreadsheet')\n\t\t\t\tthis._syncTileContainerSize();\n\t\t}\n\t},\n\n\t// These variables indicates the clientvisiblearea sent to the server and stored by the server\n\t// We need to reset them when we are reconnecting to the server or reloading a document\n\t// because the server needs new data even if the client is unmodified.\n\t_resetClientVisArea: function ()  {\n\t\tthis._clientZoom = '';\n\t\tthis._clientVisibleArea = '';\n\t},\n\n\t_resetCanonicalIdStatus: function() {\n\t\tthis._canonicalIdInitialized = false;\n\t},\n\n\t_resetViewId: function () {\n\t\tthis._viewId = undefined;\n\t},\n\n\t_resetDocumentInfo: function () {\n\t\tthis._documentInfo = \"\";\n\t},\n\n\t_getViewId: function () {\n\t\treturn this._viewId;\n\t},\n\n\t_updateTileTwips: function () {\n\t\t// smaller zoom = zoom in\n\t\tconst factor = Math.pow(1.2, (this._map.options.zoom - this._tileZoom));\n\t\tconst tileWidthTwips = Math.round(this.options.tileWidthTwips * factor);\n\n\t\tapp.twipsToPixels = TileManager.tileSize / tileWidthTwips;\n\t\tapp.pixelsToTwips = 1 / app.twipsToPixels;\n\t\tapp.tile.size.pX = app.tile.size.pY = TileManager.tileSize;\n\n\t\tif (this._docType === 'spreadsheet')\n\t\t\tthis._syncTileContainerSize();\n\t},\n\n\t_checkSpreadSheetBounds: function (newZoom) {\n\t\t// for spreadsheets, when the document is smaller than the viewing area\n\t\t// we want it to be glued to the row/column headers instead of being centered\n\t\t// In the future we probably want to remove this and set the bonds only on the\n\t\t// left/upper side of the spreadsheet so that we can have an 'infinite' number of\n\t\t// cells downwards and to the right, like we have on desktop\n\t\tvar viewSize = this._map.getSize();\n\t\tvar scale = this._map.getZoomScale(newZoom);\n\t\tvar width = app.file.size.x / app.tile.size.x * TileManager.tileSize * scale;\n\t\tvar height = app.file.size.y / app.tile.size.y * TileManager.tileSize * scale;\n\t\tif (width < viewSize.x || height < viewSize.y) {\n\t\t\t// if after zoomimg the document becomes smaller than the viewing area\n\t\t\twidth = Math.max(width, viewSize.x);\n\t\t\theight = Math.max(height, viewSize.y);\n\t\t\tif (!this._map.options._origMaxBounds) {\n\t\t\t\tthis._map.options._origMaxBounds = this._map.options.maxBounds;\n\t\t\t}\n\t\t\tscale = this._map.options.crs.scale(1);\n\t\t\tthis._map.setMaxBounds(new L.LatLngBounds(\n\t\t\t\tthis._map.unproject(new L.Point(0, 0)),\n\t\t\t\tthis._map.unproject(new L.Point(width * scale, height * scale))));\n\t\t}\n\t\telse if (this._map.options._origMaxBounds) {\n\t\t\t// if after zoomimg the document becomes larger than the viewing area\n\t\t\t// we need to restore the initial bounds\n\t\t\tthis._map.setMaxBounds(this._map.options._origMaxBounds);\n\t\t\tthis._map.options._origMaxBounds = null;\n\t\t}\n\t},\n\n\t_moveStart: function () {\n\t\tTileManager.resetPreFetching();\n\t\tthis._moveInProgress = true;\n\t\tthis._moveTileRequests = [];\n\t},\n\n\t_move: function () {\n\t\t// We throttle the \"move\" event, but in moveEnd we always call\n\t\t// a _move anyway, so if there are throttled moves still\n\t\t// pending by the time moveEnd is called then there is no point\n\t\t// processing them after _moveEnd because we are up to date\n\t\t// already when they arrive and to do would just duplicate tile\n\t\t// requests\n\t\tif (!this._moveInProgress)\n\t\t\treturn;\n\n\t\tTileManager.update();\n\t\tTileManager.resetPreFetching(true);\n\t},\n\n\t_isLatLngInView: function (position) {\n\t\tvar centerOffset = this._map._getCenterOffset(position);\n\t\tvar viewHalf = this._map.getSize()._divideBy(2);\n\t\tvar positionInView =\n\t\t\tcenterOffset.x > -viewHalf.x && centerOffset.x < viewHalf.x &&\n\t\t\tcenterOffset.y > -viewHalf.y && centerOffset.y < viewHalf.y;\n\t\treturn positionInView;\n\t},\n\n\t_moveEnd: function () {\n\t\tthis._move();\n\t\tthis._moveInProgress = false;\n\t\tthis._moveTileRequests = [];\n\t\tapp.updateFollowingUsers();\n\t},\n\n\t_requestNewTiles: function () {\n\t\tthis.handleInvalidateTilesMsg('invalidatetiles: EMPTY');\n\t\tTileManager.update();\n\t},\n\n\t_sendClientZoom: function (forceUpdate) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tvar newClientZoom = 'tilepixelwidth=' + TileManager.tileSize + ' ' +\n\t\t    'tilepixelheight=' + TileManager.tileSize + ' ' +\n\t\t    'tiletwipwidth=' + app.tile.size.x + ' ' +\n\t\t    'tiletwipheight=' + app.tile.size.y + ' ' +\n\t\t    'dpiscale=' + window.devicePixelRatio + ' ' +\n\t\t    'zoom=' + this._map.getZoom()\n\n\t\tif (this._clientZoom !== newClientZoom || forceUpdate) {\n\t\t\t// the zoom level has changed\n\t\t\tapp.socket.sendMessage('clientzoom ' + newClientZoom);\n\n\t\t\tif (!this._map._fatal && app.idleHandler._active && app.socket.connected())\n\t\t\t\tthis._clientZoom = newClientZoom;\n\t\t}\n\t},\n\n\t_twipsRectangleToPixelBounds: function (strRectangle) {\n\t\t// TODO use this more\n\t\t// strRectangle = x, y, width, height\n\t\tvar strTwips = strRectangle.match(/\\d+/g);\n\t\tif (!strTwips) {\n\t\t\treturn null;\n\t\t}\n\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\treturn new L.Bounds(\n\t\t\tthis._twipsToPixels(topLeftTwips),\n\t\t\tthis._twipsToPixels(bottomRightTwips));\n\t},\n\n\t_twipsRectanglesToPixelBounds: function (strRectangles) {\n\t\t// used when we have more rectangles\n\t\tstrRectangles = strRectangles.split(';');\n\t\tvar boundsList = [];\n\t\tfor (var i = 0; i < strRectangles.length; i++) {\n\t\t\tvar bounds = this._twipsRectangleToPixelBounds(strRectangles[i]);\n\t\t\tif (bounds) {\n\t\t\t\tboundsList.push(bounds);\n\t\t\t}\n\t\t}\n\t\treturn boundsList;\n\t},\n\n\tgetMaxDocSize: function () {\n\t\treturn undefined;\n\t},\n\n\tgetSnapDocPosX: function (docPosPixX) {\n\t\treturn docPosPixX;\n\t},\n\n\tgetSnapDocPosY: function (docPosPixY) {\n\t\treturn docPosPixY;\n\t},\n\n\tgetSplitPanesContext: function () {\n\t\treturn undefined;\n\t},\n\n\t_createNewMouseEvent: function (type, inputEvent) {\n\t\tvar event = inputEvent;\n\t\tif (inputEvent.type == 'touchstart' || inputEvent.type == 'touchmove') {\n\t\t\tevent = inputEvent.touches[0];\n\t\t}\n\t\telse if (inputEvent.type == 'touchend') {\n\t\t\tevent = inputEvent.changedTouches[0];\n\t\t}\n\t\tvar newEvent = document.createEvent('MouseEvents');\n\t\tnewEvent.initMouseEvent(\n\t\t\ttype, true, true, window, 1,\n\t\t\tevent.screenX, event.screenY,\n\t\t\tevent.clientX, event.clientY,\n\t\t\tfalse, false, false, false, 0, null\n\t\t);\n\t\treturn newEvent;\n\t},\n\n\t_getToolbarCommandsValues: function() {\n\t\tfor (var i = 0; i < this._map.unoToolbarCommands.length; i++) {\n\t\t\tvar command = this._map.unoToolbarCommands[i];\n\t\t\tapp.socket.sendMessage('commandvalues command=' + command);\n\t\t}\n\t},\n\n\t_parseCellRange: function(cellRange) {\n\t\tvar strTwips = cellRange.match(/\\d+/g);\n\t\tvar startCellAddress = [parseInt(strTwips[0]), parseInt(strTwips[1])];\n\t\tvar endCellAddress = [parseInt(strTwips[2]), parseInt(strTwips[3])];\n\t\treturn new L.Bounds(startCellAddress, endCellAddress);\n\t},\n\n\t_cellRangeToTwipRect: function(cellRange) {\n\t\tvar startCell = cellRange.getTopLeft();\n\t\tvar startCellRectPixel = this.sheetGeometry.getCellRect(startCell.x, startCell.y);\n\t\tvar topLeftTwips = this._corePixelsToTwips(startCellRectPixel.min);\n\t\tvar endCell = cellRange.getBottomRight();\n\t\tvar endCellRectPixel = this.sheetGeometry.getCellRect(endCell.x, endCell.y);\n\t\tvar bottomRightTwips = this._corePixelsToTwips(endCellRectPixel.max);\n\t\treturn new L.Bounds(topLeftTwips, bottomRightTwips);\n\t},\n\n\t_onMessage: function (textMsg, img) {\n\t\tthis._saveMessageForReplay(textMsg);\n\t\t// 'tile:' is the most common message type; keep this the first.\n\t\tif (textMsg.startsWith('tile:') || textMsg.startsWith('delta:')) {\n\t\t\tTileManager.onTileMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('commandvalues:')) {\n\t\t\tthis._onCommandValuesMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cursorvisible:')) {\n\t\t\tthis._onCursorVisibleMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('downloadas:')) {\n\t\t\tthis._onDownloadAsMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('error:')) {\n\t\t\tthis._onErrorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('getchildid:')) {\n\t\t\tthis._onGetChildIdMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('shapeselectioncontent:')) {\n\t\t\tGraphicSelection.onShapeSelectionContent(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('graphicselection:')) {\n\t\t\tthis._map.fire('resettopbottompagespacing');\n\t\t\tGraphicSelection.onMessage(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('graphicinnertextarea:')) {\n\t\t\treturn; // Not used.\n\t\t}\n\t\telse if (textMsg.startsWith('cellcursor:')) {\n\t\t\tthis._onCellCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('celladdress:')) {\n\t\t\tthis._onCellAddressMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellformula:')) {\n\t\t\tthis._onCellFormulaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('referencemarks:')) {\n\t\t\tthis._onReferencesMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('referenceclear:')) {\n\t\t\tthis._clearReferences();\n\t\t}\n\t\telse if (textMsg.startsWith('invalidatecursor:')) {\n\t\t\tthis._onInvalidateCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('invalidatetiles:')) {\n\t\t\tconsole.error(\"Message should be filterd during slurp\");\n\t\t}\n\t\telse if (textMsg.startsWith('mousepointer:')) {\n\t\t\tthis._onMousePointerMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('renderfont:')) {\n\t\t\tthis._onRenderFontMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('searchnotfound:')) {\n\t\t\tthis._onSearchNotFoundMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('searchresultselection:')) {\n\t\t\tthis._onSearchResultSelection(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('setpart:')) {\n\t\t\tthis._onSetPartMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('statechanged:')) {\n\t\t\tthis._onStateChangedMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('status:') || textMsg.startsWith('statusupdate:')) {\n\t\t\tthis._onStatusMsg(textMsg);\n\n\t\t\t// update tiles and selection because mode could be changed\n\t\t\tTileManager.update();\n\t\t\tapp.definitions.otherViewGraphicSelectionSection.updateVisibilities();\n\t\t\tapp.definitions.otherViewCursorSection.updateVisibilities();\n\t\t\tthis.updateAllTextViewSelection();\n\t\t}\n\t\telse if (textMsg.startsWith('textselection:')) {\n\t\t\tthis._onTextSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textselectioncontent:')) {\n\t\t\tlet textMsgContent = textMsg.substr(22);\n\t\t\tlet textMsgHtml = '';\n\t\t\tlet textMsgPlainText = '';\n\t\t\tif (textMsgContent.startsWith('{')) {\n\t\t\t\t// Multiple formats: JSON.\n\t\t\t\tlet textMsgJson = JSON.parse(textMsgContent);\n\t\t\t\ttextMsgHtml = textMsgJson['text/html'];\n\t\t\t\ttextMsgPlainText = textMsgJson['text/plain;charset=utf-8'];\n\t\t\t} else {\n\t\t\t\t// Single format: as-is.\n\t\t\t\ttextMsgHtml = textMsgContent;\n\t\t\t}\n\t\t\tconst hyperlinkTextBox = document.getElementById('hyperlink-text-box');\n\t\t\tif (hyperlinkTextBox) {\n\t\t\t\t// Hyperlink dialog is open, the text selection is for the link text\n\t\t\t\t// widget.\n\t\t\t\tconst extracted = this._map.extractContent(textMsgHtml);\n\t\t\t\thyperlinkTextBox.value = extracted.trim();\n\n\t\t\t\tconst hyperlinkLinkBoxInput = document.getElementById('hyperlink-link-box-input');\n\t\t\t\tif (extracted !== '' && hyperlinkLinkBoxInput) {\n\t\t\t\t\thyperlinkLinkBoxInput.focus();\n\t\t\t\t}\n\t\t\t} else if (this._map._clip) {\n\t\t\t\tthis._map._clip.setTextSelectionHTML(textMsgHtml, textMsgPlainText);\n\t\t\t} else\n\t\t\t\t// hack for ios and android to get selected text into hyperlink insertion dialog\n\t\t\t\tthis._selectedTextContent = textMsgHtml;\n\t\t}\n\t\telse if (textMsg.startsWith('clipboardchanged')) {\n\t\t\tvar jMessage = textMsg.substr(17);\n\t\t\tjMessage = JSON.parse(jMessage);\n\n\t\t\tif (jMessage.mimeType === 'text/plain') {\n\t\t\t\tthis._map._clip.setTextSelectionHTML(jMessage.content);\n\n\t\t\t\t// If _navigatorClipboardWrite is available, use it.\n\t\t\t\tif (L.Browser.clipboardApiAvailable || window.ThisIsTheiOSApp)\n\t\t\t\t\tthis._map.fire('clipboardchanged', { commandName: '.uno:CopyHyperlinkLocation' });\n\t\t\t\telse // Or use previous method.\n\t\t\t\t\tthis._map._clip._execCopyCutPaste('copy');\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('textselectionend:')) {\n\t\t\tthis._onTextSelectionEndMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textselectionstart:')) {\n\t\t\tthis._onTextSelectionStartMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellselectionarea:')) {\n\t\t\tthis._onCellSelectionAreaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellautofillarea:')) {\n\t\t\tthis._onCellAutoFillAreaMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('complexselection:')) {\n\t\t\tif (this._map._clip)\n\t\t\t\tthis._map._clip.onComplexSelection(textMsg.substr('complexselection:'.length));\n\t\t}\n\t\telse if (textMsg.startsWith('windowpaint:')) {\n\t\t\tthis._onDialogPaintMsg(textMsg, img);\n\t\t}\n\t\telse if (textMsg.startsWith('window:')) {\n\t\t\tthis._onDialogMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('unocommandresult:')) {\n\t\t\tthis._onUnoCommandResultMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('hrulerupdate:')) {\n\t\t\tthis._onRulerUpdate(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('vrulerupdate:')) {\n\t\t\tthis._onRulerUpdate(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('contextmenu:')) {\n\t\t\tthis._onContextMenuMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('invalidateviewcursor:')) {\n\t\t\tthis._onInvalidateViewCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('viewcursorvisible:')) {\n\t\t\tthis._onViewCursorVisibleMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('cellviewcursor:')) {\n\t\t\tthis._onCellViewCursorMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('viewinfo:')) {\n\t\t\tthis._onViewInfoMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('textviewselection:')) {\n\t\t\tthis._onTextViewSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('graphicviewselection:')) {\n\t\t\tthis._onGraphicViewSelectionMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('tableselected:')) {\n\t\t\tthis._onTableSelectedMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('editor:')) {\n\t\t\tthis._updateEditor(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('validitylistbutton:')) {\n\t\t\tthis._onValidityListButtonMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('validityinputhelp:')) {\n\t\t\tthis._onValidityInputHelpMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('signaturestatus:')) {\n\t\t\tvar signstatus = textMsg.substring('signaturestatus:'.length + 1);\n\t\t\tthis._map.onChangeSignStatus(signstatus);\n\t\t}\n\t\telse if (textMsg.startsWith('removesession')) {\n\t\t\tvar viewId = parseInt(textMsg.substring('removesession'.length + 1));\n\t\t\tif (this._map._docLayer._viewId === viewId)\n\t\t\t\tapp.dispatcher.dispatch('closeapp');\n\t\t}\n\t\telse if (textMsg.startsWith('calcfunctionlist:')) {\n\t\t\tthis._onCalcFunctionListMsg(textMsg.substring('calcfunctionlist:'.length + 1));\n\t\t}\n\t\telse if (textMsg.startsWith('tooltip:')) {\n\t\t\tvar tooltipInfo = JSON.parse(textMsg.substring('tooltip:'.length + 1));\n\t\t\tif (tooltipInfo.type === 'formulausage') {\n\t\t\t\tthis._onCalcFunctionUsageMsg(tooltipInfo.text);\n\t\t\t}\n\t\t\telse if (tooltipInfo.type === 'generaltooltip') {\n\t\t\t\tvar tooltipInfo = JSON.parse(textMsg.substring(textMsg.indexOf('{')));\n\t\t\t\tthis._map.uiManager.showDocumentTooltip(tooltipInfo);\n\t\t\t}\n\t\t\telse if (tooltipInfo.type === 'autofillpreviewtooltip') {\n\n\t\t\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\t\t\tif (strTwips != null && this._map.isEditMode())\n\t\t\t\t\tthis._map.fire('openautofillpreviewpopup', { data: tooltipInfo });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.error('unknown tooltip type');\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('tabstoplistupdate:')) {\n\t\t\tthis._onTabStopListUpdate(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('context:')) {\n\t\t\tvar message = textMsg.substring('context:'.length + 1);\n\t\t\tmessage = message.split(' ');\n\t\t\tif (message.length > 1) {\n\t\t\t\tvar old = this._map.context || {};\n\t\t\t\tvar newContext = {appId: message[0], context: message[1]};\n\t\t\t\tif (old.appId !== newContext.appId || old.context !== newContext.context) {\n\t\t\t\t\tthis._map.context = newContext;\n\t\t\t\t\tapp.events.fire('contextchange', {\n\t\t\t\t\t\tappId: newContext.appId, context: newContext.context,\n\t\t\t\t\t\toldAppId: old.appId, oldContext: old.context\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('formfieldbutton:')) {\n\t\t\tthis._onFormFieldButtonMsg(textMsg);\n\t\t}\n\t\telse if (textMsg.startsWith('canonicalidchange:')) {\n\t\t\tvar payload = textMsg.substring('canonicalidchange:'.length + 1);\n\t\t\tvar viewRenderedState = payload.split('=')[3].split(' ')[0];\n\t\t\tif (this._debug.overlayOn) {\n\t\t\t\tvar viewId = payload.split('=')[1].split(' ')[0];\n\t\t\t\tvar canonicalId = payload.split('=')[2].split(' ')[0];\n\t\t\t\tthis._debug.setOverlayMessage('canonicalViewId',\n\t\t\t\t\t'Canonical id changed to: ' + canonicalId + ' for view id: ' + viewId + ' with view renderend state: ' + viewRenderedState\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!this._canonicalIdInitialized) {\n\t\t\t\tthis._canonicalIdInitialized = true;\n\t\t\t\tTileManager.update();\n\t\t\t} else {\n\t\t\t\tthis._requestNewTiles();\n\t\t\t\tthis._invalidateAllPreviews();\n\t\t\t\tTileManager.redraw();\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('comment:')) {\n\t\t\tvar obj = JSON.parse(textMsg.substring('comment:'.length + 1));\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('redlinetablemodified:')) {\n\t\t\tobj = JSON.parse(textMsg.substring('redlinetablemodified:'.length + 1));\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('redlinetablechanged:')) {\n\t\t\tobj = JSON.parse(textMsg.substring('redlinetablechanged:'.length + 1));\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).onACKComment(obj);\n\t\t}\n\t\telse if (textMsg.startsWith('applicationbackgroundcolor:')) {\n\t\t\tapp.sectionContainer.setClearColor('#' + textMsg.substring('applicationbackgroundcolor:'.length + 1).trim());\n\t\t\tapp.sectionContainer.requestReDraw();\n\t\t}\n\t\telse if (textMsg.startsWith('documentbackgroundcolor:')) {\n\t\t\tapp.sectionContainer.setDocumentBackgroundColor('#' + textMsg.substring('documentbackgroundcolor:'.length + 1).trim());\n\t\t}\n\t\telse if (textMsg.startsWith('contentcontrol:')) {\n\t\t\ttextMsg = textMsg.substring('contentcontrol:'.length + 1);\n\t\t\tif (!app.sectionContainer.doesSectionExist(L.CSections.ContentControl.name)) {\n\t\t\t\tapp.sectionContainer.addSection(new cool.ContentControlSection());\n\t\t\t}\n\t\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.ContentControl.name);\n\t\t\tsection.drawContentControl(JSON.parse(textMsg));\n\t\t}\n\t\telse if (textMsg.startsWith('versionbar:')) {\n\t\t\tobj = JSON.parse(textMsg.substring('versionbar:'.length + 1));\n\t\t\tthis._map.fire('versionbar', obj);\n\t\t}\n\t\telse if (textMsg.startsWith('lockaccessibilityon')) {\n\t\t\t// a11y forced on by DocumentBroker, from view settings overrides.\n\t\t\tthis._map.lockAccessibilityOn();\n\t\t}\n\t\telse if (textMsg.startsWith('a11y')) {\n\t\t\tif (!window.prefs.getBoolean('accessibilityState'))\n\t\t\t\tthrow 'A11y events come from the core while it is disabled in the client session.';\n\n\t\t\tif (textMsg.startsWith('a11yfocuschanged:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yfocuschanged:'.length + 1));\n\t\t\t\tvar listPrefixLength = obj.listPrefixLength !== undefined ? parseInt(obj.listPrefixLength) : 0;\n\t\t\t\tthis._map._textInput.onAccessibilityFocusChanged(\n\t\t\t\t\tobj.content, parseInt(obj.position), parseInt(obj.start), parseInt(obj.end),\n\t\t\t\t\tlistPrefixLength, parseInt(obj.force) > 0);\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11ycaretchanged:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yfocuschanged:'.length + 1));\n\t\t\t\tthis._map._textInput.onAccessibilityCaretChanged(parseInt(obj.position));\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11ytextselectionchanged:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11ytextselectionchanged:'.length + 1));\n\t\t\t\tthis._map._textInput.onAccessibilityTextSelectionChanged(parseInt(obj.start), parseInt(obj.end));\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11yfocusedcellchanged:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yfocusedcellchanged:'.length + 1));\n\t\t\t\tvar outCount = obj.outCount !== undefined ? parseInt(obj.outCount) : 0;\n\t\t\t\tvar inList = obj.inList !== undefined ? obj.inList : [];\n\t\t\t\tvar row = parseInt(obj.row);\n\t\t\t\tvar col = parseInt(obj.col);\n\t\t\t\tvar rowSpan = obj.rowSpan !== undefined ? parseInt(obj.rowSpan) : 1;\n\t\t\t\tvar colSpan = obj.colSpan !== undefined ? parseInt(obj.colSpan) : 1;\n\t\t\t\tthis._map._textInput.onAccessibilityFocusedCellChanged(\n\t\t\t\t\toutCount, inList, row, col, rowSpan, colSpan, obj.paragraph);\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11yeditinginselectionstate:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yeditinginselectionstate:'.length + 1));\n\t\t\t\tthis._map._textInput.onAccessibilityEditingInSelectionState(\n\t\t\t\t\tparseInt(obj.cell) > 0, parseInt(obj.enabled) > 0, obj.selection, obj.paragraph);\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11yselectionchanged:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yselectionchanged:'.length + 1));\n\t\t\t\tthis._map._textInput.onAccessibilitySelectionChanged(\n\t\t\t\t\tparseInt(obj.cell) > 0, obj.action, obj.name, obj.text);\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11yfocusedparagraph:')) {\n\t\t\t\tobj = JSON.parse(textMsg.substring('a11yfocusedparagraph:'.length + 1));\n\t\t\t\tthis._map._textInput.setA11yFocusedParagraph(\n\t\t\t\t\tobj.content, parseInt(obj.position), parseInt(obj.start), parseInt(obj.end));\n\t\t\t}\n\t\t\telse if (textMsg.startsWith('a11ycaretposition:')) {\n\t\t\t\tvar pos = textMsg.substring('a11ycaretposition:'.length + 1);\n\t\t\t\tthis._map._textInput.setA11yCaretPosition(parseInt(pos));\n\t\t\t}\n\t\t}\n\t\telse if (textMsg.startsWith('colorpalettes:')) {\n\t\t\tvar json = JSON.parse(textMsg.substring('colorpalettes:'.length + 1));\n\n\t\t\tfor (var key in json) {\n\t\t\t\tif(key === 'ColorNames') {\n\t\t\t\t\twindow.app.colorNames = json[key];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (app.colorPalettes[key]) {\n\t\t\t\t\tapp.colorPalettes[key].colors = json[key];\n\t\t\t\t} else {\n\t\t\t\t\twindow.app.console.warn('Unknown palette: \"' + key + '\"');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove empty palettes, eg. Document colors in Impress are empty\n\t\t\tfor (var key in app.colorPalettes) {\n\t\t\t\tif (!app.colorPalettes[key].colors || !app.colorPalettes[key].colors.length) {\n\t\t\t\t\tdelete app.colorPalettes[key];\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (textMsg.startsWith('serveraudit:')) {\n\t\t\tvar serverAudit = textMsg.substr(12).trim();\n\t\t\tif (serverAudit !== 'disabled') {\n\t\t\t\t// if isAdminUser property is not set by integration - enable audit dialog for all users\n\t\t\t\tif (app.isAdminUser !== false)\n\t\t\t\t\tthis._map.serverAuditDialog = JSDialog.serverAuditDialog(this._map);\n\n\t\t\t\tvar json = JSON.parse(serverAudit);\n\t\t\t\tapp.setServerAuditFromCore(json.serverAudit);\n\t\t\t}\n\t\t} else if (textMsg.startsWith('adminuser:')) {\n\t\t\tvar value = textMsg.substr(10).trim();\n\t\t\tif (value === 'true')\n\t\t\t\tapp.isAdminUser = true;\n\t\t\telse if (value === 'false')\n\t\t\t\tapp.isAdminUser = false;\n\t\t\telse\n\t\t\t\tapp.isAdminUser = null;\n\n\t\t\tthis._map.fire('adminuser');\n\t\t} else if (textMsg.startsWith('presentationinfo:')) {\n\t\t\tvar content = JSON.parse(textMsg.substring('presentationinfo:'.length + 1));\n\t\t\tthis._map.fire('presentationinfo', content);\n\t\t} else if (textMsg.startsWith('slidelayer:')) {\n\t\t\tconst content = JSON.parse(textMsg.substring('slidelayer:'.length + 1));\n\t\t\tthis._map.fire('slidelayer', {\n\t\t\t\tmessage: content,\n\t\t\t\timage: img\n\t\t\t});\n\t\t} else if (textMsg.startsWith('sliderenderingcomplete:')) {\n\t\t\tconst status = textMsg.substring('sliderenderingcomplete:'.length + 1);\n\t\t\tthis._map.fire('sliderenderingcomplete', {\n\t\t\t\tsuccess: status === 'success'\n\t\t\t});\n\t\t}\n\t},\n\n\t_onInvalidateTilesMsg: function (textMsg) {\n\t\tconst command = app.socket.parseServerCmd(textMsg);\n\t\tif (command.x === undefined || command.y === undefined || command.part === undefined) {\n\t\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\t\tcommand.x = parseInt(strTwips[0]);\n\t\t\tcommand.y = parseInt(strTwips[1]);\n\t\t\tcommand.width = parseInt(strTwips[2]);\n\t\t\tcommand.height = parseInt(strTwips[3]);\n\t\t\tcommand.part = this._selectedPart;\n\t\t}\n\n\t\tif (isNaN(command.mode))\n\t\t\tcommand.mode = this._selectedMode;\n\n\t\tconst invalidArea = new app.definitions.simpleRectangle(command.x, command.y, command.width, command.height);\n\t\tTileManager.overlapInvalidatedRectangleWithView(command.part, command.mode, command.wireId, invalidArea, textMsg);\n\n\t\tif (this._docType === 'presentation' || this._docType === 'drawing') {\n\t\t\tif (command.part === this._selectedPart &&\n\t\t\t\tcommand.mode === this._selectedMode &&\n\t\t\t\tcommand.part !== this._lastValidPart) {\n\t\t\t\tthis._map.fire('updatepart', {part: this._lastValidPart, docType: this._docType});\n\t\t\t\tthis._lastValidPart = command.part;\n\t\t\t\tthis._map.fire('updatepart', {part: command.part, docType: this._docType});\n\t\t\t}\n\n\t\t\tconst preview = this._map._docPreviews ? this._map._docPreviews[command.part] : null;\n\t\t\tif (preview) { preview.invalid = true; }\n\n\t\t\tconst topLeftTwips = new L.Point(command.x, command.y);\n\t\t\tconst offset = new L.Point(command.width, command.height);\n\t\t\tconst bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tthis._previewInvalidations.push(new L.Bounds(topLeftTwips, bottomRightTwips));\n\t\t\t// 1s after the last invalidation, update the preview\n\t\t\tclearTimeout(this._previewInvalidator);\n\t\t\tthis._previewInvalidator = setTimeout(L.bind(this._invalidatePreviews, this), this.options.previewInvalidationTimeout);\n\t\t}\n\t},\n\n\thandleInvalidateTilesMsg: function(textMsg) {\n\t\tvar payload = textMsg.substring('invalidatetiles:'.length + 1);\n\t\tif (!payload.startsWith('EMPTY')) {\n\t\t\tthis._onInvalidateTilesMsg(textMsg);\n\t\t}\n\t\telse {\n\t\t\tvar msg = 'invalidatetiles: ';\n\n\t\t\t// see invalidatetiles: in wsd/protocol.txt for structure\n\t\t\tvar tmp = payload.substring('EMPTY'.length).replaceAll(',', ' , ');\n\t\t\tvar tokens = tmp.split(/[ \\n]+/);\n\n\t\t\tvar wireIdToken = undefined;\n\t\t\tvar commaargs = [];\n\n\t\t\tvar commaarg = false;\n\t\t\tfor (var i = 0; i < tokens.length; i++) {\n\t\t\t\tif (tokens[i] === ',') {\n\t\t\t\t\tcommaarg = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (commaarg) {\n\t\t\t\t\tcommaargs.push(tokens[i]);\n\t\t\t\t\tcommaarg = false;\n\t\t\t\t}\n\t\t\t\telse if (tokens[i].startsWith('wid=')) {\n\t\t\t\t\twireIdToken = tokens[i];\n\t\t\t\t}\n\t\t\t\telse if (tokens[i])\n\t\t\t\t\tconsole.error('unsupported invalidatetile token: ' + tokens[i]);\n\t\t\t}\n\n\t\t\tif (this.isWriter()) {\n\t\t\t\tmsg += 'part=0 ';\n\t\t\t} else {\n\n\t\t\t\tvar part = parseInt(commaargs.length > 0 ? commaargs[0] : '');\n\t\t\t\tvar mode = parseInt(commaargs.length > 1 ? commaargs[1] : '');\n\n\t\t\t\tmode = (isNaN(mode) ? this._selectedMode : mode);\n\t\t\t\tmsg += 'part=' + (isNaN(part) ? this._selectedPart : part)\n\t\t\t\t\t+ ((mode && mode !== 0) ? (' mode=' + mode) : '')\n\t\t\t\t\t+ ' ';\n\t\t\t}\n\t\t\tmsg += 'x=0 y=0 ';\n\t\t\tmsg += 'width=' + app.file.size.x + ' ';\n\t\t\tmsg += 'height=' + app.file.size.y;\n\t\t\tif (wireIdToken !== undefined)\n\t\t\t\tmsg += ' ' + wireIdToken;\n\t\t\tthis._onInvalidateTilesMsg(msg);\n\t\t}\n\t},\n\n\t// Process messages early that won't mess with the DOM\n\tfilterSlurpedMessage: function(evt) {\n\t\tvar textMsg = evt.textMsg;\n\n\t\tif (textMsg.startsWith('invalidatetiles:')) {\n\t\t\tapp.socket._logSocket('INCOMING', textMsg);\n\t\t\tthis.handleInvalidateTilesMsg(textMsg);\n\t\t\treturn true; // filter\n\t\t}\n\n\t\treturn false; // continue processing\n\t},\n\n\t_onTabStopListUpdate: function (textMsg) {\n\t\ttextMsg = textMsg.substring('tabstoplistupdate:'.length + 1);\n\t\tvar json = JSON.parse(textMsg);\n\t\tthis._map.fire('tabstoplistupdate', json);\n\t},\n\n\t_onCommandValuesMsg: function (textMsg) {\n\t\tvar jsonIdx = textMsg.indexOf('{');\n\t\tif (jsonIdx === -1) {\n\t\t\treturn;\n\t\t}\n\t\tvar obj = JSON.parse(textMsg.substring(jsonIdx));\n\t\tif (obj.commandName === '.uno:DocumentRepair') {\n\t\t\tthis._onDocumentRepair(obj);\n\t\t}\n\t\telse if (obj.commandName === '.uno:CellCursor') {\n\t\t\tthis._onCellCursorMsg(obj.commandValues);\n\t\t}\n\t\telse if (this._map.unoToolbarCommands.indexOf(obj.commandName) !== -1) {\n\t\t\tthis._toolbarCommandValues[obj.commandName] = obj.commandValues;\n\t\t\tthis._map.fire('updatetoolbarcommandvalues', {\n\t\t\t\tcommandName: obj.commandName,\n\t\t\t\tcommandValues: obj.commandValues\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tthis._map.fire('commandvalues', {\n\t\t\t\tcommandName: obj.commandName,\n\t\t\t\tcommandValues: obj.commandValues\n\t\t\t});\n\t\t}\n\t},\n\n\t_onCellAddressMsg: function (textMsg) {\n\t\t// When the user moves the focus to a different cell, a 'cellformula'\n\t\t// message is received from coolwsd, *then* a 'celladdress' message.\n\t\tvar address = textMsg.substring(13);\n\t\tif (this._map._clip && !this._map['wopi'].DisableCopy) {\n\t\t\tthis._map._clip.setTextSelectionText(this._lastFormula);\n\t\t}\n\t\tthis._map.fire('celladdress', {address: address});\n\t},\n\n\t_onCellFormulaMsg: function (textMsg) {\n\t\t// When a 'cellformula' message from coolwsd is received,\n\t\t// store the text contents of the cell, but don't push\n\t\t// them to the clipboard container (yet).\n\t\t// This is done because coolwsd will send several 'cellformula'\n\t\t// messages during text composition, and resetting the contents\n\t\t// of the clipboard container mid-composition will easily break it.\n\n\t\tlet newFormula = textMsg.substring(13);\n\t\tif (this._lastFormula) {\n\t\t\tlet minLength = Math.min(newFormula.length, this._lastFormula.length);\n\t\t\tlet index = -1;\n\t\t\tfor (let i = 0; i < minLength; i++) {\n\t\t\t\tif (newFormula.charAt(i) !== this._lastFormula.charAt(i)) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (index === -1)\n\t\t\t\tindex = newFormula.length-1;\n\n\t\t\t// newFormulaDiffIndex have index of last added character in formula\n\t\t\t// It is used during Formula Autocomplete to find partial remaining text\n\t\t\tthis._newFormulaDiffIndex = index;\n\t\t}\n\t\tthis._lastFormula = newFormula;\n\t\tthis._map.fire('cellformula', {formula: newFormula});\n\t},\n\n\t_onCalcFunctionUsageMsg: function (textMsg) {\n\t\tthis._map.fire('closepopup');\n\t\tthis._map.fire('sendformulausagetext', {data: textMsg});\n\t},\n\n\t_onCalcFunctionListMsg: function (textMsg) {\n\t\tif (textMsg.startsWith('hidetip')) {\n\t\t\tthis._map.fire('closepopup');\n\t\t} else {\n\t\t\tvar funcData = JSON.parse(textMsg);\n\n\t\t\tif (window.mode.isMobile()) {\n\t\t\t\tthis._closeMobileWizard();\n\n\t\t\t\tvar data = {\n\t\t\t\t\tid: 'funclist',\n\t\t\t\t\ttype: '',\n\t\t\t\t\ttext: _('Functions'),\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tchildren: []\n\t\t\t\t};\n\n\t\t\t\tif (funcData.categories)\n\t\t\t\t\tthis._onCalcFunctionListWithCategories(funcData, data);\n\t\t\t\telse\n\t\t\t\t\tthis._onCalcFunctionList(funcData, data);\n\n\t\t\t\tif (funcData.wholeList)\n\t\t\t\t\tthis._map._functionWizardData = data;\n\n\t\t\t\tthis._openMobileWizard(data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar functionList = this._getFunctionList(textMsg);\n\t\t\t\tthis._map.fire('sendformulatext', {data: functionList});\n\t\t\t}\n\t\t}\n\t},\n\n\t_getCalcFunctionListEntry: function(name, category, index, signature, description) {\n\t\treturn  {\n\t\t\tid: '',\n\t\t\ttype: 'calcfuncpanel',\n\t\t\ttext: name,\n\t\t\tfunctionName: name,\n\t\t\tindex: index,\n\t\t\tcategory: category,\n\t\t\tenabled: true,\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: '',\n\t\t\t\t\ttype: 'fixedtext',\n\t\t\t\t\thtml: '<div class=\"func-info-sig\">' + signature + '</div>' + '<div class=\"func-info-desc\">' + description + '</div>',\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tstyle: 'func-info'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t},\n\n\t_onCalcFunctionList: function (funcList, data) {\n\t\tvar entries = data.children;\n\t\tfor (var idx = 0; idx < funcList.length; ++idx) {\n\t\t\tvar func =  funcList[idx];\n\t\t\tvar name = func.signature.split('(')[0];\n\t\t\tentries.push(this._getCalcFunctionListEntry(\n\t\t\t\tname, undefined, func.index, func.signature, func.description));\n\t\t}\n\t},\n\n\t_onCalcFunctionListWithCategories: function (funcData, data) {\n\t\tvar categoryList = funcData.categories;\n\t\tvar categoryEntries = data.children;\n\t\tfor (var idx = 0; idx < categoryList.length; ++idx) {\n\t\t\tvar category = categoryList[idx];\n\t\t\tvar categoryEntry = {\n\t\t\t\tid: '',\n\t\t\t\ttype: 'panel',\n\t\t\t\ttext: category.name,\n\t\t\t\tindex: idx,\n\t\t\t\tenabled: true,\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tcategoryEntries.push(categoryEntry);\n\t\t}\n\n\t\tvar funcList = funcData.functions;\n\t\tfor (idx = 0; idx < funcList.length; ++idx) {\n\t\t\tvar func =  funcList[idx];\n\t\t\tvar name = func.signature.split('(')[0];\n\t\t\tvar funcEntries = categoryEntries[func.category].children;\n\t\t\tfuncEntries.push(this._getCalcFunctionListEntry(\n\t\t\t\tname, func.category, func.index, func.signature, func.description));\n\t\t}\n\t},\n\n\t_onCursorVisibleMsg: function(textMsg) {\n\t\tvar command = textMsg.match('cursorvisible: true');\n\t\tapp.setCursorVisibility(command ? true : false);\n\t\tthis._removeSelection();\n\t\tthis._onUpdateCursor();\n\t\tapp.events.fire('TextCursorVisibility', { visible: app.file.textCursor.visible });\n\t},\n\n\t_onDownloadAsMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tvar parser = document.createElement('a');\n\t\tparser.href = window.host;\n\n\t\tvar url = window.makeHttpUrlWopiSrc('/' + this._map.options.urlPrefix + '/',\n\t\t\tthis._map.options.doc, '/download/' + command.downloadid);\n\n\t\tthis._map.hideBusy();\n\t\tif (this._map['wopi'].DownloadAsPostMessage) {\n\t\t\tthis._map.fire('postMessage', {msgId: 'Download_As', args: {Type: command.id, URL: url}});\n\t\t}\n\t\telse if (command.id === 'print') {\n\t\t\tif (this._map.options.print === false || L.Browser.cypressTest) {\n\t\t\t\t// open the pdf in a new tab, it can be printed directly in the browser's pdf viewer\n\t\t\t\turl = window.makeHttpUrlWopiSrc('/' + this._map.options.urlPrefix + '/',\n\t\t\t\t\tthis._map.options.doc, '/download/' + command.downloadid,\n\t\t\t\t\t'attachment=0');\n\n\t\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\t\turl = window.processCoolUrl({ url: url, type: 'print' });\n\t\t\t\t}\n\n\t\t\t\twindow.open(url, '_blank');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\t\turl = window.processCoolUrl({ url: url, type: 'print' });\n\t\t\t\t}\n\n\t\t\t\tthis._map.fire('filedownloadready', {url: url});\n\t\t\t}\n\t\t}\n\t\telse if (command.id === 'slideshow') {\n\t\t\tthis._map.fire('slidedownloadready', {url: url});\n\t\t}\n\t\telse if (command.id === 'export') {\n\t\t\tif ('processCoolUrl' in window) {\n\t\t\t\turl = window.processCoolUrl({ url: url, type: 'export' });\n\t\t\t}\n\n\t\t\t// Don't do a real download during testing\n\t\t\tif (!L.Browser.cypressTest)\n\t\t\t\tthis._map._fileDownloader.src = url;\n\t\t\telse\n\t\t\t\tthis._map._fileDownloader.setAttribute('data-src', url);\n\t\t}\n\t},\n\n\t_onErrorMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\n\t\t// let's provide some convenience error codes for the UI\n\t\tvar errorId = 1; // internal error\n\t\tif (command.errorCmd === 'load') {\n\t\t\terrorId = 2; // document cannot be loaded\n\t\t}\n\t\telse if (command.errorCmd === 'save' || command.errorCmd === 'saveas') {\n\t\t\terrorId = 5; // document cannot be saved\n\t\t}\n\n\t\tvar errorCode = -1;\n\t\tif (command.errorCode !== undefined) {\n\t\t\terrorCode = command.errorCode;\n\t\t}\n\n\t\tthis._map.fire('error', {cmd: command.errorCmd, kind: command.errorKind, id: errorId, code: errorCode});\n\t},\n\n\t_onGetChildIdMsg: function (textMsg) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tthis._map.fire('childid', {id: command.id});\n\t},\n\n\t_openMobileWizard: function(data) {\n\t\tthis._map.fire('mobilewizard', {data: data});\n\t},\n\n\t_closeMobileWizard: function() {\n\t\tthis._map.fire('closemobilewizard');\n\t},\n\n\t_onGraphicViewSelectionMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('graphicviewselection:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar strTwips = obj.selection.match(/\\d+/g);\n\n\t\tapp.definitions.otherViewGraphicSelectionSection.addOrUpdateGraphicSelectionIndicator(viewId, strTwips, parseInt(obj.part), obj.mode !== undefined ? parseInt(obj.mode): 0);\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t\t}\n\t},\n\n\t_onCellCursorMsg: function (textMsg) {\n\t\tvar autofillMarkerSection = app.sectionContainer.getSectionWithName(L.CSections.AutoFillMarker.name);\n\n\t\tvar oldCursorAddress = app.calc.cellAddress.clone();\n\n\t\tif (textMsg.match('EMPTY')) {\n\t\t\tapp.calc.cellCursorVisible = false;\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellCursor(null);\n\t\t\tif (this._map._clip)\n\t\t\t\tthis._map._clip.clearSelection();\n\t\t}\n\t\telse {\n\t\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tlet _cellCursorTwips = this._convertToTileTwipsSheetArea(new L.Bounds(topLeftTwips, bottomRightTwips));\n\n\t\t\tapp.calc.cellAddress = new app.definitions.simplePoint(parseInt(strTwips[4]), parseInt(strTwips[5]));\n\t\t\tlet tempRectangle = _cellCursorTwips.toRectangle();\n\t\t\tapp.calc.cellCursorRectangle = new app.definitions.simpleRectangle(tempRectangle[0], tempRectangle[1], tempRectangle[2], tempRectangle[3]);\n\t\t\tthis._cellCursorSection.size[0] = app.calc.cellCursorRectangle.pWidth;\n\t\t\tthis._cellCursorSection.size[1] = app.calc.cellCursorRectangle.pHeight;\n\t\t\tthis._cellCursorSection.setPosition(app.calc.cellCursorRectangle.pX1, app.calc.cellCursorRectangle.pY1);\n\t\t\tapp.calc.cellCursorVisible = true;\n\n\t\t\tapp.sectionContainer.onCellAddressChanged();\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellCursor([app.calc.cellCursorRectangle.pX2, app.calc.cellCursorRectangle.pY2]);\n\t\t}\n\n\t\tvar sameAddress = oldCursorAddress.equals(app.calc.cellAddress.toArray());\n\n\t\tvar isFollowingOwnCursor = parseInt(app.getFollowedViewId()) === parseInt(this._viewId);\n\t\tvar notJump = sameAddress || !isFollowingOwnCursor;\n\t\tvar scrollToCursor = this._sheetSwitch.tryRestore(notJump, this._selectedPart);\n\n\t\tthis._onUpdateCellCursor(scrollToCursor, notJump);\n\n\t\t// Remove input help if there is any:\n\t\tapp.definitions.validityInputHelpSection.removeValidityInputHelp();\n\t},\n\n\t_onDocumentRepair: function (textMsg) {\n\t\tif (!this._docRepair) {\n\t\t\tthis._docRepair = L.control.documentRepair();\n\t\t}\n\n\t\tif (!this._docRepair.isVisible()) {\n\t\t\tthis._docRepair.addTo(this._map);\n\t\t\tthis._docRepair.fillActions(textMsg);\n\t\t\tthis._docRepair.show();\n\t\t}\n\t},\n\n\t_onMousePointerMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring(14); // \"mousepointer: \"\n\t\ttextMsg = Cursor.getCustomCursor(textMsg) || textMsg;\n\t\tvar mapPane = $('.leaflet-pane.leaflet-map-pane');\n\t\tif (mapPane.css('cursor') !== textMsg) {\n\t\t\tmapPane.css('cursor', textMsg);\n\t\t}\n\t},\n\n\t_getFunctionList: function(textMsg) {\n\t\tvar resultList = [];\n\t\tvar suggestionArray = JSON.parse(textMsg);\n\t\tfor (var i = 0; i < suggestionArray.length; i++) {\n\t\t\tvar signature = suggestionArray[i].signature;\n\t\t\tvar namedRange = suggestionArray[i].namedRange;\n\t\t\tvar name, description;\n\t\t\tif (namedRange) {\n\t\t\t\tname = signature;\n\t\t\t\tdescription = _('Named Range');\n\t\t\t} else {\n\t\t\t\tname = signature.substring(0,signature.indexOf('('));\n\t\t\t\tdescription = suggestionArray[i].description;\n\t\t\t}\n\t\t\tresultList.push({'name': name, 'description': description, 'namedRange': namedRange});\n\t\t}\n\t\treturn resultList;\n\t},\n\n\t_onInvalidateCursorMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring('invalidatecursor:'.length + 1);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar recCursor = this._getEditCursorRectangle(obj);\n\t\tif (recCursor === undefined || this.persistCursorPositionInWriter) {\n\t\t\tthis.persistCursorPositionInWriter = false;\n\t\t\treturn;\n\t\t}\n\n\t\t// tells who trigerred cursor invalidation, but recCursors is still \"ours\"\n\t\tvar modifierViewId = parseInt(obj.viewId);\n\t\tvar weAreModifier = (modifierViewId === this._viewId);\n\t\tif (weAreModifier && app.isFollowingOff())\n\t\t\tapp.setFollowingUser(this._viewId);\n\n\t\tthis._cursorAtMispelledWord = obj.mispelledWord ? Boolean(parseInt(obj.mispelledWord)).valueOf() : false;\n\n\t\t// Remember the last position of the caret (in core pixels).\n\t\tthis._cursorPreviousPositionCorePixels = app.file.textCursor.rectangle.clone();\n\n\t\tapp.file.textCursor.rectangle = new app.definitions.simpleRectangle(recCursor.getTopLeft().x, recCursor.getTopLeft().y, recCursor.getSize().x, recCursor.getSize().y);\n\n\t\tif (this._docType === 'text') {\n\t\t\tapp.sectionContainer.onCursorPositionChanged();\n\t\t}\n\n\t\tthis._map.hyperlinkUnderCursor = obj.hyperlink;\n\t\tapp.definitions.urlPopUpSection.closeURLPopUp();\n\t\tif (obj.hyperlink && obj.hyperlink.link)\n\t\t\tapp.definitions.urlPopUpSection.showURLPopUP(obj.hyperlink.link, new app.definitions.simplePoint(app.file.textCursor.rectangle.x1, app.file.textCursor.rectangle.y1));\n\n\t\tif (!this._map.editorHasFocus() && app.file.textCursor.visible && weAreModifier) {\n\t\t\t// Regain cursor if we had been out of focus and now have input.\n\t\t\t// Unless the focus is in the Calc Formula-Bar, don't steal the focus.\n\t\t\tif (!this._map.calcInputBarHasFocus())\n\t\t\t\tthis._map.fire('editorgotfocus');\n\t\t}\n\n\t\t//first time document open, set last cursor position\n\t\tif (!this.lastCursorPos)\n\t\t\tthis.lastCursorPos = app.file.textCursor.rectangle.clone();\n\n\t\tvar updateCursor = false;\n\t\tif (!this.lastCursorPos.equals(app.file.textCursor.rectangle.toArray())) {\n\t\t\tupdateCursor = true;\n\t\t\tthis.lastCursorPos = app.file.textCursor.rectangle.clone();\n\t\t}\n\n\t\t// If modifier view is different than the current view\n\t\t// we'll keep the caret position at the same point relative to screen.\n\t\tthis._onUpdateCursor(\n\t\t\t/* scroll */ updateCursor && weAreModifier,\n\t\t\t/* zoom */ undefined,\n\t\t\t/* keepCaretPositionRelativeToScreen */ !weAreModifier);\n\n\t\t// Only for reference equality comparison.\n\t\tthis._lastVisibleCursorRef = app.file.textCursor.rectangle.clone();\n\t},\n\n\t_updateEditor: function(textMsg) {\n\t\ttextMsg = textMsg.substring('editor:'.length + 1);\n\t\tvar editorId = parseInt(textMsg);\n\t\tvar docLayer = this._map._docLayer;\n\n\t\tdocLayer._editorId = editorId;\n\n\t\tif (app.isFollowingEditor()) {\n\t\t\tapp.setFollowingEditor(editorId);\n\t\t}\n\n\t\tif (this._map._viewInfo[editorId])\n\t\t\tthis._map.fire('updateEditorName', {username: this._map._viewInfo[editorId].username});\n\t},\n\n\t_onInvalidateViewCursorMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('invalidateviewcursor:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst username = this._map._viewInfo[viewId].username;\n\t\tconst mode = obj.mode ? parseInt(obj.mode): 0;\n\n\t\tlet rectangle;\n\t\tif (obj.refpoint) {\n\t\t\tlet refPoint = obj.refpoint.split(',');\n\t\t\trefPoint = new app.definitions.simplePoint(parseInt(refPoint[0]), parseInt(refPoint[1]));\n\n\t\t\tif (this.sheetGeometry) {\n\t\t\t\tthis.sheetGeometry.convertToTileTwips(refPoint);\n\n\t\t\t\trectangle = obj.relrect.split(',');\n\t\t\t\tfor (let i = 0; i < rectangle.length; i++) rectangle[i] = parseInt(rectangle[i]);\n\n\t\t\t\trectangle[0] += refPoint.x;\n\t\t\t\trectangle[1] += refPoint.y;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\trectangle = obj.rectangle.split(',');\n\t\t\tfor (let i = 0; i < rectangle.length; i++) rectangle[i] = parseInt(rectangle[i]);\n\t\t}\n\n\t\tapp.definitions.otherViewCursorSection.addOrUpdateOtherViewCursor(viewId, username, rectangle, parseInt(obj.part), mode);\n\n\t\tif (app.getFollowedViewId() === viewId && (app.isFollowingEditor() || app.isFollowingUser())) {\n\t\t\tif (this._map.getDocType() === 'text' || this._map.getDocType() === 'presentation') {\n\t\t\t\tthis.goToViewCursor(viewId);\n\t\t\t}\n\t\t\telse if (this._map.getDocType() === 'spreadsheet') {\n\t\t\t\tthis.goToCellViewCursor(viewId);\n\t\t\t}\n\t\t}\n\n\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t},\n\n\t_convertRawTwipsToTileTwips: function(strTwips) {\n\t\tif (!strTwips)\n\t\t\treturn null;\n\n\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\tstrTwips = this._convertToTileTwipsSheetArea(new L.Bounds(topLeftTwips, bottomRightTwips)).toRectangle();\n\t\treturn strTwips;\n\t},\n\n\t_onCellViewCursorMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('cellviewcursor:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is same as ours\n\t\tif (viewId === this._viewId) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (obj.rectangle.match('EMPTY'))\n\t\t\tOtherViewCellCursorSection.removeView(viewId);\n\t\telse {\n\t\t\tlet strTwips = obj.rectangle.match(/\\d+/g);\n\t\t\tstrTwips = this._convertRawTwipsToTileTwips(strTwips);\n\n\t\t\tOtherViewCellCursorSection.addOrUpdateOtherViewCellCursor(viewId, this._map.getViewName(viewId), strTwips, parseInt(obj.part));\n\t\t\tCursorHeaderSection.deletePopUpNow(viewId);\n\t\t}\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t\t}\n\t},\n\n\tgoToCellViewCursor: function(viewId) {\n\t\tif (OtherViewCellCursorSection.doesViewCursorExist(viewId)) {\n\t\t\tconst viewCursorSection = OtherViewCellCursorSection.getViewCursorSection(viewId);\n\n\t\t\tif (this._selectedPart !== viewCursorSection.sectionProperties.part)\n\t\t\t\tthis._map.setPart(viewCursorSection.sectionProperties.part);\n\n\t\t\tif (!viewCursorSection.isVisible) {\n\t\t\t\tconst scrollX = viewCursorSection.position[0];\n\t\t\t\tconst scrollY = viewCursorSection.position[1];\n\t\t\t\tthis.scrollToPos(new app.definitions.simplePoint(scrollX * app.pixelsToTwips, scrollY * app.pixelsToTwips));\n\t\t\t}\n\n\t\t\tOtherViewCellCursorSection.showPopUpForView(viewId);\n\t\t}\n\t},\n\n\t_onViewCursorVisibleMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('viewcursorvisible:'.length + 1);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar viewId = parseInt(obj.viewId);\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst section = app.definitions.otherViewCursorSection.getViewCursorSection(viewId);\n\t\tif (section) {\n\t\t\tconst showCursor = obj.visible === 'true';\n\t\t\tsection.sectionProperties.showCursor = showCursor;\n\t\t\tsection.setShowSection(showCursor);\n\t\t}\n\t},\n\n\t_addView: function(viewInfo) {\n\t\tif (viewInfo.color === 0 && this._map.getDocType() !== 'text') {\n\t\t\tviewInfo.color = app.LOUtil.getViewIdColor(viewInfo.id);\n\t\t}\n\n\t\tthis._map.addView(viewInfo);\n\t},\n\n\t_removeView: function(viewId) {\n\t\t// Remove selection, if any.\n\t\tif (this._viewSelections[viewId]) {\n\t\t\tif (this._viewSelections[viewId].selection) {\n\t\t\t\tthis._viewSelections[viewId].selection.remove();\n\t\t\t\tthis._viewSelections[viewId].selection = undefined;\n\t\t\t}\n\t\t\tdelete this._viewSelections[viewId];\n\t\t}\n\n\t\tapp.definitions.otherViewCursorSection.removeView(viewId);\n\n\t\tOtherViewCellCursorSection.removeView(viewId);\n\t\tapp.definitions.otherViewGraphicSelectionSection.removeView(viewId);\n\t\tthis._map.removeView(viewId);\n\t},\n\n\tremoveAllViews: function() {\n\t\tfor (var viewInfoIdx in this._map._viewInfo) {\n\t\t\tthis._removeView(parseInt(viewInfoIdx));\n\t\t}\n\t},\n\n\t_onViewInfoMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('viewinfo: '.length);\n\t\tvar viewInfo = JSON.parse(textMsg);\n\t\tthis._map.fire('viewinfo', viewInfo);\n\n\t\t// A new view\n\t\tvar viewIds = [];\n\t\tfor (var viewInfoIdx in viewInfo) {\n\t\t\tif (!(parseInt(viewInfo[viewInfoIdx].id) in this._map._viewInfo)) {\n\t\t\t\tthis._addView(viewInfo[viewInfoIdx]);\n\t\t\t}\n\t\t\tviewIds.push(viewInfo[viewInfoIdx].id);\n\t\t}\n\n\t\t// Check if any view is deleted\n\t\tfor (viewInfoIdx in this._map._viewInfo) {\n\t\t\tif (viewIds.indexOf(parseInt(viewInfoIdx)) === -1) {\n\t\t\t\tthis._removeView(parseInt(viewInfoIdx));\n\t\t\t}\n\t\t}\n\n\t\t// Sending postMessage about View_Added / View_Removed is\n\t\t// deprecated, going forward we prefer sending the entire information.\n\t\tthis._map.fire('updateviewslist');\n\t},\n\n\t_onRenderFontMsg: function (textMsg, img) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\t\tthis._map.fire('renderfont', {\n\t\t\tfont: command.font,\n\t\t\tchar: command.char,\n\t\t\timg: img\n\t\t});\n\t},\n\n\t_onSearchNotFoundMsg: function (textMsg) {\n\t\tthis._clearSearchResults();\n\t\tvar originalPhrase = textMsg.substring(16);\n\t\tthis._map.fire('search', {originalPhrase: originalPhrase, count: 0});\n\t},\n\n\t_getSearchResultRectangles: function (obj, results) {\n\t\tfor (var i = 0; i < obj.searchResultSelection.length; i++) {\n\t\t\tresults.push({\n\t\t\t\tpart: parseInt(obj.searchResultSelection[i].part),\n\t\t\t\trectangles: this._twipsRectanglesToPixelBounds(obj.searchResultSelection[i].rectangles),\n\t\t\t\ttwipsRectangles: obj.searchResultSelection[i].rectangles\n\t\t\t});\n\t\t}\n\t},\n\n\t_getSearchResultRectanglesFileBasedView: function (obj, results) {\n\t\tvar additionPerPart = this._partHeightTwips + this._spaceBetweenParts;\n\n\t\tfor (var i = 0; i < obj.searchResultSelection.length; i++) {\n\t\t\tvar rectangles = obj.searchResultSelection[i].rectangles;\n\t\t\tvar part = parseInt(obj.searchResultSelection[i].part);\n\t\t\trectangles = rectangles.split(',');\n\t\t\trectangles = rectangles.map(function(element, index) {\n\t\t\t\telement = parseInt(element);\n\t\t\t\tif (index < 2)\n\t\t\t\t\telement += additionPerPart * part;\n\t\t\t\treturn element;\n\t\t\t});\n\n\t\t\trectangles = String(rectangles[0]) + ', ' + String(rectangles[1]) + ', ' + String(rectangles[2]) + ', ' + String(rectangles[3]);\n\n\t\t\tresults.push({\n\t\t\t\tpart: parseInt(obj.searchResultSelection[i].part),\n\t\t\t\trectangles: this._twipsRectanglesToPixelBounds(rectangles),\n\t\t\t\ttwipsRectangles: rectangles\n\t\t\t});\n\t\t}\n\t},\n\n\t_onSearchResultSelection: function (textMsg) {\n\t\ttextMsg = textMsg.substring(23);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar originalPhrase = obj.searchString;\n\t\tvar count = obj.searchResultSelection.length;\n\t\tvar highlightAll = obj.highlightAll;\n\t\tvar results = [];\n\n\t\tif (!app.file.fileBasedView)\n\t\t\tthis._getSearchResultRectangles(obj, results);\n\t\telse\n\t\t\tthis._getSearchResultRectanglesFileBasedView(obj, results);\n\n\t\t// do not cache search results if there is only one result.\n\t\t// this way regular searches works fine\n\t\tif (count > 1)\n\t\t{\n\t\t\tthis._clearSearchResults();\n\t\t\tthis._searchResults = results;\n\t\t\tif (!app.file.fileBasedView)\n\t\t\t\tthis._map.setPart(results[0].part); // go to first result.\n\t\t\telse\n\t\t\t\tthis._map._docLayer._preview._scrollViewToPartPosition(results[0].part);\n\t\t} else if (count === 1) {\n\t\t\tthis._lastSearchResult = results[0];\n\t\t}\n\t\tthis._searchTerm = originalPhrase;\n\t\tthis._map.fire('search', {originalPhrase: originalPhrase, count: count, highlightAll: highlightAll, results: results});\n\n\t\tapp.setFollowingUser(this._viewId);\n\n\t\t// always jump to search result - we already received cell / text cursor before so we need\n\t\t// to force it in case we had following OFF\n\t\tif (app.file.textCursor.visible)\n\t\t\tthis._onUpdateCursor(/* scroll */ true);\n\t\telse if (app.calc.cellCursorVisible)\n\t\t\tthis._onUpdateCellCursor(/* scroll */ true);\n\t},\n\n\t_clearSearchResults: function() {\n\t\tif (this._searchTerm) {\n\t\t\tthis._textCSelections.clear();\n\t\t}\n\t\tthis._lastSearchResult = null;\n\t\tthis._searchResults = null;\n\t\tthis._searchTerm = null;\n\t\tthis._searchResultsLayer.clearLayers();\n\t},\n\n\t_onStateChangedMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substr(14);\n\n\t\tvar isPureJSON = textMsg.indexOf('=') === -1 && textMsg.indexOf('{') !== -1;\n\t\tif (isPureJSON) {\n\t\t\tvar json = JSON.parse(textMsg);\n\t\t\t// json.state as empty string is fine, for example it means no selection\n\t\t\t// when json.commandName is '.uno:RowColSelCount'.\n\t\t\tif (json.commandName && json.state !== undefined) {\n\t\t\t\tthis._map.fire('commandstatechanged', json);\n\t\t\t}\n\t\t} else {\n\t\t\tvar index = textMsg.indexOf('=');\n\t\t\tvar commandName = index !== -1 ? textMsg.substr(0, index) : '';\n\t\t\tvar state = index !== -1 ? textMsg.substr(index + 1) : '';\n\t\t\tthis._map.fire('commandstatechanged', {commandName : commandName, state : state});\n\t\t}\n\t},\n\n\t_onUnoCommandResultMsg: function (textMsg) {\n\t\t// window.app.console.log('_onUnoCommandResultMsg: \"' + textMsg + '\"');\n\t\ttextMsg = textMsg.substring(18);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tvar commandName = obj.commandName;\n\t\tif (obj.success === 'true' || obj.success === true) {\n\t\t\tvar success = true;\n\t\t}\n\t\telse if (obj.success === 'false' || obj.success === false) {\n\t\t\tsuccess = false;\n\t\t}\n\n\t\tthis._map.hideBusy();\n\t\tthis._map.fire('commandresult', {commandName: commandName, success: success, result: obj.result});\n\n\t\tif (this._map.CallPythonScriptSource != null) {\n\t\t\tthis._map.CallPythonScriptSource.postMessage(JSON.stringify({'MessageId': 'CallPythonScript-Result',\n\t\t\t\t\t\t\t\t\t\t     'SendTime': Date.now(),\n\t\t\t\t\t\t\t\t\t\t     'Values': obj\n\t\t\t\t\t\t\t\t\t\t    }),\n\t\t\t\t\t\t\t\t     '*');\n\t\t\tthis._map.CallPythonScriptSource = null;\n\t\t}\n\t},\n\n\t_onRulerUpdate: function (textMsg) {\n\t\tvar horizontalRuler = true;\n\t\tif(textMsg.startsWith('vrulerupdate:')) {\n\t\t\thorizontalRuler = false;\n\t\t}\n\t\ttextMsg = textMsg.substring(13);\n\t\tvar obj = JSON.parse(textMsg);\n\t\tif (!horizontalRuler) {\n\t\t\tthis._map.fire('vrulerupdate', obj);\n\t\t}\n\t\telse {\n\t\t\tthis._map.fire('rulerupdate', obj);\n\t\t}\n\t},\n\n\t_onContextMenuMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring(13);\n\t\tvar obj = JSON.parse(textMsg);\n\n\t\tthis._map.fire('locontextmenu', obj);\n\t},\n\n\t_onTextSelectionMsg: function (textMsg) {\n\n\t\tvar rectArray = this._getTextSelectionRectangles(textMsg);\n\t\tvar inTextSearch = $('input#search-input').is(':focus');\n\t\tvar isTextSelection = app.file.textCursor.visible || inTextSearch;\n\t\tif (rectArray.length) {\n\n\t\t\tvar rectangles = rectArray.map(function (rect) {\n\t\t\t\treturn rect.getPointArray();\n\t\t\t});\n\n\t\t\tif (app.file.fileBasedView && this._lastSearchResult) {\n\t\t\t\t// We rely on that _lastSearchResult has been updated before this function is called.\n\t\t\t\tvar additionPerPart = this._partHeightTwips + this._spaceBetweenParts;\n\t\t\t\tfor (var i = 0; i < rectangles.length; i++) {\n\t\t\t\t\tfor (var j = 0; j < rectangles[i].length; j++) {\n\t\t\t\t\t\trectangles[i][j].y += additionPerPart * this._lastSearchResult.part;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._map._docLayer._preview._scrollViewToPartPosition(this._lastSearchResult.part);\n\t\t\t\tTileManager.updateFileBasedView();\n\t\t\t\tsetTimeout(function () {app.sectionContainer.requestReDraw();}, 100);\n\t\t\t}\n\n\t\t\tvar docLayer = this;\n\t\t\tvar pointSet = CPolyUtil.rectanglesToPointSet(rectangles,\n\t\t\t\tfunction (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\n\t\t\tif (isTextSelection)\n\t\t\t\tthis._textCSelections.setPointSet(pointSet);\n\t\t\telse\n\t\t\t\tthis._cellCSelections.setPointSet(pointSet);\n\n\t\t\tthis._map.removeLayer(this._map._textInput._cursorHandler); // User selected a text, we remove the carret marker.\n\t\t\tif (L.Browser.clipboardApiAvailable) {\n\t\t\t\t// Just set the selection type, no fetch of the content.\n\t\t\t\tthis._map._clip.setTextSelectionType('text');\n\t\t\t} else {\n\t\t\t\t// Trigger fetching the selection content, we already need to have\n\t\t\t\t// it locally by the time 'copy' is executed.\n\t\t\t\tif (this._selectionContentRequest) {\n\t\t\t\t\tclearTimeout(this._selectionContentRequest);\n\t\t\t\t}\n\t\t\t\tthis._selectionContentRequest = setTimeout(L.bind(function () {\n\t\t\t\t\tapp.socket.sendMessage('gettextselection mimetype=text/html,text/plain;charset=utf-8');}, this), 100);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis._selectionHandles.start.setShowSection(false);\n\t\t\tthis._selectionHandles.end.setShowSection(false);\n\t\t\tthis._selectionHandles.active = false;\n\n\t\t\tthis._textCSelections.clear();\n\t\t\tthis._cellCSelections.clear();\n\t\t\tif (this._map._clip && this._map._clip._selectionType === 'complex')\n\t\t\t\tthis._map._clip.clearSelection();\n\t\t}\n\n\t\tthis._onUpdateTextSelection();\n\t},\n\n\t_onTextViewSelectionMsg: function (textMsg) {\n\t\tvar obj = JSON.parse(textMsg.substring('textviewselection:'.length + 1));\n\t\tvar viewId = parseInt(obj.viewId);\n\t\tvar viewPart = parseInt(obj.part);\n\t\tvar viewMode = (obj.mode !== undefined) ? parseInt(obj.mode) : 0;\n\n\t\t// Ignore if viewid is same as ours or not in our db\n\t\tif (viewId === this._viewId || !this._map._viewInfo[viewId]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar rectArray = this._getTextSelectionRectangles(obj.selection);\n\t\tthis._viewSelections[viewId] = this._viewSelections[viewId] || {};\n\n\t\tif (rectArray.length) {\n\n\t\t\tvar rectangles = rectArray.map(function (rect) {\n\t\t\t\treturn rect.getPointArray();\n\t\t\t});\n\n\t\t\tthis._viewSelections[viewId].part = viewPart;\n\t\t\tthis._viewSelections[viewId].mode = viewMode;\n\t\t\tvar docLayer = this;\n\t\t\tthis._viewSelections[viewId].pointSet = CPolyUtil.rectanglesToPointSet(rectangles,\n\t\t\t\tfunction (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis._viewSelections[viewId].pointSet = new CPointSet();\n\t\t}\n\n\t\tthis._onUpdateTextViewSelection(viewId);\n\n\t\tthis._saveMessageForReplay(textMsg, viewId);\n\t},\n\n\t_updateReferenceMarks: function() {\n\t\tthis._clearReferences();\n\n\t\tif (!this._referencesAll)\n\t\t\treturn;\n\n\t\tfor (var i = 0; i < this._referencesAll.length; i++) {\n\t\t\t// Avoid doubled marks, add only marks for current sheet\n\t\t\tif (!this._references.hasMark(this._referencesAll[i].mark)\n\t\t\t\t&& this._selectedPart === this._referencesAll[i].part) {\n\t\t\t\tthis._references.addMark(this._referencesAll[i].mark);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onReferencesMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substr(textMsg.indexOf(' ') + 1);\n\t\tvar marks = JSON.parse(textMsg);\n\t\tmarks = marks.marks;\n\t\tvar references = [];\n\t\tthis._referencesAll = [];\n\n\t\tfor (var mark = 0; mark < marks.length; mark++) {\n\t\t\tvar strTwips = marks[mark].rectangle.match(/\\d+/g);\n\t\t\tvar strColor = marks[mark].color;\n\t\t\tvar part = parseInt(marks[mark].part);\n\n\t\t\tif (strTwips != null) {\n\t\t\t\tvar rectangles = [];\n\t\t\t\tfor (var i = 0; i < strTwips.length; i += 4) {\n\t\t\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[i]), parseInt(strTwips[i + 1]));\n\t\t\t\t\tvar offset = new L.Point(parseInt(strTwips[i + 2]), parseInt(strTwips[i + 3]));\n\t\t\t\t\tvar boundsTwips = this._convertToTileTwipsSheetArea(\n\t\t\t\t\t\tnew L.Bounds(topLeftTwips, topLeftTwips.add(offset)));\n\t\t\t\t\trectangles.push([boundsTwips.getBottomLeft(), boundsTwips.getBottomRight(),\n\t\t\t\t\t\tboundsTwips.getTopLeft(), boundsTwips.getTopRight()]);\n\t\t\t\t}\n\n\t\t\t\tvar docLayer = this;\n\t\t\t\tvar pointSet = CPolyUtil.rectanglesToPointSet(rectangles, function (twipsPoint) {\n\t\t\t\t\tvar corePxPt = docLayer._twipsToCorePixels(twipsPoint);\n\t\t\t\t\tcorePxPt.round();\n\t\t\t\t\treturn corePxPt;\n\t\t\t\t});\n\t\t\t\tvar reference = new CPolygon(pointSet, {\n\t\t\t\t\tpointerEvents: 'none',\n\t\t\t\t\tfillColor: '#' + strColor,\n\t\t\t\t\tfillOpacity: 0.25,\n\t\t\t\t\tweight: 2 * app.dpiScale,\n\t\t\t\t\topacity: 0.25});\n\n\t\t\t\treferences.push({mark: reference, part: part});\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < references.length; i++) {\n\t\t\tthis._referencesAll.push(references[i]);\n\t\t}\n\n\t\tthis._updateReferenceMarks();\n\t},\n\n\t_getStringPart: function (string) {\n\t\tvar code = '';\n\t\tvar i = 0;\n\t\twhile (i < string.length) {\n\t\t\tif (string.charCodeAt(i) < 48 || string.charCodeAt(i) > 57) {\n\t\t\t\tcode += string.charAt(i);\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn code;\n\t},\n\n\t_getNumberPart: function (string) {\n\t\tvar number = '';\n\t\tvar i = 0;\n\t\twhile (i < string.length) {\n\t\t\tif (string.charCodeAt(i) >= 48 && string.charCodeAt(i) <= 57) {\n\t\t\t\tnumber += string.charAt(i);\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn parseInt(number);\n\t},\n\n\t_isWholeColumnSelected: function (cellAddress) {\n\t\tif (!cellAddress)\n\t\t\tcellAddress = document.querySelector('#addressInput input').value;\n\n\t\tvar startEnd = cellAddress.split(':');\n\t\tif (startEnd.length === 1)\n\t\t\treturn false; // Selection is not a range.\n\n\t\tvar rangeStart = this._getNumberPart(startEnd[0]);\n\t\tif (rangeStart !== 1)\n\t\t\treturn false; // Selection doesn't start at first row.\n\n\t\tvar rangeEnd = this._getNumberPart(startEnd[1]);\n\t\tif (rangeEnd === 1048576) // Last row's number.\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t},\n\n\t_isWholeRowSelected: function (cellAddress) {\n\t\tif (!cellAddress)\n\t\t\tcellAddress = document.querySelector('#addressInput input').value;\n\n\t\tvar startEnd = cellAddress.split(':');\n\t\tif (startEnd.length === 1)\n\t\t\treturn false; // Selection is not a range.\n\n\t\tvar rangeStart = this._getStringPart(startEnd[0]);\n\t\tif (rangeStart !== 'A')\n\t\t\treturn false; // Selection doesn't start at first column.\n\n\t\tvar rangeEnd = this._getStringPart(startEnd[1]);\n\t\tif (rangeEnd === 'XFD') // Last column's code.\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t},\n\n\t_updateScrollOnCellSelection: function (oldSelection, newSelection) {\n\t\tif (this.isCalc() && oldSelection) {\n\t\t\tif (!app.file.viewedRectangle.containsRectangle(newSelection.toArray()) && !newSelection.equals(oldSelection.toArray())) {\n\t\t\t\tvar spacingX = Math.abs(app.calc.cellCursorRectangle.pWidth) / 4.0;\n\t\t\t\tvar spacingY = Math.abs(app.calc.cellCursorRectangle.pHeight) / 2.0;\n\n\t\t\t\tvar scrollX = 0, scrollY = 0;\n\t\t\t\tif (newSelection.pX2 > app.file.viewedRectangle.pX2 && newSelection.pX2 > oldSelection.pX2)\n\t\t\t\t\tscrollX = newSelection.pX2 - app.file.viewedRectangle.pX2 + spacingX;\n\t\t\t\telse if (newSelection.pX1 < app.file.viewedRectangle.pX1 && newSelection.pX1 < oldSelection.pX1)\n\t\t\t\t\tscrollX = newSelection.pX1 - app.file.viewedRectangle.pX1 - spacingX;\n\t\t\t\tif (newSelection.pY2 > app.file.viewedRectangle.pY2 && newSelection.pY2 > oldSelection.pY2)\n\t\t\t\t\tscrollY = newSelection.pY2 - app.file.viewedRectangle.pY2 + spacingY;\n\t\t\t\telse if (newSelection.pY1 < app.file.viewedRectangle.pY1 && newSelection.pY1 < oldSelection.pY1)\n\t\t\t\t\tscrollY = newSelection.pY1 - app.file.viewedRectangle.pY1 - spacingY;\n\t\t\t\tif (scrollX !== 0 || scrollY !== 0) {\n\t\t\t\t\tif (!this._map.wholeColumnSelected && !this._map.wholeRowSelected) {\n\t\t\t\t\t\tvar address = document.querySelector('#addressInput input').value;\n\t\t\t\t\t\tif (!this._isWholeColumnSelected(address) && !this._isWholeRowSelected(address)) {\n\t\t\t\t\t\t\tlet scroll = new app.definitions.simplePoint(0,0);\n\t\t\t\t\t\t\tscroll.pX = scrollX;\n\t\t\t\t\t\t\tscroll.pY = scrollY;\n\t\t\t\t\t\t\tthis.scrollByPoint(scroll);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTextSelectionEndMsg: function (textMsg) {\n\t\tvar rectangles = this._getTextSelectionRectangles(textMsg);\n\n\t\tif (rectangles.length) {\n\t\t\tvar topLeftTwips = rectangles[0].getTopLeft();\n\t\t\tvar bottomRightTwips = rectangles[0].getBottomRight();\n\t\t\tvar oldSelection = this._selectionHandles.end.rectangle ? this._selectionHandles.end.rectangle.clone(): null;\n\n\t\t\tthis._selectionHandles.end.rectangle = new app.definitions.simpleRectangle(topLeftTwips.x, topLeftTwips.y, (bottomRightTwips.x - topLeftTwips.x), (bottomRightTwips.y - topLeftTwips.y));\n\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._selectionHandles.end.rectangle);\n\t\t\tthis._selectionHandles.end.setShowSection(true);\n\t\t\tthis._updateMarkers();\n\t\t}\n\t\telse {\n\t\t\tthis._selectionHandles.end.rectangle = null;\n\t\t}\n\t},\n\n\t_onTextSelectionStartMsg: function (textMsg) {\n\t\tvar rectangles = this._getTextSelectionRectangles(textMsg);\n\n\t\tif (rectangles.length) {\n\t\t\tvar topLeftTwips = rectangles[0].getTopLeft();\n\t\t\tvar bottomRightTwips = rectangles[0].getBottomRight();\n\t\t\tlet oldSelection = this._selectionHandles.start.rectangle ? this._selectionHandles.start.rectangle.clone(): null;\n\t\t\t//FIXME: The selection is really not two points, as they can be\n\t\t\t//FIXME: on top of each other, but on separate lines. We should\n\t\t\t//FIXME: capture the whole area in _onTextSelectionMsg.\n\t\t\tthis._selectionHandles.start.rectangle = new app.definitions.simpleRectangle(topLeftTwips.x, topLeftTwips.y, (bottomRightTwips.x - topLeftTwips.x), (bottomRightTwips.y - topLeftTwips.y));\n\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._selectionHandles.start.rectangle);\n\n\t\t\tthis._selectionHandles.start.setShowSection(true);\n\t\t\tthis._selectionHandles.active = true;\n\t\t}\n\t\telse {\n\t\t\tthis._selectionHandles.start.rectangle = null;\n\t\t}\n\t},\n\n\t_refreshRowColumnHeaders: function () {\n\t\tif (app.sectionContainer.doesSectionExist(L.CSections.RowHeader.name))\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.RowHeader.name)._updateCanvas();\n\t\tif (app.sectionContainer.doesSectionExist(L.CSections.ColumnHeader.name))\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.ColumnHeader.name)._updateCanvas();\n\t},\n\n\t_onCellSelectionAreaMsg: function (textMsg) {\n\t\tvar autofillMarkerSection = app.sectionContainer.getSectionWithName(L.CSections.AutoFillMarker.name);\n\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\tif (strTwips != null) {\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\t\t\tvar bottomRightTwips = topLeftTwips.add(offset);\n\t\t\tvar boundsTwips = this._convertToTileTwipsSheetArea(new L.Bounds(topLeftTwips, bottomRightTwips));\n\n\t\t\tvar oldSelection = this._cellSelectionArea ? this._cellSelectionArea.clone(): null;\n\t\t\tconst adjustedTwipsWidth = boundsTwips.max.x - boundsTwips.min.x;\n\t\t\tconst adjustedTwipsHeight = boundsTwips.max.y - boundsTwips.min.y;\n\t\t\tthis._cellSelectionArea = new app.definitions.simpleRectangle(boundsTwips.min.x, boundsTwips.min.y, adjustedTwipsWidth, adjustedTwipsHeight);\n\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellSelection([this._cellSelectionArea.pX2, this._cellSelectionArea.pY2]);\n\n\t\t\tthis._updateScrollOnCellSelection(oldSelection, this._cellSelectionArea);\n\t\t} else {\n\t\t\tthis._cellSelectionArea = null;\n\t\t\tif (autofillMarkerSection)\n\t\t\t\tautofillMarkerSection.calculatePositionViaCellSelection(null);\n\t\t\tthis._cellSelections = Array(0);\n\t\t\tthis._map.wholeColumnSelected = false; // Message related to whole column/row selection should be on the way, we should update the variables now.\n\t\t\tthis._map.wholeRowSelected = false;\n\t\t\tif (this._refreshRowColumnHeaders)\n\t\t\t\tthis._refreshRowColumnHeaders();\n\t\t}\n\t},\n\n\t_onCellAutoFillAreaMsg: function (textMsg) {\n\t\tvar strTwips = textMsg.match(/\\d+/g);\n\t\tif (strTwips != null && this._map.isEditMode()) {\n\t\t\tvar topLeftTwips = new L.Point(parseInt(strTwips[0]), parseInt(strTwips[1]));\n\t\t\tvar offset = new L.Point(parseInt(strTwips[2]), parseInt(strTwips[3]));\n\n\t\t\tvar topLeftPixels = this._twipsToCorePixels(topLeftTwips);\n\t\t\tvar offsetPixels = this._twipsToCorePixels(offset);\n\t\t\tthis._cellAutoFillAreaPixels = app.LOUtil.createRectangle(topLeftPixels.x, topLeftPixels.y, offsetPixels.x, offsetPixels.y);\n\t\t}\n\t\telse {\n\t\t\tthis._cellAutoFillAreaPixels = null;\n\t\t}\n\t},\n\n\t_onDialogPaintMsg: function(textMsg, img) {\n\t\tvar command = app.socket.parseServerCmd(textMsg);\n\n\t\t// app.socket.sendMessage('DEBUG _onDialogPaintMsg: hash=' + command.hash + ' img=' + typeof(img) + (typeof(img) == 'string' ? (' (length:' + img.length + ':\"' + img.substring(0, 30) + (img.length > 30 ? '...' : '') + '\")') : '') + ', cache size ' + this._pngCache.length);\n\t\tif (command.nopng) {\n\t\t\tvar found = false;\n\t\t\tfor (var i = 0; i < this._pngCache.length; i++) {\n\t\t\t\tif (this._pngCache[i].hash == command.hash) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\t// app.socket.sendMessage('DEBUG - Found in cache');\n\t\t\t\t\timg = this._pngCache[i].img;\n\t\t\t\t\t// Remove item (and add it below at the start of the array)\n\t\t\t\t\tthis._pngCache.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found) {\n\t\t\t\tvar message = 'windowpaint: message assumed PNG for hash ' + command.hash\n\t\t\t\t    + ' is cached here in the client but not found';\n\t\t\t\tif (L.Browser.cypressTest)\n\t\t\t\t\tthrow new Error(message);\n\t\t\t\tapp.socket.sendMessage('ERROR ' + message);\n\t\t\t\t// Not sure what to do. Ask the server to re-send the windowpaint: message but this time including the PNG?\n\t\t\t}\n\t\t} else {\n\t\t\t// Sanity check: If we get a PNG it should be for a hash that we don't have cached\n\t\t\tfor (i = 0; i < this._pngCache.length; i++) {\n\t\t\t\tif (this._pngCache[i].hash == command.hash) {\n\t\t\t\t\tmessage = 'windowpaint: message included PNG for hash ' + command.hash\n\t\t\t\t\t    + ' even if it was already cached here in the client';\n\t\t\t\t\tif (L.Browser.cypressTest)\n\t\t\t\t\t\tthrow new Error(message);\n\t\t\t\t\tapp.socket.sendMessage('ERROR ' + message);\n\t\t\t\t\t// Remove the extra copy, code below will add it at the start of the array\n\t\t\t\t\tthis._pngCache.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If cache is max size, drop the last element\n\t\tif (this._pngCache.length == app.socket.TunnelledDialogImageCacheSize) {\n\t\t\t// app.socket.sendMessage('DEBUG - Dropping last cache element');\n\t\t\tthis._pngCache.pop();\n\t\t}\n\n\t\t// Add element to cache\n\t\tthis._pngCache.unshift({hash: command.hash, img:img});\n\n\t\t// app.socket.sendMessage('DEBUG - Cache size now ' + this._pngCache.length);\n\n\t\tthis._map.fire('windowpaint', {\n\t\t\tid: command.id,\n\t\t\timg: img,\n\t\t\twidth: command.width,\n\t\t\theight: command.height,\n\t\t\trectangle: command.rectangle,\n\t\t\thash: command.hash\n\t\t});\n\t},\n\n\t_onDialogMsg: function(textMsg) {\n\t\ttextMsg = textMsg.substring('window: '.length);\n\t\tvar dialogMsg = JSON.parse(textMsg);\n\t\t// e.type refers to signal type\n\t\tdialogMsg.winType = dialogMsg.type;\n\t\tthis._map.fire('window', dialogMsg);\n\t},\n\n\t_mapOnError: function (e) {\n\t\tif (e.msg && this._map.isEditMode() && e.critical !== false) {\n\t\t\tthis._map.setPermission('view');\n\t\t}\n\t},\n\n\t_clearSelections: function (calledFromSetPartHandler) {\n\t\t// hide the cursor if not editable\n\t\tthis._onUpdateCursor(calledFromSetPartHandler);\n\t\t// hide the text selection\n\t\tthis._textCSelections.clear();\n\t\t// hide the cell selection\n\t\tthis._cellCSelections.clear();\n\t\t// hide the ole selection\n\t\tthis._oleCSelections.clear();\n\t\t// hide the selection handles\n\t\tthis._onUpdateTextSelection();\n\n\t\tthis._onUpdateCellCursor();\n\t\tif (this._map._clip)\n\t\t\tthis._map._clip.clearSelection();\n\t\telse\n\t\t\tthis._selectedTextContent = '';\n\t},\n\n\tcontainsSelection: function (latlng) {\n\t\tvar corepxPoint = this._map.project(latlng);\n\t\treturn this._textCSelections.empty() ?\n\t\t\tthis._cellCSelections.contains(corepxPoint) :\n\t\t\tthis._textCSelections.contains(corepxPoint);\n\t},\n\n\t_clearReferences: function () {\n\t\tthis._references.clear();\n\t},\n\n\t_resetReferencesMarks: function (type) {\n\t\tthis._clearReferences();\n\n        if (type === undefined)\n\t\t    this._referencesAll = [];\n        else if (type === 'focuscell')\n            this._referencesAll = this._referencesAll.filter(function(e) { return e.type !== 'focuscell' });\n\n\t\tthis._updateReferenceMarks();\n\t},\n\n\t_postMouseEvent: function(type, x, y, count, buttons, modifier) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tif (this._map.calcInputBarHasFocus() && type === 'move') {\n\t\t\t// When the Formula-bar has the focus, sending\n\t\t\t// mouse move with the document coordinates\n\t\t\t// hides the cursor (lost focus?). This is clearly\n\t\t\t// a bug in Core, but we need to work around it\n\t\t\t// until fixed. Just don't send mouse move.\n\t\t\treturn;\n\t\t}\n\n\t\tconst verticalOffset = this.getFiledBasedViewVerticalOffset();\n\t\tif (verticalOffset) {\n\t\t\ty -= verticalOffset;\n\t\t}\n\n\t\tapp.socket.sendMessage('mouse type=' + type +\n\t\t\t\t' x=' + x + ' y=' + y + ' count=' + count +\n\t\t\t\t' buttons=' + buttons + ' modifier=' + modifier);\n\n\n\t\tif (type === 'buttondown')\n\t\t\tthis._clearSearchResults();\n\n\t\tif (this._map && this._map._docLayer && (type === 'buttondown' || type === 'buttonup'))\n\t\t\tthis._map.userList.followUser(this._map._docLayer._getViewId(), false);\n\t},\n\n\t// If viewing multi-page PDF files, get the twips offset of the current part. This is\n\t// needed, because core has multiple draw pages in such a case, but we have just one canvas.\n\tgetFiledBasedViewVerticalOffset: function() {\n\t\tif (!app.file.fileBasedView) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst additionPerPart = this._partHeightTwips + this._spaceBetweenParts;\n\t\tconst verticalOffset = additionPerPart * this._selectedPart;\n\n\t\treturn verticalOffset;\n\t},\n\n\t// If viewing multi-page PDF files, no precise tracking of invalidations is implemented yet,\n\t// so this allows requesting new tiles when we know a viewed PDF changes for some special\n\t// reason.\n\trequestNewFiledBasedViewTiles: function() {\n\t\tif (!app.file.fileBasedView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._requestNewTiles();\n\t\tTileManager.redraw();\n\t},\n\n\t// Given a character code and a UNO keycode, send a \"key\" message to coolwsd.\n\t//\n\t// \"type\" is either \"input\" for key presses (akin to the DOM \"keypress\"\n\t// / \"beforeinput\" events) and \"up\" for key releases (akin to the DOM\n\t// \"keyup\" event).\n\t//\n\t// PageUp/PageDown and select column & row are handled as special cases for spreadsheets - in\n\t// addition of sending messages to coolwsd, they move the cell cursor around.\n\tpostKeyboardEvent: function(type, charCode, unoKeyCode) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tif (L.Browser.mac) {\n\t\t\t// Map Mac standard shortcuts to the LO shortcuts for the corresponding\n\t\t\t// functions when possible. Note that the Cmd modifier comes here as CTRL.\n\n\t\t\t// Cmd+UpArrow -> Ctrl+Home\n\t\t\tif (unoKeyCode == UNOKey.UP + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.HOME + UNOModifier.CTRL;\n\t\t\t// Cmd+DownArrow -> Ctrl+End\n\t\t\telse if (unoKeyCode == UNOKey.DOWN + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.END + UNOModifier.CTRL;\n\t\t\t// Cmd+LeftArrow -> Home\n\t\t\telse if (unoKeyCode == UNOKey.LEFT + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.HOME;\n\t\t\t// Cmd+RightArrow -> End\n\t\t\telse if (unoKeyCode == UNOKey.RIGHT + UNOModifier.CTRL)\n\t\t\t\tunoKeyCode = UNOKey.END;\n\t\t\t// Option+LeftArrow -> Ctrl+LeftArrow\n\t\t\telse if (unoKeyCode == UNOKey.LEFT + UNOModifier.ALT)\n\t\t\t\tunoKeyCode = UNOKey.LEFT + UNOModifier.CTRL;\n\t\t\t// Option+RightArrow -> Ctrl+RightArrow (Not entirely equivalent, should go\n\t\t\t// to end of word (or next), LO goes to beginning of next word.)\n\t\t\telse if (unoKeyCode == UNOKey.RIGHT + UNOModifier.ALT)\n\t\t\t\tunoKeyCode = UNOKey.RIGHT + UNOModifier.CTRL;\n\t\t}\n\n\t\tvar completeEvent = app.socket.createCompleteTraceEvent('L.TileSectionManager.postKeyboardEvent', { type: type, charCode: charCode });\n\n\t\tvar winId = this._map.getWinId();\n\t\tif (\n\t\t\tthis.isCalc() &&\n\t\t\ttype === 'input' &&\n\t\t\twinId === 0\n\t\t) {\n\t\t\tif (unoKeyCode === UNOKey.SPACE + UNOModifier.CTRL) { // Select whole column.\n\t\t\t\tthis._map.wholeColumnSelected = true;\n\t\t\t}\n\t\t\telse if (unoKeyCode === UNOKey.SPACE + UNOModifier.SHIFT) { // Select whole row.\n\t\t\t\tthis._map.wholeRowSelected = true;\n\t\t\t}\n\t\t}\n\n\t\tif (winId === 0) {\n\t\t\tapp.socket.sendMessage(\n\t\t\t\t'key' +\n\t\t\t\t' type=' + type +\n\t\t\t\t' char=' + charCode +\n\t\t\t\t' key=' + unoKeyCode +\n\t\t\t\t'\\n'\n\t\t\t);\n\t\t} else {\n\t\t\tapp.socket.sendMessage(\n\t\t\t\t'windowkey id=' + winId +\n\t\t\t\t' type=' + type +\n\t\t\t\t' char=' + charCode +\n\t\t\t\t' key=' + unoKeyCode +\n\t\t\t\t'\\n'\n\t\t\t);\n\t\t}\n\t\tif (completeEvent)\n\t\t\tcompleteEvent.finish();\n\t},\n\n\t_postSelectTextEvent: function(type, x, y) {\n\t\tapp.socket.sendMessage('selecttext type=' + type +\n\t\t\t\t' x=' + x + ' y=' + y);\n\t},\n\n\t// Is rRectangle empty?\n\t_isEmptyRectangle: function (bounds) {\n\t\tif (!bounds) {\n\t\t\treturn true;\n\t\t}\n\t\treturn bounds.getSouthWest().equals(new L.LatLng(0, 0)) && bounds.getNorthEast().equals(new L.LatLng(0, 0));\n\t},\n\n\t_onZoomStart: function () {\n\t\tthis._isZooming = true;\n\t},\n\n\n\t_onZoomEnd: function () {\n\t\tthis._isZooming = false;\n\t\tif (!this.isCalc())\n\t\t\tthis._replayPrintTwipsMsgs(false);\n\t\tthis._onUpdateCursor(null, true);\n\t\tapp.definitions.otherViewCursorSection.updateVisibilities();\n\t},\n\n\t_updateCursorPos: function () {\n\t\tvar cursorPos = new L.Point(app.file.textCursor.rectangle.pX1, app.file.textCursor.rectangle.pY1);\n\t\tvar cursorSize = new L.Point(app.file.textCursor.rectangle.pWidth, app.file.textCursor.rectangle.pHeight);\n\n\t\tif (!this._cursorMarker) {\n\t\t\tthis._cursorMarker = new Cursor(cursorPos, cursorSize, this._map, { blink: true });\n\t\t} else {\n\t\t\tthis._cursorMarker.setPositionSize(cursorPos, cursorSize);\n\t\t}\n\t},\n\n\tgoToTarget: function(target) {\n\t\tvar command = {\n\t\t\t'Name': {\n\t\t\t\ttype: 'string',\n\t\t\t\tvalue: 'URL'\n\t\t\t},\n\t\t\t'URL': {\n\t\t\t\ttype: 'string',\n\t\t\t\tvalue: '#' + target\n\t\t\t}\n\t\t};\n\n\t\tthis._map.sendUnoCommand('.uno:OpenHyperlink', command);\n\t},\n\n\t_allowViewJump: function() {\n\t\treturn (!this._map._clip || this._map._clip._selectionType !== 'complex');\n\t},\n\n\t// Scrolls the view to selected position\n\tscrollToPos: function(pos) {\n\t\tif (pos instanceof app.definitions.simplePoint) // Turn into lat/lng if required (pos may also be a simplePoint.).\n\t\t\tpos = this._twipsToLatLng({ x: pos.x, y: pos.y });\n\n\t\tvar center = this._map.project(pos);\n\n\t\tlet needsXScroll = false;\n\t\tlet needsYScroll = false;\n\t\tconst CSSPixelsToTwips = app.dpiScale * app.pixelsToTwips;\n\n\t\t// If x coordinate is already within visible area, we won't scroll to that direction.\n\t\tif (app.isXVisibleInTheDisplayedArea(Math.round(center.x * CSSPixelsToTwips)))\n\t\t\tcenter.x = app.file.viewedRectangle.cX1;\n\t\telse {\n\t\t\tcenter.x -= this._map.getSize().divideBy(2).x;\n\t\t\tcenter.x = Math.round(center.x < 0 ? 0 : center.x);\n\t\t\tneedsXScroll = true;\n\t\t}\n\n\t\t// If y coordinate is already within visible area, we won't scroll to that direction.\n\t\tconst controlYDown = center.y + (app.file.textCursor.visible ? app.file.textCursor.rectangle.cHeight :\n\t\t\t(app.calc.cellCursorVisible ? app.calc.cellCursorRectangle.cHeight : 0));\n\n\t\tconst controlYUp = center.y - (app.file.textCursor.visible ? app.file.textCursor.rectangle.cHeight :\n\t\t\t(app.calc.cellCursorVisible ? app.calc.cellCursorRectangle.cHeight : 0));\n\n\t\tif (app.isYVisibleInTheDisplayedArea(Math.round(controlYDown * CSSPixelsToTwips)) && app.isYVisibleInTheDisplayedArea(Math.round(controlYUp * CSSPixelsToTwips)))\n\t\t\tcenter.y = app.file.viewedRectangle.cY1;\n\t\telse {\n\t\t\tcenter.y -= this._map.getSize().divideBy(2).y;\n\t\t\tcenter.y = Math.round(center.y < 0 ? 0 : center.y);\n\t\t\tneedsYScroll = true;\n\t\t}\n\n\t\tif (needsXScroll || needsYScroll) {\n\t\t\tconst section = app.sectionContainer.getSectionWithName(L.CSections.Scroll.name);\n\t\t\tif (section) {\n\t\t\t\tsection.onScrollTo({x: center.x, y: center.y});\n\t\t\t}\n\t\t}\n\t},\n\n\t// Scroll the view by an amount given by a simplePoint\n\tscrollByPoint: function(offset) {\n\t\tthis._map.fire('scrollby', {x: offset.cX, y: offset.cY});\n\t},\n\n\t// Update cursor layer (blinking cursor).\n\t_onUpdateCursor: function (scroll, zoom, keepCaretPositionRelativeToScreen) {\n\n\t\tif (this._map.ignoreCursorUpdate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!app.file.textCursor.visible) {\n\t\t\tthis._updateCursorAndOverlay();\n\t\t\tapp.definitions.otherViewCursorSection.updateVisibilities(true);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!zoom\n\t\t&& scroll !== false\n\t\t&& (app.file.textCursor.visible || GraphicSelection.hasActiveSelection())\n\t\t// Do not center view in Calc if no new cursor coordinates have arrived yet.\n\t\t// ie, 'invalidatecursor' has not arrived after 'cursorvisible' yet.\n\t\t&& (!this.isCalc() || (this._lastVisibleCursorRef && !this._lastVisibleCursorRef.equals(app.file.textCursor.rectangle.toArray())))\n\t\t&& this._allowViewJump()) {\n\n\t\t\t// Cursor invalidation should take most precedence among all the scrolling to follow the cursor\n\t\t\t// so here we disregard all the pending scrolling\n\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.Scroll.name).pendingScrollEvent = null;\n\t\t\tvar correctedCursor = app.file.textCursor.rectangle.clone();\n\n\t\t\tif (this._docType === 'text') {\n\t\t\t\t// For Writer documents, disallow scrolling to cursor outside of the page (horizontally)\n\t\t\t\t// Use document dimensions to approximate page width\n\t\t\t\tcorrectedCursor.x1 = clamp(correctedCursor.x1, 0, app.view.size.x);\n\t\t\t\tcorrectedCursor.x2 = clamp(correctedCursor.x2, 0, app.view.size.x);\n\t\t\t}\n\n\t\t\tif (!app.isPointVisibleInTheDisplayedArea(new app.definitions.simplePoint(correctedCursor.x1, correctedCursor.y1).toArray()) ||\n\t\t\t\t!app.isPointVisibleInTheDisplayedArea(new app.definitions.simplePoint(correctedCursor.x2, correctedCursor.y2).toArray())) {\n\t\t\t\tif (app.isFollowingUser() && app.getFollowedViewId() === this._viewId && !this._map.calcInputBarHasFocus()) {\n\t\t\t\t\tthis.scrollToPos(new app.definitions.simplePoint(correctedCursor.x1, correctedCursor.y1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (keepCaretPositionRelativeToScreen) {\n\t\t\t/* We should be here when:\n\t\t\t\tAnother view updated the text.\n\t\t\t\tThat edit changed our cursor position.\n\t\t\tNow we already set the cursor position to another point.\n\t\t\tWe want to keep the cursor position at the same point relative to screen.\n\t\t\tDo that only when we are reaching the end of screen so we don't flicker.\n\t\t\t*/\n\t\t\tvar that = this;\n\n\t\t\tvar isCursorVisible = app.isPointVisibleInTheDisplayedArea(app.file.textCursor.rectangle.toArray());\n\n\t\t\tif (!isCursorVisible) {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tvar y = app.file.textCursor.rectangle.pY1 - that._cursorPreviousPositionCorePixels.pY1;\n\t\t\t\t\tif (y) {\n\t\t\t\t\t\tapp.sectionContainer.getSectionWithName(L.CSections.Scroll.name).scrollVerticalWithOffset(y);\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateCursorAndOverlay();\n\n\t\tapp.definitions.otherViewCursorSection.updateVisibilities();\n\t},\n\n\tactivateCursor: function () {\n\t\tthis._replayPrintTwipsMsg('invalidatecursor');\n\t},\n\n\t// enable or disable blinking cursor and the cursor overlay depending on\n\t// the state of the document (if the flags are set)\n\t_updateCursorAndOverlay: function (/*update*/) {\n\t\tif (app.file.textCursor.visible   // only when LOK has told us it is ok\n\t\t\t&& this._map.editorHasFocus()   // not when document is not focused\n\t\t\t&& !this._map.isSearching()  \t// not when searching within the doc\n\t\t\t&& !this._isZooming             // not when zooming\n\t\t) {\n\t\t\tthis._updateCursorPos();\n\n\t\t\tvar scrollSection = app.sectionContainer.getSectionWithName(L.CSections.Scroll.name);\n\t\t\tif (!scrollSection.sectionProperties.mouseIsOnVerticalScrollBar && !scrollSection.sectionProperties.mouseIsOnHorizontalScrollBar) {\n\t\t\t\tthis._map._textInput.showCursor();\n\t\t\t}\n\n\t\t\tvar hasMobileWizardOpened = this._map.uiManager.mobileWizard ? this._map.uiManager.mobileWizard.isOpen() : false;\n\t\t\tvar hasIframeModalOpened = $('.iframe-dialog-modal').is(':visible');\n\t\t\t// Don't show the keyboard when the Wizard is visible.\n\t\t\tif (!window.mobileWizard && !window.pageMobileWizard &&\n\t\t\t\t!window.insertionMobileWizard && !hasMobileWizardOpened &&\n\t\t\t\t!JSDialog.IsAnyInputFocused() && !hasIframeModalOpened) {\n\t\t\t\t// If the user is editing, show the keyboard, but don't change\n\t\t\t\t// anything if nothing is changed.\n\n\t\t\t\t// We will focus map if no comment is being edited (writer only for now).\n\t\t\t\tif (this._docType === 'text') {\n\t\t\t\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.CommentList.name);\n\t\t\t\t\tif (!section || !section.sectionProperties.selectedComment || !section.sectionProperties.selectedComment.isEdit())\n\t\t\t\t\t\tthis._map.focus(true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tthis._map.focus(true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._map._textInput.hideCursor();\n\t\t\t// Maintain input if a dialog or search-box has the focus.\n\t\t\tif (this._map.editorHasFocus() && !this._map.uiManager.isAnyDialogOpen() && !this._map.isSearching()\n\t\t\t\t&& !JSDialog.IsAnyInputFocused())\n\t\t\t\tthis._map.focus(false);\n\t\t}\n\n\t\t// when first time we updated the cursor - document is loaded\n\t\t// let's move cursor to the target\n\t\tif (this._map.options.docTarget !== '') {\n\t\t\tthis.goToTarget(this._map.options.docTarget);\n\t\t\tthis._map.options.docTarget = '';\n\t\t}\n\t},\n\n\tupdateAllTextViewSelection: function() {\n\t\tthis.eachView(this._viewSelections, this._onUpdateTextViewSelection, this, false);\n\t},\n\n\tgoToViewCursor: function(viewId) {\n\t\tif (viewId === this._viewId) {\n\t\t\tthis._onUpdateCursor();\n\t\t\treturn;\n\t\t}\n\n\t\tconst section = app.definitions.otherViewCursorSection.getViewCursorSection(viewId);\n\n\t\tif (section && section.showSection) {\n\t\t\tconst point = new app.definitions.simplePoint(section.position[0] * app.pixelsToTwips, section.position[1] * app.pixelsToTwips);\n\t\t\tvar isNewCursorVisible = app.isPointVisibleInTheDisplayedArea(point.toArray());\n\t\t\tif (!isNewCursorVisible)\n\t\t\t\tthis.scrollToPos(point);\n\t\t\tapp.definitions.cursorHeaderSection.showCursorHeader(viewId);\n\t\t}\n\t},\n\n\t_onUpdateTextViewSelection: function (viewId) {\n\t\tviewId = parseInt(viewId);\n\t\tvar viewPointSet = this._viewSelections[viewId].pointSet;\n\t\tvar viewSelection = this._viewSelections[viewId].selection;\n\t\tvar viewPart = this._viewSelections[viewId].part;\n\t\tvar viewMode = this._viewSelections[viewId].mode ? this._viewSelections[viewId].mode : 0;\n\n\t\tif (viewPointSet &&\n\t\t    (this.isWriter() || (this._selectedPart === viewPart && this._selectedMode === viewMode))) {\n\n\t\t\tif (viewSelection) {\n\t\t\t\tif (!this._map.hasInfoForView(viewId)) {\n\t\t\t\t\tviewSelection.clear();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// change previous selections\n\t\t\t\tviewSelection.setPointSet(viewPointSet);\n\t\t\t} else {\n\t\t\t\tviewSelection = new CSelections(viewPointSet, this._canvasOverlay,\n\t\t\t\t\tthis._selectionsDataDiv, this._map, true /* isView */, viewId, true /* isText */);\n\t\t\t\tthis._viewSelections[viewId].selection = viewSelection;\n\t\t\t}\n\t\t}\n\t\telse if (viewSelection) {\n\t\t\tviewSelection.clear();\n\t\t}\n\t},\n\n\teachView: function (views, method, context, item) {\n\t\tfor (var key in views) {\n\t\t\tmethod.call(context, item ? views[key] : key);\n\t\t}\n\t},\n\n\t// TODO: used only in calc: move to CalcTileLayer\n\t_onUpdateCellCursor: function (scrollToCursor, sameAddress) {\n\t\tthis._onUpdateCellResizeMarkers();\n\t\tif (app.calc.cellCursorVisible) {\n\t\t\tif (scrollToCursor &&\n\t\t\t    !this._map.calcInputBarHasFocus()) {\n\t\t\t\tconst scroll = this._calculateScrollForNewCellCursor();\n\t\t\t\tif (scroll.x !== 0 || scroll.y !== 0) {\n\t\t\t\t\tconst section = app.sectionContainer.getSectionWithName(L.CSections.Scroll.name);\n\t\t\t\t\tif (section) {\n\t\t\t\t\t\tsection.moveMapBy(scroll.cX, scroll.cY, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._prevCellCursorAddress = app.calc.cellAddress.clone();\n\t\t\t}\n\n\t\t\tthis._addCellDropDownArrow();\n\n\t\t\tvar focusOutOfDocument = document.activeElement === document.body;\n\t\t\tvar dontFocusDocument = JSDialog.IsAnyInputFocused() || focusOutOfDocument;\n\t\t\tvar dontStealFocus = sameAddress && this._map.calcInputBarHasFocus();\n\t\t\tdontFocusDocument = dontFocusDocument || dontStealFocus;\n\n\t\t\t// when the cell cursor is moving, the user is in the document,\n\t\t\t// and the focus should leave the cell input bar\n\t\t\t// exception: when dialog opened don't focus the document\n\t\t\tif (!dontFocusDocument)\n\t\t\t\tthis._map.fire('editorgotfocus');\n\t\t}\n\n\t\tthis._removeCellDropDownArrow();\n\t\tapp.definitions.urlPopUpSection.closeURLPopUp();\n\t},\n\n\t_onValidityListButtonMsg: function(textMsg) {\n\t\tvar strXY = textMsg.match(/\\d+/g);\n\t\tvar validatedCellAddress = new app.definitions.simplePoint(parseInt(strXY[0]), parseInt(strXY[1])); // Cell address of the validity list.\n\t\tvar show = parseInt(strXY[2]) === 1;\n\t\tif (show) {\n\t\t\tif (this._validatedCellAddress && !validatedCellAddress.equals(this._validatedCellAddress.toArray())) {\n\t\t\t\tthis._validatedCellAddress = null;\n\t\t\t\tthis._removeCellDropDownArrow();\n\t\t\t}\n\t\t\tthis._validatedCellAddress = validatedCellAddress;\n\t\t\tthis._addCellDropDownArrow();\n\t\t}\n\t\telse if (this._validatedCellAddress && validatedCellAddress.equals(this._validatedCellAddress.toArray())) {\n\t\t\tthis._validatedCellAddress = null;\n\t\t\tthis._removeCellDropDownArrow();\n\t\t}\n\t},\n\n\t_onValidityInputHelpMsg: function(textMsg) {\n\t\tapp.definitions.validityInputHelpSection.removeValidityInputHelp();\n\t\tapp.definitions.validityInputHelpSection.showValidityInputHelp(textMsg, new app.definitions.simplePoint(app.calc.cellCursorRectangle.x2, app.calc.cellCursorRectangle.y1));\n\t},\n\n\t_addCellDropDownArrow: function () {\n\t\tif (this._validatedCellAddress && app.calc.cellCursorVisible && this._validatedCellAddress.equals(app.calc.cellAddress.toArray())) {\n\t\t\tlet position;\n\t\t\tif (this.sheetGeometry) {\n\t\t\t\tposition = this.sheetGeometry.getCellRect(this._validatedCellAddress.x, this._validatedCellAddress.y, this._map.getZoomScale(this._map.getZoom(), this._map.options.defaultZoom));\n\t\t\t\tconst height = position.max.y - position.min.y;\n\t\t\t\tposition = new app.definitions.simplePoint(app.calc.cellCursorRectangle.x2, app.calc.cellCursorRectangle.y1 + (height - 16) * app.pixelsToTwips);\n\t\t\t}\n\t\t\telse\n\t\t\t\tposition = new app.definitions.simplePoint(app.calc.cellCursorRectangle.x2, app.calc.cellCursorRectangle.y2 - 16 * app.pixelsToTwips);\n\n\t\t\tif (!app.sectionContainer.getSectionWithName('DropDownArrow')) {\n\t\t\t\tlet dropDownSection = new app.definitions.calcValidityDropDown('DropDownArrow', position);\n\t\t\t\tapp.sectionContainer.addSection(dropDownSection);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tapp.sectionContainer.getSectionWithName('DropDownArrow').setPosition(position.pX, position.pY);\n\t\t\t}\n\t\t}\n\t},\n\n\t_removeCellDropDownArrow: function () {\n\t\tif (!this._validatedCellAddress)\n\t\t\tapp.sectionContainer.removeSection('DropDownArrow');\n\t},\n\n\t_onUpdateCellResizeMarkers: function () {\n\t\tvar selectionOnDesktop = window.mode.isDesktop() && (this._cellSelectionArea || app.calc.cellCursorVisible);\n\n\t\tif (!selectionOnDesktop && (!this._cellCSelections.empty() || app.calc.cellCursorVisible)) {\n\n\t\t\tif (!this._cellSelectionArea && !app.calc.cellCursorVisible)\n\t\t\t\treturn;\n\n\t\t\tthis._cellSelectionHandleStart.setShowSection(true);\n\t\t\tthis._cellSelectionHandleEnd.setShowSection(true);\n\n\t\t\tvar cellRectangle = this._cellSelectionArea ? this._cellSelectionArea.clone() : app.calc.cellCursorRectangle.clone();\n\n\t\t\tconst posStart = new app.definitions.simplePoint(cellRectangle.x1, cellRectangle.y1);\n\t\t\tconst posEnd = new app.definitions.simplePoint(cellRectangle.x2, cellRectangle.y2);\n\n\t\t\tconst offset = this._cellSelectionHandleStart.sectionProperties.circleRadius;\n\t\t\tthis._cellSelectionHandleStart.setPosition(posStart.pX - offset, posStart.pY - offset);\n\t\t\tthis._cellSelectionHandleEnd.setPosition(posEnd.pX - offset, posEnd.pY - offset);\n\t\t}\n\t\telse {\n\t\t\tthis._cellSelectionHandleStart.setShowSection(false);\n\t\t\tthis._cellSelectionHandleEnd.setShowSection(false);\n\t\t}\n\t},\n\n\t// Update text selection handlers.\n\t_onUpdateTextSelection: function () {\n\t\tthis._onUpdateCellResizeMarkers();\n\n\t\tif (this._map.editorHasFocus() && (!this._textCSelections.empty() || this._selectionHandles.active)) {\n\t\t\tthis._updateMarkers();\n\t\t}\n\t\telse {\n\t\t\tthis._updateMarkers();\n\t\t\tthis._removeSelection();\n\t\t}\n\t},\n\n\t_removeSelection: function() {\n\t\tthis._selectionHandles.start.rectangle = null;\n\t\tthis._selectionHandles.end.rectangle = null;\n\t\tthis._selectedTextContent = '';\n\n\t\tthis._selectionHandles.start.setShowSection(false);\n\t\tthis._selectionHandles.end.setShowSection(false);\n\t\tthis._selectionHandles.active = false;\n\n\t\tthis._textCSelections.clear();\n\t},\n\n\t_updateMarkers: function() {\n\t\tif (!app.file.textCursor.visible || !this._selectionHandles.start.rectangle)\n\t\t\treturn;\n\n\t\tif (!this._selectionHandles.start.isSectionShown() || !this._selectionHandles.end.isSectionShown())\n\t\t\treturn;\n\n\t\tvar startPos = { x: this._selectionHandles.start.rectangle.pX1, y: this._selectionHandles.start.rectangle.pY2 };\n\t\tvar endPos = { x: this._selectionHandles.end.rectangle.pX1, y: this._selectionHandles.end.rectangle.pY2 };\n\n\t\tif (app.map._docLayer.isCalcRTL()) {\n\t\t\t// Mirror position from right to left.\n\t\t\tstartPos.x = app.file.viewedRectangle.pX2 - (startPos.x - app.file.viewedRectangle.pX1);\n\t\t\tendPos.x = app.file.viewedRectangle.pX2 - (endPos.x - app.file.viewedRectangle.pX1);\n\t\t}\n\n\t\tconst oldStart = this._selectionHandles.start.getPosition();\n\t\tconst oldEnd = this._selectionHandles.end.getPosition();\n\n\t\tstartPos.x -= 30 * app.dpiScale;\n\t\tthis._selectionHandles.start.setPosition(startPos.x, startPos.y);\n\t\tlet newStart = this._selectionHandles.start.getPosition();\n\n\n\t\tthis._selectionHandles.end.setPosition(endPos.x, endPos.y);\n\t\tconst newEnd = this._selectionHandles.end.getPosition();\n\n\t\tif (app.map._docLayer.isCalcRTL() && (newStart.y < newEnd.y || (newStart.y <= newEnd.y && newStart.x < newEnd.x))) {\n\t\t\t// If the start handle is actually closer to the end of the selection, reverse positions (Right To Left case).\n\t\t\tthis._selectionHandles.start.setPosition(newEnd.pX, newEnd.pY);\n\t\t\tthis._selectionHandles.end.setPosition(newStart.pX, newStart.pY);\n\t\t}\n\t\telse if (\n\t\t\t!app.map._docLayer.isCalcRTL() &&\n\t\t\t(oldEnd.distanceTo(newStart.toArray()) < 20 || oldStart.distanceTo(newEnd.toArray()) < 20)\n\t\t) {\n\t\t\t/*\n\t\t\t\tIf the start handle is actually closer to the end of the selection, reverse positions.\n\t\t\t\tThis seems to be a core side issue to me. I think the start and end positions are switched but the handlers aren't on the core side.\n\t\t\t*/\n\t\t\tconst temp = this._selectionHandles.start;\n\t\t\tthis._selectionHandles.start = this._selectionHandles.end;\n\t\t\tthis._selectionHandles.end = temp;\n\t\t}\n\t},\n\n\t_onDragOver: function (e) {\n\t\te = e.originalEvent;\n\t\te.preventDefault();\n\t},\n\n\t_onDrop: function (e) {\n\t\t// Move the cursor, so that the insert position is as close to the drop coordinates as possible.\n\t\tvar latlng = e.latlng;\n\t\tvar docLayer = this._map._docLayer;\n\t\tvar mousePos = docLayer._latLngToTwips(latlng);\n\t\tvar count = 1;\n\t\tvar buttons = 1;\n\t\tvar modifier = this._map.keyboard.modifier;\n\t\tthis._postMouseEvent('buttondown', mousePos.x, mousePos.y, count, buttons, modifier);\n\t\tthis._postMouseEvent('buttonup', mousePos.x, mousePos.y, count, buttons, modifier);\n\n\t\te = e.originalEvent;\n\t\te.preventDefault();\n\n\t\tif (this._map._clip) {\n\t\t\t// Always capture the html content separate as we may lose it when we\n\t\t\t// pass the clipboard data to a different context (async calls, f.e.).\n\t\t\tvar htmlText = e.dataTransfer.getData('text/html');\n\t\t\tthis._map._clip.dataTransferToDocument(e.dataTransfer, /* preferInternal = */ false, htmlText);\n\t\t}\n\t},\n\n\t// This is really just called on zoomend\n\t_fitWidthZoom: function (e, maxZoom) {\n\t\tif (this.isCalc())\n\t\t\treturn;\n\n\t\tif (app.file.size.x === 0) { return; }\n\t\tvar oldSize = e ? e.oldSize : this._map.getSize();\n\t\tvar newSize = e ? e.newSize : this._map.getSize();\n\n\t\tnewSize.x *= app.dpiScale;\n\t\tnewSize.y *= app.dpiScale;\n\t\toldSize.x *= app.dpiScale;\n\t\toldSize.y *= app.dpiScale;\n\n\t\tif (this.isWriter() && newSize.x - oldSize.x === 0) { return; }\n\n\t\tvar widthTwips = newSize.x * app.tile.size.x / TileManager.tileSize;\n\t\tvar ratio = widthTwips / app.file.size.x;\n\n\t\tmaxZoom = maxZoom ? maxZoom : 10;\n\t\tvar zoom = this._map.getScaleZoom(ratio, 10);\n\n\t\tzoom = Math.min(maxZoom, Math.max(0.1, zoom));\n\t\t// Not clear why we wanted to zoom in the past.\n\t\t// This resets the view & scroll area and does a 'panTo'\n\t\t// to keep the cursor in view.\n\t\t// But of course, zoom to fit the first time.\n\t\tif (this._firstFitDone)\n\t\t\tzoom = this._map._zoom;\n\t\tthis._firstFitDone = true;\n\n\t\tif (zoom > 1)\n\t\t\tzoom = Math.floor(zoom);\n\n\t\tthis._map.setZoom(zoom, {animate: false});\n\t},\n\n\t// Cells can change position during changes of zoom level in calc\n\t// hence we need to request an updated cell cursor position for this level.\n\t_onCellCursorShift: function (force) {\n\t\tif ((this._cellCursorSection && !this.options.sheetGeometryDataEnabled) || force) {\n\t\t\tthis.requestCellCursor();\n\t\t}\n\t},\n\n\trequestCellCursor: function() {\n\t\tapp.socket.sendMessage('commandvalues command=.uno:CellCursor'\n\t\t\t+ '?outputHeight=' + TileManager.tileSize\n\t\t\t+ '&outputWidth=' + TileManager.tileSize\n\t\t\t+ '&tileHeight=' + app.tile.size.x\n\t\t\t+ '&tileWidth=' + app.tile.size.y);\n\t},\n\n\t_invalidateAllPreviews: function () {\n\t\tthis._previewInvalidations = [];\n\t\tfor (var key in this._map._docPreviews) {\n\t\t\tvar preview = this._map._docPreviews[key];\n\t\t\tpreview.invalid = true;\n\t\t\tthis._previewInvalidations.push(new L.Bounds(new L.Point(0, 0), new L.Point(preview.maxWidth, preview.maxHeight)));\n\t\t}\n\t\tthis._invalidatePreviews();\n\t},\n\n\t_invalidatePreviews: function () {\n\t\tif (this._map && this._map._docPreviews && this._previewInvalidations.length > 0) {\n\t\t\tvar toInvalidate = {};\n\t\t\tfor (var i = 0; i < this._previewInvalidations.length; i++) {\n\t\t\t\tvar invalidBounds = this._previewInvalidations[i];\n\t\t\t\tfor (var key in this._map._docPreviews) {\n\t\t\t\t\t// find preview tiles that need to be updated and add them in a set\n\t\t\t\t\tvar preview = this._map._docPreviews[key];\n\t\t\t\t\tif (preview.index >= 0) {\n\t\t\t\t\t\t// we have a preview for a part\n\t\t\t\t\t\tif (preview.invalid || preview.index === this._selectedPart ||\n\t\t\t\t\t\t\t\t(preview.index === this._prevSelectedPart && this._prevSelectedPartNeedsUpdate)) {\n\t\t\t\t\t\t\t// if the current part needs its preview updated OR\n\t\t\t\t\t\t\t// the part has been changed and we need to update the previous part preview\n\t\t\t\t\t\t\tif (preview.index === this._prevSelectedPart) {\n\t\t\t\t\t\t\t\tthis._prevSelectedPartNeedsUpdate = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttoInvalidate[key] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// we have a custom preview\n\t\t\t\t\t\tvar bounds = new L.Bounds(\n\t\t\t\t\t\t\tnew L.Point(preview.tilePosX, preview.tilePosY),\n\t\t\t\t\t\t\tnew L.Point(preview.tilePosX + preview.tileWidth, preview.tilePosY + preview.tileHeight));\n\t\t\t\t\t\tif (preview.invalid || (preview.part === this._selectedPart ||\n\t\t\t\t\t\t\t\t(preview.part === this._prevSelectedPart && this._prevSelectedPartNeedsUpdate)) &&\n\t\t\t\t\t\t\t\tinvalidBounds.intersects(bounds)) {\n\t\t\t\t\t\t\t// if the current part needs its preview updated OR\n\t\t\t\t\t\t\t// the part has been changed and we need to update the previous part preview\n\t\t\t\t\t\t\tif (preview.index === this._prevSelectedPart) {\n\t\t\t\t\t\t\t\tthis._prevSelectedPartNeedsUpdate = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttoInvalidate[key] = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor (key in toInvalidate) {\n\t\t\t\t// update invalid preview tiles\n\t\t\t\tpreview = this._map._docPreviews[key];\n\t\t\t\tif (preview.autoUpdate) {\n\t\t\t\t\tif (preview.index >= 0) {\n\t\t\t\t\t\tthis._map.getPreview(preview.id, preview.index, preview.maxWidth, preview.maxHeight, {autoUpdate: true});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._map.getCustomPreview(preview.id, preview.part, preview.width, preview.height, preview.tilePosX,\n\t\t\t\t\t\t\tpreview.tilePosY, preview.tileWidth, preview.tileHeight, {autoUpdate: true});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._previewInvalidations = [];\n\t},\n\n\t_onFormFieldButtonMsg: function (textMsg) {\n\t\ttextMsg = textMsg.substring('formfieldbutton:'.length + 1);\n\t\tvar json = JSON.parse(textMsg);\n\t\tif (json.action === 'show') {\n\t\t\tthis._formFieldButton = new L.FormFieldButton(json);\n\t\t\tthis._map.addLayer(this._formFieldButton);\n\t\t} else if (this._formFieldButton) {\n\t\t\tthis._map.removeLayer(this._formFieldButton);\n\t\t}\n\t},\n\n\t// converts rectangle in print-twips to tile-twips rectangle of the smallest cell-range that encloses it.\n\t_convertToTileTwipsSheetArea: function (rectangle) {\n\t\tif (!(rectangle instanceof L.Bounds) || !this.options.printTwipsMsgsEnabled || !this.sheetGeometry) {\n\t\t\treturn rectangle;\n\t\t}\n\n\t\treturn this.sheetGeometry.getTileTwipsSheetAreaFromPrint(rectangle);\n\t},\n\n\t_convertCalcTileTwips: function (point, offset) {\n\t\tif (!this.options.printTwipsMsgsEnabled || !this.sheetGeometry)\n\t\t\treturn point;\n\t\tvar newPoint = new L.Point(parseInt(point.x), parseInt(point.y));\n\t\tvar _offset = offset ? new L.Point(parseInt(offset.x), parseInt(offset.y)) : new L.Point(this._shapeGridOffset.x, this._shapeGridOffset.y);\n\t\treturn newPoint.add(_offset);\n\t},\n\n\t_getEditCursorRectangle: function (msgObj) {\n\n\t\tif (typeof msgObj !== 'object' || !Object.prototype.hasOwnProperty.call(msgObj,'rectangle')) {\n\t\t\twindow.app.console.error('invalid edit cursor message');\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn L.Bounds.parse(msgObj.rectangle);\n\t},\n\n\t_getTextSelectionRectangles: function (textMsg) {\n\n\t\tif (typeof textMsg !== 'string') {\n\t\t\twindow.app.console.error('invalid text selection message');\n\t\t\treturn [];\n\t\t}\n\n\t\treturn L.Bounds.parseArray(textMsg);\n\t},\n\n\t// Needed for the split-panes feature to determine the active split-pane.\n\t// Needs to be implemented by the app specific TileLayer.\n\tgetCursorPos: function () {\n\t\twindow.app.console.error('No implementations available for getCursorPos!');\n\t\treturn new L.Point(0, 0);\n\t},\n\n\t/// onlyThread - takes annotation indicating which thread will be generated\n\tgetCommentWizardStructure: function(menuStructure, onlyThread) {\n\t\tvar customTitleBar = L.DomUtil.create('div');\n\t\tL.DomUtil.addClass(customTitleBar, 'mobile-wizard-titlebar-btn-container');\n\t\tvar title = L.DomUtil.create('span', '', customTitleBar);\n\t\ttitle.innerText = _('Comment');\n\t\tvar button = L.DomUtil.createWithId('button', 'insert_comment', customTitleBar);\n\t\tL.DomUtil.addClass(button, 'mobile-wizard-titlebar-btn');\n\t\tbutton.innerText = '+';\n\t\tbutton.onclick = this._map.insertComment.bind(this._map);\n\n\t\tif (menuStructure === undefined) {\n\t\t\tmenuStructure = {\n\t\t\t\tid : 'comment',\n\t\t\t\ttype : 'mainmenu',\n\t\t\t\tenabled : true,\n\t\t\t\ttext : _('Comment'),\n\t\t\t\texecutionType : 'menu',\n\t\t\t\tdata : [],\n\t\t\t\tchildren : []\n\t\t\t};\n\n\t\t\tif (app.isCommentEditingAllowed())\n\t\t\t\tmenuStructure['customTitle'] = customTitleBar;\n\t\t}\n\n\t\tapp.sectionContainer.getSectionWithName(L.CSections.CommentList.name).createCommentStructure(menuStructure, onlyThread);\n\n\t\tif (menuStructure.children.length === 0) {\n\t\t\tvar noComments = {\n\t\t\t\tid: 'emptyWizard',\n\t\t\t\tenable: true,\n\t\t\t\ttype: 'emptyCommentWizard',\n\t\t\t\ttext: _('No Comments'),\n\t\t\t\tchildren: []\n\t\t\t};\n\t\t\tmenuStructure['children'].push(noComments);\n\t\t}\n\t\treturn menuStructure;\n\t},\n\n\t_openCommentWizard: function(annotation) {\n\t\twindow.commentWizard = true;\n\t\tvar menuData = this._map._docLayer.getCommentWizardStructure();\n\t\tthis._map.fire('mobilewizard', {data: menuData});\n\n\t\t// if annotation is provided we can select particular comment\n\t\tif (annotation) {\n\t\t\t$('#comment' + annotation.sectionProperties.data.id).click();\n\t\t}\n\t},\n\n\t_saveMessageForReplay: function (textMsg, viewId) {\n\t\t// We will not get some messages (with coordinates)\n\t\t// from core when zoom changes because print-twips coordinates are zoom-invariant. So we need to\n\t\t// remember the last version of them and replay, when zoom is changed.\n\t\t// In calc we need to replay the messages when sheet-geometry changes too. This is because it is possible for\n\t\t// the updated print-twips messages to arrive before the sheet-geometry update message arrives.\n\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\tvar ownViewTypes = this.isCalc() ? [\n\t\t\t\t'cellcursor',\n\t\t\t\t'referencemarks',\n\t\t\t\t'cellselectionarea',\n\t\t\t\t'textselection',\n\t\t\t\t'invalidatecursor',\n\t\t\t\t'textselectionstart',\n\t\t\t\t'textselectionend',\n\t\t\t\t'graphicselection',\n\t\t\t] : [\n\t\t\t\t'invalidatecursor',\n\t\t\t\t'textselection',\n\t\t\t\t'graphicselection'\n\t\t\t];\n\n\t\t\tif (this.isWriter())\n\t\t\t\townViewTypes.push('contentcontrol');\n\n\t\t\tvar otherViewTypes = this.isCalc() ? [\n\t\t\t\t'cellviewcursor',\n\t\t\t\t'textviewselection',\n\t\t\t\t'invalidateviewcursor',\n\t\t\t\t'graphicviewselection',\n\t\t\t] : [\n\t\t\t\t'textviewselection',\n\t\t\t\t'invalidateviewcursor'\n\t\t\t];\n\n\t\t\tthis._printTwipsMessagesForReplay = new L.MessageStore(ownViewTypes, otherViewTypes);\n\t\t}\n\n\t\tvar colonIndex = textMsg.indexOf(':');\n\t\tif (colonIndex === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar msgType = textMsg.substring(0, colonIndex);\n\t\tthis._printTwipsMessagesForReplay.save(msgType, textMsg, viewId);\n\t},\n\n\t_clearMsgReplayStore: function (notOtherMsg) {\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._printTwipsMessagesForReplay.clear(notOtherMsg);\n\t},\n\n\t_replayPrintTwipsMsgs: function (differentSheet) {\n\t\tif (!this._printTwipsMessagesForReplay) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._printTwipsMessagesForReplay.forEach(function (msg) {\n\t\t\t// don't try and replace graphic selection if the sheet/page has changed\n\t\t\tvar skipMessage = differentSheet && msg.startsWith('graphicselection:');\n\t\t\tif (!skipMessage)\n\t\t\t\tthis._onMessage(msg);\n\t\t}.bind(this));\n\t},\n\n\t_replayPrintTwipsMsg: function (msgType) {\n\t\tvar msg = this._printTwipsMessagesForReplay.get(msgType);\n\t\tthis._onMessage(msg);\n\t},\n\n\t_replayPrintTwipsMsgAllViews: function (msgType) {\n\t\tObject.keys(this._map._viewInfo).forEach(function (viewId) {\n\t\t\tvar msg = this._printTwipsMessagesForReplay.get(msgType, parseInt(viewId));\n\t\t\tif (msg)\n\t\t\t\tthis._onMessage(msg);\n\t\t}.bind(this));\n\t},\n\n\t_syncTilePanePos: function () {\n\t\tif (this._container) {\n\t\t\tvar mapPanePos = this._map._getMapPanePos();\n\t\t\tL.DomUtil.setPosition(this._container, new L.Point(-mapPanePos.x , -mapPanePos.y));\n\t\t}\n\t\tvar documentBounds = this._map.getPixelBoundsCore();\n\t\tvar documentPos = documentBounds.min;\n\t\tvar documentEndPos = documentBounds.max;\n\t\tapp.sectionContainer.setDocumentBounds([documentPos.x, documentPos.y, documentEndPos.x, documentEndPos.y]);\n\t\tif (app.file.writer.multiPageView)\n\t\t\tMultiPageViewLayout.reset();\n\t},\n\n\tpauseDrawing: function () {\n\t\tif (this._painter && app.sectionContainer)\n\t\t\tapp.sectionContainer.pauseDrawing();\n\t},\n\n\tresumeDrawing: function (topLevel) {\n\t\tif (this._painter && app.sectionContainer)\n\t\t\tapp.sectionContainer.resumeDrawing(topLevel);\n\t},\n\n\t// used in Calc, see CalcTileLayer\n\tallowDrawing: function() {},\n\n\tenableDrawing: function () {\n\t\tif (this._painter && app.sectionContainer)\n\t\t\tapp.sectionContainer.enableDrawing();\n\t},\n\n\t_getUIWidth: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.RowHeader.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[0] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getUIHeight: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.ColumnHeader.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getGroupWidth: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.RowGroup.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[0] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getGroupHeight: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.ColumnGroup.name);\n\t\tif (section) {\n\t\t\treturn Math.round(section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t_getTilesSectionRectangle: function () {\n\t\tvar section = app.sectionContainer.getSectionWithName(L.CSections.Tiles.name);\n\t\tif (section) {\n\t\t\treturn app.LOUtil.createRectangle(section.myTopLeft[0] / app.dpiScale, section.myTopLeft[1] / app.dpiScale, section.size[0] / app.dpiScale, section.size[1] / app.dpiScale);\n\t\t}\n\t\telse {\n\t\t\treturn app.LOUtil.createRectangle(0, 0, 0, 0);\n\t\t}\n\t},\n\n\t_getRealMapSize: function() {\n\t\tthis._map._sizeChanged = true; // force using real size\n\t\treturn this._map.getPixelBounds().getSize();\n\t},\n\n\t_getDocumentContainerSize: function() {\n\t\tlet documentContainerSize = document.getElementById('document-container').getBoundingClientRect();\n\t\tdocumentContainerSize = [documentContainerSize.width, documentContainerSize.height];\n\t\treturn documentContainerSize;\n\t},\n\n\t_resizeMapElementAndTilesLayer: function(sizeRectangle) {\n\t\tconst mapElement = document.getElementById('map'); // map's size = tiles section's size.\n\t\tmapElement.style.left = sizeRectangle.getPxX1() + 'px';\n\t\tmapElement.style.top = sizeRectangle.getPxY1() + 'px';\n\t\tmapElement.style.width = sizeRectangle.getPxWidth() + 'px';\n\t\tmapElement.style.height = sizeRectangle.getPxHeight() + 'px';\n\n\t\tthis._container.style.width = sizeRectangle.getPxWidth() + 'px';\n\t\tthis._container.style.height = sizeRectangle.getPxHeight() + 'px';\n\t},\n\n\t_mobileChecksAfterResizeEvent: function(heightIncreased) {\n\t\tif (!window.mode.isMobile()) return;\n\n\t\tconst hasMobileWizardOpened = this._map.uiManager.mobileWizard ? this._map.uiManager.mobileWizard.isOpen() : false;\n\t\tconst hasIframeModalOpened = $('.iframe-dialog-modal').is(':visible');\n\t\t// when integrator has opened dialog in parent frame (eg. save as) we shouldn't steal the focus\n\t\tconst focusedUI = document.activeElement === document.body;\n\t\tif (!hasMobileWizardOpened && !hasIframeModalOpened && !focusedUI) {\n\t\t\tif (heightIncreased) {\n\t\t\t\t// if the keyboard is hidden - be sure we setup correct state in TextInput\n\t\t\t\tthis._map.setAcceptInput(false);\n\t\t\t} else\n\t\t\t\tthis._onUpdateCursor(true);\n\t\t}\n\t},\n\n\t_nonDesktopChecksAfterResizeEvent: function(heightIncreased) {\n\t\t// We want to keep cursor visible when we show the keyboard on mobile device or tablet\n\t\tif (!window.mode.isMobile() && !window.mode.isTablet()) return;\n\n\t\tconst hasVisibleCursor = app.file.textCursor.visible\n\t\t\t&& this._map._docLayer._cursorMarker && this._map._docLayer._cursorMarker.isDomAttached();\n\t\tif (!heightIncreased && this._map._docLoaded && hasVisibleCursor) {\n\t\t\tconst cursorPos = this._map._docLayer._twipsToLatLng({ x: app.file.textCursor.rectangle.x1, y: app.file.textCursor.rectangle.y2 });\n\t\t\tconst cursorPositionInView = this._isLatLngInView(cursorPos);\n\t\t\tif (!cursorPositionInView)\n\t\t\t\tthis._map.panTo(cursorPos);\n\t\t}\n\t},\n\n\t_syncTileContainerSize: function () {\n\t\tif (!this._map) return;\n\n\t\tif (this._docType === 'presentation' || this._docType === 'drawing') this.onResizeImpress();\n\n\t\tif (!this._container) return;\n\n\t\tconst documentContainerSize = this._getDocumentContainerSize();\n\n\t\tapp.sectionContainer.onResize(documentContainerSize[0], documentContainerSize[1]); // Canvas's size = documentContainer's size.\n\n\t\tconst oldSize = this._getRealMapSize();\n\n\t\tthis._resizeMapElementAndTilesLayer(this._getTilesSectionRectangle());\n\n\t\tconst newSize = this._getRealMapSize();\n\t\tconst heightIncreased = oldSize.y < newSize.y;\n\t\tconst widthIncreased = oldSize.x < newSize.x;\n\n\t\tif (oldSize.x !== newSize.x || oldSize.y !== newSize.y)\n\t\t\tthis._map.invalidateSize(false, oldSize);\n\n\t\tthis._mobileChecksAfterResizeEvent(heightIncreased);\n\n\t\tthis._fitWidthZoom();\n\n\t\t// Center the view w.r.t the new map-pane position using the current zoom.\n\t\tthis._map.setView(this._map.getCenter());\n\n\t\tthis._nonDesktopChecksAfterResizeEvent(heightIncreased);\n\n\t\tif (heightIncreased || widthIncreased) {\n\t\t\tapp.sectionContainer.requestReDraw();\n\t\t\tthis._map.fire('sizeincreased');\n\t\t}\n\t},\n\n\thasSplitPanesSupport: function () {\n\t\t// Only enabled for Calc for now\n\t\t// It may work without this.options.sheetGeometryDataEnabled but not tested.\n\t\t// The overlay-pane with split-panes is still based on svg renderer,\n\t\t// and not available for VML or canvas yet.\n\t\tif (this.isCalc() &&\n\t\t\tthis.options.sheetGeometryDataEnabled) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tsetZoomChanged: function (zoomChanged) {\n\t\tapp.sectionContainer.setZoomChanged(zoomChanged);\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._initContainer();\n\n\t\t// Initiate selection handles.\n\t\tthis._selectionHandles = {};\n\t\tthis._selectionHandles.start = new app.definitions.textSelectionHandleSection('selection_start_handle', 30, 44, new app.definitions.simplePoint(0, 0), 'text-selection-handle-start', false);\n\t\tthis._selectionHandles.end = new app.definitions.textSelectionHandleSection('selection_end_handle', 30, 44, new app.definitions.simplePoint(0, 0), 'text-selection-handle-end', false);\n\t\tthis._selectionHandles.active = false;\n\t\tapp.sectionContainer.addSection(this._map._docLayer._selectionHandles.start);\n\t\tapp.sectionContainer.addSection(this._map._docLayer._selectionHandles.end);\n\n\t\t// Cell selection handles (mobile & tablet).\n\t\tthis._cellSelectionHandleStart = new app.definitions.cellSelectionHandle('cell_selection_handle_start');\n\t\tthis._cellSelectionHandleEnd = new app.definitions.cellSelectionHandle('cell_selection_handle_end');\n\t\tapp.sectionContainer.addSection(this._map._docLayer._cellSelectionHandleStart);\n\t\tapp.sectionContainer.addSection(this._map._docLayer._cellSelectionHandleEnd);\n\n\t\tif (this.isCalc()) {\n\t\t\tvar cursorStyle = new CStyleData(this._cursorDataDiv);\n\t\t\tvar weight = cursorStyle.getFloatPropWithoutUnit('border-top-width') * app.dpiScale;\n\t\t\tvar color = cursorStyle.getPropValue('border-top-color');\n\t\t\tthis._cellCursorSection = new app.definitions.cellCursorSection(color, weight);\n\t\t\tapp.sectionContainer.addSection(this._cellCursorSection);\n\t\t}\n\n\t\tthis._getToolbarCommandsValues();\n\t\tthis._textCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'text');\n\t\tthis._cellCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'cell');\n\t\tthis._oleCSelections = new CSelections(undefined, this._canvasOverlay,\n\t\t\tthis._selectionsDataDiv, this._map, false /* isView */, undefined, 'ole');\n\t\tthis._references = new CReferences(this._canvasOverlay);\n\t\tthis._referencesAll = [];\n\n\t\t// This layergroup contains all the layers corresponding to other's view\n\t\tthis._viewLayerGroup = new L.LayerGroup();\n\t\tif (!app.isReadOnly()) {\n\t\t\tmap.addLayer(this._viewLayerGroup);\n\t\t}\n\n\t\tthis._debug = map._debug;\n\n\t\tthis._searchResultsLayer = new L.LayerGroup();\n\t\tmap.addLayer(this._searchResultsLayer);\n\n\t\tapp.socket.sendMessage('commandvalues command=.uno:AcceptTrackedChanges');\n\n\t\tmap._fadeAnimated = false;\n\t\tthis._viewReset();\n\n\t\tmap.on('dragover', this._onDragOver, this);\n\t\tmap.on('drop', this._onDrop, this);\n\n\t\tmap.on('zoomstart', this._onZoomStart, this);\n\t\tmap.on('zoomend', this._onZoomEnd, this);\n\t\tif (this._docType === 'spreadsheet') {\n\t\t\tmap.on('zoomend', this._onCellCursorShift, this);\n\t\t}\n\t\tmap.on('error', this._mapOnError, this);\n\t\tif (map.options.autoFitWidth !== false) {\n\t\t\t// always true since autoFitWidth is never set\n\t\t\tmap.on('resize', this._fitWidthZoom, this);\n\t\t}\n\t\tthis._map.on('resize', this._syncTileContainerSize, this);\n\t\t// Retrieve the initial cell cursor position (as LOK only sends us an\n\t\t// updated cell cursor when the selected cell is changed and not the initial\n\t\t// cell).\n\t\tmap.on('statusindicator',\n\t\t\tfunction (e) {\n\t\t\t\tif (e.statusType === 'alltilesloaded' && this._docType === 'spreadsheet') {\n\t\t\t\t\tif (!this._map.uiManager.isAnyDialogOpen())\n\t\t\t\t\t\tthis._onCellCursorShift(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis);\n\n\t\tapp.events.on('updatepermission', function(e) {\n\t\t\tif (e.detail.perm !== 'edit') {\n\t\t\t\tthis._clearSelections();\n\t\t\t}\n\t\t}.bind(this));\n\n\t\tmap.setPermission(app.file.permission);\n\n\t\tmap.fire('statusindicator', {statusType: 'coolloaded'});\n\n\t\tthis._map.sendInitUNOCommands();\n\n\t\tthis._resetClientVisArea();\n\t\tthis._requestNewTiles();\n\n\t\tmap.setZoom();\n\n\t\t// This is called when page size is increased\n\t\t// the content of the page that become visible may stay empty\n\t\t// unless we have the tiles in the cache already\n\t\t// This will only fetch the tiles which are invalid or does not exist\n\t\tmap.on('sizeincreased', function() {\n\t\t\tTileManager.update();\n\t\t}.bind(this));\n\t},\n\n\tonRemove: function (map) {\n\t\tL.DomUtil.remove(this._container);\n\t\tmap._removeZoomLimit(this);\n\t\tthis._container = null;\n\t\tthis._tileZoom = null;\n\t\tTileManager.clearPreFetch();\n\t\tclearTimeout(this._previewInvalidator);\n\n\t\tif (!this._cellCSelections.empty()) {\n\t\t\tthis._cellCSelections.clear();\n\t\t}\n\n\t\tif (!this._textCSelections.empty()) {\n\t\t\tthis._textCSelections.clear();\n\t\t}\n\n\t\tif (!this._oleCSelections.empty()) {\n\t\t\tthis._oleCSelections.clear();\n\t\t}\n\n\t\tif (this._cursorMarker && this._cursorMarker.isDomAttached()) {\n\t\t\tthis._cursorMarker.remove();\n\t\t}\n\n\t\tapp.sectionContainer.removeSection(this._selectionHandles.start);\n\t\tapp.sectionContainer.removeSection(this._selectionHandles.end);\n\n\t\tthis._removeSplitters();\n\t\tL.DomUtil.remove(this._canvasContainer);\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tviewreset: this._viewReset,\n\t\t\tmovestart: this._moveStart,\n\t\t\t// update tiles on move, but not more often than once per given interval\n\t\t\tmove: app.util.throttle(this._move, this.options.updateInterval, this),\n\t\t\tmoveend: this._moveEnd,\n\t\t\tsplitposchanged: this._move,\n\t\t};\n\n\t\treturn events;\n\t},\n\n\t// zoom is the new intermediate zoom level (log scale : 1 to 14)\n\tzoomStep: function (zoom, newCenter) {\n\t\tthis._painter.zoomStep(zoom, newCenter);\n\t},\n\n\tzoomStepEnd: function (zoom, newCenter, mapUpdater, runAtFinish, noGap) {\n\t\tthis._painter.zoomStepEnd(zoom, newCenter, mapUpdater, runAtFinish, noGap);\n\t},\n\n\tpreZoomAnimation: function (pinchStartCenter) {\n\t\tthis._pinchStartCenter = this._map.project(pinchStartCenter).multiplyBy(app.dpiScale); // in core pixels\n\t\tthis._painter._offset = new L.Point(0, 0);\n\n\t\tif (this._cursorMarker && app.file.textCursor.visible) {\n\t\t\tthis._cursorMarker.setOpacity(0);\n\t\t}\n\t\tif (this._map._textInput._cursorHandler) {\n\t\t\tthis._map._textInput._cursorHandler.setOpacity(0);\n\t\t}\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._cellCursorSection.setShowSection(false);\n\t\t}\n\n\t\tif (this._selectionHandles.start.isSectionShown())\n\t\t\tthis._selectionHandles.start.setOpacity(0);\n\t\tif (this._selectionHandles.end.isSectionShown())\n\t\t\tthis._selectionHandles.end.setOpacity(0);\n\n\t\tapp.definitions.otherViewCursorSection.updateVisibilities(true);\n\t},\n\n\tpostZoomAnimation: function () {\n\t\tif (app.file.textCursor.visible) {\n\t\t\tthis._cursorMarker.setOpacity(1);\n\t\t}\n\t\tif (this._map._textInput._cursorHandler) {\n\t\t\tthis._map._textInput._cursorHandler.setOpacity(1);\n\t\t}\n\n\t\tif (this.isCalc()) {\n\t\t\tthis._cellCursorSection.setShowSection(true);\n\t\t}\n\n\t\tif (this._selectionHandles.start.isSectionShown())\n\t\t\tthis._selectionHandles.start.setOpacity(1);\n\t\tif (this._selectionHandles.end.isSectionShown())\n\t\t\tthis._selectionHandles.end.setOpacity(1);\n\n\t\tif (this._annotations) {\n\t\t\tvar annotations = this._annotations;\n\t\t\tif (annotations.update)\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tannotations.update();\n\t\t\t\t}, 250 /* ms */);\n\t\t}\n\t},\n\n\t// Meant for desktop case, where the ending zoom and centers are all known in advance.\n\trunZoomAnimation: function (zoomEnd, pinchCenter, mapUpdater, runAtFinish) {\n\n\t\tif (this._map.getDocType() === 'spreadsheet')\n\t\t\tOtherViewCellCursorSection.closePopups();\n\n\t\tthis.preZoomAnimation(pinchCenter);\n\t\tthis.zoomStep(this._map.getZoom(), pinchCenter);\n\t\tvar thisObj = this;\n\t\tthis.zoomStepEnd(zoomEnd, pinchCenter,\n\t\t\tmapUpdater,\n\t\t\t// runAtFinish\n\t\t\tfunction () {\n\t\t\t\tthisObj.postZoomAnimation();\n\t\t\t\trunAtFinish();\n\t\t\t});\n\t},\n\n\t_viewReset: function (e) {\n\t\tthis._reset(e && e.hard);\n\t\tif (this._docType === 'spreadsheet' && this._annotations !== undefined) {\n\t\t\tapp.socket.sendMessage('commandvalues command=.uno:ViewAnnotationsPosition');\n\t\t}\n\t},\n\n\t_removeSplitters: function () {\n\t\tif (this._xSplitter) {\n\t\t\tthis._canvasOverlay.removePath(this._xSplitter);\n\t\t\tthis._xSplitter = undefined;\n\t\t}\n\n\t\tif (this._ySplitter) {\n\t\t\tthis._canvasOverlay.removePath(this._ySplitter);\n\t\t\tthis._ySplitter = undefined;\n\t\t}\n\t},\n\n\t_cssPixelsToCore: function (cssPixels) {\n\t\treturn cssPixels.multiplyBy(app.dpiScale);\n\t},\n\n\t_twipsToCorePixels: function (twips) {\n\t\treturn new L.Point(\n\t\t\ttwips.x * app.twipsToPixels,\n\t\t\ttwips.y * app.twipsToPixels);\n\t},\n\n\t_twipsToCorePixelsBounds: function (twips) {\n\t\treturn new L.Bounds(\n\t\t\tthis._twipsToCorePixels(twips.min),\n\t\t\tthis._twipsToCorePixels(twips.max)\n\t\t);\n\t},\n\n\t_corePixelsToTwips: function (corePixels) {\n\t\treturn new L.Point(\n\t\t\tcorePixels.x * app.pixelsToTwips,\n\t\t\tcorePixels.y * app.pixelsToTwips);\n\t},\n\n\t_twipsToCssPixels: function (twips) {\n\t\treturn new L.Point(\n\t\t\t(twips.x / app.tile.size.x) * (TileManager.tileSize / app.dpiScale),\n\t\t\t(twips.y / app.tile.size.y) * (TileManager.tileSize / app.dpiScale));\n\t},\n\n\t_cssPixelsToTwips: function (pixels) {\n\t\treturn new L.Point(\n\t\t\t(pixels.x * app.dpiScale) * app.pixelsToTwips,\n\t\t\t(pixels.y * app.dpiScale) * app.pixelsToTwips);\n\t},\n\n\t_twipsToLatLng: function (twips, zoom) {\n\t\tvar pixels = this._twipsToCssPixels(twips);\n\t\treturn this._map.unproject(pixels, zoom);\n\t},\n\n\t_latLngToTwips: function (latLng, zoom) {\n\t\tvar pixels = this._map.project(latLng, zoom);\n\t\treturn this._cssPixelsToTwips(pixels);\n\t},\n\n\t_twipsToPixels: function (twips) { // css pixels\n\t\treturn this._twipsToCssPixels(twips);\n\t},\n\n\t_pixelsToTwips: function (pixels) { // css pixels\n\t\treturn this._cssPixelsToTwips(pixels);\n\t},\n\n\t_updateMaxBounds: function (sizeChanged) {\n\t\tif (app.file.size.x === 0 || app.file.size.y === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar docPixelLimits = new L.Point(app.file.size.pX / app.dpiScale, app.file.size.pY / app.dpiScale);\n\t\tvar scrollPixelLimits = new L.Point(app.view.size.pX / app.dpiScale, app.view.size.pY / app.dpiScale);\n\t\tvar topLeft = this._map.unproject(new L.Point(0, 0));\n\n\t\tif (this._documentInfo === '' || sizeChanged) {\n\t\t\t// we just got the first status so we need to center the document\n\t\t\tthis._map.setDocBounds(new L.LatLngBounds(topLeft, this._map.unproject(docPixelLimits)));\n\t\t\tthis._map.setMaxBounds(new L.LatLngBounds(topLeft, this._map.unproject(scrollPixelLimits)));\n\t\t}\n\n\t\tthis._docPixelSize = {x: docPixelLimits.x, y: docPixelLimits.y};\n\t\tthis._map.fire('scrolllimits', {});\n\t},\n\n\t// Used with filebasedview.\n\t_getMostVisiblePart: function (queue) {\n\t\tvar parts = [];\n\t\tvar found = false;\n\n\t\tfor (var i = 0; i < queue.length; i++) {\n\t\t\tfor (var j = 0; j < parts.length; j++) {\n\t\t\t\tif (parts[j].part === queue[i].part) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found)\n\t\t\t\tparts.push({part: queue[i].part});\n\t\t\tfound = false;\n\t\t}\n\n\t\tvar ratio = TileManager.tileSize / app.tile.size.y;\n\t\tvar partHeightPixels = Math.round((this._partHeightTwips + this._spaceBetweenParts) * ratio);\n\t\tvar partWidthPixels = Math.round(this._partWidthTwips * ratio);\n\n\t\tvar rectangle;\n\t\tvar maxArea = -1;\n\t\tvar mostVisiblePart = 0;\n\t\tconst viewedRectangle = app.file.viewedRectangle.pToArray();\n\t\tfor (i = 0; i < parts.length; i++) {\n\t\t\trectangle = [0, partHeightPixels * parts[i].part, partWidthPixels, partHeightPixels];\n\t\t\trectangle = app.LOUtil._getIntersectionRectangle(rectangle, viewedRectangle);\n\t\t\tif (rectangle) {\n\t\t\t\tif (rectangle[2] * rectangle[3] > maxArea) {\n\t\t\t\t\tmaxArea = rectangle[2] * rectangle[3];\n\t\t\t\t\tmostVisiblePart = parts[i].part;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn mostVisiblePart;\n\t},\n\n\thighlightCurrentPart: function (part) {\n\t\tvar previews = document.getElementsByClassName('preview-frame');\n\t\tfor (var i = 0; i < previews.length; i++) {\n\t\t\tconst img = previews[i].querySelector('img');\n\t\t\tif (parseInt(previews[i].id.replace('preview-frame-part-', '')) === part) {\n\t\t\t\tL.DomUtil.addClass(img, 'preview-img-currentpart');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tL.DomUtil.removeClass(img, 'preview-img-currentpart');\n\t\t\t}\n\t\t}\n\t},\n\n\t// Used with file based view. Check the most visible part and set the selected part if needed.\n\t_checkSelectedPart: function () {\n\t\tvar queue = TileManager.updateFileBasedView(true);\n\t\tif (queue.length > 0) {\n\t\t\tvar partToSelect = this._getMostVisiblePart(queue);\n\t\t\tif (this._selectedPart !== partToSelect) {\n\t\t\t\tthis._selectedPart = partToSelect;\n\t\t\t\tthis._preview._scrollToPart();\n\t\t\t\tthis.highlightCurrentPart(partToSelect);\n\t\t\t\tapp.socket.sendMessage('setclientpart part=' + this._selectedPart);\n\t\t\t}\n\t\t}\n\t},\n\n\t_sendClientVisibleArea: function (forceUpdate) {\n\t\tif (!this._map._docLoaded)\n\t\t\treturn;\n\n\t\tif (app.file.writer.multiPageView)\n\t\t\treturn; // This view mode sends the client visible area after modifying the document position.\n\n\t\tvar splitPos = this._splitPanesContext ? this._splitPanesContext.getSplitPos() : new L.Point(0, 0);\n\n\t\tvar visibleArea = this._map.getPixelBounds();\n\t\tvisibleArea = new L.Bounds(\n\t\t\tthis._pixelsToTwips(visibleArea.min),\n\t\t\tthis._pixelsToTwips(visibleArea.max)\n\t\t);\n\t\tsplitPos = this._corePixelsToTwips(splitPos);\n\t\tvar size = visibleArea.getSize();\n\t\tvar visibleTopLeft = visibleArea.min;\n\t\tvar newClientVisibleArea = 'clientvisiblearea x=' + Math.round(visibleTopLeft.x)\n\t\t\t\t\t+ ' y=' + Math.round(visibleTopLeft.y)\n\t\t\t\t\t+ ' width=' + Math.round(size.x)\n\t\t\t\t\t+ ' height=' + Math.round(size.y)\n\t\t\t\t\t+ ' splitx=' + Math.round(splitPos.x)\n\t\t\t\t\t+ ' splity=' + Math.round(splitPos.y);\n\n\t\tif (this._clientVisibleArea !== newClientVisibleArea || forceUpdate) {\n\t\t\t// Only update on some change\n\t\t\tif (this._ySplitter) {\n\t\t\t\tthis._ySplitter.onPositionChange();\n\t\t\t}\n\t\t\tif (this._xSplitter) {\n\t\t\t\tthis._xSplitter.onPositionChange();\n\t\t\t}\n\t\t\t// Visible area is dirty, update it on the server\n\t\t\tapp.socket.sendMessage(newClientVisibleArea);\n\t\t\tif (!this._map._fatal && app.idleHandler._active && app.socket.connected())\n\t\t\t\tthis._clientVisibleArea = newClientVisibleArea;\n\t\t}\n\t},\n\n\t// Update debug overlay for a tile\n\t_showDebugForTile: function(key) {\n\t\tif (!this._debug.debugOn)\n\t\t\treturn;\n\n\t\tconst tile = TileManager.get(key);\n\t\ttile._debugTime = this._debug.getTimeArray();\n\t},\n\n\t_coordsToPixBounds: function (coords) {\n\t\t// coords.x and coords.y are the pixel coordinates of the top-left corner of the tile.\n\t\tvar topLeft = new L.Point(coords.x, coords.y);\n\t\tvar bottomRight = topLeft.add(new L.Point(TileManager.tileSize, TileManager.tileSize));\n\t\treturn new L.Bounds(topLeft, bottomRight);\n\t},\n\n\thasXSplitter: function () {\n\t\treturn !!(this._xSplitter);\n\t},\n\n\thasYSplitter: function () {\n\t\treturn !!(this._ySplitter);\n\t},\n\n\tgetTileSectionPos: function () {\n\t\treturn this._painter.getTileSectionPos();\n\t},\n\n\tisLayoutRTL: function () {\n\t\treturn !!this._layoutIsRTL;\n\t},\n\n\tisCalcRTL: function () {\n\t\treturn this.isCalc() && this.isLayoutRTL();\n\t}\n\n});\n\nL.MessageStore = L.Class.extend({\n\n\t// ownViewTypes : The types of messages related to own view.\n\t// otherViewTypes: The types of messages related to other views.\n\tinitialize: function (ownViewTypes, otherViewTypes) {\n\n\t\tif (!Array.isArray(ownViewTypes) || !Array.isArray(otherViewTypes)) {\n\t\t\twindow.app.console.error('Unexpected argument types');\n\t\t\treturn;\n\t\t}\n\n\t\tvar ownMessages = {};\n\t\townViewTypes.forEach(function (msgType) {\n\t\t\townMessages[msgType] = '';\n\t\t});\n\t\tthis._ownMessages = ownMessages;\n\n\t\tvar othersMessages = {};\n\t\totherViewTypes.forEach(function (msgType) {\n\t\t\tothersMessages[msgType] = [];\n\t\t});\n\t\tthis._othersMessages = othersMessages;\n\t},\n\n\tclear: function (notOtherMsg) {\n\t\tvar msgs = this._ownMessages;\n\t\tObject.keys(msgs).forEach(function (msgType) {\n\t\t\tmsgs[msgType] = '';\n\t\t});\n\n\t\tif (!notOtherMsg) {\n\t\t\tmsgs = this._othersMessages;\n\t\t\tObject.keys(msgs).forEach(function (msgType) {\n\t\t\t\tmsgs[msgType] = [];\n\t\t\t});\n\t\t}\n\t},\n\n\tsave: function (msgType, textMsg, viewId) {\n\n\t\tvar othersMessage = (typeof viewId === 'number');\n\n\t\tif (!othersMessage && Object.prototype.hasOwnProperty.call(this._ownMessages, msgType)) {\n\t\t\tthis._ownMessages[msgType] = textMsg;\n\t\t\treturn;\n\t\t}\n\n\t\tif (othersMessage && Object.prototype.hasOwnProperty.call(this._othersMessages, msgType)) {\n\t\t\tthis._othersMessages[msgType][viewId] = textMsg;\n\t\t}\n\t},\n\n\tget: function (msgType, viewId) {\n\n\t\tvar othersMessage = (typeof viewId === 'number');\n\n\t\tif (!othersMessage && Object.prototype.hasOwnProperty.call(this._ownMessages, msgType)) {\n\t\t\treturn this._ownMessages[msgType];\n\t\t}\n\n\t\tif (othersMessage && Object.prototype.hasOwnProperty.call(this._othersMessages, msgType)) {\n\t\t\treturn this._othersMessages[msgType][viewId];\n\t\t}\n\t},\n\n\tforEach: function (callback) {\n\t\tif (typeof callback !== 'function') {\n\t\t\twindow.app.console.error('Invalid callback type');\n\t\t\treturn;\n\t\t}\n\n\t\tthis._cleanUpSelectionMessages(this._ownMessages);\n\n\t\tvar ownMessages = this._ownMessages;\n\t\tObject.keys(this._ownMessages).forEach(function (msgType) {\n\t\t\tcallback(ownMessages[msgType]);\n\t\t});\n\n\t\tvar othersMessages = this._othersMessages;\n\t\tObject.keys(othersMessages).forEach(function (msgType) {\n\t\t\tothersMessages[msgType].forEach(callback);\n\t\t});\n\t},\n\n\t_cleanUpSelectionMessages: function(messages) {\n\t\t// must be called only from _replayPrintTwipsMsg !!\n\t\t// check if textselection is empty\n\t\t// if it is, we need to handle textselectionstart and textselectionend\n\t\t// otherwise we get handles without selection and they also may appear in the wrong cell\n\t\t// but it is also reproducible on the same cell too. e.g. selection handles without selection\n\t\tif (!messages && !messages['textselection'] && messages['textselection'] !== 'textselection: ')\n\t\t\treturn;\n\t\tmessages['textselectionstart'] = 'textselectionstart: ';\n\t\tmessages['textselectionend'] = 'textselectionend: ';\n\t}\n});\n"]}