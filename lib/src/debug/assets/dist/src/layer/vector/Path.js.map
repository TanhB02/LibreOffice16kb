{"version":3,"file":"Path.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/layer/vector/Path.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/* global app */\n/*\n * L.Path is the base class for all Leaflet vector layers like polygons and circles.\n */\n\nL.Path = L.Layer.extend({\n\n\toptions: {\n\t\tstroke: true,\n\t\tcolor: '#3388ff',\n\t\tweight: 3,\n\t\topacity: 1,\n\t\tlineCap: 'round',\n\t\tlineJoin: 'round',\n\t\t// dashArray: null\n\t\t// dashOffset: null\n\n\t\t// fill: false\n\t\t// fillColor: same as color by default\n\t\tfillOpacity: 0.2,\n\t\tfillRule: 'evenodd',\n\n\t\t// className: ''\n\t\tinteractive: true,\n\t\tfixed: false,\n\t},\n\n\tinitialize: function () {\n\t\tL.Layer.prototype.initialize.call(this);\n\t},\n\n\tonAdd: function () {\n\t\tthis._pathNodeCollection = new L.Path.PathNodeCollection();\n\t\tthis._renderer = this._map.getRenderer(this);\n\t\tthis._renderer._initPath(this);\n\t\tthis._reset();\n\t\tthis._renderer._addPath(this);\n\t},\n\n\tonRemove: function () {\n\t\tif (this._renderer)\n\t\t\tthis._renderer._removePath(this);\n\t\telse\n\t\t\tconsole.debug('Path.onRemove: this._renderer missing');\n\t},\n\n\tgetEvents: function () {\n\t\treturn {\n\t\t\tviewreset: this._project,\n\t\t\tmoveend: this._update\n\t\t};\n\t},\n\n\tredraw: function () {\n\t\tif (this._map) {\n\t\t\tthis._renderer._updatePath(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tsetStyle: function (style) {\n\t\tL.setOptions(this, style);\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._updateStyle(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToFront: function () {\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._bringToFront(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\tbringToBack: function () {\n\t\tif (this._renderer) {\n\t\t\tthis._renderer._bringToBack(this);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_reset: function () {\n\t\t// defined in child classes\n\t\tthis._project();\n\t\tthis._update();\n\t},\n\n\t_clickTolerance: function () {\n\t\t// used when doing hit detection for Canvas layers\n\t\treturn (\n\t\t\t(this.options.stroke ? this.options.weight / 2 : 0) +\n\t\t\t(window.touch.currentlyUsingTouchscreen() ? 10 : 0)\n\t\t);\n\t},\n\n\taddPathNode: function (pathNode, actualRenderer) {\n\n\t\tthis._path = undefined;\n\n\t\tif (!this._pathNodeCollection) {\n\t\t\tthis._pathNodeCollection = new L.Path.PathNodeCollection();\n\t\t}\n\n\t\tthis._pathNodeCollection.add(new L.Path.PathNodeData(pathNode, actualRenderer));\n\t},\n\n\tgetPathNode: function (actualRenderer) {\n\t\treturn this._pathNodeCollection.getPathNode(actualRenderer);\n\t},\n\n\taddClass: function (className) {\n\t\tthis._pathNodeCollection.addOrRemoveClass(className, true /* add */);\n\t},\n\n\tremoveClass: function (className) {\n\t\tthis._pathNodeCollection.addOrRemoveClass(className, false /* add */);\n\t},\n\n\tsetCursorType: function (cursorType) {\n\t\tthis._pathNodeCollection.setCursorType(cursorType);\n\t},\n\n});\n\nL.Path.PathNodeData = L.Class.extend({\n\n\tinitialize: function (pathNode, actualRenderer) {\n\n\t\twindow.app.console.assert(pathNode, 'invalid pathNode argument!');\n\t\twindow.app.console.assert(actualRenderer, 'invalid actualRenderer argument!');\n\n\t\tif (!(pathNode instanceof Node)) {\n\t\t\twindow.app.console.error('Not a node instance!');\n\t\t}\n\n\t\tthis._pathNode = pathNode;\n\t\tthis._actualRenderer = actualRenderer;\n\t\tthis._data = {};\n\t},\n\n\tkey: function () {\n\t\treturn L.Path.PathNodeData.key(this._actualRenderer);\n\t},\n\n\tgetNode: function () {\n\t\tif (!(this._pathNode instanceof Node)) {\n\t\t\twindow.app.console.error('Not a node instance!');\n\t\t}\n\t\treturn this._pathNode;\n\t},\n\n\tgetActualRenderer: function () {\n\t\treturn this._actualRenderer;\n\t},\n\n\tsetCustomField: function (fieldName, value) {\n\t\twindow.app.console.assert(typeof fieldName === 'string' && fieldName, 'invalid fieldName');\n\t\tthis._data[fieldName] = value;\n\t},\n\n\tgetCustomField: function (fieldName) {\n\t\twindow.app.console.assert(typeof fieldName === 'string' && fieldName, 'invalid fieldName');\n\t\treturn this._data[fieldName];\n\t},\n\n\tclearCustomField: function (fieldName) {\n\t\twindow.app.console.assert(typeof fieldName === 'string' && fieldName, 'invalid fieldName');\n\t\tdelete this._data[fieldName];\n\t},\n\n\taddOrRemoveClass: function (className, add) {\n\t\tif (add) {\n\t\t\tL.DomUtil.addClass(this._pathNode, className);\n\t\t}\n\t\telse {\n\t\t\tL.DomUtil.removeClass(this._pathNode, className);\n\t\t}\n\t},\n\n\tsetCursorType: function (cursorType) {\n\t\tthis._pathNode.style.cursor = cursorType;\n\t},\n\n});\n\nL.Path.PathNodeData.key = function (layer) {\n\treturn app.util.stamp(layer);\n};\n\nL.Path.PathNodeCollection = L.Class.extend({\n\n\tinitialize: function () {\n\t\tthis.clear();\n\t},\n\n\tadd: function (pathNodeData) {\n\n\t\twindow.app.console.assert(pathNodeData instanceof L.Path.PathNodeData,\n\t\t\t'invalid pathNodeData argument!');\n\n\t\tthis._collection[pathNodeData.key()] = pathNodeData;\n\t},\n\n\tclear: function () {\n\t\tthis._collection = {};\n\t},\n\n\tgetPathNode: function (actualRenderer) {\n\n\t\twindow.app.console.assert(actualRenderer, 'invalid actualRenderer argument!');\n\t\tvar key = L.Path.PathNodeData.key(actualRenderer);\n\t\tvar nodeData = this._collection[key];\n\n\t\twindow.app.console.assert(nodeData, 'cannot find path node!');\n\n\t\treturn nodeData.getNode();\n\t},\n\n\tforEachNode: function (callback) {\n\t\tvar that = this;\n\t\tObject.keys(this._collection).forEach(function (key) {\n\t\t\tcallback(that._collection[key]);\n\t\t});\n\t},\n\n\taddOrRemoveClass: function (className, add) {\n\t\twindow.app.console.assert(className, 'className not provided!');\n\t\tthis.forEachNode(function (nodeData) {\n\t\t\tnodeData.addOrRemoveClass(className, add);\n\t\t});\n\t},\n\n\tsetCursorType: function (cursorType) {\n\t\tthis.forEachNode(function (nodeData) {\n\t\t\tnodeData.setCursorType(cursorType);\n\t\t});\n\t},\n\n});\n"]}