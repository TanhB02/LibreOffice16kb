{"version":3,"file":"Renderer.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/layer/vector/Renderer.js"],"names":[],"mappings":"AAAA,gCAAgC;AAChC,gBAAgB;AAChB;;;GAGG;AAEH,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;IAE3B,OAAO,EAAE;QACR,8EAA8E;QAC9E,0FAA0F;QAC1F,OAAO,EAAE,CAAC;KACV;IAED,UAAU,EAAE,UAAU,OAAO;QAE5B,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAExC,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC5B,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACtB,CAAC;IAED,iBAAiB,EAAE,UAAU,MAAM;QAClC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,KAAK,IAAI,EAAE,gBAAgB,CAAC,CAAC;QAC7D,IAAI,CAAC,eAAe,GAAG,MAAM,CAAC;IAC/B,CAAC;IAED,KAAK,EAAE;QACN,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACrB,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,sCAAsC;SAC7D;QAED,IAAI,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACjE;aACI;YACJ,IAAI,CAAC,OAAO,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAC5C;QAED,IAAI,IAAI,CAAC,UAAU;YAClB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC,CAAC;QAEpE,IAAI,CAAC,OAAO,EAAE,CAAC;IAChB,CAAC;IAED,QAAQ,EAAE;QACT,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IACnC,CAAC;IAED,SAAS,EAAE;QACV,IAAI,MAAM,GAAG;YACZ,OAAO,EAAE,IAAI,CAAC,OAAO;SACrB,CAAC;QACF,OAAO,MAAM,CAAC;IACf,CAAC;IAED,OAAO,EAAE;QACR,oFAAoF;QACpF,IAAI,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAC7D,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,QAAQ,CAAC;YACpC,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC;YAChC,OAAO;SACP;QAED,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EACxB,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAC1B,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,sCAAsC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC;QAExF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;QAC9E,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IACnC,CAAC;IAED,YAAY,EAAE;QACb,OAAO,IAAI,CAAC,UAAU,CAAC;IACxB,CAAC;IAED,SAAS,EAAE;QACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB,CAAC;IAED,gBAAgB,EAAE,UAAU,QAAQ;QACnC,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;IAC1C,CAAC;IAED,iBAAiB,EAAE,UAAU,SAAS;QACrC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;IAChD,CAAC;IAED,oBAAoB,EAAE,UAAU,SAAS;QACxC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;IACnD,CAAC;CAED,CAAC,CAAC;AAGH,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC;IACb,4DAA4D;IAC5D,WAAW,EAAE,UAAU,KAAK;QAC3B,IAAI,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC;QAE9H,IAAI,CAAC,QAAQ,EAAE;YACd,IAAI,IAAI,CAAC,oBAAoB,EAAE,EAAE;gBAChC,QAAQ,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,aAAa,IAAI,CAAC,CAAC,aAAa,EAAE,CAAC;oBAC1E,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,gBAAgB,IAAI,CAAC,CAAC,gBAAgB,EAAE,CAAC,CAAC;aAC1D;iBACI;gBACJ,QAAQ,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;aAC3E;SACD;QAED,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,0BAA0B,CAAC,CAAC;QAEhE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;YAC7B,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SACxB;QACD,OAAO,QAAQ,CAAC;IACjB,CAAC;IAED,gBAAgB,EAAE,UAAU,IAAI;QAC/B,IAAI,IAAI,KAAK,aAAa,IAAI,IAAI,KAAK,SAAS,EAAE;YACjD,OAAO,KAAK,CAAC;SACb;QAED,IAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,QAAQ,KAAK,SAAS,EAAE;YAC3B,IAAI,IAAI,CAAC,oBAAoB,EAAE,EAAE;gBAChC,QAAQ,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,aAAa,IAAI,CAAC,CAAC,aAAa,CAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;oBACrE,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,gBAAgB,IAAI,CAAC,CAAC,gBAAgB,CAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;aACtE;iBACI;gBACJ,QAAQ,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,CAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;aAClF;YAED,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,0BAA0B,CAAC,CAAC;YAChE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;SACrC;QAED,OAAO,QAAQ,CAAC;IACjB,CAAC;CACD,CAAC,CAAC","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/* global app */\n/*\n * L.Renderer is a base class for renderer implementations (SVG, Canvas);\n * handles renderer container, bounds and zoom animation.\n */\n\nL.Renderer = L.Layer.extend({\n\n\toptions: {\n\t\t// how much to extend the clip area around the map view (relative to its size)\n\t\t// e.g. 0.1 would be 10% of map view in each direction; defaults to clip with the map view\n\t\tpadding: 0\n\t},\n\n\tinitialize: function (options) {\n\n\t\tL.Layer.prototype.initialize.call(this);\n\n\t\tL.setOptions(this, options);\n\t\tapp.util.stamp(this);\n\t},\n\n\tsetParentRenderer: function (parent) {\n\t\twindow.app.console.assert(parent !== this, 'self reference');\n\t\tthis._parentRenderer = parent;\n\t},\n\n\tonAdd: function () {\n\t\tif (!this._container) {\n\t\t\tthis._initContainer(); // defined by renderer implementations\n\t\t}\n\n\t\tif (this._parentRenderer) {\n\t\t\tthis._parentRenderer.getContainer().appendChild(this._container);\n\t\t}\n\t\telse {\n\t\t\tthis.getPane().appendChild(this._container);\n\t\t}\n\n\t\tif (this.rendererId)\n\t\t\tL.DomUtil.addClass(this._container, this.rendererId + '-svg-pane');\n\n\t\tthis._update();\n\t},\n\n\tonRemove: function () {\n\t\tL.DomUtil.remove(this._container);\n\t},\n\n\tgetEvents: function () {\n\t\tvar events = {\n\t\t\tmoveend: this._update\n\t\t};\n\t\treturn events;\n\t},\n\n\t_update: function () {\n\t\t// update pixel bounds of renderer container (for positioning/sizing/clipping later)\n\t\tif (this._parentRenderer) {\n\t\t\tvar posBounds = this._parentRenderer.getChildPosBounds(this);\n\t\t\tthis._position = posBounds.position;\n\t\t\tthis._bounds = posBounds.bounds;\n\t\t\treturn;\n\t\t}\n\n\t\tvar p = this.options.padding,\n\t\t    size = this._map.getSize(),\n\t\t    min = this._map.containerPointToLayerPointIgnoreSplits(size.multiplyBy(-p)).round();\n\n\t\tthis._bounds = new L.Bounds(min, min.add(size.multiplyBy(1 + p * 2)).round());\n\t\tthis._position = this._bounds.min;\n\t},\n\n\tgetContainer: function () {\n\t\treturn this._container;\n\t},\n\n\tgetBounds: function () {\n\t\treturn this._bounds;\n\t},\n\n\tintersectsBounds: function (pxBounds) {\n\t\treturn this._bounds.intersects(pxBounds);\n\t},\n\n\taddContainerClass: function (className) {\n\t\tL.DomUtil.addClass(this._container, className);\n\t},\n\n\tremoveContainerClass: function (className) {\n\t\tL.DomUtil.removeClass(this._container, className);\n\t},\n\n});\n\n\nL.Map.include({\n\t// used by each vector layer to decide which renderer to use\n\tgetRenderer: function (layer) {\n\t\tvar renderer = layer.options.renderer || this._getPaneRenderer(layer.options.pane) || this.options.renderer || this._renderer;\n\n\t\tif (!renderer) {\n\t\t\tif (this.getSplitPanesContext()) {\n\t\t\t\trenderer = this._renderer = (L.SVG && L.SplitPanesSVG && L.splitPanesSVG()) ||\n\t\t\t\t\t(L.Canvas && L.SplitPanesCanvas && L.splitPanesCanvas());\n\t\t\t}\n\t\t\telse {\n\t\t\t\trenderer = this._renderer = (L.SVG && L.svg()) || (L.Canvas && L.canvas());\n\t\t\t}\n\t\t}\n\n\t\twindow.app.console.assert(renderer, 'Could create a renderer!');\n\n\t\tif (!this.hasLayer(renderer)) {\n\t\t\tthis.addLayer(renderer);\n\t\t}\n\t\treturn renderer;\n\t},\n\n\t_getPaneRenderer: function (name) {\n\t\tif (name === 'overlayPane' || name === undefined) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar renderer = this._paneRenderers[name];\n\t\tif (renderer === undefined) {\n\t\t\tif (this.getSplitPanesContext()) {\n\t\t\t\trenderer = (L.SVG && L.SplitPanesSVG && L.splitPanesSVG({pane: name})) ||\n\t\t\t\t\t(L.Canvas && L.SplitPanesCanvas && L.splitPanesCanvas({pane: name}));\n\t\t\t}\n\t\t\telse {\n\t\t\t\trenderer = (L.SVG && L.svg({pane: name})) || (L.Canvas && L.canvas({pane: name}));\n\t\t\t}\n\n\t\t\twindow.app.console.assert(renderer, 'Could create a renderer!');\n\t\t\tthis._paneRenderers[name] = renderer;\n\t\t}\n\n\t\treturn renderer;\n\t}\n});\n"]}