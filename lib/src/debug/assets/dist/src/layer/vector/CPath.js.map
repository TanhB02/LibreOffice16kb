{"version":3,"file":"CPath.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/layer/vector/CPath.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n\ndeclare var L: any;\n\n/*\n * CPath is the base class for all vector paths like polygons and circles used to draw overlay\n * objects like cell-cursors, cell-selections etc.\n */\n\nabstract class CPath extends CEventsHandler {\n\tname: string = '';\n\tstroke: boolean = true;\n\tcolor: string = '#3388ff';\n\tweight: number = 3;\n\topacity: number = 1;\n\tlineCap: CanvasLineCap = 'round';\n\tlineJoin: CanvasLineJoin = 'round';\n\tfill: boolean = false;\n\tfillGradient: boolean = false;\n\tfillColor: string = this.color;\n\tfillOpacity: number = 0.2;\n\tfillRule: CanvasFillRule = 'evenodd';\n\tinteractive: boolean = true;\n\tfixed: boolean = false; // CPath coordinates are the same as overlay section coordinates.\n\tcursorType: string;\n\tthickness: number = 2;\n\tviewId: number = -1;\n\tgroupType: PathGroupType = PathGroupType.Other;\n\ttoCompatUnits: (from: cool.PointConvertable) => any;\n\n\tradius: number = 0;\n\tradiusY: number = 0;\n\tpoint: cool.Point;\n\tzIndex: number = 0;\n\n\tstatic countObjects: number = 0;\n\tprivate id: number;\n\tprivate isDeleted: boolean = false;\n\tprivate testDiv: HTMLDivElement;\n\tprotected renderer: CanvasOverlay = null;\n\tprotected underMouse: boolean = false;\n\tprivate popup: any;\n\tprivate popupHandlersAdded: boolean = false;\n\tprivate popupTimer: NodeJS.Timeout;\n\n\tconstructor(options: any) {\n\t\tsuper();\n\t\tthis.setStyleOptions(options);\n\n\t\tthis.radius = options.radius !== undefined ? options.radius : this.radius;\n\t\tthis.radiusY = options.radiusY !== undefined ? options.radiusY : this.radiusY;\n\t\tthis.point = options.point !== undefined ? options.point : this.point;\n\t\tthis.toCompatUnits = options.toCompatUnits !== undefined ? options.toCompatUnits : this.toCompatUnits;\n\n\t\tthis.viewId = CPath.getViewId(options);\n\t\tif (options.groupType !== undefined)\n\t\t\tthis.groupType = options.groupType;\n\n\t\tCPath.countObjects += 1;\n\t\tthis.id = CPath.countObjects;\n\t\tthis.zIndex = this.id;\n\t\tthis.addSupportedEvents(['popupopen', 'popupclose']);\n\t}\n\n\tstatic getViewId(options: any): number {\n\t\tif (options.viewId === undefined || options.viewId === null) // Own cell cursor/selection\n\t\t\treturn -1;\n\t\telse\n\t\t\treturn parseInt(options.viewId);\n\t}\n\n\tsetStyleOptions(options: any) {\n\t\tthis.name = options.name !== undefined ? options.name : this.name;\n\t\tthis.stroke = options.stroke !== undefined ? options.stroke : this.stroke;\n\t\tthis.color = options.color !== undefined ? options.color : this.color;\n\t\tthis.weight = options.weight !== undefined ? options.weight : this.weight;\n\t\tthis.opacity = options.opacity !== undefined ? options.opacity : this.opacity;\n\t\tthis.lineCap = options.lineCap !== undefined ? options.lineCap : this.lineCap;\n\t\tthis.lineJoin = options.lineJoin !== undefined ? options.lineJoin : this.lineJoin;\n\t\tthis.fill = options.fill !== undefined ? options.fill : this.fill;\n\t\tthis.fillColor = options.fillColor !== undefined ? options.fillColor : this.fillColor;\n\t\tthis.fillOpacity = options.fillOpacity !== undefined ? options.fillOpacity : this.fillOpacity;\n\t\tthis.fillRule = options.fillRule !== undefined ? options.fillRule : this.fillRule;\n\t\tthis.cursorType = options.cursorType !== undefined ? options.cursorType : this.cursorType;\n\t\tthis.thickness = options.thickness !== undefined ? options.thickness : this.thickness;\n\t\tthis.interactive = options.interactive !== undefined ? options.interactive : this.interactive;\n\t\tthis.fixed = options.fixed !== undefined ? options.fixed : this.fixed;\n\t}\n\n\tsetRenderer(rendererObj: CanvasOverlay) {\n\t\tthis.renderer = rendererObj;\n\t\tif (this.renderer) {\n\t\t\tthis.addPathTestDiv();\n\t\t}\n\t\tthis.fire('add', {});\n\t}\n\n\t// Adds a div for cypress-tests (if active) for this CPath if not already done.\n\tprivate addPathTestDiv() {\n\t\tvar testContainer = this.renderer.getTestDiv();\n\t\tif (testContainer && !this.testDiv) {\n\t\t\tthis.testDiv = document.createElement('div');\n\t\t\tthis.testDiv.id = 'test-div-overlay-' + this.name;\n\t\t\ttestContainer.appendChild(this.testDiv);\n\t\t}\n\t}\n\n\t// Used by cypress tests to assert on the bounds of CPaths.\n\tprotected updateTestData() {\n\t\tif (!this.testDiv)\n\t\t\treturn;\n\t\tvar bounds = this.getBounds();\n\t\tif (this.empty() || !bounds.isValid()) {\n\t\t\tthis.testDiv.innerText = '{}';\n\t\t\treturn;\n\t\t}\n\n\t\tvar topLeft = bounds.getTopLeft();\n\t\tvar size = bounds.getSize();\n\t\tthis.testDiv.innerText = JSON.stringify({\n\t\t\ttop: Math.round(topLeft.y),\n\t\t\tleft: Math.round(topLeft.x),\n\t\t\twidth: Math.round(size.x),\n\t\t\theight: Math.round(size.y)\n\t\t});\n\t}\n\n\tgetId(): number {\n\t\treturn this.id;\n\t}\n\n\tsetDeleted() {\n\t\tthis.fire('remove', {});\n\t\tthis.isDeleted = true;\n\t\tif (this.testDiv) {\n\t\t\tthis.testDiv.remove();\n\t\t\tthis.testDiv = undefined;\n\t\t}\n\t}\n\n\tisUnderMouse(): boolean {\n\t\treturn this.underMouse;\n\t}\n\n\tsetUnderMouse(isUnder: boolean) {\n\t\tthis.underMouse = isUnder;\n\t}\n\n\tonMouseEnter(position: cool.Point) {\n\t\tthis.fire('mouseenter', {position: position});\n\t}\n\n\tonMouseLeave(position: cool.Point) {\n\t\tthis.fire('mouseleave', {position: position});\n\t}\n\n\tredraw(oldBounds: cool.Bounds) {\n\t\tif (this.renderer)\n\t\t\tthis.renderer.updatePath(this, oldBounds);\n\t}\n\n\tsetStyle(style: any) {\n\t\tvar oldBounds = this.getBounds();\n\t\tthis.setStyleOptions(style);\n\t\tif (this.renderer) {\n\t\t\tthis.renderer.updateStyle(this, oldBounds);\n\t\t}\n\t}\n\n\tupdatePathAllPanes(paintArea?: cool.Bounds) {\n\t\tvar viewBounds = this.renderer.getBounds().clone();\n\n\t\tif (this.fixed) {\n\t\t\t// Ignore freeze-panes.\n\t\t\tvar fixedMapArea = new cool.Bounds(\n\t\t\t\tnew cool.Point(0, 0),\n\t\t\t\tviewBounds.getSize()\n\t\t\t);\n\t\t\tthis.updatePath(fixedMapArea, fixedMapArea);\n\t\t\tthis.updateTestData();\n\t\t\treturn;\n\t\t}\n\n\t\tvar splitPanesContext = this.renderer.getSplitPanesContext();\n\t\tvar paneBoundsList: Array<cool.Bounds> = splitPanesContext ?\n\t\t\tsplitPanesContext.getPxBoundList() :\n\t\t\t[viewBounds];\n\n\t\tlet maxXBound = 0;\n\t\tlet maxYBound = 0;\n\n\t\tfor (const paneBounds of paneBoundsList) {\n\t\t\tmaxXBound = Math.max(maxXBound, paneBounds.min.x);\n\t\t\tmaxYBound = Math.max(maxYBound, paneBounds.min.y);\n\t\t}\n\n\t\tfor (var i = 0; i < paneBoundsList.length; ++i) {\n\t\t\tvar panePaintArea = paintArea ? paintArea.clone() : paneBoundsList[i].clone();\n\t\t\tvar paneArea = paneBoundsList[i];\n\t\t\tif (paintArea) {\n\n\t\t\t\tif (!paneArea.intersects(panePaintArea))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tpanePaintArea.min.x = Math.max(panePaintArea.min.x, paneArea.min.x);\n\t\t\t\tpanePaintArea.min.y = Math.max(panePaintArea.min.y, paneArea.min.y);\n\n\t\t\t\tpanePaintArea.max.x = Math.min(panePaintArea.max.x, paneArea.max.x);\n\t\t\t\tpanePaintArea.max.y = Math.min(panePaintArea.max.y, paneArea.max.y);\n\t\t\t}\n\n\t\t\tlet freezeX: boolean;\n\t\t\tlet freezeY: boolean;\n\t\t\tif (paneArea.min.x === 0 && maxXBound !== 0) {\n\t\t\t\tfreezeX = true;\n\t\t\t} else {\n\t\t\t\tfreezeX = false;\n\t\t\t}\n\n\t\t\tif (paneArea.min.y === 0 && maxYBound !== 0) {\n\t\t\t\tfreezeY = true;\n\t\t\t} else {\n\t\t\t\tfreezeY = false;\n\t\t\t}\n\n\t\t\tthis.updatePath(panePaintArea, paneArea, { freezeX, freezeY });\n\t\t}\n\n\t\tthis.updateTestData();\n\t}\n\n\tupdatePath(paintArea?: cool.Bounds, paneBounds?: cool.Bounds, freezePane?: { freezeX: boolean, freezeY: boolean }) {\n\t\t// Overridden in implementations.\n\t}\n\n\tbringToFront() {\n\t\tif (this.renderer) {\n\t\t\tthis.renderer.bringToFront(this);\n\t\t}\n\t}\n\n\tbringToBack() {\n\t\tif (this.renderer) {\n\t\t\tthis.renderer.bringToBack(this);\n\t\t}\n\t}\n\n\tgetBounds(): cool.Bounds {\n\t\t// Overridden in implementations.\n\t\treturn undefined;\n\t}\n\n\tempty(): boolean {\n\t\t// Overridden in implementations.\n\t\treturn true;\n\t}\n\n\tgetParts(): Array<Array<cool.Point>> {\n\t\t// Overridden in implementations.\n\t\treturn Array<Array<cool.Point>>();\n\t}\n\n\tclickTolerance(): number {\n\t\t// used when doing hit detection for Canvas layers\n\t\treturn (\n\t\t\t(this.stroke ? this.weight / 2 : 0) +\n\t\t\t((\n\t\t\t\twindow as typeof window & { touch: any }\n\t\t\t).touch.currentlyUsingTouchscreen()\n\t\t\t\t? 10\n\t\t\t\t: 0)\n\t\t);\n\t}\n\n\tsetCursorType(cursorType: string) {\n\t\t// TODO: Implement this using move-move + hover handler.\n\t\tthis.cursorType = cursorType;\n\t}\n\n\tonResize() {\n\t\t// Overridden in implementations.\n\t}\n\n\tgetMap(): any {\n\t\tif (this.renderer) {\n\t\t\treturn this.renderer.getMap();\n\t\t}\n\t}\n}\n\n// This also defines partial rendering order.\nenum PathGroupType {\n\tCellSelection, // bottom.\n\tTextSelection,\n\tCellCursor,\n\tOther  // top.\n}\n\nclass CPathGroup {\n\tprivate paths: CPath[];\n\n\tconstructor(paths: CPath[]) {\n\t\tthis.paths = paths;\n\t}\n\n\tforEach(callback: (path: CPath, index: number, pathArray: CPath[]) => void) {\n\t\tthis.paths.forEach(callback);\n\t}\n\n\tpush(path: CPath) {\n\t\tthis.paths.push(path);\n\t}\n}\n"]}