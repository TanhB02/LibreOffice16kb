{"version":3,"file":"Path.Drag.js","sourceRoot":"","sources":["../../../../../../../../../../../TanhX/online/browser/src/layer/vector/Path.Drag.js"],"names":[],"mappings":"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","sourcesContent":["/* -*- js-indent-level: 8 -*- */\n/* global app */\n\nvar END = {\n\tmousedown:     'mouseup',\n\ttouchstart:    'touchend',\n\tpointerdown:   'touchend',\n\tMSPointerDown: 'touchend'\n};\n\nvar MOVE = {\n\tmousedown:     'mousemove',\n\ttouchstart:    'touchmove',\n\tpointerdown:   'touchmove',\n\tMSPointerDown: 'touchmove'\n};\n\nfunction distance(a, b) {\n\tvar dx = a.x - b.x, dy = a.y - b.y;\n\treturn Math.sqrt(dx * dx + dy * dy);\n}\n\n/**\n * Drag handler\n * @class L.Path.Drag\n * @extends {L.Handler}\n */\nL.Handler.PathDrag = L.Handler.extend(/** @lends  L.Path.Drag.prototype */ {\n\n\tstatics: {\n\t\tDRAGGING_CLS: 'leaflet-path-draggable',\n\t},\n\n\n\t/**\n\t* @param  {L.Path} path\n\t* @constructor\n\t*/\n\tinitialize: function(path) {\n\n\t\t/**\n\t\t* @type {L.Path}\n\t\t*/\n\t\tthis._path = path;\n\n\t\t/**\n\t\t* @type {Array.<Number>}\n\t\t*/\n\t\tthis._matrix = null;\n\n\t\t/**\n\t\t* @type {L.Point}\n\t\t*/\n\t\tthis._startPoint = null;\n\n\t\t/**\n\t\t* @type {L.Point}\n\t\t*/\n\t\tthis._dragStartPoint = null;\n\n\t\t/**\n\t\t* @type {Boolean}\n\t\t*/\n\t\tthis._mapDraggingWasEnabled = false;\n\n\t},\n\n\tnoManualDrag: window.memo.decorator(function(f) {\n\t\tif ('noManualDrag' in this._path) {\n\t\t\treturn this._path.noManualDrag.bind(this._path)(f).bind(this._path);\n\t\t} else {\n\t\t\treturn f;\n\t\t}\n\t}),\n\n\t/**\n\t* Enable dragging\n\t*/\n\taddHooks: function() {\n\t\tthis._path.on('mousedown', this._onDragStart, this);\n\n\t\tthis._path.options.className = this._path.options.className ?\n\t\t\t(this._path.options.className + ' ' + L.Handler.PathDrag.DRAGGING_CLS) :\n\t\t\t L.Handler.PathDrag.DRAGGING_CLS;\n\n\t\tthis._path.addClass(L.Handler.PathDrag.DRAGGING_CLS);\n\t},\n\n\t/**\n\t* Disable dragging\n\t*/\n\tremoveHooks: function() {\n\t\tthis._path.off('mousedown', this._onDragStart, this);\n\n\t\tthis._path.options.className = this._path.options.className\n\t\t\t.replace(new RegExp('\\\\s+' + L.Handler.PathDrag.DRAGGING_CLS), '');\n\n\t\tthis._path.removeClass(L.Handler.PathDrag.DRAGGING_CLS);\n\n\t\tL.DomEvent.off(document, 'mousemove touchmove', this.noManualDrag(window.memo.bind(this._onDrag, this)),    this);\n\t\tL.DomEvent.off(document, 'mouseup touchend',    this.noManualDrag(window.memo.bind(this._onDragEnd, this)), this);\n\t},\n\n\t/**\n\t* @return {Boolean}\n\t*/\n\tmoved: function() {\n\t\treturn this._path._dragMoved;\n\t},\n\n\t/**\n\t* Start drag\n\t* @param  {L.MouseEvent} evt\n\t*/\n\t_onDragStart: function(evt) {\n\t\tvar eventType = evt.originalEvent._simulated ? 'touchstart' : evt.originalEvent.type;\n\n\t\tif (!MOVE[eventType])\n\t\t\treturn;\n\n\t\tthis._mouseDown = evt.originalEvent;\n\t\tthis._mapDraggingWasEnabled = false;\n\t\tthis._startPoint = evt.containerPoint.clone();\n\t\tthis._dragStartPoint = evt.containerPoint.clone();\n\t\tthis._matrix = [1, 0, 0, 1, 0, 0];\n\t\tL.DomEvent.stop(evt.originalEvent);\n\n\t\tthis._path._renderer.addContainerClass('leaflet-interactive');\n\n\t\tL.DomEvent\n\t\t .on(document, MOVE[eventType], this.noManualDrag(window.memo.bind(this._onDrag, this)),    this)\n\t\t .on(document, END[eventType],  this.noManualDrag(window.memo.bind(this._onDragEnd, this)), this);\n\n\t\tif (this._path._map.dragging.enabled()) {\n\t\t\t// I guess it's required because mousedown gets simulated with a delay\n\t\t\t//this._path._map.dragging._draggable._onUp(evt);\n\n\t\t\tthis._path._map.dragging.disable();\n\t\t\tthis._mapDraggingWasEnabled = true;\n\t\t}\n\t\tthis._path._dragMoved = false;\n\n\t\tif (this._path._popup) { // that might be a case on touch devices as well\n\t\t\tthis._path._popup._close();\n\t\t}\n\n\t\tthis._replaceCoordGetters(evt);\n\t},\n\n\t/**\n\t* Dragging\n\t* @param  {L.MouseEvent} evt\n\t*/\n\t_onDrag: function(evt) {\n\t\tif (!this._startPoint)\n\t\t\treturn;\n\n\t\tL.DomEvent.stop(evt);\n\n\t\tvar first = (evt.touches && evt.touches.length >= 1 ? evt.touches[0] : evt);\n\t\tvar containerPoint = this._path._map.mouseEventToContainerPoint(first);\n\n\t\t// skip taps\n\t\tif (evt.type === 'touchmove' && !this._path._dragMoved) {\n\t\t\tvar totalMouseDragDistance = this._dragStartPoint.distanceTo(containerPoint);\n\t\t\tif (totalMouseDragDistance <= this._path._map.options.tapTolerance) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this._startPoint === null)\n\t\t\treturn;\n\n\t\tvar x = containerPoint.x;\n\t\tvar y = containerPoint.y;\n\n\t\tvar dx = x - this._startPoint.x;\n\t\tvar dy = y - this._startPoint.y;\n\n\t\tif (isNaN(dx) || isNaN(dy))\n\t\t\treturn;\n\n\t\tif (this.constraint) {\n\t\t\tif (this.constraint.dragMethod === 'PieSegmentDragging') {\n\t\t\t\tvar initialOffset = this.constraint.initialOffset;\n\t\t\t\tvar dragDirection = this.constraint.dragDirection;\n\n\t\t\t\tvar dsx = x - this._dragStartPoint.x;\n\t\t\t\tvar dsy = y - this._dragStartPoint.y;\n\t\t\t\tvar additionalOffset = (dsx * dragDirection.x + dsy * dragDirection.y) / this.constraint.range2;\n\t\t\t\tvar currentOffset = (dx * dragDirection.x + dy * dragDirection.y) / this.constraint.range2;\n\n\t\t\t\tif (additionalOffset < -initialOffset && currentOffset < 0)\n\t\t\t\t\tcurrentOffset = 0;\n\t\t\t\telse if (additionalOffset > (1.0 - initialOffset) && currentOffset > 0)\n\t\t\t\t\tcurrentOffset = 0;\n\n\t\t\t\tdx = currentOffset * dragDirection.x;\n\t\t\t\tdy = currentOffset * dragDirection.y;\n\n\t\t\t\tx = this._startPoint.x + dx;\n\t\t\t\ty = this._startPoint.y + dy;\n\t\t\t}\n\t\t}\n\n\t\t// Send events only if point was moved\n\t\tif (dx || dy) {\n\t\t\tif (!this._path._dragMoved) {\n\t\t\t\tthis._path._dragMoved = true;\n\t\t\t\tthis._path.fire('dragstart', evt);\n\t\t\t\t// we don't want that to happen on click\n\t\t\t\tthis._path.bringToFront();\n\t\t\t}\n\n\t\t\tthis._matrix[4] += dx;\n\t\t\tthis._matrix[5] += dy;\n\n\t\t\tthis._startPoint.x = x;\n\t\t\tthis._startPoint.y = y;\n\n\t\t\tthis._path.fire('predrag', evt);\n\t\t\tthis._path._transform(this._matrix);\n\t\t\tthis._path.fire('drag', evt);\n\t\t}\n\t},\n\n\t/**\n\t* Dragging stopped, apply\n\t* @param  {L.MouseEvent} evt\n\t*/\n\t_onDragEnd: function(evt) {\n\t\tL.DomEvent.stop(evt);\n\t\tvar containerPoint = this._path._map.mouseEventToContainerPoint(evt);\n\t\tvar moved = this.moved();\n\n\t\t// apply matrix\n\t\tif (moved) {\n\t\t\tthis._transformPoints(this._matrix);\n\t\t\tthis._path._updatePath();\n\t\t\tthis._path._project();\n\t\t\tthis._path._transform(null);\n\t\t}\n\n\t\tL.DomEvent.off(document, 'mousemove touchmove', this.noManualDrag(window.memo.bind(this._onDrag, this)),    this);\n\t\tL.DomEvent.off(document, 'mouseup touchend',    this.noManualDrag(window.memo.bind(this._onDragEnd, this)), this);\n\n\t\tthis._restoreCoordGetters();\n\n\t\t// consistency\n\t\tif (moved) {\n\t\t\tthis._path.fire('dragend', {\n\t\t\t\tdistance: distance(this._dragStartPoint, containerPoint)\n\t\t\t});\n\n\t\t\t// hack for skipping the click in canvas-rendered layers\n\t\t\tvar contains = this._path._containsPoint;\n\t\t\tthis._path._containsPoint = app.util.falseFn;\n\t\t\tapp.util.requestAnimFrame(function() {\n\t\t\t\tL.DomEvent._skipped({ type: 'click' });\n\t\t\t\tthis._path._containsPoint = contains;\n\t\t\t}, this);\n\t\t}\n\n\t\tthis._matrix          = null;\n\t\tthis._startPoint      = null;\n\t\tthis._dragStartPoint  = null;\n\t\tthis._path._dragMoved = false;\n\n\t\tif (this._mapDraggingWasEnabled) {\n\t\t\tif (moved) L.DomEvent._fakeStop({ type: 'click' });\n\t\t\tthis._path._map.dragging.enable();\n\t\t}\n\n\t\tif (!moved && this._mouseDown && !this._path.options.manualDrag(this._mouseDown)) {\n\t\t\tthis._path._map._handleDOMEvent(this._mouseDown);\n\t\t\tthis._path._map._handleDOMEvent(evt);\n\t\t}\n\t},\n\n\n\t/**\n\t* Applies transformation, does it in one sweep for performance,\n\t* so don't be surprised about the code repetition.\n\t*\n\t* [ x ]   [ a  b  tx ] [ x ]   [ a * x + b * y + tx ]\n\t* [ y ] = [ c  d  ty ] [ y ] = [ c * x + d * y + ty ]\n\t*\n\t* @param {Array.<Number>} matrix\n\t*/\n\t_transformPoints: function(matrix, dest) {\n\t\tvar path = this._path;\n\t\tvar i, len, latlng;\n\n\t\tvar px = L.point(matrix[4], matrix[5]);\n\n\t\tvar crs = path._map.options.crs;\n\t\tvar transformation = crs.transformation;\n\t\tvar scale = crs.scale(path._map.getZoom());\n\t\tvar projection = crs.projection;\n\n\t\tvar diff = transformation.untransform(px, scale)\n\t\t\t.subtract(transformation.untransform(L.point(0, 0), scale));\n\t\tvar applyTransform = !dest;\n\n\t\tpath._bounds = new L.LatLngBounds();\n\n\t\t// window.app.console.time('transform');\n\t\t// all shifts are in-place\n\t\tif (path._point) { // L.Circle\n\t\t\tdest = projection.unproject(\n\t\t\t\tprojection.project(path._latlng)._add(diff));\n\t\t\tif (applyTransform) {\n\t\t\t\tpath._latlng = dest;\n\t\t\t\tpath._point._add(px);\n\t\t\t}\n\t\t} else if (path._rings || path._parts) { // everything else\n\t\t\tvar rings   = path._rings || path._parts;\n\t\t\tvar latlngs = path._latlngs;\n\t\t\tdest = dest || latlngs;\n\t\t\tif (!app.util.isArray(latlngs[0])) { // polyline\n\t\t\t\tlatlngs = [latlngs];\n\t\t\t\tdest    = [dest];\n\t\t\t}\n\t\t\tfor (i = 0, len = rings.length; i < len; i++) {\n\t\t\t\tdest[i] = dest[i] || [];\n\t\t\t\tfor (var j = 0, jj = rings[i].length; j < jj; j++) {\n\t\t\t\t\tlatlng     = latlngs[i][j];\n\t\t\t\t\tdest[i][j] = projection\n\t\t\t\t\t\t.unproject(projection.project(latlng)._add(diff));\n\t\t\t\t\tif (applyTransform) {\n\t\t\t\t\t\tpath._bounds.extend(latlngs[i][j]);\n\t\t\t\t\t\trings[i][j]._add(px);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dest;\n\t\t// window.app.console.timeEnd('transform');\n\t},\n\n\n\t/**\n\t* If you want to read the latlngs during the drag - your right,\n\t* but they have to be transformed\n\t*/\n\t_replaceCoordGetters: function() {\n\t\tif (this._path.getLatLng) { // Circle, CircleMarker\n\t\t\tthis._path.getLatLng_ = this._path.getLatLng;\n\t\t\tthis._path.getLatLng = function() {\n\t\t\t\treturn this.dragging._transformPoints(this.dragging._matrix, {});\n\t\t\t}.bind(this._path);\n\t\t} else if (this._path.getLatLngs) {\n\t\t\tthis._path.getLatLngs_ = this._path.getLatLngs;\n\t\t\tthis._path.getLatLngs = function() {\n\t\t\t\treturn this.dragging._transformPoints(this.dragging._matrix, []);\n\t\t\t}.bind(this._path);\n\t\t}\n\t},\n\n\n\t/**\n\t* Put back the getters\n\t*/\n\t_restoreCoordGetters: function() {\n\t\tif (this._path.getLatLng_) {\n\t\t\tthis._path.getLatLng = this._path.getLatLng_;\n\t\t\tdelete this._path.getLatLng_;\n\t\t} else if (this._path.getLatLngs_) {\n\t\t\tthis._path.getLatLngs = this._path.getLatLngs_;\n\t\t\tdelete this._path.getLatLngs_;\n\t\t}\n\t}\n\n});\n\n\n/**\n * @param  {L.Path} layer\n * @return {L.Path}\n */\nL.Handler.PathDrag.makeDraggable = function(layer) {\n\tlayer.dragging = new L.Handler.PathDrag(layer);\n\treturn layer;\n};\n\n\n/**\n * Also expose as a method\n * @return {L.Path}\n */\nL.Path.prototype.makeDraggable = function() {\n\treturn L.Handler.PathDrag.makeDraggable(this);\n};\n"]}