{"version":3,"file":"Util.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/app/Util.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ndeclare var brandProductFAQURL: string | undefined;\n\ninterface IDAble {\n\t_leaflet_id: number;\n\t[name: string]: any;\n}\n\ntype CallbackFunctionVariadic = (...args: any[]) => void;\n\nclass Util {\n\tprivate static lastId = 0;\n\tprivate static nextId(): number {\n\t\treturn ++Util.lastId;\n\t}\n\n\t/// Returns the id of the object. Initializes it if necessary.\n\tpublic static stamp(obj: IDAble): number {\n\t\tif (obj._leaflet_id > 0) {\n\t\t\treturn obj._leaflet_id;\n\t\t}\n\t\tobj._leaflet_id = Util.nextId();\n\t\treturn obj._leaflet_id;\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\tpublic static merge(one: any, two: any): any {\n\t\treturn { ...one, ...two };\n\t}\n\n\t// return a function that won't be called more often than the given interval\n\tpublic static throttle(\n\t\tfn: CallbackFunctionVariadic,\n\t\ttime: number,\n\t\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\t\tcontext: any,\n\t): CallbackFunctionVariadic {\n\t\tlet lock: boolean = false;\n\t\t// eslint-disable-next-line prefer-const\n\t\tlet wrapperFn: CallbackFunctionVariadic;\n\t\tlet args: any[] | boolean = false;\n\n\t\tconst later = function () {\n\t\t\t// reset lock and call if queued.\n\t\t\tlock = false;\n\t\t\tif (args) {\n\t\t\t\twrapperFn.apply(context, args);\n\t\t\t\targs = false;\n\t\t\t}\n\t\t};\n\n\t\twrapperFn = function (...args_: any[]) {\n\t\t\tif (lock) {\n\t\t\t\t// called too soon, queue to call later\n\t\t\t\targs = args_;\n\t\t\t} else {\n\t\t\t\t// call and lock until later\n\t\t\t\tfn.apply(context, args_);\n\t\t\t\tsetTimeout(later, time);\n\t\t\t\tlock = true;\n\t\t\t}\n\t\t};\n\n\t\treturn wrapperFn;\n\t}\n\n\t// wrap the given number to lie within a certain range (used for wrapping longitude)\n\tpublic static wrapNum(\n\t\tx: number,\n\t\trange: Array<number>,\n\t\tincludeMax: boolean,\n\t): number {\n\t\tconst max = range[1];\n\t\tconst min = range[0];\n\t\tconst d = max - min;\n\t\treturn x === max && includeMax ? x : ((((x - min) % d) + d) % d) + min;\n\t}\n\n\t// do nothing (used as a noop throughout the code)\n\tpublic static falseFn(): boolean {\n\t\treturn false;\n\t}\n\n\t// round a given number to a given precision\n\tpublic static formatNum(num: number, digits: number): number {\n\t\tvar pow = Math.pow(10, digits || 5);\n\t\treturn Math.round(num * pow) / pow;\n\t}\n\n\t// removes prefix from string if string starts with that prefix\n\tpublic static trimStart(str: string, prefix: string): string {\n\t\tif (str.indexOf(prefix) === 0) return str.substring(prefix.length);\n\t\treturn str;\n\t}\n\n\t// removes suffix from string if string ends with that suffix\n\tpublic static trimEnd(str: string, suffix: string): string {\n\t\tvar suffixIndex = str.lastIndexOf(suffix);\n\t\tif (suffixIndex !== -1 && str.length - suffix.length === suffixIndex)\n\t\t\treturn str.substring(0, suffixIndex);\n\t\treturn str;\n\t}\n\n\t// removes given prefix and suffix from the string if exists\n\t// if suffix is not specified, prefix is trimmed from both end of string\n\t// trim whitespace from both sides of a string if prefix and suffix are not given\n\tpublic static trim(str: string, prefix?: string, suffix?: string): string {\n\t\tif (!prefix) return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n\t\tlet result = Util.trimStart(str, prefix);\n\t\tresult = Util.trimEnd(result, suffix);\n\t\treturn result;\n\t}\n\n\t// split a string into words\n\tpublic static splitWords(str: string): string[] {\n\t\treturn Util.trim(str).split(/\\s+/);\n\t}\n\n\tpublic static round(x: number, e?: number): number {\n\t\tif (!e) {\n\t\t\treturn Math.round(x);\n\t\t}\n\t\tvar f = 1.0 / e;\n\t\treturn Math.round(x * f) * e;\n\t}\n\n\tpublic static templateRe = /\\{ *([\\w_]+) *\\}/g;\n\n\t// super-simple templating facility, used for TileLayer URLs\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\tpublic static template(str: string, data: any): string {\n\t\treturn str.replace(Util.templateRe, function (str, key) {\n\t\t\tlet value: any = data[key];\n\n\t\t\tif (value === undefined) {\n\t\t\t\tthrow new Error('No value provided for variable ' + str);\n\t\t\t} else if (typeof value === 'function') {\n\t\t\t\tvalue = value(data);\n\t\t\t}\n\t\t\treturn value;\n\t\t});\n\t}\n\n\tpublic static isArray =\n\t\tArray.isArray ||\n\t\tfunction (obj) {\n\t\t\treturn Object.prototype.toString.call(obj) === '[object Array]';\n\t\t};\n\n\t// minimal image URI, set to an image when disposing to flush memory\n\tpublic static emptyImageUrl =\n\t\t'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n\tpublic static toggleFullScreen(): void {\n\t\tconst doc = document as any;\n\t\tif (\n\t\t\t!doc.fullscreenElement &&\n\t\t\t!doc.mozFullscreenElement &&\n\t\t\t!doc.msFullscreenElement &&\n\t\t\t!doc.webkitFullscreenElement\n\t\t) {\n\t\t\tif (doc.documentElement.requestFullscreen) {\n\t\t\t\tdoc.documentElement.requestFullscreen();\n\t\t\t} else if (doc.documentElement.msRequestFullscreen) {\n\t\t\t\tdoc.documentElement.msRequestFullscreen();\n\t\t\t} else if (doc.documentElement.mozRequestFullScreen) {\n\t\t\t\tdoc.documentElement.mozRequestFullScreen();\n\t\t\t} else if (doc.documentElement.webkitRequestFullscreen) {\n\t\t\t\tdoc.documentElement.webkitRequestFullscreen(\n\t\t\t\t\t(Element as any).ALLOW_KEYBOARD_INPUT,\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (doc.exitFullscreen) {\n\t\t\tdoc.exitFullscreen();\n\t\t} else if (doc.msExitFullscreen) {\n\t\t\tdoc.msExitFullscreen();\n\t\t} else if (doc.mozCancelFullScreen) {\n\t\t\tdoc.mozCancelFullScreen();\n\t\t} else if (doc.webkitExitFullscreen) {\n\t\t\tdoc.webkitExitFullscreen();\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\tpublic static isEmpty(o: any): boolean {\n\t\treturn !(o && o.length);\n\t}\n\n\tpublic static mm100thToInch(mm: number): number {\n\t\treturn mm / 2540;\n\t}\n\n\tprivate static _canvas: HTMLCanvasElement | null = null;\n\n\tprivate static getTempCanvas(): HTMLCanvasElement {\n\t\tif (Util._canvas) {\n\t\t\treturn Util._canvas;\n\t\t}\n\t\tUtil._canvas = document.createElement('canvas');\n\t\treturn Util._canvas;\n\t}\n\n\tpublic static getTextWidth(text: string, font: string): number {\n\t\tconst canvas = Util.getTempCanvas();\n\t\tconst context = canvas.getContext('2d');\n\t\tcontext.font = font;\n\t\tconst metrics = context.measureText(text);\n\t\treturn Math.floor(metrics.width);\n\t}\n\n\tpublic static getProduct(): string {\n\t\tlet brandFAQURL =\n\t\t\ttypeof brandProductFAQURL !== 'undefined'\n\t\t\t\t? brandProductFAQURL\n\t\t\t\t: 'https://collaboraonline.github.io/post/faq/';\n\t\tconst customWindow = window as any;\n\t\tif (customWindow.feedbackUrl && customWindow.buyProductUrl) {\n\t\t\tconst integratorUrl = encodeURIComponent(customWindow.buyProductUrl);\n\t\t\tbrandFAQURL = customWindow.feedbackUrl;\n\t\t\tbrandFAQURL =\n\t\t\t\tbrandFAQURL.substring(0, brandFAQURL.lastIndexOf('/')) +\n\t\t\t\t'/product.html?integrator=' +\n\t\t\t\tintegratorUrl;\n\t\t}\n\t\treturn brandFAQURL;\n\t}\n\n\tpublic static replaceCtrlAltInMac(msg: string): string {\n\t\tif (L.Browser.mac) {\n\t\t\tvar ctrl = /Ctrl/g;\n\t\t\tvar alt = /Alt/g;\n\t\t\tconst CustomString = String as any;\n\t\t\tif (\n\t\t\t\tCustomString.locale.startsWith('de') ||\n\t\t\t\tCustomString.locale.startsWith('dsb') ||\n\t\t\t\tCustomString.locale.startsWith('hsb')\n\t\t\t) {\n\t\t\t\tctrl = /Strg/g;\n\t\t\t}\n\t\t\tif (CustomString.locale.startsWith('lt')) {\n\t\t\t\tctrl = /Vald/g;\n\t\t\t}\n\t\t\tif (CustomString.locale.startsWith('sl')) {\n\t\t\t\tctrl = /Krmilka/gi;\n\t\t\t\talt = /Izmenjalka/gi;\n\t\t\t}\n\t\t\treturn msg.replace(ctrl, '⌘').replace(alt, '⌥');\n\t\t}\n\t\treturn msg;\n\t}\n\n\tpublic static randomString(len: number): string {\n\t\tlet result = '';\n\t\tconst ValidCharacters =\n\t\t\t'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tresult += ValidCharacters.charAt(\n\t\t\t\tMath.floor(Math.random() * ValidCharacters.length),\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static requestAnimFrame(\n\t\tfn: () => void,\n\t\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\t\tcontext: any,\n\t): number {\n\t\treturn window.requestAnimationFrame(fn.bind(context));\n\t}\n\n\tpublic static cancelAnimFrame(id: number): void {\n\t\tif (id) {\n\t\t\twindow.cancelAnimationFrame(id);\n\t\t}\n\t}\n\n\tpublic static MAX_SAFE_INTEGER = Math.pow(2, 53) - 1;\n\tpublic static MIN_SAFE_INTEGER = -Util.MAX_SAFE_INTEGER;\n}\n\napp.util = Util;\n"]}