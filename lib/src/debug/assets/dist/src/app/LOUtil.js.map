{"version":3,"file":"LOUtil.js","sourceRoot":"","sources":["../../../../../../../../../../TanhX/online/browser/src/app/LOUtil.ts"],"names":[],"mappings":"AAAA,oBAAoB;AACpB,gCAAgC;AAChC,gBAAgB;AAChB;;;;;;;;GAQG;AAkBH,4DAA4D;AAC5D,uBAAuB;AAEvB;IAAA;IA+mBA,CAAC;IA/lBc,0BAAmB,GAAjC,UACC,OAAgB,EAChB,gBAA4B;QAE5B,IAAM,QAAQ,GAAG,IAAI,gBAAgB,CAAC;YACrC,SAAS,UAAU,CAAC,EAAW;gBAC9B,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAC5B,CAAC;YAED,IAAI,UAAU,CAAC,OAAO,CAAC,EAAE;gBACxB,gBAAgB,EAAE,CAAC;gBACnB,QAAQ,CAAC,UAAU,EAAE,CAAC;aACtB;QACF,CAAC,CAAC,CAAC;QAEH,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE;YAC1B,SAAS,EAAE,IAAI;YACf,OAAO,EAAE,IAAI;SACb,CAAC,CAAC;IACJ,CAAC;IAEa,mBAAY,GAA1B,UACC,aAAgC,EAChC,YAAoB;QAEpB,aAAa,CAAC,KAAK,GAAG,EAAE,CAAC;QACzB,aAAa,CAAC,MAAM,GAAG,EAAE,CAAC;QAE1B,IAAM,OAAO,GAAG,aAAa,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAC/C,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;QACtB,OAAO,CAAC,WAAW,GAAG,MAAM,CAAC;QAC7B,IAAM,CAAC,GAAG,aAAa,CAAC,KAAK,GAAG,CAAC,CAAC;QAClC,IAAM,CAAC,GAAG,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;QACnC,IAAM,MAAM,GAAG,CAAC,GAAG,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;QACzC,IAAM,eAAe,GAAG,WAAW,CAAC;YACnC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;YACtC,iBAAiB;YACjB,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACxB,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC;YAC/C,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC1B,OAAO,CAAC,SAAS,EAAE,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;YAC5C,OAAO,CAAC,MAAM,EAAE,CAAC;QAClB,CAAC,EAAE,EAAE,CAAC,CAAC;QAEP,OAAO,eAAe,CAAC;IACxB,CAAC;IAEa,qBAAc,GAA5B,UAA6B,MAAc;QAC1C,IAAM,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QACzE,OAAO,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;IACtD,CAAC;IAEa,eAAQ,GAAtB,UAAuB,KAAa;QACnC,OAAO,GAAG,GAAG,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC;IAEa,qBAAc,GAA5B,UAA6B,MAAc;QAC1C,IAAM,OAAO,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACrC,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CACjC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EACpB,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CACpB,CAAC;QACF,IAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAC9B,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CACnD,CAAC;QACF,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;IACnD,CAAC;IAEa,yBAAkB,GAAhC,UAAiC,OAAe;QAC/C,IAAM,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtC,IAAM,UAAU,GAAmB,EAAE,CAAC;QACtC,IAAI,OAAO,KAAK,IAAI,EAAE;YACrB,KAAK,IAAI,OAAO,GAAG,CAAC,EAAE,OAAO,GAAG,OAAO,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,EAAE;gBAC7D,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CACjC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,EAC1B,QAAQ,CAAC,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAC9B,CAAC;gBACF,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAC9B,QAAQ,CAAC,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,EAC9B,QAAQ,CAAC,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAC9B,CAAC;gBACF,IAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;gBACjD,IAAM,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBACtC,UAAU,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,WAAW,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC,CAAC;aAC9D;SACD;QACD,OAAO,UAAU,CAAC;IACnB,CAAC;IASD,2DAA2D;IAC7C,gBAAS,GAAvB,UAAwB,IAAY;QACnC,4BAA4B;QAC5B,IAAI,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QAE9C,wCAAwC;QACxC,IAAI,YAAY,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE;YACnC,YAAY,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SACzC;QAED,OAAO,YAAY,CAAC;IACrB,CAAC;IAEa,qBAAc,GAA5B,UAA6B,IAAY;QACxC,IAAM,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAE5C,gEAAgE;QAChE,OAAO,MAAM,CAAC,iBAAiB,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IACxD,CAAC;IAEa,yBAAkB,GAAhC,UAAiC,IAAY;QAC5C,IAAM,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAE5C,0DAA0D;QAC1D,OAAO,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IAClD,CAAC;IAED,6CAA6C;IAC/B,aAAM,GAApB,UAAqB,IAAY;QAChC,IAAI,IAAI,KAAK,EAAE;YAAE,OAAO,EAAE,CAAC;QAC3B,IAAM,YAAY,GAAG,MAAa,CAAC;QACnC,IAAI,YAAY,CAAC,IAAI,KAAK,EAAE,IAAI,YAAY,CAAC,WAAW,KAAK,EAAE;YAC9D,OAAO,IAAI,CAAC,CAAC,aAAa;QAE3B,IAAI,GAAG,GAAG,YAAY,CAAC,WAAW,CAAC,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,CAAC;QAC3E,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,GAAG;YAAE,GAAG,IAAI,GAAG,CAAC;QAE1C,GAAG,IAAI,IAAI,CAAC;QACZ,OAAO,GAAG,CAAC;IACZ,CAAC;IAEa,eAAQ,GAAtB,UAAuB,GAAqB,EAAE,IAAY,EAAE,GAAQ;QACnE,IAAM,SAAS,GAAG;YACjB,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACnC,MAAM,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC;QAChC,CAAC,CAAC;QACF,SAAS,EAAE,CAAC;QAEZ,GAAG,CAAC,EAAE,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;IACnC,CAAC;IAEa,mBAAY,GAA1B,UACC,GAAqB,EACrB,GAAQ,EACR,MAAc;QAEd,qDAAqD;QACrD,IAAM,YAAY,GAAG,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACpD,IAAM,QAAQ,GAAG,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QACvC,IACC,QAAQ,KAAK,SAAS;YACtB,QAAQ,CAAC,aAAa,KAAK,SAAS;YACpC,QAAQ,CAAC,aAAa,CAAC,MAAM,KAAK,SAAS,EAC1C;YACD,mBAAmB;YACnB,GAAG,CAAC,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;YACxC,uDAAuD;YACvD,GAAG,CAAC,gBAAgB,CACnB,OAAO,EACP;gBACC,GAAG,CAAC,GAAG,GAAG,YAAY,CAAC;gBACvB,MAAM,CAAC,kBAAkB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YACtC,CAAC,EACD,EAAE,IAAI,EAAE,IAAI,EAAE,CACd,CAAC;YACF,OAAO;SACP;QACD,GAAG,CAAC,GAAG,GAAG,YAAY,CAAC;QACvB,MAAM,CAAC,kBAAkB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IACtC,CAAC;IAEa,kBAAW,GAAzB,UAA0B,OAAe;QACxC,IAAI,eAAe,GAAG,MAAM,CAAC,MAAM,CAAC,SAAS,GAAG,OAAO,CAAC,CAAC;QAEzD,sFAAsF;QACtF,IAAI,MAAM,CAAC,kBAAkB,CAAC,OAAO,CAAC,EAAE;YACvC,OAAO,eAAe,CAAC;SACvB;QAED,IAAK,MAAc,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;YAClD,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,GAAG,OAAO,CAAC,CAAC;SAC/C;QAED,IAAM,aAAa,GAClB,oHAAoH,CAAC;QACtH,eAAe,GAAG,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC;YAC/C,CAAC,CAAC,aAAa;YACf,CAAC,CAAC,eAAe,CAAC;QACnB,OAAO,eAAe,CAAC;IACxB,CAAC;IAEa,2BAAoB,GAAlC,UAAmC,IAAY,EAAE,QAAiB;QACjE,IAAI,CAAC,IAAI;YAAE,OAAO,EAAE,CAAC;QAErB,IAAI,YAAY,GAAG,QAAQ,CAAC;QAC5B,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,IAAI,CAAC,YAAY,IAAI,YAAY,KAAK,IAAI,EAAE;YAC3C,IAAI,YAAY,GAAG,OAAO,CAAC,MAAM,CAAC;YAClC,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,YAAY,CAAC,IAAI,OAAO;gBAC1C,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YACvC,SAAS,GAAG,kBAAkB,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC5D,SAAS,GAAG,SAAS,CAAC,WAAW,EAAE,CAAC;SACpC;QACD,IAAI,cAAc,GAAgB;YACjC,+DAA+D;YAC/D,gEAAgE;YAChE,WAAW,EAAE,gBAAgB;YAC7B,aAAa,EAAE,QAAQ;YACvB,aAAa,EAAE,WAAW;YAC1B,YAAY,EAAE,IAAI;YAClB,WAAW,EAAE,MAAM;YACnB,eAAe,EAAE,iBAAiB;YAClC,eAAe,EAAE,QAAQ;YACzB,gBAAgB,EAAE,iBAAiB;YACnC,SAAS,EAAE,UAAU;YACrB,UAAU,EAAE,WAAW;YACvB,qBAAqB,EAAE,YAAY;YACnC,UAAU,EAAE,aAAa;YACzB,mBAAmB,EAAE,iBAAiB;YACtC,wBAAwB,EAAE,WAAW;YACrC,mBAAmB,EAAE,iBAAiB;YACtC,QAAQ,EAAE,QAAQ;YAClB,kBAAkB,EAAE,iBAAiB;YACrC,qBAAqB,EAAE,YAAY;YACnC,iBAAiB,EAAE,kBAAkB;YACrC,oBAAoB,EAAE,kBAAkB;YACxC,eAAe,EAAE,kBAAkB;YACnC,kBAAkB,EAAE,kBAAkB;YACtC,wBAAwB,EAAE,WAAW;YACrC,gBAAgB,EAAE,gBAAgB;YAClC,uBAAuB,EAAE,uBAAuB;YAChD,gBAAgB,EAAE,OAAO;YACzB,UAAU,EAAE,WAAW;YACvB,WAAW,EAAE,SAAS;YACtB,+BAA+B,EAAE,SAAS;YAC1C,SAAS,EAAE,UAAU;YACrB,mBAAmB,EAAE,UAAU;YAC/B,cAAc,EAAE,cAAc;YAC9B,sBAAsB,EAAE,cAAc;YACtC,cAAc,EAAE,cAAc;YAC9B,aAAa,EAAE,WAAW;YAC1B,cAAc,EAAE,cAAc;YAC9B,eAAe,EAAE,gBAAgB;YACjC,iBAAiB,EAAE,WAAW;YAC9B,iBAAiB,EAAE,kBAAkB;YACrC,WAAW,EAAE,aAAa;YAC1B,kBAAkB,EAAE,UAAU;YAC9B,YAAY,EAAE,QAAQ;YACtB,OAAO,EAAE,SAAS;YAClB,QAAQ,EAAE,SAAS;YACnB,QAAQ,EAAE,MAAM;YAChB,aAAa,EAAE,MAAM;YACrB,oBAAoB,EAAE,eAAe;YACrC,mBAAmB,EAAE,eAAe;YACpC,cAAc,EAAE,WAAW;YAC3B,iBAAiB,EAAE,WAAW;YAC9B,UAAU,EAAE,WAAW;YACvB,kBAAkB,EAAE,eAAe;YACnC,mBAAmB,EAAE,UAAU;YAC/B,cAAc,EAAE,aAAa;YAC7B,aAAa,EAAE,WAAW;YAC1B,mBAAmB,EAAE,WAAW;YAChC,WAAW,EAAE,UAAU;YACvB,wBAAwB,EAAE,UAAU;YACpC,eAAe,EAAE,iBAAiB;YAClC,UAAU,EAAE,iBAAiB;YAC7B,eAAe,EAAE,eAAe;YAChC,qBAAqB,EAAE,iBAAiB;YACxC,gBAAgB,EAAE,YAAY;YAC9B,eAAe,EAAE,WAAW;YAC5B,2BAA2B,EAAE,WAAW;YACxC,UAAU,EAAE,WAAW;YACvB,SAAS,EAAE,WAAW;YACtB,6BAA6B,EAAE,WAAW;YAC1C,kBAAkB,EAAE,mBAAmB;YACvC,sBAAsB,EAAE,gBAAgB;YACxC,iBAAiB,EAAE,WAAW;YAC9B,kBAAkB,EAAE,WAAW;YAC/B,eAAe,EAAE,WAAW;YAC5B,kBAAkB,EAAE,WAAW;YAC/B,wBAAwB,EAAE,aAAa;YACvC,wBAAwB,EAAE,aAAa;YACvC,WAAW,EAAE,aAAa;YAC1B,kEAAkE,EACjE,WAAW;YACZ,sBAAsB,EAAE,uBAAuB;YAC/C,eAAe,EAAE,aAAa;YAC9B,gBAAgB,EAAE,uBAAuB;YACzC,SAAS,EAAE,SAAS;YACpB,4BAA4B,EAAE,UAAU;YACxC,cAAc,EAAE,aAAa;YAC7B,iBAAiB,EAAE,iBAAiB;YACpC,kBAAkB,EAAE,iBAAiB;YACrC,kBAAkB,EAAE,iBAAiB;YACrC,aAAa,EAAE,QAAQ;YACvB,eAAe,EAAE,YAAY;YAC7B,WAAW,EAAE,WAAW;YACxB,kBAAkB,EAAE,kBAAkB;YACtC,WAAW,EAAE,YAAY;YACzB,iBAAiB,EAAE,aAAa;YAChC,eAAe,EAAE,aAAa;YAC9B,eAAe,EAAE,aAAa;YAC9B,eAAe,EAAE,cAAc;YAC/B,mBAAmB,EAAE,gBAAgB;YACrC,kBAAkB,EAAE,aAAa;YACjC,cAAc,EAAE,aAAa;YAC7B,gBAAgB,EAAE,aAAa;YAC/B,eAAe,EAAE,aAAa;YAC9B,WAAW,EAAE,WAAW;YACxB,aAAa,EAAE,cAAc;YAC7B,gBAAgB,EAAE,YAAY;YAC9B,iBAAiB,EAAE,gBAAgB;YACnC,gBAAgB,EAAE,eAAe;YACjC,cAAc,EAAE,cAAc;YAC9B,aAAa,EAAE,IAAI;YACnB,gBAAgB,EAAE,UAAU;YAC5B,aAAa,EAAE,UAAU;YACzB,sBAAsB,EAAE,UAAU;YAClC,SAAS,EAAE,UAAU;YACrB,eAAe,EAAE,YAAY;YAC7B,SAAS,EAAE,QAAQ;YACnB,cAAc,EAAE,aAAa;YAC7B,gBAAgB,EAAE,aAAa;YAC/B,YAAY,EAAE,aAAa;YAC3B,2BAA2B,EAAE,yBAAyB;YACtD,oBAAoB,EAAE,eAAe;YACrC,cAAc,EAAE,YAAY;YAC5B,WAAW,EAAE,UAAU;YACvB,iBAAiB,EAAE,YAAY;YAC/B,iBAAiB,EAAE,aAAa;YAChC,eAAe,EAAE,SAAS;YAC1B,UAAU,EAAE,SAAS;YACrB,iBAAiB,EAAE,iBAAiB;YACpC,wBAAwB,EAAE,WAAW;YACrC,aAAa,EAAE,cAAc;YAC7B,oBAAoB,EAAE,cAAc;YACpC,UAAU,EAAE,cAAc;YAC1B,cAAc,EAAE,cAAc;YAC9B,iBAAiB,EAAE,YAAY;YAC/B,UAAU,EAAE,cAAc;YAC1B,qBAAqB,EAAE,cAAc;YACrC,qBAAqB,EAAE,cAAc;YACrC,cAAc,EAAE,cAAc;YAC9B,WAAW,EAAE,cAAc;YAC3B,yBAAyB,EAAE,cAAc;YACzC,UAAU,EAAE,cAAc;YAC1B,eAAe,EAAE,cAAc;YAC/B,aAAa,EAAE,cAAc;YAC7B,oBAAoB,EAAE,cAAc;YACpC,eAAe,EAAE,cAAc;YAC/B,YAAY,EAAE,cAAc;YAC5B,qBAAqB,EAAE,cAAc;YACrC,aAAa,EAAE,cAAc;YAC7B,qBAAqB,EAAE,wBAAwB;YAC/C,aAAa,EAAE,iBAAiB;YAChC,aAAa,EAAE,WAAW;YAC1B,YAAY,EAAE,gBAAgB;YAC9B,yBAAyB,EAAE,qBAAqB;YAChD,sBAAsB,EAAE,qBAAqB;YAC7C,iBAAiB,EAAE,gBAAgB;YACnC,0BAA0B,EAAE,SAAS;YACrC,+DAA+D;YAC/D,+DAA+D;YAC/D,+CAA+C;YAC/C,gBAAgB,EAAE,WAAW;YAC7B,uBAAuB,EAAE,iBAAiB;YAC1C,iBAAiB,EAAE,YAAY;YAC/B,kBAAkB,EAAE,cAAc;YAClC,YAAY,EAAE,QAAQ;YACtB,YAAY,EAAE,OAAO;YACrB,eAAe,EAAE,MAAM;YACvB,kBAAkB,EAAE,MAAM;YAC1B,eAAe,EAAE,WAAW;YAC5B,wBAAwB,EAAE,cAAc;YACxC,2BAA2B,EAAE,WAAW;SACxC,CAAC;QACF,IAAI,cAAc,CAAC,SAAS,CAAC,EAAE;YAC9B,SAAS,GAAG,cAAc,CAAC,SAAS,CAAC,CAAC;SACtC;QAED,OAAO,KAAK,GAAG,SAAS,GAAG,MAAM,CAAC;IACnC,CAAC;IAEa,yBAAkB,GAAhC,UACC,YAA8B,EAC9B,qBAA+B;QAE/B,YAAY,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,CAAM;YACtD,IAAI,CAAC,CAAC,eAAe,EAAE;gBACtB,OAAO;aACP;YAED,IACC,YAAY,CAAC,GAAG;gBAChB,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,wBAAwB,CAAC,EAClD;gBACD,YAAY,CAAC,GAAG,GAAG,YAAY,CAAC,GAAG,CAAC,OAAO,CAC1C,wBAAwB,EACxB,eAAe,CACf,CAAC;gBACF,CAAC,CAAC,eAAe,GAAG,IAAI,CAAC;gBACzB,OAAO;aACP;YACD,IACC,YAAY,CAAC,GAAG;gBAChB,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC;oBAC1C,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC,EAC/C;gBACD,YAAY,CAAC,GAAG,GAAG,YAAY,CAAC,GAAG,CAAC,OAAO,CAC1C,eAAe,EACf,UAAU,CACV,CAAC;gBACF,YAAY,CAAC,GAAG,GAAG,YAAY,CAAC,GAAG,CAAC,OAAO,CAC1C,mBAAmB,EACnB,UAAU,CACV,CAAC;gBACF,CAAC,CAAC,eAAe,GAAG,IAAI,CAAC;gBACzB,OAAO;aACP;YAED,IAAI,qBAAqB,EAAE;gBAC1B,YAAY,CAAC,GAAG;oBACf,oHAAoH,CAAC;gBACtH,2DAA2D;gBAC3D,kDAAkD;gBAClD,CAAC,CAAC,eAAe,GAAG,IAAI,CAAC;gBACzB,OAAO;aACP;YAED,YAAY,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACpC,CAAC,CAAC,eAAe,GAAG,IAAI,CAAC;QAC1B,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,2CAA2C;IAC3C,4BAA4B;IACd,0BAAmB,GAAjC,UACC,WAAmB,EACnB,MAAc;QAEd,IAAM,GAAG,GAAG,WAAW,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QACzC,OAAO,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,MAAM,GAAG,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IAC5E,CAAC;IAYa,2BAAoB,GAAlC,UACC,OAAe,EACf,OAAe;QAEf,IAAM,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC;YAC9C,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC;YACnC,CAAC,CAAC,OAAO,CAAC;QACX,IAAM,GAAG,GAAG,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,EAAU;YAC/D,OAAO,EAAE,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QACH,IAAI,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;YACpC,IACC,WAAW,CAAC,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBAC9C,WAAW,CAAC,OAAO,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;gBAEjD,OAAO,IAAI,CAAC;YAEb,IACC,CAAC,OAAO,KAAK,aAAa,IAAI,OAAO,KAAK,cAAc,CAAC;gBACzD,WAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;gBAE5C,OAAO,IAAI,CAAC;YAEb,IACC,WAAW;gBACV,sDAAsD;gBACvD,WAAW;oBACV,wDAAwD;gBACzD,WAAW;oBACV,wDAAwD;gBACzD,WAAW;oBACV,0DAA0D;gBAE3D,OAAO,IAAI,CAAC;YAEb,OAAO,KAAK,CAAC;SACb;QACD,OAAO,GAAG,CAAC;IACZ,CAAC;IAED,wDAAwD;IAC1C,qCAA8B,GAA5C,UACC,IAAmB,EACnB,MAAc,EACd,OAAY;QAEZ,IAAI,KAAK,GAAyB,IAAI,CAAC;QACvC,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,OAAO;YAAE,OAAO,IAAI,CAAC;QAC1C,IAAI,IAAI,CAAC,QAAQ,EAAE;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE;gBACtD,KAAK,GAAG,MAAM,CAAC,8BAA8B,CAC5C,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAChB,MAAM,EACN,OAAO,CACP,CAAC;SACH;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAED,6EAA6E;IAC/D,mCAA4B,GAA1C,UACC,IAAmB,EACnB,MAAc,EACd,OAAY;QAEZ,IAAI,IAAI,CAAC,QAAQ,EAAE;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE;gBAC5C,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,OAAO;oBAAE,OAAO,CAAC,CAAC;SACpD;QACD,OAAO,CAAC,CAAC,CAAC;IACX,CAAC;IAEa,6BAAsB,GAApC,UACC,UAAoB,EACpB,UAAoB;QAEpB,wBAAwB;QACxB,gEAAgE;QAChE,IACC,IAAI,CAAC,GAAG,CACP,UAAU,CAAC,CAAC,CAAC;YACZ,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG;YACnB,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CACtC;YACD,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,EACpC;YACD,IACC,IAAI,CAAC,GAAG,CACP,UAAU,CAAC,CAAC,CAAC;gBACZ,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG;gBACnB,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CACtC;gBACD,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBAErC,OAAO,IAAI,CAAC;;gBACR,OAAO,KAAK,CAAC;SAClB;;YAAM,OAAO,KAAK,CAAC;IACrB,CAAC;IAED,oHAAoH;IACtG,gCAAyB,GAAvC,UACC,UAAoB,EACpB,UAAoB;QAEpB,IAAI,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE,UAAU,CAAC,EAAE;YACxD,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACtE,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACtE,IAAI,CAAC,GACJ,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC;gBAC5D,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC;gBACnC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YACtC,IAAI,CAAC,GACJ,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC;gBAC5D,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC;gBACnC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YAEtC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;SACpB;;YAAM,OAAO,IAAI,CAAC;IACpB,CAAC;IAEa,uBAAgB,GAA9B,UAA+B,GAAQ;QACtC,IAAM,QAAQ,GAAW,GAAG,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;QAClD,OAAO,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;IAC1D,CAAC;IAEa,gBAAS,GAAvB,UAAwB,GAAQ;QAC/B,IAAI,GAAG,GAAG,MAAM,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;QACvC,OAAO,GAAG,KAAK,KAAK,IAAI,GAAG,KAAK,KAAK,IAAI,GAAG,KAAK,KAAK,IAAI,GAAG,IAAI,KAAK,CAAC;IACxE,CAAC;IAEa,sBAAe,GAA7B,UACC,QAAuB,EACvB,IAAmB;QAEnB,OAAO,CACN,IAAI,CAAC,GAAG,IAAI,QAAQ,CAAC,GAAG;YACxB,IAAI,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK;YAC5B,IAAI,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM;YAC9B,IAAI,CAAC,IAAI,IAAI,QAAQ,CAAC,IAAI,CAC1B,CAAC;IACH,CAAC;IA1mBD,yEAAyE;IACzE,qCAAqC;IACrC,sEAAsE;IACxD,iBAAU,GAAG;QAC1B,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;QACb,CAAC,CAAC,EAAE,EAAE,EAAE,GAAG,CAAC;QACZ,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC;QACb,CAAC,GAAG,EAAE,EAAE,EAAE,GAAG,CAAC;QACd,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC;QACZ,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;QACb,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;QACb,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC;QACb,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;KACb,CAAC;IA6FF,2EAA2E;IAC3E,2BAA2B;IACb,wBAAiB,GAAa,CAAC,kBAAkB,CAAC,CAAC;IAEjE,oEAAoE;IACtD,kBAAW,GAAa,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC;IAqW9D,yBAAkB,GAAa;QAC5C,kBAAkB;QAClB,kBAAkB;QAClB,gBAAgB;QAChB,qBAAqB;QACrB,MAAM;QACN,MAAM;QACN,MAAM;KACN,CAAC;IAgJY,gBAAS,GAAG,IAAI,CAAC,SAAS,CAAC;IAC3B,sBAAe,GAAG,IAAI,CAAC,eAAe,CAAC;IACtD,aAAC;CAAA,AA/mBD,IA+mBC;AAED,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC","sourcesContent":["// @ts-strict-ignore\n/* -*- js-indent-level: 8 -*- */\n/* global app */\n/*\n * Copyright the Collabora Online contributors.\n *\n * SPDX-License-Identifier: MPL-2.0\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\ninterface DOMObjectLike {\n\t[index: string]: any;\n\tchildren?: DOMObjectLike[];\n}\n\ninterface RectangleLike {\n\ttop: number;\n\tleft: number;\n\tbottom: number;\n\tright: number;\n}\n\ninterface IconNameMap {\n\t[key: string]: string;\n}\n\n// LOUtil contains various LO related utility functions used\n// throughout the code.\n\nclass LOUtil {\n\t// Based on core.git's colordata.hxx: COL_AUTHOR1_DARK...COL_AUTHOR9_DARK\n\t// consisting of arrays of RGB values\n\t// Maybe move the color logic to separate file when it becomes complex\n\tpublic static darkColors = [\n\t\t[198, 146, 0],\n\t\t[6, 70, 162],\n\t\t[87, 157, 28],\n\t\t[105, 43, 157],\n\t\t[197, 0, 11],\n\t\t[0, 128, 128],\n\t\t[140, 132, 0],\n\t\t[53, 85, 107],\n\t\t[209, 118, 0],\n\t];\n\n\tpublic static onRemoveHTMLElement(\n\t\telement: Element,\n\t\tonDetachCallback: () => void,\n\t) {\n\t\tconst observer = new MutationObserver(function () {\n\t\t\tfunction isDetached(el: Element) {\n\t\t\t\treturn !el.closest('html');\n\t\t\t}\n\n\t\t\tif (isDetached(element)) {\n\t\t\t\tonDetachCallback();\n\t\t\t\tobserver.disconnect();\n\t\t\t}\n\t\t});\n\n\t\tobserver.observe(document, {\n\t\t\tchildList: true,\n\t\t\tsubtree: true,\n\t\t});\n\t}\n\n\tpublic static startSpinner(\n\t\tspinnerCanvas: HTMLCanvasElement,\n\t\tspinnerSpeed: number,\n\t): NodeJS.Timer {\n\t\tspinnerCanvas.width = 50;\n\t\tspinnerCanvas.height = 50;\n\n\t\tconst context = spinnerCanvas.getContext('2d');\n\t\tcontext.lineWidth = 8;\n\t\tcontext.strokeStyle = 'grey';\n\t\tconst x = spinnerCanvas.width / 2;\n\t\tconst y = spinnerCanvas.height / 2;\n\t\tconst radius = y - context.lineWidth / 2;\n\t\tconst spinnerInterval = setInterval(function () {\n\t\t\tcontext.clearRect(0, 0, x * 2, y * 2);\n\t\t\t// Move to center\n\t\t\tcontext.translate(x, y);\n\t\t\tcontext.rotate((spinnerSpeed * Math.PI) / 180);\n\t\t\tcontext.translate(-x, -y);\n\t\t\tcontext.beginPath();\n\t\t\tcontext.arc(x, y, radius, 0, Math.PI * 1.3);\n\t\t\tcontext.stroke();\n\t\t}, 30);\n\n\t\treturn spinnerInterval;\n\t}\n\n\tpublic static getViewIdColor(viewId: number): number {\n\t\tconst color = LOUtil.darkColors[(viewId + 1) % LOUtil.darkColors.length];\n\t\treturn color[2] | (color[1] << 8) | (color[0] << 16);\n\t}\n\n\tpublic static rgbToHex(color: number) {\n\t\treturn '#' + ('000000' + color.toString(16)).slice(-6);\n\t}\n\n\tpublic static stringToBounds(bounds: string): cool.Bounds {\n\t\tconst numbers = bounds.match(/\\d+/g);\n\t\tconst topLeft = cool.Point.toPoint(\n\t\t\tparseInt(numbers[0]),\n\t\t\tparseInt(numbers[1]),\n\t\t);\n\t\tconst bottomRight = topLeft.add(\n\t\t\tL.point(parseInt(numbers[2]), parseInt(numbers[3])),\n\t\t);\n\t\treturn cool.Bounds.toBounds(topLeft, bottomRight);\n\t}\n\n\tpublic static stringToRectangles(strRect: string): cool.Point[][] {\n\t\tconst matches = strRect.match(/\\d+/g);\n\t\tconst rectangles: cool.Point[][] = [];\n\t\tif (matches !== null) {\n\t\t\tfor (let itMatch = 0; itMatch < matches.length; itMatch += 4) {\n\t\t\t\tconst topLeft = cool.Point.toPoint(\n\t\t\t\t\tparseInt(matches[itMatch]),\n\t\t\t\t\tparseInt(matches[itMatch + 1]),\n\t\t\t\t);\n\t\t\t\tconst size = cool.Point.toPoint(\n\t\t\t\t\tparseInt(matches[itMatch + 2]),\n\t\t\t\t\tparseInt(matches[itMatch + 3]),\n\t\t\t\t);\n\t\t\t\tconst topRight = topLeft.add(L.point(size.x, 0));\n\t\t\t\tconst bottomLeft = topLeft.add(L.point(0, size.y));\n\t\t\t\tconst bottomRight = topLeft.add(size);\n\t\t\t\trectangles.push([bottomLeft, bottomRight, topLeft, topRight]);\n\t\t\t}\n\t\t}\n\t\treturn rectangles;\n\t}\n\n\t// Some items will only be present in dark mode so we will not check errors\n\t// for those in other mode.\n\tpublic static onlydarkModeItems: string[] = ['invertbackground'];\n\n\t// Common images used in all modes, so the default one will be used.\n\tpublic static commonItems: string[] = ['serverauditok', 'serverauditerror'];\n\n\t// Helper function to strip '.svg' suffix and 'lc_' prefix.\n\tpublic static stripName(name: string): string {\n\t\t// Remove the '.svg' suffix.\n\t\tvar strippedName = name.replace(/\\.svg$/, '');\n\n\t\t// Remove the 'lc_' prefix if it exists.\n\t\tif (strippedName.startsWith('lc_')) {\n\t\t\tstrippedName = strippedName.substring(3);\n\t\t}\n\n\t\treturn strippedName;\n\t}\n\n\tpublic static isDarkModeItem(name: string): boolean {\n\t\tconst strippedName = LOUtil.stripName(name);\n\n\t\t// Check if the stripped name is in the onlydarkModeItems array.\n\t\treturn LOUtil.onlydarkModeItems.includes(strippedName);\n\t}\n\n\tpublic static isCommonForAllMode(name: string): boolean {\n\t\tconst strippedName = LOUtil.stripName(name);\n\n\t\t// Check if the stripped name is in the commonItems array.\n\t\treturn LOUtil.commonItems.includes(strippedName);\n\t}\n\n\t/// unwind things to get a good absolute URL.\n\tpublic static getURL(path: string): string {\n\t\tif (path === '') return '';\n\t\tconst customWindow = window as any;\n\t\tif (customWindow.host === '' && customWindow.serviceRoot === '')\n\t\t\treturn path; // mobile app\n\n\t\tlet url = customWindow.makeHttpUrl('/browser/' + customWindow.versionPath);\n\t\tif (path.substr(0, 1) !== '/') url += '/';\n\n\t\turl += path;\n\t\treturn url;\n\t}\n\n\tpublic static setImage(img: HTMLImageElement, name: string, map: any): void {\n\t\tconst setupIcon = function () {\n\t\t\timg.src = LOUtil.getImageURL(name);\n\t\t\tLOUtil.checkIfImageExists(img);\n\t\t};\n\t\tsetupIcon();\n\n\t\tmap.on('themechanged', setupIcon);\n\t}\n\n\tpublic static setUserImage(\n\t\timg: HTMLImageElement,\n\t\tmap: any,\n\t\tviewId: number,\n\t): void {\n\t\t// set avatar image if it exist in user extract info.\n\t\tconst defaultImage = LOUtil.getImageURL('user.svg');\n\t\tconst viewInfo = map._viewInfo[viewId];\n\t\tif (\n\t\t\tviewInfo !== undefined &&\n\t\t\tviewInfo.userextrainfo !== undefined &&\n\t\t\tviewInfo.userextrainfo.avatar !== undefined\n\t\t) {\n\t\t\t// set user avatar.\n\t\t\timg.src = viewInfo.userextrainfo.avatar;\n\t\t\t// Track if error event is already bound to this image.\n\t\t\timg.addEventListener(\n\t\t\t\t'error',\n\t\t\t\tfunction () {\n\t\t\t\t\timg.src = defaultImage;\n\t\t\t\t\tLOUtil.checkIfImageExists(img, true);\n\t\t\t\t},\n\t\t\t\t{ once: true },\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\timg.src = defaultImage;\n\t\tLOUtil.checkIfImageExists(img, true);\n\t}\n\n\tpublic static getImageURL(imgName: string) {\n\t\tlet defaultImageURL = LOUtil.getURL('images/' + imgName);\n\n\t\t// Check if the image name is in the commonItems list and return the normal image path\n\t\tif (LOUtil.isCommonForAllMode(imgName)) {\n\t\t\treturn defaultImageURL;\n\t\t}\n\n\t\tif ((window as any).prefs.getBoolean('darkTheme')) {\n\t\t\treturn LOUtil.getURL('images/dark/' + imgName);\n\t\t}\n\n\t\tconst dummyEmptyImg =\n\t\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\t\tdefaultImageURL = LOUtil.isDarkModeItem(imgName)\n\t\t\t? dummyEmptyImg\n\t\t\t: defaultImageURL;\n\t\treturn defaultImageURL;\n\t}\n\n\tpublic static getIconNameOfCommand(name: string, noCommad: boolean) {\n\t\tif (!name) return '';\n\n\t\tvar alreadyClean = noCommad;\n\t\tvar cleanName = name;\n\n\t\tif (!alreadyClean || alreadyClean !== true) {\n\t\t\tvar prefixLength = '.uno:'.length;\n\t\t\tif (name.substr(0, prefixLength) == '.uno:')\n\t\t\t\tcleanName = name.substr(prefixLength);\n\t\t\tcleanName = encodeURIComponent(cleanName).replace(/%/g, '');\n\t\t\tcleanName = cleanName.toLowerCase();\n\t\t}\n\t\tvar iconURLAliases: IconNameMap = {\n\t\t\t// lc_closemobile.svg is generated when loading in NB mode then\n\t\t\t// switch to compact mode: 1st hidden element in the top toolbar\n\t\t\tclosemobile: 'closedocmobile',\n\t\t\t'file-saveas': 'saveas',\n\t\t\t'home-search': 'recsearch',\n\t\t\t'addmb-menu': 'ok',\n\t\t\tclosetablet: 'view',\n\t\t\tdefineprintarea: 'menuprintranges',\n\t\t\tdeleteprintarea: 'delete',\n\t\t\tsheetrighttoleft: 'pararighttoleft',\n\t\t\talignleft: 'leftpara',\n\t\t\talignright: 'rightpara',\n\t\t\talignhorizontalcenter: 'centerpara',\n\t\t\talignblock: 'justifypara',\n\t\t\tformatsparklinemenu: 'insertsparkline',\n\t\t\tinsertdatecontentcontrol: 'datefield',\n\t\t\teditheaderandfooter: 'headerandfooter',\n\t\t\texportas: 'saveas',\n\t\t\tinsertheaderfooter: 'headerandfooter',\n\t\t\tprevioustrackedchange: 'prevrecord',\n\t\t\tfieldtransparency: 'linetransparency',\n\t\t\tlb_glow_transparency: 'linetransparency',\n\t\t\tsettransparency: 'linetransparency',\n\t\t\tfield_transparency: 'linetransparency',\n\t\t\tselectionlanugagedefault: 'updateall',\n\t\t\tconnectortoolbox: 'connectorlines',\n\t\t\tconditionalformatdialog: 'conditionalformatmenu',\n\t\t\tgroupoutlinemenu: 'group',\n\t\t\tpaperwidth: 'pagewidth',\n\t\t\tcharspacing: 'spacing',\n\t\t\tfontworkcharacterspacingfloater: 'spacing',\n\t\t\ttablesort: 'datasort',\n\t\t\tspellcheckignoreall: 'spelling',\n\t\t\tdeleterowbreak: 'delbreakmenu',\n\t\t\talignmentpropertypanel: 'alignvcenter',\n\t\t\tcellvertcenter: 'alignvcenter',\n\t\t\tcharbackcolor: 'backcolor',\n\t\t\tcharmapcontrol: 'insertsymbol',\n\t\t\tinsertrowsafter: 'insertrowsmenu',\n\t\t\tinsertobjectchart: 'drawchart',\n\t\t\ttextpropertypanel: 'sidebartextpanel',\n\t\t\tspacepara15: 'linespacing',\n\t\t\torientationdegrees: 'rotation',\n\t\t\tclearoutline: 'delete',\n\t\t\tdocsign: 'editdoc',\n\t\t\teditmenu: 'editdoc',\n\t\t\tdrawtext: 'text',\n\t\t\tinserttextbox: 'text',\n\t\t\taccepttrackedchanges: 'acceptchanges',\n\t\t\taccepttrackedchange: 'acceptchanges',\n\t\t\tchartlinepanel: 'linestyle',\n\t\t\tlinepropertypanel: 'linestyle',\n\t\t\txlinestyle: 'linestyle',\n\t\t\tlistspropertypanel: 'outlinebullet',\n\t\t\tshadowpropertypanel: 'shadowed',\n\t\t\tincrementlevel: 'outlineleft',\n\t\t\tmenurowheight: 'rowheight',\n\t\t\tsetoptimalrowheight: 'rowheight',\n\t\t\tcellverttop: 'aligntop',\n\t\t\tscalignmentpropertypanel: 'aligntop',\n\t\t\thyperlinkdialog: 'inserthyperlink',\n\t\t\tremotelink: 'inserthyperlink',\n\t\t\tremoteaicontent: 'sdrespageobjs',\n\t\t\topenhyperlinkoncursor: 'inserthyperlink',\n\t\t\tpageformatdialog: 'pagedialog',\n\t\t\tbackgroundcolor: 'fillcolor',\n\t\t\tcellappearancepropertypanel: 'fillcolor',\n\t\t\tformatarea: 'fillcolor',\n\t\t\tglowcolor: 'fillcolor',\n\t\t\tsccellappearancepropertypanel: 'fillcolor',\n\t\t\tinsertcolumnsafter: 'insertcolumnsmenu',\n\t\t\tinsertnonbreakingspace: 'formattingmark',\n\t\t\tinsertcurrentdate: 'datefield',\n\t\t\tinsertdatefieldfix: 'datefield',\n\t\t\tinsertdatefield: 'datefield',\n\t\t\tinsertdatefieldvar: 'datefield',\n\t\t\tsetparagraphlanguagemenu: 'spelldialog',\n\t\t\tspellingandgrammardialog: 'spelldialog',\n\t\t\tspellonline: 'spelldialog',\n\t\t\tstyleapply3fstyle3astring3ddefault26familyname3astring3dcellstyles:\n\t\t\t\t'fontcolor',\n\t\t\tfontworkgalleryfloater: 'fontworkpropertypanel',\n\t\t\tinsertfieldctrl: 'insertfield',\n\t\t\tpagenumberwizard: 'insertpagenumberfield',\n\t\t\tentirerow: 'fromrow',\n\t\t\tinsertcheckboxcontentcontrol: 'checkbox',\n\t\t\tcellvertbottom: 'alignbottom',\n\t\t\tinsertcurrenttime: 'inserttimefield',\n\t\t\tinserttimefieldfix: 'inserttimefield',\n\t\t\tinserttimefieldvar: 'inserttimefield',\n\t\t\tcancelformula: 'cancel',\n\t\t\tresetattributes: 'setdefault',\n\t\t\ttabledialog: 'tablemenu',\n\t\t\tinsertindexesentry: 'insertmultiindex',\n\t\t\tpaperheight: 'pageheight',\n\t\t\tmasterslidespanel: 'masterslide',\n\t\t\tslidemasterpage: 'masterslide',\n\t\t\ttabledeletemenu: 'deletetable',\n\t\t\ttracechangemode: 'trackchanges',\n\t\t\tdeleteallannotation: 'deleteallnotes',\n\t\t\tsdtabledesignpanel: 'tabledesign',\n\t\t\ttableeditpanel: 'tabledesign',\n\t\t\ttableautofitmenu: 'columnwidth',\n\t\t\tmenucolumnwidth: 'columnwidth',\n\t\t\thyphenation: 'hyphenate',\n\t\t\tobjectbackone: 'behindobject',\n\t\t\tdeleteannotation: 'deletenote',\n\t\t\tareapropertypanel: 'chartareapanel',\n\t\t\t'downloadas-png': 'insertgraphic',\n\t\t\tdecrementlevel: 'outlineright',\n\t\t\tacceptformula: 'ok',\n\t\t\tinsertannotation: 'shownote',\n\t\t\tinsertcomment: 'shownote',\n\t\t\tobjecttitledescription: 'shownote',\n\t\t\tnamegroup: 'shownote',\n\t\t\tincrementindent: 'leftindent',\n\t\t\toutlineup: 'moveup',\n\t\t\tcharttypepanel: 'diagramtype',\n\t\t\tarrangeframemenu: 'arrangemenu',\n\t\t\tbringtofront: 'arrangemenu',\n\t\t\tscnumberformatpropertypanel: 'numberformatincdecimals',\n\t\t\tgraphicpropertypanel: 'graphicdialog',\n\t\t\trotateflipmenu: 'rotateleft',\n\t\t\toutlinedown: 'movedown',\n\t\t\tnexttrackedchange: 'nextrecord',\n\t\t\ttoggleorientation: 'orientation',\n\t\t\tconfiguredialog: 'sidebar',\n\t\t\tmodifypage: 'sidebar',\n\t\t\tparapropertypanel: 'paragraphdialog',\n\t\t\ttablecellbackgroundcolor: 'fillcolor',\n\t\t\tzoteroArtwork: 'zoteroThesis',\n\t\t\tzoteroAudioRecording: 'zoteroThesis',\n\t\t\tzoteroBill: 'zoteroThesis',\n\t\t\tzoteroBlogPost: 'zoteroThesis',\n\t\t\tzoteroBookSection: 'zoteroBook',\n\t\t\tzoteroCase: 'zoteroThesis',\n\t\t\tzoteroConferencePaper: 'zoteroThesis',\n\t\t\tzoteroDictionaryEntry: 'zoteroThesis',\n\t\t\tzoteroDocument: 'zoteroThesis',\n\t\t\tzoteroEmail: 'zoteroThesis',\n\t\t\tzoteroEncyclopediaArticle: 'zoteroThesis',\n\t\t\tzoteroFilm: 'zoteroThesis',\n\t\t\tzoteroForumPost: 'zoteroThesis',\n\t\t\tzoteroHearing: 'zoteroThesis',\n\t\t\tzoteroInstantMessage: 'zoteroThesis',\n\t\t\tzoteroInterview: 'zoteroThesis',\n\t\t\tzoteroLetter: 'zoteroThesis',\n\t\t\tzoteroMagazineArticle: 'zoteroThesis',\n\t\t\tzoteroWebpage: 'zoteroThesis',\n\t\t\tzoteroaddeditcitation: 'insertauthoritiesentry',\n\t\t\tzoteroaddnote: 'addcitationnote',\n\t\t\tzoterorefresh: 'updateall',\n\t\t\tzoterounlink: 'unlinkcitation',\n\t\t\tzoteroaddeditbibliography: 'addeditbibliography',\n\t\t\tzoteroeditbibliography: 'addeditbibliography',\n\t\t\tzoterosetdocprefs: 'formproperties',\n\t\t\t'sidebardeck.propertydeck': 'sidebar',\n\t\t\t// Fix issue #6145 by adding aliases for the PDF and EPUB icons\n\t\t\t// The fix for issues #6103 and #6104 changes the name of these\n\t\t\t// icons so map the new names to the old names.\n\t\t\t'downloadas-pdf': 'exportpdf',\n\t\t\t'downloadas-direct-pdf': 'exportdirectpdf',\n\t\t\t'downloadas-epub': 'exportepub',\n\t\t\tlanguagestatusmenu: 'languagemenu',\n\t\t\tcancelsearch: 'cancel',\n\t\t\tprintoptions: 'print',\n\t\t\ttogglesheetgrid: 'show',\n\t\t\t'hamburger-tablet': 'fold',\n\t\t\texportdirectpdf: 'exportpdf',\n\t\t\ttextcolumnspropertypanel: 'entirecolumn',\n\t\t\t'sidebardeck.stylelistdeck': 'editstyle',\n\t\t};\n\t\tif (iconURLAliases[cleanName]) {\n\t\t\tcleanName = iconURLAliases[cleanName];\n\t\t}\n\n\t\treturn 'lc_' + cleanName + '.svg';\n\t}\n\n\tpublic static checkIfImageExists(\n\t\timageElement: HTMLImageElement,\n\t\timageIsLayoutCritical?: boolean,\n\t): void {\n\t\timageElement.addEventListener('error', function (e: any) {\n\t\t\tif (e.loUtilProcessed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\timageElement.src &&\n\t\t\t\timageElement.src.includes('/images/branding/dark/')\n\t\t\t) {\n\t\t\t\timageElement.src = imageElement.src.replace(\n\t\t\t\t\t'/images/branding/dark/',\n\t\t\t\t\t'/images/dark/',\n\t\t\t\t);\n\t\t\t\te.loUtilProcessed = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (\n\t\t\t\timageElement.src &&\n\t\t\t\t(imageElement.src.includes('/images/dark/') ||\n\t\t\t\t\timageElement.src.includes('/images/branding/'))\n\t\t\t) {\n\t\t\t\timageElement.src = imageElement.src.replace(\n\t\t\t\t\t'/images/dark/',\n\t\t\t\t\t'/images/',\n\t\t\t\t);\n\t\t\t\timageElement.src = imageElement.src.replace(\n\t\t\t\t\t'/images/branding/',\n\t\t\t\t\t'/images/',\n\t\t\t\t);\n\t\t\t\te.loUtilProcessed = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (imageIsLayoutCritical) {\n\t\t\t\timageElement.src =\n\t\t\t\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\t\t\t\t// We cannot set visibility: hidden because that would hide\n\t\t\t\t// other attributes of the image, e.g. its border.\n\t\t\t\te.loUtilProcessed = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\timageElement.style.display = 'none';\n\t\t\te.loUtilProcessed = true;\n\t\t});\n\t}\n\n\t/// oldFileName = Example.odt, suffix = new\n\t/// returns: Example_new.odt\n\tpublic static generateNewFileName(\n\t\toldFileName: string,\n\t\tsuffix: string,\n\t): string {\n\t\tconst idx = oldFileName.lastIndexOf('.');\n\t\treturn oldFileName.substring(0, idx) + suffix + oldFileName.substring(idx);\n\t}\n\n\tpublic static commandWithoutIcon: string[] = [\n\t\t'InsertPageHeader',\n\t\t'InsertPageFooter',\n\t\t'FLD_COL_NUMBER',\n\t\t'MTR_FLD_COL_SPACING',\n\t\t'rows',\n\t\t'cols',\n\t\t'None',\n\t];\n\n\tpublic static existsIconForCommand(\n\t\tcommand: string,\n\t\tdocType: string,\n\t): boolean {\n\t\tconst commandName = command.startsWith('.uno:')\n\t\t\t? command.substring('.uno:'.length)\n\t\t\t: command;\n\t\tconst res = !LOUtil.commandWithoutIcon.find(function (el: string) {\n\t\t\treturn el.startsWith(commandName);\n\t\t});\n\t\tif (commandName.indexOf('?') !== -1) {\n\t\t\tif (\n\t\t\t\tcommandName.indexOf('SpellCheckIgnore') !== -1 ||\n\t\t\t\tcommandName.indexOf('SpellCheckIgnoreAll') !== -1\n\t\t\t)\n\t\t\t\treturn true;\n\n\t\t\tif (\n\t\t\t\t(docType === 'spreadsheet' || docType === 'presentation') &&\n\t\t\t\tcommandName.indexOf('LanguageStatus') !== -1\n\t\t\t)\n\t\t\t\treturn true;\n\n\t\t\tif (\n\t\t\t\tcommandName ===\n\t\t\t\t\t'LanguageStatus?Language:string=Current_LANGUAGE_NONE' ||\n\t\t\t\tcommandName ===\n\t\t\t\t\t'LanguageStatus?Language:string=Current_RESET_LANGUAGES' ||\n\t\t\t\tcommandName ===\n\t\t\t\t\t'LanguageStatus?Language:string=Paragraph_LANGUAGE_NONE' ||\n\t\t\t\tcommandName ===\n\t\t\t\t\t'LanguageStatus?Language:string=Paragraph_RESET_LANGUAGES'\n\t\t\t)\n\t\t\t\treturn true;\n\n\t\t\treturn false;\n\t\t}\n\t\treturn res;\n\t}\n\n\t/// Searching in JSON trees for data with a given field.\n\tpublic static findItemWithAttributeRecursive(\n\t\tnode: DOMObjectLike,\n\t\tidName: string,\n\t\tidValue: any,\n\t): DOMObjectLike | null {\n\t\tlet found: DOMObjectLike | null = null;\n\t\tif (node[idName] === idValue) return node;\n\t\tif (node.children) {\n\t\t\tfor (var i = 0; !found && i < node.children.length; i++)\n\t\t\t\tfound = LOUtil.findItemWithAttributeRecursive(\n\t\t\t\t\tnode.children[i],\n\t\t\t\t\tidName,\n\t\t\t\t\tidValue,\n\t\t\t\t);\n\t\t}\n\t\treturn found;\n\t}\n\n\t/// Searching in JSON trees for an identifier and return the index in parent.\n\tpublic static findIndexInParentByAttribute(\n\t\tnode: DOMObjectLike,\n\t\tidName: string,\n\t\tidValue: any,\n\t): number {\n\t\tif (node.children) {\n\t\t\tfor (var i = 0; i < node.children.length; i++)\n\t\t\t\tif (node.children[i][idName] === idValue) return i;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tpublic static _doRectanglesIntersect(\n\t\trectangle1: number[],\n\t\trectangle2: number[],\n\t): boolean {\n\t\t// Format: (x, y, w, h).\n\t\t// Don't use equality in comparison, that's not an intersection.\n\t\tif (\n\t\t\tMath.abs(\n\t\t\t\trectangle1[0] +\n\t\t\t\t\trectangle1[2] * 0.5 -\n\t\t\t\t\t(rectangle2[0] + rectangle2[2] * 0.5),\n\t\t\t) <\n\t\t\t0.5 * (rectangle1[2] + rectangle2[2])\n\t\t) {\n\t\t\tif (\n\t\t\t\tMath.abs(\n\t\t\t\t\trectangle1[1] +\n\t\t\t\t\t\trectangle1[3] * 0.5 -\n\t\t\t\t\t\t(rectangle2[1] + rectangle2[3] * 0.5),\n\t\t\t\t) <\n\t\t\t\t0.5 * (rectangle1[3] + rectangle2[3])\n\t\t\t)\n\t\t\t\treturn true;\n\t\t\telse return false;\n\t\t} else return false;\n\t}\n\n\t// Returns the intersecting area of 2 rectangles. Rectangle format: (x, y, w, h). Return format is the same or null.\n\tpublic static _getIntersectionRectangle(\n\t\trectangle1: number[],\n\t\trectangle2: number[],\n\t): number[] | null {\n\t\tif (this._doRectanglesIntersect(rectangle1, rectangle2)) {\n\t\t\tvar x = rectangle1[0] > rectangle2[0] ? rectangle1[0] : rectangle2[0];\n\t\t\tvar y = rectangle1[1] > rectangle2[1] ? rectangle1[1] : rectangle2[1];\n\t\t\tvar w =\n\t\t\t\trectangle1[0] + rectangle1[2] < rectangle2[0] + rectangle2[2]\n\t\t\t\t\t? rectangle1[0] + rectangle1[2] - x\n\t\t\t\t\t: rectangle2[0] + rectangle2[2] - x;\n\t\t\tvar h =\n\t\t\t\trectangle1[1] + rectangle1[3] < rectangle2[1] + rectangle2[3]\n\t\t\t\t\t? rectangle1[1] + rectangle1[3] - y\n\t\t\t\t\t: rectangle2[1] + rectangle2[3] - y;\n\n\t\t\treturn [x, y, w, h];\n\t\t} else return null;\n\t}\n\n\tpublic static getFileExtension(map: any): string {\n\t\tconst filename: string = map['wopi'].BaseFileName;\n\t\treturn filename.substring(filename.lastIndexOf('.') + 1);\n\t}\n\n\tpublic static isFileODF(map: any): boolean {\n\t\tvar ext = LOUtil.getFileExtension(map);\n\t\treturn ext === 'odt' || ext === 'ods' || ext === 'odp' || ext == 'odg';\n\t}\n\n\tpublic static containsDOMRect(\n\t\tviewRect: RectangleLike,\n\t\trect: RectangleLike,\n\t): boolean {\n\t\treturn (\n\t\t\trect.top >= viewRect.top &&\n\t\t\trect.right <= viewRect.right &&\n\t\t\trect.bottom <= viewRect.bottom &&\n\t\t\trect.left >= viewRect.left\n\t\t);\n\t}\n\n\tpublic static Rectangle = cool.Rectangle;\n\tpublic static createRectangle = cool.createRectangle;\n}\n\napp.LOUtil = LOUtil;\n"]}